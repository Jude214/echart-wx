!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.echarts={})}(this,function(exports){"use strict";var isDom2="undefined"!=typeof window&&!!window.addEventListener,extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)};function __extends(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var Browser=function(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1},env=new function(){this.browser=new Browser,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow="undefined"!=typeof window};"object"==typeof wx&&"function"==typeof wx.getSystemInfoSync?(env.wxa=!0,env.touchEventsSupported=!0):"undefined"==typeof document&&"undefined"!=typeof self?env.worker=!0:"undefined"==typeof navigator?(env.node=!0,env.svgSupported=!0):function(ua,env){var browser=env.browser,firefox=ua.match(/Firefox\/([\d.]+)/),ie=ua.match(/MSIE\s([\d.]+)/)||ua.match(/Trident\/.+?rv:(([\d.]+))/),edge=ua.match(/Edge?\/([\d.]+)/),ua=/micromessenger/i.test(ua);firefox&&(browser.firefox=!0,browser.version=firefox[1]);ie&&(browser.ie=!0,browser.version=ie[1]);edge&&(browser.edge=!0,browser.version=edge[1],browser.newEdge=18<+edge[1].split(".")[0]);ua&&(browser.weChat=!0);env.svgSupported="undefined"!=typeof SVGRect,env.touchEventsSupported="ontouchstart"in window&&!browser.ie&&!browser.edge,env.pointerEventsSupported="onpointerdown"in window&&(browser.edge||browser.ie&&11<=+browser.version),env.domSupported="undefined"!=typeof document;firefox=document.documentElement.style;env.transform3dSupported=(browser.ie&&"transition"in firefox||browser.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in firefox)&&!("OTransition"in firefox),env.transformSupported=env.transform3dSupported||browser.ie&&9<=+browser.version}(navigator.userAgent,env);var DEFAULT_FONT="12px sans-serif";var _ctx,_cachedFont,DEFAULT_TEXT_WIDTH_MAP=function(mapStr){var map={};if("undefined"==typeof JSON)return map;for(var i=0;i<mapStr.length;i++){var char=String.fromCharCode(i+32),size=(mapStr.charCodeAt(i)-20)/100;map[char]=size}return map}("007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N"),platformApi={createCanvas:function(){return"undefined"!=typeof document&&document.createElement("canvas")},measureText:function(text,font){if(_ctx||(canvas=platformApi.createCanvas(),_ctx=canvas&&canvas.getContext("2d")),_ctx)return _cachedFont!==font&&(_cachedFont=_ctx.font=font||DEFAULT_FONT),_ctx.measureText(text);text=text||"",font=font||DEFAULT_FONT;var canvas=/^([0-9]*?)px$/.exec(font),fontSize=+(canvas&&canvas[1])||12,width=0;if(0<=font.indexOf("mono"))width=fontSize*text.length;else for(var i=0;i<text.length;i++){var preCalcWidth=DEFAULT_TEXT_WIDTH_MAP[text[i]];width+=null==preCalcWidth?fontSize:preCalcWidth*fontSize}return{width:width}},loadImage:function(src,onload,onerror){var image=new Image;return image.onload=onload,image.onerror=onerror,image.src=src,image}};function setPlatformAPI(newPlatformApis){for(var key in platformApi)newPlatformApis[key]&&(platformApi[key]=newPlatformApis[key])}var BUILTIN_OBJECT=reduce(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(obj,val){return obj["[object "+val+"]"]=!0,obj},{}),TYPED_ARRAY=reduce(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(obj,val){return obj["[object "+val+"Array]"]=!0,obj},{}),objToString=Object.prototype.toString,arrayProto=Array.prototype,nativeForEach=arrayProto.forEach,nativeFilter=arrayProto.filter,nativeSlice=arrayProto.slice,nativeMap=arrayProto.map,arrayProto=function(){}.constructor,arrayProto=arrayProto?arrayProto.prototype:null,protoKey="__proto__",idStart=2311;function guid(){return idStart++}function logError(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];"undefined"!=typeof console&&console.error.apply(console,args)}function clone(source){if(null==source||"object"!=typeof source)return source;var result=source,typeStr=objToString.call(source);if("[object Array]"===typeStr){if(!isPrimitive(source))for(var result=[],i=0,len=source.length;i<len;i++)result[i]=clone(source[i])}else if(TYPED_ARRAY[typeStr]){if(!isPrimitive(source)){var Ctor=source.constructor;if(Ctor.from)result=Ctor.from(source);else{result=new Ctor(source.length);for(i=0,len=source.length;i<len;i++)result[i]=source[i]}}}else if(!BUILTIN_OBJECT[typeStr]&&!isPrimitive(source)&&!isDom(source))for(var key in result={},source)source.hasOwnProperty(key)&&key!==protoKey&&(result[key]=clone(source[key]));return result}function merge(target,source,overwrite){if(!isObject(source)||!isObject(target))return overwrite?clone(source):target;for(var key in source){var targetProp,sourceProp;source.hasOwnProperty(key)&&key!==protoKey&&(targetProp=target[key],!isObject(sourceProp=source[key])||!isObject(targetProp)||isArray(sourceProp)||isArray(targetProp)||isDom(sourceProp)||isDom(targetProp)||isBuiltInObject(sourceProp)||isBuiltInObject(targetProp)||isPrimitive(sourceProp)||isPrimitive(targetProp)?!overwrite&&key in target||(target[key]=clone(source[key])):merge(targetProp,sourceProp,overwrite))}return target}function extend(target,source){if(Object.assign)Object.assign(target,source);else for(var key in source)source.hasOwnProperty(key)&&key!==protoKey&&(target[key]=source[key]);return target}function defaults(target,source,overlay){for(var keysArr=keys(source),i=0;i<keysArr.length;i++){var key=keysArr[i];(overlay?null!=source[key]:null==target[key])&&(target[key]=source[key])}return target}var createCanvas=platformApi.createCanvas;function indexOf(array,value){if(array){if(array.indexOf)return array.indexOf(value);for(var i=0,len=array.length;i<len;i++)if(array[i]===value)return i}return-1}function inherits(clazz,baseClazz){var prop,clazzPrototype=clazz.prototype;function F(){}for(prop in F.prototype=baseClazz.prototype,clazz.prototype=new F,clazzPrototype)clazzPrototype.hasOwnProperty(prop)&&(clazz.prototype[prop]=clazzPrototype[prop]);(clazz.prototype.constructor=clazz).superClass=baseClazz}function mixin(target,source,override){if(target="prototype"in target?target.prototype:target,source="prototype"in source?source.prototype:source,Object.getOwnPropertyNames)for(var keyList=Object.getOwnPropertyNames(source),i=0;i<keyList.length;i++){var key=keyList[i];"constructor"!==key&&(override?null!=source[key]:null==target[key])&&(target[key]=source[key])}else defaults(target,source,override)}function isArrayLike(data){return!!data&&("string"!=typeof data&&"number"==typeof data.length)}function each(arr,cb,context){if(arr&&cb)if(arr.forEach&&arr.forEach===nativeForEach)arr.forEach(cb,context);else if(arr.length===+arr.length)for(var i=0,len=arr.length;i<len;i++)cb.call(context,arr[i],i,arr);else for(var key in arr)arr.hasOwnProperty(key)&&cb.call(context,arr[key],key,arr)}function map(arr,cb,context){if(!arr)return[];if(!cb)return slice(arr);if(arr.map&&arr.map===nativeMap)return arr.map(cb,context);for(var result=[],i=0,len=arr.length;i<len;i++)result.push(cb.call(context,arr[i],i,arr));return result}function reduce(arr,cb,memo,context){if(arr&&cb){for(var i=0,len=arr.length;i<len;i++)memo=cb.call(context,memo,arr[i],i,arr);return memo}}function filter(arr,cb,context){if(!arr)return[];if(!cb)return slice(arr);if(arr.filter&&arr.filter===nativeFilter)return arr.filter(cb,context);for(var result=[],i=0,len=arr.length;i<len;i++)cb.call(context,arr[i],i,arr)&&result.push(arr[i]);return result}function keys(obj){if(!obj)return[];if(Object.keys)return Object.keys(obj);var key,keyList=[];for(key in obj)obj.hasOwnProperty(key)&&keyList.push(key);return keyList}var bind=arrayProto&&isFunction(arrayProto.bind)?arrayProto.call.bind(arrayProto.bind):function(func,context){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];return function(){return func.apply(context,args.concat(nativeSlice.call(arguments)))}};function curry(func){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return function(){return func.apply(this,args.concat(nativeSlice.call(arguments)))}}function isArray(value){return Array.isArray?Array.isArray(value):"[object Array]"===objToString.call(value)}function isFunction(value){return"function"==typeof value}function isString(value){return"string"==typeof value}function isStringSafe(value){return"[object String]"===objToString.call(value)}function isNumber(value){return"number"==typeof value}function isObject(value){var type=typeof value;return"function"==type||!!value&&"object"==type}function isBuiltInObject(value){return!!BUILTIN_OBJECT[objToString.call(value)]}function isTypedArray(value){return!!TYPED_ARRAY[objToString.call(value)]}function isDom(value){return"object"==typeof value&&"number"==typeof value.nodeType&&"object"==typeof value.ownerDocument}function isGradientObject(value){return null!=value.colorStops}function isImagePatternObject(value){return null!=value.image}function isRegExp(value){return"[object RegExp]"===objToString.call(value)}function eqNaN(value){return value!=value}function retrieve(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];for(var i=0,len=args.length;i<len;i++)if(null!=args[i])return args[i]}function retrieve2(value0,value1){return null!=value0?value0:value1}function retrieve3(value0,value1,value2){return null!=value0?value0:null!=value1?value1:value2}function slice(arr){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return nativeSlice.apply(arr,args)}function normalizeCssArray(val){if("number"==typeof val)return[val,val,val,val];var len=val.length;return 2===len?[val[0],val[1],val[0],val[1]]:3===len?[val[0],val[1],val[2],val[1]]:val}function assert(condition,message){if(!condition)throw new Error(message)}function trim(str){return null==str?null:"function"==typeof str.trim?str.trim():str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var primitiveKey="__ec_primitive__";function setAsPrimitive(obj){obj[primitiveKey]=!0}function isPrimitive(obj){return obj[primitiveKey]}var HashMap=function(){function HashMap(obj){this.data={};var isArr=isArray(obj),thisMap=(this.data={},this);function visit(value,key){isArr?thisMap.set(value,key):thisMap.set(key,value)}obj instanceof HashMap?obj.each(visit):obj&&each(obj,visit)}return HashMap.prototype.get=function(key){return this.data.hasOwnProperty(key)?this.data[key]:null},HashMap.prototype.set=function(key,value){return this.data[key]=value},HashMap.prototype.each=function(cb,context){for(var key in this.data)this.data.hasOwnProperty(key)&&cb.call(context,this.data[key],key)},HashMap.prototype.keys=function(){return keys(this.data)},HashMap.prototype.removeKey=function(key){delete this.data[key]},HashMap}();function createHashMap(obj){return new HashMap(obj)}function concatArray(a,b){for(var newArray=new a.constructor(a.length+b.length),i=0;i<a.length;i++)newArray[i]=a[i];for(var offset=a.length,i=0;i<b.length;i++)newArray[i+offset]=b[i];return newArray}function createObject(proto,properties){var StyleCtor,proto=Object.create?Object.create(proto):((StyleCtor=function(){}).prototype=proto,new StyleCtor);return properties&&extend(proto,properties),proto}function disableUserSelect(dom){dom=dom.style;dom.webkitUserSelect="none",dom.userSelect="none",dom.webkitTapHighlightColor="rgba(0,0,0,0)",dom["-webkit-touch-callout"]="none"}function hasOwn(own,prop){return own.hasOwnProperty(prop)}function noop(){}var RADIAN_TO_DEGREE=180/Math.PI,arrayProto=(Object.freeze||Object)({guid:guid,logError:logError,clone:clone,merge:merge,mergeAll:function(targetAndSources,overwrite){for(var result=targetAndSources[0],i=1,len=targetAndSources.length;i<len;i++)result=merge(result,targetAndSources[i],overwrite);return result},extend:extend,defaults:defaults,createCanvas:createCanvas,indexOf:indexOf,inherits:inherits,mixin:mixin,isArrayLike:isArrayLike,each:each,map:map,reduce:reduce,filter:filter,find:function(arr,cb,context){if(arr&&cb)for(var i=0,len=arr.length;i<len;i++)if(cb.call(context,arr[i],i,arr))return arr[i]},keys:keys,bind:bind,curry:curry,isArray:isArray,isFunction:isFunction,isString:isString,isStringSafe:isStringSafe,isNumber:isNumber,isObject:isObject,isBuiltInObject:isBuiltInObject,isTypedArray:isTypedArray,isDom:isDom,isGradientObject:isGradientObject,isImagePatternObject:isImagePatternObject,isRegExp:isRegExp,eqNaN:eqNaN,retrieve:retrieve,retrieve2:retrieve2,retrieve3:retrieve3,slice:slice,normalizeCssArray:normalizeCssArray,assert:assert,trim:trim,setAsPrimitive:setAsPrimitive,isPrimitive:isPrimitive,HashMap:HashMap,createHashMap:createHashMap,concatArray:concatArray,createObject:createObject,disableUserSelect:disableUserSelect,hasOwn:hasOwn,noop:noop,RADIAN_TO_DEGREE:RADIAN_TO_DEGREE});function create(x,y){return[x=null==x?0:x,y=null==y?0:y]}function clone$1(v){return[v[0],v[1]]}function add(out,v1,v2){return out[0]=v1[0]+v2[0],out[1]=v1[1]+v2[1],out}function sub(out,v1,v2){return out[0]=v1[0]-v2[0],out[1]=v1[1]-v2[1],out}function len(v){return Math.sqrt(lenSquare(v))}function lenSquare(v){return v[0]*v[0]+v[1]*v[1]}function scale(out,v,s){return out[0]=v[0]*s,out[1]=v[1]*s,out}function normalize(out,v){var d=len(v);return 0===d?(out[0]=0,out[1]=0):(out[0]=v[0]/d,out[1]=v[1]/d),out}function distance(v1,v2){return Math.sqrt((v1[0]-v2[0])*(v1[0]-v2[0])+(v1[1]-v2[1])*(v1[1]-v2[1]))}var dist=distance;function distanceSquare(v1,v2){return(v1[0]-v2[0])*(v1[0]-v2[0])+(v1[1]-v2[1])*(v1[1]-v2[1])}var distSquare=distanceSquare;function lerp(out,v1,v2,t){return out[0]=v1[0]+t*(v2[0]-v1[0]),out[1]=v1[1]+t*(v2[1]-v1[1]),out}function applyTransform(out,v,m){var x=v[0],v=v[1];return out[0]=m[0]*x+m[2]*v+m[4],out[1]=m[1]*x+m[3]*v+m[5],out}function min(out,v1,v2){return out[0]=Math.min(v1[0],v2[0]),out[1]=Math.min(v1[1],v2[1]),out}function max(out,v1,v2){return out[0]=Math.max(v1[0],v2[0]),out[1]=Math.max(v1[1],v2[1]),out}var createCanvas=(Object.freeze||Object)({create:create,copy:function(out,v){return out[0]=v[0],out[1]=v[1],out},clone:clone$1,set:function(out,a,b){return out[0]=a,out[1]=b,out},add:add,scaleAndAdd:function(out,v1,v2,a){return out[0]=v1[0]+v2[0]*a,out[1]=v1[1]+v2[1]*a,out},sub:sub,len:len,length:len,lenSquare:lenSquare,lengthSquare:lenSquare,mul:function(out,v1,v2){return out[0]=v1[0]*v2[0],out[1]=v1[1]*v2[1],out},div:function(out,v1,v2){return out[0]=v1[0]/v2[0],out[1]=v1[1]/v2[1],out},dot:function(v1,v2){return v1[0]*v2[0]+v1[1]*v2[1]},scale:scale,normalize:normalize,distance:distance,dist:dist,distanceSquare:distanceSquare,distSquare:distSquare,negate:function(out,v){return out[0]=-v[0],out[1]=-v[1],out},lerp:lerp,applyTransform:applyTransform,min:min,max:max}),Param=function(target,e){this.target=target,this.topTarget=e&&e.topTarget},Draggable=function(){function Draggable(handler){(this.handler=handler).on("mousedown",this._dragStart,this),handler.on("mousemove",this._drag,this),handler.on("mouseup",this._dragEnd,this)}return Draggable.prototype._dragStart=function(e){for(var draggingTarget=e.target;draggingTarget&&!draggingTarget.draggable;)draggingTarget=draggingTarget.parent||draggingTarget.__hostTarget;draggingTarget&&((this._draggingTarget=draggingTarget).dragging=!0,this._x=e.offsetX,this._y=e.offsetY,this.handler.dispatchToElement(new Param(draggingTarget,e),"dragstart",e.event))},Draggable.prototype._drag=function(e){var x,y,dx,dy,draggingTarget=this._draggingTarget;draggingTarget&&(x=e.offsetX,y=e.offsetY,dx=x-this._x,dy=y-this._y,this._x=x,this._y=y,draggingTarget.drift(dx,dy,e),this.handler.dispatchToElement(new Param(draggingTarget,e),"drag",e.event),dx=this.handler.findHover(x,y,draggingTarget).target,dy=this._dropTarget,draggingTarget!==(this._dropTarget=dx)&&(dy&&dx!==dy&&this.handler.dispatchToElement(new Param(dy,e),"dragleave",e.event),dx&&dx!==dy&&this.handler.dispatchToElement(new Param(dx,e),"dragenter",e.event)))},Draggable.prototype._dragEnd=function(e){var draggingTarget=this._draggingTarget;draggingTarget&&(draggingTarget.dragging=!1),this.handler.dispatchToElement(new Param(draggingTarget,e),"dragend",e.event),this._dropTarget&&this.handler.dispatchToElement(new Param(this._dropTarget,e),"drop",e.event),this._draggingTarget=null,this._dropTarget=null},Draggable}(),Eventful=function(){function Eventful(eventProcessors){eventProcessors&&(this._$eventProcessor=eventProcessors)}return Eventful.prototype.on=function(event,query,handler,context){this._$handlers||(this._$handlers={});var _h=this._$handlers;if("function"==typeof query&&(context=handler,handler=query,query=null),!handler||!event)return this;var eventProcessor=this._$eventProcessor;null!=query&&eventProcessor&&eventProcessor.normalizeQuery&&(query=eventProcessor.normalizeQuery(query)),_h[event]||(_h[event]=[]);for(var i=0;i<_h[event].length;i++)if(_h[event][i].h===handler)return this;eventProcessor={h:handler,query:query,ctx:context||this,callAtLast:handler.zrEventfulCallAtLast},query=_h[event].length-1,context=_h[event][query];return context&&context.callAtLast?_h[event].splice(query,0,eventProcessor):_h[event].push(eventProcessor),this},Eventful.prototype.isSilent=function(eventName){var _h=this._$handlers;return!_h||!_h[eventName]||!_h[eventName].length},Eventful.prototype.off=function(eventType,handler){var _h=this._$handlers;if(!_h)return this;if(!eventType)return this._$handlers={},this;if(handler){if(_h[eventType]){for(var newList=[],i=0,l=_h[eventType].length;i<l;i++)_h[eventType][i].h!==handler&&newList.push(_h[eventType][i]);_h[eventType]=newList}_h[eventType]&&0===_h[eventType].length&&delete _h[eventType]}else delete _h[eventType];return this},Eventful.prototype.trigger=function(eventType){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];if(!this._$handlers)return this;var _h=this._$handlers[eventType],eventProcessor=this._$eventProcessor;if(_h)for(var argLen=args.length,len=_h.length,i=0;i<len;i++){var hItem=_h[i];if(!eventProcessor||!eventProcessor.filter||null==hItem.query||eventProcessor.filter(eventType,hItem.query))switch(argLen){case 0:hItem.h.call(hItem.ctx);break;case 1:hItem.h.call(hItem.ctx,args[0]);break;case 2:hItem.h.call(hItem.ctx,args[0],args[1]);break;default:hItem.h.apply(hItem.ctx,args)}}return eventProcessor&&eventProcessor.afterTrigger&&eventProcessor.afterTrigger(eventType),this},Eventful.prototype.triggerWithContext=function(type){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];if(!this._$handlers)return this;var _h=this._$handlers[type],eventProcessor=this._$eventProcessor;if(_h)for(var argLen=args.length,ctx=args[argLen-1],len=_h.length,i=0;i<len;i++){var hItem=_h[i];if(!eventProcessor||!eventProcessor.filter||null==hItem.query||eventProcessor.filter(type,hItem.query))switch(argLen){case 0:hItem.h.call(ctx);break;case 1:hItem.h.call(ctx,args[0]);break;case 2:hItem.h.call(ctx,args[0],args[1]);break;default:hItem.h.apply(ctx,args.slice(1,argLen-1))}}return eventProcessor&&eventProcessor.afterTrigger&&eventProcessor.afterTrigger(type),this},Eventful}(),LN2=Math.log(2);function determinant(rows,rank,rowStart,rowMask,colMask,detCache){var colStart,cacheKey=rowMask+"-"+colMask,fullRank=rows.length;if(detCache.hasOwnProperty(cacheKey))return detCache[cacheKey];if(1===rank)return colStart=Math.round(Math.log((1<<fullRank)-1&~colMask)/LN2),rows[rowStart][colStart];for(var subRowMask=rowMask|1<<rowStart,subRowStart=rowStart+1;rowMask&1<<subRowStart;)subRowStart++;for(var sum=0,j=0,colLocalIdx=0;j<fullRank;j++){var colTag=1<<j;colTag&colMask||(sum+=(colLocalIdx%2?-1:1)*rows[rowStart][j]*determinant(rows,rank-1,subRowStart,subRowMask,colMask|colTag,detCache),colLocalIdx++)}return detCache[cacheKey]=sum}function buildTransformer(src,dest){var mA=[[src[0],src[1],1,0,0,0,-dest[0]*src[0],-dest[0]*src[1]],[0,0,0,src[0],src[1],1,-dest[1]*src[0],-dest[1]*src[1]],[src[2],src[3],1,0,0,0,-dest[2]*src[2],-dest[2]*src[3]],[0,0,0,src[2],src[3],1,-dest[3]*src[2],-dest[3]*src[3]],[src[4],src[5],1,0,0,0,-dest[4]*src[4],-dest[4]*src[5]],[0,0,0,src[4],src[5],1,-dest[5]*src[4],-dest[5]*src[5]],[src[6],src[7],1,0,0,0,-dest[6]*src[6],-dest[6]*src[7]],[0,0,0,src[6],src[7],1,-dest[7]*src[6],-dest[7]*src[7]]],detCache={},det=determinant(mA,8,0,0,0,detCache);if(0!==det){for(var vh=[],i=0;i<8;i++)for(var j=0;j<8;j++)null==vh[j]&&(vh[j]=0),vh[j]+=((i+j)%2?-1:1)*determinant(mA,7,0===i?1:0,1<<i,1<<j,detCache)/det*dest[i];return function(out,srcPointX,srcPointY){var pk=srcPointX*vh[6]+srcPointY*vh[7]+1;out[0]=(srcPointX*vh[0]+srcPointY*vh[1]+vh[2])/pk,out[1]=(srcPointX*vh[3]+srcPointY*vh[4]+vh[5])/pk}}}var EVENT_SAVED_PROP="___zrEVENTSAVED",_calcOut$1=[];function transformCoordWithViewport(out,el,inX,inY,inverse){if(el.getBoundingClientRect&&env.domSupported&&!isCanvasEl(el)){var saved=el[EVENT_SAVED_PROP]||(el[EVENT_SAVED_PROP]={}),el=function(markers,saved,inverse){for(var transformerName=inverse?"invTrans":"trans",transformer=saved[transformerName],oldSrcCoords=saved.srcCoords,srcCoords=[],destCoords=[],oldCoordTheSame=!0,i=0;i<4;i++){var rect=markers[i].getBoundingClientRect(),ii=2*i,x=rect.left,rect=rect.top;srcCoords.push(x,rect),oldCoordTheSame=oldCoordTheSame&&oldSrcCoords&&x===oldSrcCoords[ii]&&rect===oldSrcCoords[1+ii],destCoords.push(markers[i].offsetLeft,markers[i].offsetTop)}return oldCoordTheSame&&transformer?transformer:(saved.srcCoords=srcCoords,saved[transformerName]=inverse?buildTransformer(destCoords,srcCoords):buildTransformer(srcCoords,destCoords))}(function(el,saved){var markers=saved.markers;if(markers)return markers;markers=saved.markers=[];for(var propLR=["left","right"],propTB=["top","bottom"],i=0;i<4;i++){var marker=document.createElement("div"),stl=marker.style,idxLR=i%2,idxTB=(i>>1)%2;stl.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",propLR[idxLR]+":0",propTB[idxTB]+":0",propLR[1-idxLR]+":auto",propTB[1-idxTB]+":auto",""].join("!important;"),el.appendChild(marker),markers.push(marker)}return markers}(el,saved),saved,inverse);if(el)return el(out,inX,inY),!0}return!1}function isCanvasEl(el){return"CANVAS"===el.nodeName.toUpperCase()}var MOUSE_EVENT_REG=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,_calcOut=[],firefoxNotSupportOffsetXY=env.browser.firefox&&+env.browser.version.split(".")[0]<39;function clientToLocal(el,e,out,calculate){return out=out||{},calculate?calculateZrXY(el,e,out):firefoxNotSupportOffsetXY&&null!=e.layerX&&e.layerX!==e.offsetX?(out.zrX=e.layerX,out.zrY=e.layerY):null!=e.offsetX?(out.zrX=e.offsetX,out.zrY=e.offsetY):calculateZrXY(el,e,out),out}function calculateZrXY(el,e,out){if(env.domSupported&&el.getBoundingClientRect){var box,ex=e.clientX,e=e.clientY;if(isCanvasEl(el))return box=el.getBoundingClientRect(),out.zrX=ex-box.left,void(out.zrY=e-box.top);if(transformCoordWithViewport(_calcOut,el,ex,e))return out.zrX=_calcOut[0],void(out.zrY=_calcOut[1])}out.zrX=out.zrY=0}function getNativeEvent(e){return e||window.event}function normalizeEvent(el,e,calculate){if(null!=(e=getNativeEvent(e)).zrX)return e;var eventType=e.type,el=(eventType&&0<=eventType.indexOf("touch")?(eventType=("touchend"!==eventType?e.targetTouches:e.changedTouches)[0])&&clientToLocal(el,eventType,e,calculate):(clientToLocal(el,e,e,calculate),eventType=function(e){var rawWheelDelta=e.wheelDelta;if(rawWheelDelta)return rawWheelDelta;var deltaX=e.deltaX,e=e.deltaY;return null!=deltaX&&null!=e?3*(0!==e?Math.abs(e):Math.abs(deltaX))*(0<e||!(e<0)&&0<deltaX?-1:1):rawWheelDelta}(e),e.zrDelta=eventType?eventType/120:-(e.detail||0)/3),e.button);return null==e.which&&void 0!==el&&MOUSE_EVENT_REG.test(e.type)&&(e.which=1&el?1:2&el?3:4&el?2:0),e}var stop=function(e){isDom2?(e.preventDefault(),e.stopPropagation()):e.returnValue=!1,e.cancelBubble=!0};function isMiddleOrRightButtonOnMouseUpDown(e){return 2===e.which||3===e.which}var GestureMgr=function(){function GestureMgr(){this._track=[]}return GestureMgr.prototype.recognize=function(event,target,root){return this._doTrack(event,target,root),this._recognize(event)},GestureMgr.prototype.clear=function(){return this._track.length=0,this},GestureMgr.prototype._doTrack=function(event,target,root){var touches=event.touches;if(touches){for(var trackItem={points:[],touches:[],target:target,event:event},i=0,len=touches.length;i<len;i++){var touch=touches[i],pos=clientToLocal(root,touch,{});trackItem.points.push([pos.zrX,pos.zrY]),trackItem.touches.push(touch)}this._track.push(trackItem)}},GestureMgr.prototype._recognize=function(event){for(var eventName in recognizers)if(recognizers.hasOwnProperty(eventName)){eventName=recognizers[eventName](this._track,event);if(eventName)return eventName}},GestureMgr}();function dist$1(pointPair){var dx=pointPair[1][0]-pointPair[0][0],pointPair=pointPair[1][1]-pointPair[0][1];return Math.sqrt(dx*dx+pointPair*pointPair)}var recognizers={pinch:function(tracks,event){var pinchEnd,trackLen=tracks.length;if(trackLen)return pinchEnd=(tracks[trackLen-1]||{}).points,trackLen=(tracks[trackLen-2]||{}).points||pinchEnd,trackLen&&1<trackLen.length&&pinchEnd&&1<pinchEnd.length?(trackLen=dist$1(pinchEnd)/dist$1(trackLen),isFinite(trackLen)||(trackLen=1),event.pinchScale=trackLen,trackLen=[(pinchEnd[0][0]+pinchEnd[1][0])/2,(pinchEnd[0][1]+pinchEnd[1][1])/2],event.pinchX=trackLen[0],event.pinchY=trackLen[1],{type:"pinch",target:tracks[0].target,event:event}):void 0}};function stopEvent(){stop(this.event)}var EmptyProxy=function(_super){function EmptyProxy(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.handler=null,_this}return __extends(EmptyProxy,_super),EmptyProxy.prototype.dispose=function(){},EmptyProxy.prototype.setCursor=function(){},EmptyProxy}(Eventful),HoveredResult=function(x,y){this.x=x,this.y=y},handlerNames=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],Handler=function(_super){function Handler(storage,painter,proxy,painterRoot){var _this=_super.call(this)||this;return _this._hovered=new HoveredResult(0,0),_this.storage=storage,_this.painter=painter,_this.painterRoot=painterRoot,proxy=proxy||new EmptyProxy,_this.proxy=null,_this.setHandlerProxy(proxy),_this._draggingMgr=new Draggable(_this),_this}return __extends(Handler,_super),Handler.prototype.setHandlerProxy=function(proxy){this.proxy&&this.proxy.dispose(),proxy&&(each(handlerNames,function(name){proxy.on&&proxy.on(name,this[name],this)},this),proxy.handler=this),this.proxy=proxy},Handler.prototype.mousemove=function(event){var x=event.zrX,y=event.zrY,isOutside=isOutsideBoundary(this,x,y),lastHovered=this._hovered,lastHoveredTarget=lastHovered.target,isOutside=(lastHoveredTarget&&!lastHoveredTarget.__zr&&(lastHoveredTarget=(lastHovered=this.findHover(lastHovered.x,lastHovered.y)).target),this._hovered=isOutside?new HoveredResult(x,y):this.findHover(x,y)),x=isOutside.target,y=this.proxy;y.setCursor&&y.setCursor(x?x.cursor:"default"),lastHoveredTarget&&x!==lastHoveredTarget&&this.dispatchToElement(lastHovered,"mouseout",event),this.dispatchToElement(isOutside,"mousemove",event),x&&x!==lastHoveredTarget&&this.dispatchToElement(isOutside,"mouseover",event)},Handler.prototype.mouseout=function(event){var eventControl=event.zrEventControl;"only_globalout"!==eventControl&&this.dispatchToElement(this._hovered,"mouseout",event),"no_globalout"!==eventControl&&this.trigger("globalout",{type:"globalout",event:event})},Handler.prototype.resize=function(){this._hovered=new HoveredResult(0,0)},Handler.prototype.dispatch=function(eventName,eventArgs){eventName=this[eventName];eventName&&eventName.call(this,eventArgs)},Handler.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},Handler.prototype.setCursorStyle=function(cursorStyle){var proxy=this.proxy;proxy.setCursor&&proxy.setCursor(cursorStyle)},Handler.prototype.dispatchToElement=function(targetInfo,eventName,event){var el=(targetInfo=targetInfo||{}).target;if(!el||!el.silent){for(var eventKey="on"+eventName,eventPacket=function(eveType,targetInfo,event){return{type:eveType,event:event,target:targetInfo.target,topTarget:targetInfo.topTarget,cancelBubble:!1,offsetX:event.zrX,offsetY:event.zrY,gestureEvent:event.gestureEvent,pinchX:event.pinchX,pinchY:event.pinchY,pinchScale:event.pinchScale,wheelDelta:event.zrDelta,zrByTouch:event.zrByTouch,which:event.which,stop:stopEvent}}(eventName,targetInfo,event);el&&(el[eventKey]&&(eventPacket.cancelBubble=!!el[eventKey].call(el,eventPacket)),el.trigger(eventName,eventPacket),el=el.__hostTarget||el.parent,!eventPacket.cancelBubble););eventPacket.cancelBubble||(this.trigger(eventName,eventPacket),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(layer){"function"==typeof layer[eventKey]&&layer[eventKey].call(layer,eventPacket),layer.trigger&&layer.trigger(eventName,eventPacket)}))}},Handler.prototype.findHover=function(x,y,exclude){for(var list=this.storage.getDisplayList(),out=new HoveredResult(x,y),i=list.length-1;0<=i;i--){var hoverCheckResult=void 0;if(list[i]!==exclude&&!list[i].ignore&&(hoverCheckResult=function(displayable,x,y){if(displayable[displayable.rectHover?"rectContain":"contain"](x,y)){for(var el=displayable,isSilent=void 0,ignoreClip=!1;el;){if(!(ignoreClip=el.ignoreClip?!0:ignoreClip)){var clipPath=el.getClipPath();if(clipPath&&!clipPath.contain(x,y))return!1;el.silent&&(isSilent=!0)}clipPath=el.__hostTarget;el=clipPath||el.parent}return!isSilent||"silent"}return!1}(list[i],x,y))&&(out.topTarget||(out.topTarget=list[i]),"silent"!==hoverCheckResult)){out.target=list[i];break}}return out},Handler.prototype.processGesture=function(event,stage){this._gestureMgr||(this._gestureMgr=new GestureMgr);var gestureMgr=this._gestureMgr,gestureInfo=("start"===stage&&gestureMgr.clear(),gestureMgr.recognize(event,this.findHover(event.zrX,event.zrY,null).target,this.proxy.dom));"end"===stage&&gestureMgr.clear(),gestureInfo&&(stage=gestureInfo.type,event.gestureEvent=stage,(gestureMgr=new HoveredResult).target=gestureInfo.target,this.dispatchToElement(gestureMgr,stage,gestureInfo.event))},Handler}(Eventful);function isOutsideBoundary(handlerInstance,x,y){handlerInstance=handlerInstance.painter;return x<0||x>handlerInstance.getWidth()||y<0||y>handlerInstance.getHeight()}each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(name){Handler.prototype[name]=function(event){var hovered,hoveredTarget,x=event.zrX,y=event.zrY,isOutside=isOutsideBoundary(this,x,y);if("mouseup"===name&&isOutside||(hoveredTarget=(hovered=this.findHover(x,y)).target),"mousedown"===name)this._downEl=hoveredTarget,this._downPoint=[event.zrX,event.zrY],this._upEl=hoveredTarget;else if("mouseup"===name)this._upEl=hoveredTarget;else if("click"===name){if(this._downEl!==this._upEl||!this._downPoint||4<dist(this._downPoint,[event.zrX,event.zrY]))return;this._downPoint=null}this.dispatchToElement(hovered,name,event)}});var DEFAULT_MIN_MERGE=32,DEFAULT_MIN_GALLOPING=7;function makeAscendingRun(array,lo,hi,compare){var runHi=lo+1;if(runHi===hi)return 1;if(compare(array[runHi++],array[lo])<0){for(;runHi<hi&&compare(array[runHi],array[runHi-1])<0;)runHi++;!function(array,lo,hi){hi--;for(;lo<hi;){var t=array[lo];array[lo++]=array[hi],array[hi--]=t}}(array,lo,runHi)}else for(;runHi<hi&&0<=compare(array[runHi],array[runHi-1]);)runHi++;return runHi-lo}function binaryInsertionSort(array,lo,hi,start,compare){for(start===lo&&start++;start<hi;start++){for(var mid,pivot=array[start],left=lo,right=start;left<right;)compare(pivot,array[mid=left+right>>>1])<0?right=mid:left=1+mid;var n=start-left;switch(n){case 3:array[left+3]=array[left+2];case 2:array[left+2]=array[left+1];case 1:array[left+1]=array[left];break;default:for(;0<n;)array[left+n]=array[left+n-1],n--}array[left]=pivot}}function gallopLeft(value,array,start,length,hint,compare){var lastOffset=0,maxOffset=0,offset=1;if(0<compare(value,array[start+hint])){for(maxOffset=length-hint;offset<maxOffset&&0<compare(value,array[start+hint+offset]);)(offset=1+((lastOffset=offset)<<1))<=0&&(offset=maxOffset);maxOffset<offset&&(offset=maxOffset),lastOffset+=hint,offset+=hint}else{for(maxOffset=hint+1;offset<maxOffset&&compare(value,array[start+hint-offset])<=0;)(offset=1+((lastOffset=offset)<<1))<=0&&(offset=maxOffset);length=lastOffset,lastOffset=hint-(offset=maxOffset<offset?maxOffset:offset),offset=hint-length}for(lastOffset++;lastOffset<offset;){var m=lastOffset+(offset-lastOffset>>>1);0<compare(value,array[start+m])?lastOffset=m+1:offset=m}return offset}function gallopRight(value,array,start,length,hint,compare){var lastOffset=0,maxOffset=0,offset=1;if(compare(value,array[start+hint])<0){for(maxOffset=hint+1;offset<maxOffset&&compare(value,array[start+hint-offset])<0;)(offset=1+((lastOffset=offset)<<1))<=0&&(offset=maxOffset);var tmp=lastOffset,lastOffset=hint-(offset=maxOffset<offset?maxOffset:offset),offset=hint-tmp}else{for(maxOffset=length-hint;offset<maxOffset&&0<=compare(value,array[start+hint+offset]);)(offset=1+((lastOffset=offset)<<1))<=0&&(offset=maxOffset);maxOffset<offset&&(offset=maxOffset),lastOffset+=hint,offset+=hint}for(lastOffset++;lastOffset<offset;){var m=lastOffset+(offset-lastOffset>>>1);compare(value,array[start+m])<0?offset=m:lastOffset=m+1}return offset}function TimSort(array,compare){var runStart,runLength,minGallop=DEFAULT_MIN_GALLOPING,stackSize=0,tmp=[];function mergeAt(i){var start1=runStart[i],length1=runLength[i],start2=runStart[i+1],length2=runLength[i+1],i=(runLength[i]=length1+length2,i===stackSize-3&&(runStart[i+1]=runStart[i+2],runLength[i+1]=runLength[i+2]),stackSize--,gallopRight(array[start2],array,start1,length1,0,compare));start1+=i,0!=(length1-=i)&&0!==(length2=gallopLeft(array[start1+length1-1],array,start2,length2,length2-1,compare))&&(length1<=length2?function(start1,length1,start2,length2){var i=0;for(i=0;i<length1;i++)tmp[i]=array[start1+i];var cursor1=0,cursor2=start2,dest=start1;if(array[dest++]=array[cursor2++],0==--length2)for(i=0;i<length1;i++)array[dest+i]=tmp[cursor1+i];else if(1===length1){for(i=0;i<length2;i++)array[dest+i]=array[cursor2+i];array[dest+length2]=tmp[cursor1]}else{for(var count1,count2,exit,_minGallop=minGallop;;){count2=count1=0,exit=!1;do{if(compare(array[cursor2],tmp[cursor1])<0){if(array[dest++]=array[cursor2++],count2++,(count1=0)==--length2){exit=!0;break}}else if(array[dest++]=tmp[cursor1++],count1++,count2=0,1==--length1){exit=!0;break}}while((count1|count2)<_minGallop);if(exit)break;do{if(0!==(count1=gallopRight(array[cursor2],tmp,cursor1,length1,0,compare))){for(i=0;i<count1;i++)array[dest+i]=tmp[cursor1+i];if(dest+=count1,cursor1+=count1,(length1-=count1)<=1){exit=!0;break}}if(array[dest++]=array[cursor2++],0==--length2){exit=!0;break}if(0!==(count2=gallopLeft(tmp[cursor1],array,cursor2,length2,0,compare))){for(i=0;i<count2;i++)array[dest+i]=array[cursor2+i];if(dest+=count2,cursor2+=count2,0===(length2-=count2)){exit=!0;break}}if(array[dest++]=tmp[cursor1++],1==--length1){exit=!0;break}}while(_minGallop--,DEFAULT_MIN_GALLOPING<=count1||DEFAULT_MIN_GALLOPING<=count2);if(exit)break;_minGallop<0&&(_minGallop=0),_minGallop+=2}if((minGallop=_minGallop)<1&&(minGallop=1),1===length1){for(i=0;i<length2;i++)array[dest+i]=array[cursor2+i];array[dest+length2]=tmp[cursor1]}else{if(0===length1)throw new Error;for(i=0;i<length1;i++)array[dest+i]=tmp[cursor1+i]}}}:function(start1,length1,start2,length2){var i=0;for(i=0;i<length2;i++)tmp[i]=array[start2+i];var cursor1=start1+length1-1,cursor2=length2-1,dest=start2+length2-1,customCursor=0,customDest=0;if(array[dest--]=array[cursor1--],0==--length1)for(customCursor=dest-(length2-1),i=0;i<length2;i++)array[customCursor+i]=tmp[i];else if(1===length2){for(customDest=(dest-=length1)+1,customCursor=(cursor1-=length1)+1,i=length1-1;0<=i;i--)array[customDest+i]=array[customCursor+i];array[dest]=tmp[cursor2]}else{for(var _minGallop=minGallop;;){var count1=0,count2=0,exit=!1;do{if(compare(tmp[cursor2],array[cursor1])<0){if(array[dest--]=array[cursor1--],count1++,(count2=0)==--length1){exit=!0;break}}else if(array[dest--]=tmp[cursor2--],count2++,count1=0,1==--length2){exit=!0;break}}while((count1|count2)<_minGallop);if(exit)break;do{if(0!==(count1=length1-gallopRight(tmp[cursor2],array,start1,length1,length1-1,compare))){for(length1-=count1,customDest=(dest-=count1)+1,customCursor=(cursor1-=count1)+1,i=count1-1;0<=i;i--)array[customDest+i]=array[customCursor+i];if(0===length1){exit=!0;break}}if(array[dest--]=tmp[cursor2--],1==--length2){exit=!0;break}if(0!==(count2=length2-gallopLeft(array[cursor1],tmp,0,length2,length2-1,compare))){for(length2-=count2,customDest=(dest-=count2)+1,customCursor=(cursor2-=count2)+1,i=0;i<count2;i++)array[customDest+i]=tmp[customCursor+i];if(length2<=1){exit=!0;break}}if(array[dest--]=array[cursor1--],0==--length1){exit=!0;break}}while(_minGallop--,DEFAULT_MIN_GALLOPING<=count1||DEFAULT_MIN_GALLOPING<=count2);if(exit)break;_minGallop<0&&(_minGallop=0),_minGallop+=2}if((minGallop=_minGallop)<1&&(minGallop=1),1===length2){for(customDest=(dest-=length1)+1,customCursor=(cursor1-=length1)+1,i=length1-1;0<=i;i--)array[customDest+i]=array[customCursor+i];array[dest]=tmp[cursor2]}else{if(0===length2)throw new Error;for(customCursor=dest-(length2-1),i=0;i<length2;i++)array[customCursor+i]=tmp[i]}}})(start1,length1,start2,length2)}return runStart=[],runLength=[],{mergeRuns:function(){for(;1<stackSize;){var n=stackSize-2;if(1<=n&&runLength[n-1]<=runLength[n]+runLength[n+1]||2<=n&&runLength[n-2]<=runLength[n]+runLength[n-1])runLength[n-1]<runLength[n+1]&&n--;else if(runLength[n]>runLength[n+1])break;mergeAt(n)}},forceMergeRuns:function(){for(;1<stackSize;){var n=stackSize-2;0<n&&runLength[n-1]<runLength[n+1]&&n--,mergeAt(n)}},pushRun:function(_runStart,_runLength){runStart[stackSize]=_runStart,runLength[stackSize]=_runLength,stackSize+=1}}}function sort(array,compare,lo,hi){var remaining=(hi=hi||array.length)-(lo=lo||0);if(!(remaining<2)){var runLength=0;if(remaining<DEFAULT_MIN_MERGE)binaryInsertionSort(array,lo,hi,lo+(runLength=makeAscendingRun(array,lo,hi,compare)),compare);else{var force,ts=TimSort(array,compare),minRun=function(n){for(var r=0;DEFAULT_MIN_MERGE<=n;)r|=1&n,n>>=1;return n+r}(remaining);do{}while((runLength=makeAscendingRun(array,lo,hi,compare))<minRun&&(binaryInsertionSort(array,lo,lo+(force=minRun<(force=remaining)?minRun:remaining),lo+runLength,compare),runLength=force),ts.pushRun(lo,runLength),ts.mergeRuns(),lo+=runLength,0!==(remaining-=runLength));ts.forceMergeRuns()}}}var REDRAW_BIT=1,SHAPE_CHANGED_BIT=4,invalidZErrorLogged=!1;function logInvalidZError(){invalidZErrorLogged||(invalidZErrorLogged=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function shapeCompareFunc(a,b){return a.zlevel===b.zlevel?a.z===b.z?a.z2-b.z2:a.z-b.z:a.zlevel-b.zlevel}var Storage=function(){function Storage(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=shapeCompareFunc}return Storage.prototype.traverse=function(cb,context){for(var i=0;i<this._roots.length;i++)this._roots[i].traverse(cb,context)},Storage.prototype.getDisplayList=function(update,includeIgnore){includeIgnore=includeIgnore||!1;var displayList=this._displayList;return!update&&displayList.length||this.updateDisplayList(includeIgnore),displayList},Storage.prototype.updateDisplayList=function(includeIgnore){this._displayListLen=0;for(var roots=this._roots,displayList=this._displayList,i=0,len=roots.length;i<len;i++)this._updateAndAddDisplayable(roots[i],null,includeIgnore);displayList.length=this._displayListLen,sort(displayList,shapeCompareFunc)},Storage.prototype._updateAndAddDisplayable=function(el,clipPaths,includeIgnore){if(!el.ignore||includeIgnore){el.beforeUpdate(),el.update(),el.afterUpdate();var userSetClipPath=el.getClipPath();if(el.ignoreClip)clipPaths=null;else if(userSetClipPath){clipPaths=clipPaths?clipPaths.slice():[];for(var currentClipPath=userSetClipPath,parentClipPath=el;currentClipPath;)currentClipPath.parent=parentClipPath,currentClipPath.updateTransform(),clipPaths.push(currentClipPath),currentClipPath=(parentClipPath=currentClipPath).getClipPath()}if(el.childrenRef){for(var children=el.childrenRef(),i=0;i<children.length;i++){var child=children[i];el.__dirty&&(child.__dirty|=REDRAW_BIT),this._updateAndAddDisplayable(child,clipPaths,includeIgnore)}el.__dirty=0}else{userSetClipPath=el;clipPaths&&clipPaths.length?userSetClipPath.__clipPaths=clipPaths:userSetClipPath.__clipPaths&&0<userSetClipPath.__clipPaths.length&&(userSetClipPath.__clipPaths=[]),isNaN(userSetClipPath.z)&&(logInvalidZError(),userSetClipPath.z=0),isNaN(userSetClipPath.z2)&&(logInvalidZError(),userSetClipPath.z2=0),isNaN(userSetClipPath.zlevel)&&(logInvalidZError(),userSetClipPath.zlevel=0),this._displayList[this._displayListLen++]=userSetClipPath}userSetClipPath=el.getDecalElement&&el.getDecalElement(),userSetClipPath=(userSetClipPath&&this._updateAndAddDisplayable(userSetClipPath,clipPaths,includeIgnore),el.getTextGuideLine()),userSetClipPath=(userSetClipPath&&this._updateAndAddDisplayable(userSetClipPath,clipPaths,includeIgnore),el.getTextContent());userSetClipPath&&this._updateAndAddDisplayable(userSetClipPath,clipPaths,includeIgnore)}},Storage.prototype.addRoot=function(el){el.__zr&&el.__zr.storage===this||this._roots.push(el)},Storage.prototype.delRoot=function(el){if(el instanceof Array)for(var i=0,l=el.length;i<l;i++)this.delRoot(el[i]);else{var idx=indexOf(this._roots,el);0<=idx&&this._roots.splice(idx,1)}},Storage.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},Storage.prototype.getRoots=function(){return this._roots},Storage.prototype.dispose=function(){this._displayList=null,this._roots=null},Storage}(),requestAnimationFrame$1=env.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(func){return setTimeout(func,16)},easingFuncs={linear:function(k){return k},quadraticIn:function(k){return k*k},quadraticOut:function(k){return k*(2-k)},quadraticInOut:function(k){return(k*=2)<1?.5*k*k:-.5*(--k*(k-2)-1)},cubicIn:function(k){return k*k*k},cubicOut:function(k){return--k*k*k+1},cubicInOut:function(k){return(k*=2)<1?.5*k*k*k:.5*((k-=2)*k*k+2)},quarticIn:function(k){return k*k*k*k},quarticOut:function(k){return 1- --k*k*k*k},quarticInOut:function(k){return(k*=2)<1?.5*k*k*k*k:-.5*((k-=2)*k*k*k-2)},quinticIn:function(k){return k*k*k*k*k},quinticOut:function(k){return--k*k*k*k*k+1},quinticInOut:function(k){return(k*=2)<1?.5*k*k*k*k*k:.5*((k-=2)*k*k*k*k+2)},sinusoidalIn:function(k){return 1-Math.cos(k*Math.PI/2)},sinusoidalOut:function(k){return Math.sin(k*Math.PI/2)},sinusoidalInOut:function(k){return.5*(1-Math.cos(Math.PI*k))},exponentialIn:function(k){return 0===k?0:Math.pow(1024,k-1)},exponentialOut:function(k){return 1===k?1:1-Math.pow(2,-10*k)},exponentialInOut:function(k){return 0===k?0:1===k?1:(k*=2)<1?.5*Math.pow(1024,k-1):.5*(2-Math.pow(2,-10*(k-1)))},circularIn:function(k){return 1-Math.sqrt(1-k*k)},circularOut:function(k){return Math.sqrt(1- --k*k)},circularInOut:function(k){return(k*=2)<1?-.5*(Math.sqrt(1-k*k)-1):.5*(Math.sqrt(1-(k-=2)*k)+1)},elasticIn:function(k){var s,a=.1;return 0===k?0:1===k?1:(s=!a||a<1?(a=1,.1):.4*Math.asin(1/a)/(2*Math.PI),-(a*Math.pow(2,10*--k)*Math.sin((k-s)*(2*Math.PI)/.4)))},elasticOut:function(k){var s,a=.1;return 0===k?0:1===k?1:(s=!a||a<1?(a=1,.1):.4*Math.asin(1/a)/(2*Math.PI),a*Math.pow(2,-10*k)*Math.sin((k-s)*(2*Math.PI)/.4)+1)},elasticInOut:function(k){var s,a=.1;return 0===k?0:1===k?1:(s=!a||a<1?(a=1,.1):.4*Math.asin(1/a)/(2*Math.PI),(k*=2)<1?a*Math.pow(2,10*--k)*Math.sin((k-s)*(2*Math.PI)/.4)*-.5:a*Math.pow(2,-10*--k)*Math.sin((k-s)*(2*Math.PI)/.4)*.5+1)},backIn:function(k){var s=1.70158;return k*k*((1+s)*k-s)},backOut:function(k){var s=1.70158;return--k*k*((1+s)*k+s)+1},backInOut:function(k){var s=2.5949095;return(k*=2)<1?k*k*((1+s)*k-s)*.5:.5*((k-=2)*k*((1+s)*k+s)+2)},bounceIn:function(k){return 1-easingFuncs.bounceOut(1-k)},bounceOut:function(k){return k<1/2.75?7.5625*k*k:k<2/2.75?7.5625*(k-=1.5/2.75)*k+.75:k<2.5/2.75?7.5625*(k-=2.25/2.75)*k+.9375:7.5625*(k-=2.625/2.75)*k+.984375},bounceInOut:function(k){return k<.5?.5*easingFuncs.bounceIn(2*k):.5*easingFuncs.bounceOut(2*k-1)+.5}},mathPow=Math.pow,mathSqrt=Math.sqrt,EPSILON=1e-8,THREE_SQRT=mathSqrt(3),ONE_THIRD=1/3,_v0=create(),_v1=create(),_v2=create();function isAroundZero(val){return-EPSILON<val&&val<EPSILON}function isNotAroundZero(val){return EPSILON<val||val<-EPSILON}function cubicAt(p0,p1,p2,p3,t){var onet=1-t;return onet*onet*(onet*p0+3*t*p1)+t*t*(t*p3+3*onet*p2)}function cubicDerivativeAt(p0,p1,p2,p3,t){var onet=1-t;return 3*(((p1-p0)*onet+2*(p2-p1)*t)*onet+(p3-p2)*t*t)}function cubicRootAt(p0,p1,p2,p3,val,roots){var t1,t2,p3=p3+3*(p1-p2)-p0,p2=3*(p2-2*p1+p0),p1=3*(p1-p0),p0=p0-val,val=p2*p2-3*p3*p1,B=p2*p1-9*p3*p0,p0=p1*p1-3*p2*p0,n=0;return isAroundZero(val)&&isAroundZero(B)?isAroundZero(p2)?roots[0]=0:0<=(t1=-p1/p2)&&t1<=1&&(roots[n++]=t1):isAroundZero(p1=B*B-4*val*p0)?(t2=-(p0=B/val)/2,0<=(t1=-p2/p3+p0)&&t1<=1&&(roots[n++]=t1),0<=t2&&t2<=1&&(roots[n++]=t2)):0<p1?(p1=val*p2+1.5*p3*(-B-(p0=mathSqrt(p1))),0<=(t1=(-p2-((p0=(p0=val*p2+1.5*p3*(-B+p0))<0?-mathPow(-p0,ONE_THIRD):mathPow(p0,ONE_THIRD))+(p1=p1<0?-mathPow(-p1,ONE_THIRD):mathPow(p1,ONE_THIRD))))/(3*p3))&&t1<=1&&(roots[n++]=t1)):(p0=(2*val*p2-3*p3*B)/(2*mathSqrt(val*val*val)),p1=Math.acos(p0)/3,t1=(-p2-2*(B=mathSqrt(val))*(p0=Math.cos(p1)))/(3*p3),t2=(-p2+B*(p0+THREE_SQRT*Math.sin(p1)))/(3*p3),val=(-p2+B*(p0-THREE_SQRT*Math.sin(p1)))/(3*p3),0<=t1&&t1<=1&&(roots[n++]=t1),0<=t2&&t2<=1&&(roots[n++]=t2),0<=val&&val<=1&&(roots[n++]=val)),n}function cubicExtrema(p0,p1,p2,p3,extrema){var t1,b=6*p2-12*p1+6*p0,p3=9*p1+3*p3-3*p0-9*p2,p2=3*p1-3*p0,p1=0;return isAroundZero(p3)?isNotAroundZero(b)&&0<=(t1=-p2/b)&&t1<=1&&(extrema[p1++]=t1):isAroundZero(p0=b*b-4*p3*p2)?extrema[0]=-b/(2*p3):0<p0&&(p0=(-b-(p2=mathSqrt(p0)))/(2*p3),0<=(t1=(-b+p2)/(2*p3))&&t1<=1&&(extrema[p1++]=t1),0<=p0&&p0<=1&&(extrema[p1++]=p0)),p1}function cubicSubdivide(p0,p1,p2,p3,t,out){var p01=(p1-p0)*t+p0,p1=(p2-p1)*t+p1,p2=(p3-p2)*t+p2,p012=(p1-p01)*t+p01,p1=(p2-p1)*t+p1,t=(p1-p012)*t+p012;out[0]=p0,out[1]=p01,out[2]=p012,out[3]=t,out[4]=t,out[5]=p1,out[6]=p2,out[7]=p3}function cubicProjectPoint(x0,y0,x1,y1,x2,y2,x3,y3,x,y,out){var t,next,d1,prev,interval=.005,d=1/0;_v0[0]=x,_v0[1]=y;for(var _t=0;_t<1;_t+=.05)_v1[0]=cubicAt(x0,x1,x2,x3,_t),_v1[1]=cubicAt(y0,y1,y2,y3,_t),(d1=distSquare(_v0,_v1))<d&&(t=_t,d=d1);for(var d=1/0,i=0;i<32&&!(interval<1e-4);i++)next=t+interval,_v1[0]=cubicAt(x0,x1,x2,x3,prev=t-interval),_v1[1]=cubicAt(y0,y1,y2,y3,prev),d1=distSquare(_v1,_v0),0<=prev&&d1<d?(t=prev,d=d1):(_v2[0]=cubicAt(x0,x1,x2,x3,next),_v2[1]=cubicAt(y0,y1,y2,y3,next),prev=distSquare(_v2,_v0),next<=1&&prev<d?(t=next,d=prev):interval*=.5);return out&&(out[0]=cubicAt(x0,x1,x2,x3,t),out[1]=cubicAt(y0,y1,y2,y3,t)),mathSqrt(d)}function quadraticAt(p0,p1,p2,t){var onet=1-t;return onet*(onet*p0+2*t*p1)+t*t*p2}function quadraticDerivativeAt(p0,p1,p2,t){return 2*((1-t)*(p1-p0)+t*(p2-p1))}function quadraticExtremum(p0,p1,p2){p2=p0+p2-2*p1;return 0==p2?.5:(p0-p1)/p2}function quadraticSubdivide(p0,p1,p2,t,out){var p01=(p1-p0)*t+p0,p1=(p2-p1)*t+p1,t=(p1-p01)*t+p01;out[0]=p0,out[1]=p01,out[2]=t,out[3]=t,out[4]=p1,out[5]=p2}function quadraticProjectPoint(x0,y0,x1,y1,x2,y2,x,y,out){var t,interval=.005,d=1/0;_v0[0]=x,_v0[1]=y;for(var _t=0;_t<1;_t+=.05)_v1[0]=quadraticAt(x0,x1,x2,_t),_v1[1]=quadraticAt(y0,y1,y2,_t),(d1=distSquare(_v0,_v1))<d&&(t=_t,d=d1);for(var d=1/0,i=0;i<32&&!(interval<1e-4);i++){var prev=t-interval,next=t+interval,d1=(_v1[0]=quadraticAt(x0,x1,x2,prev),_v1[1]=quadraticAt(y0,y1,y2,prev),distSquare(_v1,_v0));0<=prev&&d1<d?(t=prev,d=d1):(_v2[0]=quadraticAt(x0,x1,x2,next),_v2[1]=quadraticAt(y0,y1,y2,next),prev=distSquare(_v2,_v0),next<=1&&prev<d?(t=next,d=prev):interval*=.5)}return out&&(out[0]=quadraticAt(x0,x1,x2,t),out[1]=quadraticAt(y0,y1,y2,t)),mathSqrt(d)}var regexp=/cubic-bezier\(([0-9,\.e ]+)\)/;function createCubicEasingFunc(cubicEasingStr){cubicEasingStr=cubicEasingStr&&regexp.exec(cubicEasingStr);if(cubicEasingStr){var roots_1,cubicEasingStr=cubicEasingStr[1].split(","),a_1=+trim(cubicEasingStr[0]),b_1=+trim(cubicEasingStr[1]),c_1=+trim(cubicEasingStr[2]),d_1=+trim(cubicEasingStr[3]);if(isNaN(a_1+b_1+c_1+d_1));else return roots_1=[],function(p){return p<=0?0:1<=p?1:cubicRootAt(0,a_1,c_1,1,p,roots_1)&&cubicAt(0,b_1,d_1,1,roots_1[0])}}}var Clip=function(){function Clip(opts){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=opts.life||1e3,this._delay=opts.delay||0,this.loop=opts.loop||!1,this.onframe=opts.onframe||noop,this.ondestroy=opts.ondestroy||noop,this.onrestart=opts.onrestart||noop,opts.easing&&this.setEasing(opts.easing)}return Clip.prototype.step=function(globalTime,deltaTime){if(this._inited||(this._startTime=globalTime+this._delay,this._inited=!0),!this._paused){var life=this._life,elapsedTime=globalTime-this._startTime-this._pausedTime,percent=elapsedTime/life,easingFunc=(percent<0&&(percent=0),percent=Math.min(percent,1),this.easingFunc),easingFunc=easingFunc?easingFunc(percent):percent;if(this.onframe(easingFunc),1===percent){if(!this.loop)return!0;this._startTime=globalTime-elapsedTime%life,this._pausedTime=0,this.onrestart()}return!1}this._pausedTime+=deltaTime},Clip.prototype.pause=function(){this._paused=!0},Clip.prototype.resume=function(){this._paused=!1},Clip.prototype.setEasing=function(easing){this.easing=easing,this.easingFunc=isFunction(easing)?easing:easingFuncs[easing]||createCubicEasingFunc(easing)},Clip}(),Entry=function(val){this.value=val},LinkedList=function(){function LinkedList(){this._len=0}return LinkedList.prototype.insert=function(val){val=new Entry(val);return this.insertEntry(val),val},LinkedList.prototype.insertEntry=function(entry){this.head?((this.tail.next=entry).prev=this.tail,entry.next=null,this.tail=entry):this.head=this.tail=entry,this._len++},LinkedList.prototype.remove=function(entry){var prev=entry.prev,next=entry.next;prev?prev.next=next:this.head=next,next?next.prev=prev:this.tail=prev,entry.next=entry.prev=null,this._len--},LinkedList.prototype.len=function(){return this._len},LinkedList.prototype.clear=function(){this.head=this.tail=null,this._len=0},LinkedList}(),LRU=function(){function LRU(maxSize){this._list=new LinkedList,this._maxSize=10,this._map={},this._maxSize=maxSize}return LRU.prototype.put=function(key,value){var entry,len,list=this._list,map=this._map,removed=null;return null==map[key]&&(len=list.len(),entry=this._lastRemovedEntry,len>=this._maxSize&&0<len&&(len=list.head,list.remove(len),delete map[len.key],removed=len.value,this._lastRemovedEntry=len),entry?entry.value=value:entry=new Entry(value),entry.key=key,list.insertEntry(entry),map[key]=entry),removed},LRU.prototype.get=function(key){var key=this._map[key],list=this._list;if(null!=key)return key!==list.tail&&(list.remove(key),list.insertEntry(key)),key.value},LRU.prototype.clear=function(){this._list.clear(),this._map={}},LRU.prototype.len=function(){return this._list.len()},LRU}(),kCSSColorTable={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function clampCssByte(i){return(i=Math.round(i))<0?0:255<i?255:i}function clampCssFloat(f){return f<0?0:1<f?1:f}function parseCssInt(val){return val.length&&"%"===val.charAt(val.length-1)?clampCssByte(parseFloat(val)/100*255):clampCssByte(parseInt(val,10))}function parseCssFloat(val){return val.length&&"%"===val.charAt(val.length-1)?clampCssFloat(parseFloat(val)/100):clampCssFloat(parseFloat(val))}function cssHueToRgb(m1,m2,h){return h<0?h+=1:1<h&&--h,6*h<1?m1+(m2-m1)*h*6:2*h<1?m2:3*h<2?m1+(m2-m1)*(2/3-h)*6:m1}function lerpNumber(a,b,p){return a+(b-a)*p}function setRgba(out,r,g,b,a){return out[0]=r,out[1]=g,out[2]=b,out[3]=a,out}function copyRgba(out,a){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out}var colorCache=new LRU(20),lastRemovedArr=null;function putToCache(colorStr,rgbaArr){lastRemovedArr&&copyRgba(lastRemovedArr,rgbaArr),lastRemovedArr=colorCache.put(colorStr,lastRemovedArr||rgbaArr.slice())}function parse(colorStr,rgbaArr){if(colorStr){rgbaArr=rgbaArr||[];var cached=colorCache.get(colorStr);if(cached)return copyRgba(rgbaArr,cached);cached=(colorStr+="").replace(/ /g,"").toLowerCase();if(cached in kCSSColorTable)return copyRgba(rgbaArr,kCSSColorTable[cached]),putToCache(colorStr,rgbaArr),rgbaArr;var strLen=cached.length;if("#"===cached.charAt(0))return 4===strLen||5===strLen?0<=(iv=parseInt(cached.slice(1,4),16))&&iv<=4095?(setRgba(rgbaArr,(3840&iv)>>4|(3840&iv)>>8,240&iv|(240&iv)>>4,15&iv|(15&iv)<<4,5===strLen?parseInt(cached.slice(4),16)/15:1),putToCache(colorStr,rgbaArr),rgbaArr):void setRgba(rgbaArr,0,0,0,1):7===strLen||9===strLen?0<=(iv=parseInt(cached.slice(1,7),16))&&iv<=16777215?(setRgba(rgbaArr,(16711680&iv)>>16,(65280&iv)>>8,255&iv,9===strLen?parseInt(cached.slice(7),16)/255:1),putToCache(colorStr,rgbaArr),rgbaArr):void setRgba(rgbaArr,0,0,0,1):void 0;var iv=cached.indexOf("("),ep=cached.indexOf(")");if(-1!==iv&&ep+1===strLen){var strLen=cached.substr(0,iv),params=cached.substr(iv+1,ep-(iv+1)).split(","),alpha=1;switch(strLen){case"rgba":if(4!==params.length)return 3===params.length?setRgba(rgbaArr,+params[0],+params[1],+params[2],1):setRgba(rgbaArr,0,0,0,1);alpha=parseCssFloat(params.pop());case"rgb":return 3!==params.length?void setRgba(rgbaArr,0,0,0,1):(setRgba(rgbaArr,parseCssInt(params[0]),parseCssInt(params[1]),parseCssInt(params[2]),alpha),putToCache(colorStr,rgbaArr),rgbaArr);case"hsla":return 4!==params.length?void setRgba(rgbaArr,0,0,0,1):(params[3]=parseCssFloat(params[3]),hsla2rgba(params,rgbaArr),putToCache(colorStr,rgbaArr),rgbaArr);case"hsl":return 3!==params.length?void setRgba(rgbaArr,0,0,0,1):(hsla2rgba(params,rgbaArr),putToCache(colorStr,rgbaArr),rgbaArr);default:return}}setRgba(rgbaArr,0,0,0,1)}}function hsla2rgba(hsla,rgba){var h=(parseFloat(hsla[0])%360+360)%360/360,s=parseCssFloat(hsla[1]),l=parseCssFloat(hsla[2]),s=l<=.5?l*(s+1):l+s-l*s,l=2*l-s;return setRgba(rgba=rgba||[],clampCssByte(255*cssHueToRgb(l,s,h+1/3)),clampCssByte(255*cssHueToRgb(l,s,h)),clampCssByte(255*cssHueToRgb(l,s,h-1/3)),1),4===hsla.length&&(rgba[3]=hsla[3]),rgba}function lift(color,level){var colorArr=parse(color);if(colorArr){for(var i=0;i<3;i++)colorArr[i]=level<0?colorArr[i]*(1-level)|0:(255-colorArr[i])*level+colorArr[i]|0,255<colorArr[i]?colorArr[i]=255:colorArr[i]<0&&(colorArr[i]=0);return stringify(colorArr,4===colorArr.length?"rgba":"rgb")}}function fastLerp(normalizedValue,colors,out){var leftIndex,leftColor,rightIndex;if(colors&&colors.length&&0<=normalizedValue&&normalizedValue<=1)return out=out||[],normalizedValue*=colors.length-1,leftIndex=Math.floor(normalizedValue),rightIndex=Math.ceil(normalizedValue),leftColor=colors[leftIndex],colors=colors[rightIndex],rightIndex=normalizedValue-leftIndex,out[0]=clampCssByte(lerpNumber(leftColor[0],colors[0],rightIndex)),out[1]=clampCssByte(lerpNumber(leftColor[1],colors[1],rightIndex)),out[2]=clampCssByte(lerpNumber(leftColor[2],colors[2],rightIndex)),out[3]=clampCssFloat(lerpNumber(leftColor[3],colors[3],rightIndex)),out}function lerp$1(normalizedValue,colors,fullOutput){var leftIndex,rightIndex,dv,leftColor;if(colors&&colors.length&&0<=normalizedValue&&normalizedValue<=1)return normalizedValue*=colors.length-1,leftIndex=Math.floor(normalizedValue),rightIndex=Math.ceil(normalizedValue),leftColor=parse(colors[leftIndex]),colors=parse(colors[rightIndex]),dv=normalizedValue-leftIndex,leftColor=stringify([clampCssByte(lerpNumber(leftColor[0],colors[0],dv)),clampCssByte(lerpNumber(leftColor[1],colors[1],dv)),clampCssByte(lerpNumber(leftColor[2],colors[2],dv)),clampCssFloat(lerpNumber(leftColor[3],colors[3],dv))],"rgba"),fullOutput?{color:leftColor,leftIndex:leftIndex,rightIndex:rightIndex,value:normalizedValue}:leftColor}function stringify(arrColor,type){var colorStr;if(arrColor&&arrColor.length)return colorStr=arrColor[0]+","+arrColor[1]+","+arrColor[2],"rgba"!==type&&"hsva"!==type&&"hsla"!==type||(colorStr+=","+arrColor[3]),type+"("+colorStr+")"}function lum(color,backgroundLum){color=parse(color);return color?(.299*color[0]+.587*color[1]+.114*color[2])*color[3]/255+(1-color[3])*backgroundLum:0}var color=(Object.freeze||Object)({parse:parse,lift:lift,toHex:function(color){if(color=parse(color))return((1<<24)+(color[0]<<16)+(color[1]<<8)+ +color[2]).toString(16).slice(1)},fastLerp:fastLerp,fastMapToColor:fastLerp,lerp:lerp$1,mapToColor:lerp$1,modifyHSL:function(color,h,s,l){var colorArr=parse(color);if(color)return colorArr=function(rgba){var G,B,vMax,L,H,S,vMin,deltaG,delta,R;if(rgba)return R=rgba[0]/255,G=rgba[1]/255,B=rgba[2]/255,vMin=Math.min(R,G,B),vMax=Math.max(R,G,B),L=(vMax+vMin)/2,0==(delta=vMax-vMin)?S=H=0:(S=L<.5?delta/(vMax+vMin):delta/(2-vMax-vMin),vMin=((vMax-R)/6+delta/2)/delta,deltaG=((vMax-G)/6+delta/2)/delta,delta=((vMax-B)/6+delta/2)/delta,R===vMax?H=delta-deltaG:G===vMax?H=1/3+vMin-delta:B===vMax&&(H=2/3+deltaG-vMin),H<0&&(H+=1),1<H&&--H),R=[360*H,S,L],null!=rgba[3]&&R.push(rgba[3]),R}(colorArr),null!=h&&(colorArr[0]=(color=h,(color=Math.round(color))<0?0:360<color?360:color)),null!=s&&(colorArr[1]=parseCssFloat(s)),null!=l&&(colorArr[2]=parseCssFloat(l)),stringify(hsla2rgba(colorArr),"rgba")},modifyAlpha:function(color,alpha){if((color=parse(color))&&null!=alpha)return color[3]=clampCssFloat(alpha),stringify(color,"rgba")},stringify:stringify,lum:lum,random:function(){return stringify([Math.round(255*Math.random()),Math.round(255*Math.random()),Math.round(255*Math.random())],"rgb")}});env.hasGlobalWindow&&isFunction(window.btoa);var arraySlice=Array.prototype.slice;function interpolateNumber(p0,p1,percent){return(p1-p0)*percent+p0}function interpolate1DArray(out,p0,p1,percent){for(var len=p0.length,i=0;i<len;i++)out[i]=interpolateNumber(p0[i],p1[i],percent);return out}function add1DArray(out,p0,p1,sign){for(var len=p0.length,i=0;i<len;i++)out[i]=p0[i]+p1[i]*sign;return out}function add2DArray(out,p0,p1,sign){for(var len=p0.length,len2=len&&p0[0].length,i=0;i<len;i++){out[i]||(out[i]=[]);for(var j=0;j<len2;j++)out[i][j]=p0[i][j]+p1[i][j]*sign}return out}function cloneValue(value){if(isArrayLike(value)){var len=value.length;if(isArrayLike(value[0])){for(var ret=[],i=0;i<len;i++)ret.push(arraySlice.call(value[i]));return ret}return arraySlice.call(value)}return value}function rgba2String(rgba){return rgba[0]=Math.floor(rgba[0])||0,rgba[1]=Math.floor(rgba[1])||0,rgba[2]=Math.floor(rgba[2])||0,rgba[3]=null==rgba[3]?1:rgba[3],"rgba("+rgba.join(",")+")"}function isGradientValueType(valType){return 4===valType||5===valType}function isArrayValueType(valType){return 1===valType||2===valType}var tmpRgba=[0,0,0,0],Track=function(){function Track(propName){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=propName}return Track.prototype.isFinished=function(){return this._finished},Track.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},Track.prototype.needsAnimate=function(){return 1<=this.keyframes.length},Track.prototype.getAdditiveTrack=function(){return this._additiveTrack},Track.prototype.addKeyframe=function(time,rawValue,easing){this._needsSort=!0;var keyframes=this.keyframes,len=keyframes.length,discrete=!1,valType=6,value=rawValue,arrayDim=(isArrayLike(rawValue)?(1===(valType=arrayDim=function(value){return isArrayLike(value&&value[0])?2:1}(rawValue))&&!isNumber(rawValue[0])||2===arrayDim&&!isNumber(rawValue[0][0]))&&(discrete=!0):isNumber(rawValue)&&!eqNaN(rawValue)?valType=0:isString(rawValue)?isNaN(+rawValue)?(arrayDim=parse(rawValue))&&(value=arrayDim,valType=3):valType=0:null!=rawValue.colorStops&&((arrayDim=extend({},value)).colorStops=map(rawValue.colorStops,function(colorStop){return{offset:colorStop.offset,color:parse(colorStop.color)}}),"linear"===rawValue.type?valType=4:"radial"===rawValue.type&&(valType=5),value=arrayDim),0===len?this.valType=valType:valType===this.valType&&6!==valType||(discrete=!0),this.discrete=this.discrete||discrete,{time:time,value:value,rawValue:rawValue,percent:0});return easing&&(arrayDim.easing=easing,arrayDim.easingFunc=isFunction(easing)?easing:easingFuncs[easing]||createCubicEasingFunc(easing)),keyframes.push(arrayDim),arrayDim},Track.prototype.prepare=function(maxTime,additiveTrack){for(var kfs=this.keyframes,valType=(this._needsSort&&kfs.sort(function(a,b){return a.time-b.time}),this.valType),kfsLen=kfs.length,lastKf=kfs[kfsLen-1],isDiscrete=this.discrete,isArr=isArrayValueType(valType),isGradient$$1=isGradientValueType(valType),i=0;i<kfsLen;i++){var kf=kfs[i],value=kf.value,lastValue=lastKf.value;kf.percent=kf.time/maxTime,isDiscrete||(isArr&&i!==kfsLen-1?function(val0,val1,arrDim){var arr0=val0,arr1=val1;if(arr0.push&&arr1.push){var val0=arr0.length,arr1Len=arr1.length;if(val0!==arr1Len)if(arr1Len<val0)arr0.length=arr1Len;else for(var i=val0;i<arr1Len;i++)arr0.push(1===arrDim?arr1[i]:arraySlice.call(arr1[i]));for(var len2=arr0[0]&&arr0[0].length,i=0;i<arr0.length;i++)if(1===arrDim)isNaN(arr0[i])&&(arr0[i]=arr1[i]);else for(var j=0;j<len2;j++)isNaN(arr0[i][j])&&(arr0[i][j]=arr1[i][j])}}(value,lastValue,valType):isGradient$$1&&function(val0,val1){for(var len0=val0.length,len1=val1.length,shorterArr=len1<len0?val1:val0,val1=Math.min(len0,len1),last=shorterArr[val1-1]||{color:[0,0,0,0],offset:0},i=val1;i<Math.max(len0,len1);i++)shorterArr.push({offset:last.offset,color:last.color.slice()})}(value.colorStops,lastValue.colorStops))}if(!isDiscrete&&5!==valType&&additiveTrack&&this.needsAnimate()&&additiveTrack.needsAnimate()&&valType===additiveTrack.valType&&!additiveTrack._finished){this._additiveTrack=additiveTrack;for(var startValue=kfs[0].value,i=0;i<kfsLen;i++)0===valType?kfs[i].additiveValue=kfs[i].value-startValue:3===valType?kfs[i].additiveValue=add1DArray([],kfs[i].value,startValue,-1):isArrayValueType(valType)&&(kfs[i].additiveValue=(1===valType?add1DArray:add2DArray)([],kfs[i].value,startValue,-1))}},Track.prototype.step=function(target,percent){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var frame,nextFrame,w,nextVal_1,isAdditive=null!=this._additiveTrack,valueKey=isAdditive?"additiveValue":"value",valType=this.valType,keyframes=this.keyframes,kfsNum=keyframes.length,propName=this.propName,isValueColor=3===valType,lastFrame=this._lastFr,mathMin=Math.min;if(1===kfsNum)frame=nextFrame=keyframes[0];else{if(percent<0)frameIdx=0;else if(percent<this._lastFrP){for(var frameIdx=mathMin(lastFrame+1,kfsNum-1);0<=frameIdx&&!(keyframes[frameIdx].percent<=percent);frameIdx--);frameIdx=mathMin(frameIdx,kfsNum-2)}else{for(frameIdx=lastFrame;frameIdx<kfsNum&&!(keyframes[frameIdx].percent>percent);frameIdx++);frameIdx=mathMin(frameIdx-1,kfsNum-2)}nextFrame=keyframes[frameIdx+1],frame=keyframes[frameIdx]}frame&&nextFrame&&(this._lastFr=frameIdx,this._lastFrP=percent,lastFrame=nextFrame.percent-frame.percent,w=0==lastFrame?1:mathMin((percent-frame.percent)/lastFrame,1),nextFrame.easingFunc&&(w=nextFrame.easingFunc(w)),mathMin=isAdditive?this._additiveValue:isValueColor?tmpRgba:target[propName],!isArrayValueType(valType)&&!isValueColor||mathMin||(mathMin=this._additiveValue=[]),this.discrete?target[propName]=(w<1?frame:nextFrame).rawValue:isArrayValueType(valType)?(1===valType?interpolate1DArray:function(out,p0,p1,percent){for(var len=p0.length,len2=len&&p0[0].length,i=0;i<len;i++){out[i]||(out[i]=[]);for(var j=0;j<len2;j++)out[i][j]=interpolateNumber(p0[i][j],p1[i][j],percent)}})(mathMin,frame[valueKey],nextFrame[valueKey],w):isGradientValueType(valType)?(lastFrame=frame[valueKey],nextVal_1=nextFrame[valueKey],target[propName]={type:(valType=4===valType)?"linear":"radial",x:interpolateNumber(lastFrame.x,nextVal_1.x,w),y:interpolateNumber(lastFrame.y,nextVal_1.y,w),colorStops:map(lastFrame.colorStops,function(colorStop,idx){idx=nextVal_1.colorStops[idx];return{offset:interpolateNumber(colorStop.offset,idx.offset,w),color:rgba2String(interpolate1DArray([],colorStop.color,idx.color,w))}}),global:nextVal_1.global},valType?(target[propName].x2=interpolateNumber(lastFrame.x2,nextVal_1.x2,w),target[propName].y2=interpolateNumber(lastFrame.y2,nextVal_1.y2,w)):target[propName].r=interpolateNumber(lastFrame.r,nextVal_1.r,w)):isValueColor?(interpolate1DArray(mathMin,frame[valueKey],nextFrame[valueKey],w),isAdditive||(target[propName]=rgba2String(mathMin))):(valType=interpolateNumber(frame[valueKey],nextFrame[valueKey],w),isAdditive?this._additiveValue=valType:target[propName]=valType),isAdditive&&this._addToTarget(target))}},Track.prototype._addToTarget=function(target){var valType=this.valType,propName=this.propName,additiveValue=this._additiveValue;0===valType?target[propName]=target[propName]+additiveValue:3===valType?(parse(target[propName],tmpRgba),add1DArray(tmpRgba,tmpRgba,additiveValue,1),target[propName]=rgba2String(tmpRgba)):1===valType?add1DArray(target[propName],target[propName],additiveValue,1):2===valType&&add2DArray(target[propName],target[propName],additiveValue,1)},Track}(),Animator=function(){function Animator(target,loop,allowDiscreteAnimation,additiveTo){this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=target,(this._loop=loop)&&additiveTo?logError("Can' use additive animation on looped animation."):(this._additiveAnimators=additiveTo,this._allowDiscrete=allowDiscreteAnimation)}return Animator.prototype.getMaxTime=function(){return this._maxTime},Animator.prototype.getDelay=function(){return this._delay},Animator.prototype.getLoop=function(){return this._loop},Animator.prototype.getTarget=function(){return this._target},Animator.prototype.changeTarget=function(target){this._target=target},Animator.prototype.when=function(time,props,easing){return this.whenWithKeys(time,props,keys(props),easing)},Animator.prototype.whenWithKeys=function(time,props,propNames,easing){for(var tracks=this._tracks,i=0;i<propNames.length;i++){var propName=propNames[i];if(!(track=tracks[propName])){var addtiveTrackKfs,track=tracks[propName]=new Track(propName),initialValue=void 0,additiveTrack=this._getAdditiveTrack(propName);if(additiveTrack?(initialValue=(addtiveTrackKfs=(addtiveTrackKfs=additiveTrack.keyframes)[addtiveTrackKfs.length-1])&&addtiveTrackKfs.value,3===additiveTrack.valType&&initialValue&&(initialValue=rgba2String(initialValue))):initialValue=this._target[propName],null==initialValue)continue;0<time&&track.addKeyframe(0,cloneValue(initialValue),easing),this._trackKeys.push(propName)}track.addKeyframe(time,cloneValue(props[propName]),easing)}return this._maxTime=Math.max(this._maxTime,time),this},Animator.prototype.pause=function(){this._clip.pause(),this._paused=!0},Animator.prototype.resume=function(){this._clip.resume(),this._paused=!1},Animator.prototype.isPaused=function(){return!!this._paused},Animator.prototype.duration=function(duration){return this._maxTime=duration,this._force=!0,this},Animator.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var doneList=this._doneCbs;if(doneList)for(var len=doneList.length,i=0;i<len;i++)doneList[i].call(this)},Animator.prototype._abortedCallback=function(){this._setTracksFinished();var animation=this.animation,abortedList=this._abortedCbs;if(animation&&animation.removeClip(this._clip),this._clip=null,abortedList)for(var i=0;i<abortedList.length;i++)abortedList[i].call(this)},Animator.prototype._setTracksFinished=function(){for(var tracks=this._tracks,tracksKeys=this._trackKeys,i=0;i<tracksKeys.length;i++)tracks[tracksKeys[i]].setFinished()},Animator.prototype._getAdditiveTrack=function(trackName){var additiveTrack,additiveAnimators=this._additiveAnimators;if(additiveAnimators)for(var i=0;i<additiveAnimators.length;i++){var track=additiveAnimators[i].getTrack(trackName);track&&(additiveTrack=track)}return additiveTrack},Animator.prototype.start=function(easing){if(!(0<this._started)){this._started=1;for(var clip,self=this,tracks=[],maxTime=this._maxTime||0,i=0;i<this._trackKeys.length;i++){var propName=this._trackKeys[i],track=this._tracks[propName],propName=this._getAdditiveTrack(propName),kfs=track.keyframes,kfsNum=kfs.length;track.prepare(maxTime,propName),track.needsAnimate()&&(!this._allowDiscrete&&track.discrete?((propName=kfs[kfsNum-1])&&(self._target[track.propName]=propName.rawValue),track.setFinished()):tracks.push(track))}return tracks.length||this._force?(clip=new Clip({life:maxTime,loop:this._loop,delay:this._delay||0,onframe:function(percent){self._started=2;var additiveAnimators=self._additiveAnimators;if(additiveAnimators){for(var stillHasAdditiveAnimator=!1,i=0;i<additiveAnimators.length;i++)if(additiveAnimators[i]._clip){stillHasAdditiveAnimator=!0;break}stillHasAdditiveAnimator||(self._additiveAnimators=null)}for(i=0;i<tracks.length;i++)tracks[i].step(self._target,percent);var onframeList=self._onframeCbs;if(onframeList)for(i=0;i<onframeList.length;i++)onframeList[i](self._target,percent)},ondestroy:function(){self._doneCallback()}}),this._clip=clip,this.animation&&this.animation.addClip(clip),easing&&clip.setEasing(easing)):this._doneCallback(),this}},Animator.prototype.stop=function(forwardToLast){var clip;this._clip&&(clip=this._clip,forwardToLast&&clip.onframe(1),this._abortedCallback())},Animator.prototype.delay=function(time){return this._delay=time,this},Animator.prototype.during=function(cb){return cb&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(cb)),this},Animator.prototype.done=function(cb){return cb&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(cb)),this},Animator.prototype.aborted=function(cb){return cb&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(cb)),this},Animator.prototype.getClip=function(){return this._clip},Animator.prototype.getTrack=function(propName){return this._tracks[propName]},Animator.prototype.getTracks=function(){var _this=this;return map(this._trackKeys,function(key){return _this._tracks[key]})},Animator.prototype.stopTracks=function(propNames,forwardToLast){if(!propNames.length||!this._clip)return!0;for(var tracks=this._tracks,tracksKeys=this._trackKeys,i=0;i<propNames.length;i++){var track=tracks[propNames[i]];track&&!track.isFinished()&&(forwardToLast?track.step(this._target,1):1===this._started&&track.step(this._target,0),track.setFinished())}for(var allAborted=!0,i=0;i<tracksKeys.length;i++)if(!tracks[tracksKeys[i]].isFinished()){allAborted=!1;break}return allAborted&&this._abortedCallback(),allAborted},Animator.prototype.saveTo=function(target,trackKeys,firstOrLast){if(target){trackKeys=trackKeys||this._trackKeys;for(var i=0;i<trackKeys.length;i++){var propName=trackKeys[i],track=this._tracks[propName];track&&!track.isFinished()&&((track=(track=track.keyframes)[firstOrLast?0:track.length-1])&&(target[propName]=cloneValue(track.rawValue)))}}},Animator.prototype.__changeFinalValue=function(finalProps,trackKeys){trackKeys=trackKeys||keys(finalProps);for(var i=0;i<trackKeys.length;i++){var kfs,propName=trackKeys[i],track=this._tracks[propName];track&&(1<(kfs=track.keyframes).length&&(kfs=kfs.pop(),track.addKeyframe(kfs.time,finalProps[propName]),track.prepare(this._maxTime,track.getAdditiveTrack())))}},Animator}();function getTime(){return(new Date).getTime()}var pointerEventNameMap,Animation=function(_super){function Animation(opts){var _this=_super.call(this)||this;return _this._running=!1,_this._time=0,_this._pausedTime=0,_this._pauseStart=0,_this._paused=!1,_this.stage=(opts=opts||{}).stage||{},_this}return __extends(Animation,_super),Animation.prototype.addClip=function(clip){clip.animation&&this.removeClip(clip),this._head?((this._tail.next=clip).prev=this._tail,clip.next=null,this._tail=clip):this._head=this._tail=clip,clip.animation=this},Animation.prototype.addAnimator=function(animator){animator.animation=this;animator=animator.getClip();animator&&this.addClip(animator)},Animation.prototype.removeClip=function(clip){var prev,next;clip.animation&&(prev=clip.prev,next=clip.next,prev?prev.next=next:this._head=next,next?next.prev=prev:this._tail=prev,clip.next=clip.prev=clip.animation=null)},Animation.prototype.removeAnimator=function(animator){var clip=animator.getClip();clip&&this.removeClip(clip),animator.animation=null},Animation.prototype.update=function(notTriggerFrameAndStageUpdate){for(var time=getTime()-this._pausedTime,delta=time-this._time,clip=this._head;clip;)var nextClip=clip.next,clip=(clip.step(time,delta)&&(clip.ondestroy(),this.removeClip(clip)),nextClip);this._time=time,notTriggerFrameAndStageUpdate||(this.trigger("frame",delta),this.stage.update&&this.stage.update())},Animation.prototype._startLoop=function(){var self=this;this._running=!0,requestAnimationFrame$1(function step(){self._running&&(requestAnimationFrame$1(step),self._paused||self.update())})},Animation.prototype.start=function(){this._running||(this._time=getTime(),this._pausedTime=0,this._startLoop())},Animation.prototype.stop=function(){this._running=!1},Animation.prototype.pause=function(){this._paused||(this._pauseStart=getTime(),this._paused=!0)},Animation.prototype.resume=function(){this._paused&&(this._pausedTime+=getTime()-this._pauseStart,this._paused=!1)},Animation.prototype.clear=function(){for(var clip=this._head;clip;){var nextClip=clip.next;clip.prev=clip.next=clip.animation=null,clip=nextClip}this._head=this._tail=null},Animation.prototype.isFinished=function(){return null==this._head},Animation.prototype.animate=function(target,options){options=options||{},this.start();target=new Animator(target,options.loop);return this.addAnimator(target),target},Animation}(Eventful),globalEventSupported=env.domSupported,localNativeListenerNames=(pointerEventNameMap={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},{mouse:mouseHandlerNames=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],touch:["touchstart","touchend","touchmove"],pointer:map(mouseHandlerNames,function(name){var nm=name.replace("mouse","pointer");return pointerEventNameMap.hasOwnProperty(nm)?nm:name})}),globalNativeListenerNames_mouse=["mousemove","mouseup"],globalNativeListenerNames_pointer=["pointermove","pointerup"],wheelEventSupported=!1;function isPointerFromTouch(event){event=event.pointerType;return"pen"===event||"touch"===event}function markTouch(event){event&&(event.zrByTouch=!0)}function isLocalEl(instance,el){for(var elTmp=el,isLocal=!1;elTmp&&9!==elTmp.nodeType&&!(isLocal=elTmp.domBelongToZr||elTmp!==el&&elTmp===instance.painterRoot);)elTmp=elTmp.parentNode;return isLocal}var FakeGlobalEvent=function(instance,event){this.stopPropagation=noop,this.stopImmediatePropagation=noop,this.preventDefault=noop,this.type=event.type,this.target=this.currentTarget=instance.dom,this.pointerType=event.pointerType,this.clientX=event.clientX,this.clientY=event.clientY},localDOMHandlers={mousedown:function(event){event=normalizeEvent(this.dom,event),this.__mayPointerCapture=[event.zrX,event.zrY],this.trigger("mousedown",event)},mousemove:function(event){event=normalizeEvent(this.dom,event);var downPoint=this.__mayPointerCapture;!downPoint||event.zrX===downPoint[0]&&event.zrY===downPoint[1]||this.__togglePointerCapture(!0),this.trigger("mousemove",event)},mouseup:function(event){event=normalizeEvent(this.dom,event),this.__togglePointerCapture(!1),this.trigger("mouseup",event)},mouseout:function(event){isLocalEl(this,(event=normalizeEvent(this.dom,event)).toElement||event.relatedTarget)||(this.__pointerCapturing&&(event.zrEventControl="no_globalout"),this.trigger("mouseout",event))},wheel:function(event){wheelEventSupported=!0,event=normalizeEvent(this.dom,event),this.trigger("mousewheel",event)},mousewheel:function(event){wheelEventSupported||(event=normalizeEvent(this.dom,event),this.trigger("mousewheel",event))},touchstart:function(event){markTouch(event=normalizeEvent(this.dom,event)),this.__lastTouchMoment=new Date,this.handler.processGesture(event,"start"),localDOMHandlers.mousemove.call(this,event),localDOMHandlers.mousedown.call(this,event)},touchmove:function(event){markTouch(event=normalizeEvent(this.dom,event)),this.handler.processGesture(event,"change"),localDOMHandlers.mousemove.call(this,event)},touchend:function(event){markTouch(event=normalizeEvent(this.dom,event)),this.handler.processGesture(event,"end"),localDOMHandlers.mouseup.call(this,event),+new Date-+this.__lastTouchMoment<300&&localDOMHandlers.click.call(this,event)},pointerdown:function(event){localDOMHandlers.mousedown.call(this,event)},pointermove:function(event){isPointerFromTouch(event)||localDOMHandlers.mousemove.call(this,event)},pointerup:function(event){localDOMHandlers.mouseup.call(this,event)},pointerout:function(event){isPointerFromTouch(event)||localDOMHandlers.mouseout.call(this,event)}},globalDOMHandlers=(each(["click","dblclick","contextmenu"],function(name){localDOMHandlers[name]=function(event){event=normalizeEvent(this.dom,event),this.trigger(name,event)}}),{pointermove:function(event){isPointerFromTouch(event)||globalDOMHandlers.mousemove.call(this,event)},pointerup:function(event){globalDOMHandlers.mouseup.call(this,event)},mousemove:function(event){this.trigger("mousemove",event)},mouseup:function(event){var pointerCaptureReleasing=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",event),pointerCaptureReleasing&&(event.zrEventControl="only_globalout",this.trigger("mouseout",event))}});function mountLocalDOMEventListeners(instance,scope){var domHandlers=scope.domHandlers;env.pointerEventsSupported?each(localNativeListenerNames.pointer,function(nativeEventName){mountSingleDOMEventListener(scope,nativeEventName,function(event){domHandlers[nativeEventName].call(instance,event)})}):(env.touchEventsSupported&&each(localNativeListenerNames.touch,function(nativeEventName){mountSingleDOMEventListener(scope,nativeEventName,function(event){domHandlers[nativeEventName].call(instance,event),function(scope){scope.touching=!0,null!=scope.touchTimer&&(clearTimeout(scope.touchTimer),scope.touchTimer=null),scope.touchTimer=setTimeout(function(){scope.touching=!1,scope.touchTimer=null},700)}(scope)})}),each(localNativeListenerNames.mouse,function(nativeEventName){mountSingleDOMEventListener(scope,nativeEventName,function(event){event=getNativeEvent(event),scope.touching||domHandlers[nativeEventName].call(instance,event)})}))}function mountGlobalDOMEventListeners(instance,scope){function mount(nativeEventName){mountSingleDOMEventListener(scope,nativeEventName,function(event){event=getNativeEvent(event),isLocalEl(instance,event.target)||(event=function(instance,event){return normalizeEvent(instance.dom,new FakeGlobalEvent(instance,event),!0)}(instance,event),scope.domHandlers[nativeEventName].call(instance,event))},{capture:!0})}env.pointerEventsSupported?each(globalNativeListenerNames_pointer,mount):env.touchEventsSupported||each(globalNativeListenerNames_mouse,mount)}function mountSingleDOMEventListener(scope,nativeEventName,listener,opt){scope.mounted[nativeEventName]=listener,scope.listenerOpts[nativeEventName]=opt,function(el,name,handler,opt){isDom2?el.addEventListener(name,handler,opt):el.attachEvent("on"+name,handler)}(scope.domTarget,nativeEventName,listener,opt)}function unmountDOMEventListeners(scope){var nativeEventName,el,name,handler,opt,mounted=scope.mounted;for(nativeEventName in mounted)mounted.hasOwnProperty(nativeEventName)&&(el=scope.domTarget,handler=mounted[name=nativeEventName],opt=scope.listenerOpts[nativeEventName],isDom2?el.removeEventListener(name,handler,opt):el.detachEvent("on"+name,handler));scope.mounted={}}var DOMHandlerScope=function(domTarget,domHandlers){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=domTarget,this.domHandlers=domHandlers},HandlerDomProxy=function(_super){function HandlerDomProxy(dom,painterRoot){var _this=_super.call(this)||this;return _this.__pointerCapturing=!1,_this.dom=dom,_this.painterRoot=painterRoot,_this._localHandlerScope=new DOMHandlerScope(dom,localDOMHandlers),globalEventSupported&&(_this._globalHandlerScope=new DOMHandlerScope(document,globalDOMHandlers)),mountLocalDOMEventListeners(_this,_this._localHandlerScope),_this}return __extends(HandlerDomProxy,_super),HandlerDomProxy.prototype.dispose=function(){unmountDOMEventListeners(this._localHandlerScope),globalEventSupported&&unmountDOMEventListeners(this._globalHandlerScope)},HandlerDomProxy.prototype.setCursor=function(cursorStyle){this.dom.style&&(this.dom.style.cursor=cursorStyle||"default")},HandlerDomProxy.prototype.__togglePointerCapture=function(isPointerCapturing){var globalHandlerScope;this.__mayPointerCapture=null,globalEventSupported&&+this.__pointerCapturing^+isPointerCapturing&&(this.__pointerCapturing=isPointerCapturing,globalHandlerScope=this._globalHandlerScope,isPointerCapturing?mountGlobalDOMEventListeners(this,globalHandlerScope):unmountDOMEventListeners(globalHandlerScope))},HandlerDomProxy}(Eventful),mouseHandlerNames=1,devicePixelRatio=mouseHandlerNames=env.hasGlobalWindow?Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1):mouseHandlerNames;function create$1(){return[1,0,0,1,0,0]}function identity(out){return out[0]=1,out[1]=0,out[2]=0,out[3]=1,out[4]=0,out[5]=0,out}function copy$1(out,m){return out[0]=m[0],out[1]=m[1],out[2]=m[2],out[3]=m[3],out[4]=m[4],out[5]=m[5],out}function mul$1(out,m1,m2){var out0=m1[0]*m2[0]+m1[2]*m2[1],out1=m1[1]*m2[0]+m1[3]*m2[1],out2=m1[0]*m2[2]+m1[2]*m2[3],out3=m1[1]*m2[2]+m1[3]*m2[3],out4=m1[0]*m2[4]+m1[2]*m2[5]+m1[4],m2=m1[1]*m2[4]+m1[3]*m2[5]+m1[5];return out[0]=out0,out[1]=out1,out[2]=out2,out[3]=out3,out[4]=out4,out[5]=m2,out}function translate(out,a,v){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4]+v[0],out[5]=a[5]+v[1],out}function rotate(out,a,rad){var aa=a[0],ac=a[2],atx=a[4],ab=a[1],ad=a[3],a=a[5],st=Math.sin(rad),rad=Math.cos(rad);return out[0]=aa*rad+ab*st,out[1]=-aa*st+ab*rad,out[2]=ac*rad+ad*st,out[3]=-ac*st+rad*ad,out[4]=rad*atx+st*a,out[5]=rad*a-st*atx,out}function scale$1(out,a,v){var vx=v[0],v=v[1];return out[0]=a[0]*vx,out[1]=a[1]*v,out[2]=a[2]*vx,out[3]=a[3]*v,out[4]=a[4]*vx,out[5]=a[5]*v,out}function invert(out,a){var aa=a[0],ac=a[2],atx=a[4],ab=a[1],ad=a[3],a=a[5],det=aa*ad-ab*ac;return det?(out[0]=ad*(det=1/det),out[1]=-ab*det,out[2]=-ac*det,out[3]=aa*det,out[4]=(ac*a-ad*atx)*det,out[5]=(ab*atx-aa*a)*det,out):null}var mouseHandlerNames=(Object.freeze||Object)({create:create$1,identity:identity,copy:copy$1,mul:mul$1,translate:translate,rotate:rotate,scale:scale$1,invert:invert,clone:function(a){var b=create$1();return copy$1(b,a),b}}),mIdentity=identity;function isNotAroundZero$1(val){return 5e-5<val||val<-5e-5}var scaleTmp=[],tmpTransform=[],originTransform=create$1(),abs=Math.abs,Transformable=function(){function Transformable(){}var proto;return Transformable.prototype.getLocalTransform=function(m){return Transformable.getLocalTransform(this,m)},Transformable.prototype.setPosition=function(arr){this.x=arr[0],this.y=arr[1]},Transformable.prototype.setScale=function(arr){this.scaleX=arr[0],this.scaleY=arr[1]},Transformable.prototype.setSkew=function(arr){this.skewX=arr[0],this.skewY=arr[1]},Transformable.prototype.setOrigin=function(arr){this.originX=arr[0],this.originY=arr[1]},Transformable.prototype.needLocalTransform=function(){return isNotAroundZero$1(this.rotation)||isNotAroundZero$1(this.x)||isNotAroundZero$1(this.y)||isNotAroundZero$1(this.scaleX-1)||isNotAroundZero$1(this.scaleY-1)||isNotAroundZero$1(this.skewX)||isNotAroundZero$1(this.skewY)},Transformable.prototype.updateTransform=function(){var parentTransform=this.parent&&this.parent.transform,needLocalTransform=this.needLocalTransform(),m=this.transform;needLocalTransform||parentTransform?(m=m||create$1(),needLocalTransform?this.getLocalTransform(m):mIdentity(m),parentTransform&&(needLocalTransform?mul$1(m,parentTransform,m):copy$1(m,parentTransform)),this.transform=m,this._resolveGlobalScaleRatio(m)):m&&mIdentity(m)},Transformable.prototype._resolveGlobalScaleRatio=function(m){var relX,relY,globalScaleRatio=this.globalScaleRatio;null!=globalScaleRatio&&1!==globalScaleRatio&&(this.getGlobalScale(scaleTmp),relY=((scaleTmp[1]-(relY=scaleTmp[1]<0?-1:1))*globalScaleRatio+relY)/scaleTmp[1]||0,m[0]*=globalScaleRatio=((scaleTmp[0]-(relX=scaleTmp[0]<0?-1:1))*globalScaleRatio+relX)/scaleTmp[0]||0,m[1]*=globalScaleRatio,m[2]*=relY,m[3]*=relY),this.invTransform=this.invTransform||create$1(),invert(this.invTransform,m)},Transformable.prototype.getComputedTransform=function(){for(var transformNode=this,ancestors=[];transformNode;)ancestors.push(transformNode),transformNode=transformNode.parent;for(;transformNode=ancestors.pop();)transformNode.updateTransform();return this.transform},Transformable.prototype.setLocalTransform=function(m){var rotation,shearX,sy,sx;m&&(sx=m[0]*m[0]+m[1]*m[1],sy=m[2]*m[2]+m[3]*m[3],rotation=Math.atan2(m[1],m[0]),shearX=Math.PI/2+rotation-Math.atan2(m[3],m[2]),sy=Math.sqrt(sy)*Math.cos(shearX),sx=Math.sqrt(sx),this.skewX=shearX,this.skewY=0,this.rotation=-rotation,this.x=+m[4],this.y=+m[5],this.scaleX=sx,this.scaleY=sy,this.originX=0,this.originY=0)},Transformable.prototype.decomposeTransform=function(){var m,parent,oy;this.transform&&(parent=this.parent,m=this.transform,parent&&parent.transform&&(mul$1(tmpTransform,parent.invTransform,m),m=tmpTransform),parent=this.originX,oy=this.originY,(parent||oy)&&(originTransform[4]=parent,originTransform[5]=oy,mul$1(tmpTransform,m,originTransform),tmpTransform[4]-=parent,tmpTransform[5]-=oy,m=tmpTransform),this.setLocalTransform(m))},Transformable.prototype.getGlobalScale=function(out){var m=this.transform;return out=out||[],m?(out[0]=Math.sqrt(m[0]*m[0]+m[1]*m[1]),out[1]=Math.sqrt(m[2]*m[2]+m[3]*m[3]),m[0]<0&&(out[0]=-out[0]),m[3]<0&&(out[1]=-out[1])):(out[0]=1,out[1]=1),out},Transformable.prototype.transformCoordToLocal=function(x,y){x=[x,y],y=this.invTransform;return y&&applyTransform(x,x,y),x},Transformable.prototype.transformCoordToGlobal=function(x,y){x=[x,y],y=this.transform;return y&&applyTransform(x,x,y),x},Transformable.prototype.getLineScale=function(){var m=this.transform;return m&&1e-10<abs(m[0]-1)&&1e-10<abs(m[3]-1)?Math.sqrt(abs(m[0]*m[3]-m[2]*m[1])):1},Transformable.prototype.copyTransform=function(source){!function(target,source){for(var i=0;i<TRANSFORMABLE_PROPS.length;i++){var propName=TRANSFORMABLE_PROPS[i];target[propName]=source[propName]}}(this,source)},Transformable.getLocalTransform=function(target,m){m=m||[];var ox=target.originX||0,oy=target.originY||0,sx=target.scaleX,sy=target.scaleY,ax=target.anchorX,ay=target.anchorY,rotation=target.rotation||0,x=target.x,y=target.y,skewX=target.skewX?Math.tan(target.skewX):0,target=target.skewY?Math.tan(-target.skewY):0;return ox||oy||ax||ay?(m[4]=-(ax=ox+ax)*sx-skewX*(ay=oy+ay)*sy,m[5]=-ay*sy-target*ax*sx):m[4]=m[5]=0,m[0]=sx,m[3]=sy,m[1]=target*sx,m[2]=skewX*sy,rotation&&rotate(m,m,rotation),m[4]+=ox+x,m[5]+=oy+y,m},Transformable.initDefaultProps=((proto=Transformable.prototype).scaleX=proto.scaleY=proto.globalScaleRatio=1,void(proto.x=proto.y=proto.originX=proto.originY=proto.skewX=proto.skewY=proto.rotation=proto.anchorX=proto.anchorY=0)),Transformable}(),TRANSFORMABLE_PROPS=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];var Point=function(){function Point(x,y){this.x=x||0,this.y=y||0}return Point.prototype.copy=function(other){return this.x=other.x,this.y=other.y,this},Point.prototype.clone=function(){return new Point(this.x,this.y)},Point.prototype.set=function(x,y){return this.x=x,this.y=y,this},Point.prototype.equal=function(other){return other.x===this.x&&other.y===this.y},Point.prototype.add=function(other){return this.x+=other.x,this.y+=other.y,this},Point.prototype.scale=function(scalar){this.x*=scalar,this.y*=scalar},Point.prototype.scaleAndAdd=function(other,scalar){this.x+=other.x*scalar,this.y+=other.y*scalar},Point.prototype.sub=function(other){return this.x-=other.x,this.y-=other.y,this},Point.prototype.dot=function(other){return this.x*other.x+this.y*other.y},Point.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Point.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},Point.prototype.normalize=function(){var len=this.len();return this.x/=len,this.y/=len,this},Point.prototype.distance=function(other){var dx=this.x-other.x,other=this.y-other.y;return Math.sqrt(dx*dx+other*other)},Point.prototype.distanceSquare=function(other){var dx=this.x-other.x,other=this.y-other.y;return dx*dx+other*other},Point.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},Point.prototype.transform=function(m){var x,y;if(m)return x=this.x,y=this.y,this.x=m[0]*x+m[2]*y+m[4],this.y=m[1]*x+m[3]*y+m[5],this},Point.prototype.toArray=function(out){return out[0]=this.x,out[1]=this.y,out},Point.prototype.fromArray=function(input){this.x=input[0],this.y=input[1]},Point.set=function(p,x,y){p.x=x,p.y=y},Point.copy=function(p,p2){p.x=p2.x,p.y=p2.y},Point.len=function(p){return Math.sqrt(p.x*p.x+p.y*p.y)},Point.lenSquare=function(p){return p.x*p.x+p.y*p.y},Point.dot=function(p0,p1){return p0.x*p1.x+p0.y*p1.y},Point.add=function(out,p0,p1){out.x=p0.x+p1.x,out.y=p0.y+p1.y},Point.sub=function(out,p0,p1){out.x=p0.x-p1.x,out.y=p0.y-p1.y},Point.scale=function(out,p0,scalar){out.x=p0.x*scalar,out.y=p0.y*scalar},Point.scaleAndAdd=function(out,p0,p1,scalar){out.x=p0.x+p1.x*scalar,out.y=p0.y+p1.y*scalar},Point.lerp=function(out,p0,p1,t){var onet=1-t;out.x=onet*p0.x+t*p1.x,out.y=onet*p0.y+t*p1.y},Point}(),mathMin=Math.min,mathMax=Math.max,lt=new Point,rb=new Point,lb=new Point,rt=new Point,minTv=new Point,maxTv=new Point,BoundingRect=function(){function BoundingRect(x,y,width,height){width<0&&(x+=width,width=-width),height<0&&(y+=height,height=-height),this.x=x,this.y=y,this.width=width,this.height=height}return BoundingRect.prototype.union=function(other){var x=mathMin(other.x,this.x),y=mathMin(other.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=mathMax(other.x+other.width,this.x+this.width)-x:this.width=other.width,isFinite(this.y)&&isFinite(this.height)?this.height=mathMax(other.y+other.height,this.y+this.height)-y:this.height=other.height,this.x=x,this.y=y},BoundingRect.prototype.applyTransform=function(m){BoundingRect.applyTransform(this,this,m)},BoundingRect.prototype.calculateTransform=function(b){var a=this,sx=b.width/a.width,sy=b.height/a.height,m=create$1();return translate(m,m,[-a.x,-a.y]),scale$1(m,m,[sx,sy]),translate(m,m,[b.x,b.y]),m},BoundingRect.prototype.intersect=function(b,mtv){if(!b)return!1;b instanceof BoundingRect||(b=BoundingRect.create(b));var dMin,dMax,d0,d1,d2,d3,dx,dy,a=this,ax0=a.x,ax1=a.x+a.width,ay0=a.y,a=a.y+a.height,bx0=b.x,bx1=b.x+b.width,by0=b.y,b=b.y+b.height,overlap=!(ax1<bx0||bx1<ax0||a<by0||b<ay0);return mtv&&(dMin=1/0,dMax=0,d0=Math.abs(ax1-bx0),d1=Math.abs(bx1-ax0),d2=Math.abs(a-by0),d3=Math.abs(b-ay0),dx=Math.min(d0,d1),dy=Math.min(d2,d3),ax1<bx0||bx1<ax0?dMax<dx&&(dMax=dx,d0<d1?Point.set(maxTv,-d0,0):Point.set(maxTv,d1,0)):dx<dMin&&(dMin=dx,d0<d1?Point.set(minTv,d0,0):Point.set(minTv,-d1,0)),a<by0||b<ay0?dMax<dy&&(dMax=dy,d2<d3?Point.set(maxTv,0,-d2):Point.set(maxTv,0,d3)):dx<dMin&&(dMin=dx,d2<d3?Point.set(minTv,0,d2):Point.set(minTv,0,-d3))),mtv&&Point.copy(mtv,overlap?minTv:maxTv),overlap},BoundingRect.prototype.contain=function(x,y){return x>=this.x&&x<=this.x+this.width&&y>=this.y&&y<=this.y+this.height},BoundingRect.prototype.clone=function(){return new BoundingRect(this.x,this.y,this.width,this.height)},BoundingRect.prototype.copy=function(other){BoundingRect.copy(this,other)},BoundingRect.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},BoundingRect.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},BoundingRect.prototype.isZero=function(){return 0===this.width||0===this.height},BoundingRect.create=function(rect){return new BoundingRect(rect.x,rect.y,rect.width,rect.height)},BoundingRect.copy=function(target,source){target.x=source.x,target.y=source.y,target.width=source.width,target.height=source.height},BoundingRect.applyTransform=function(target,source,m){if(m){var sx,sy;if(m[1]<1e-5&&-1e-5<m[1]&&m[2]<1e-5&&-1e-5<m[2])return sx=m[0],sy=m[3],tx=m[4],ty=m[5],target.x=source.x*sx+tx,target.y=source.y*sy+ty,target.width=source.width*sx,target.height=source.height*sy,target.width<0&&(target.x+=target.width,target.width=-target.width),void(target.height<0&&(target.y+=target.height,target.height=-target.height));lt.x=lb.x=source.x,lt.y=rt.y=source.y,rb.x=rt.x=source.x+source.width,rb.y=lb.y=source.y+source.height,lt.transform(m),rt.transform(m),rb.transform(m),lb.transform(m),target.x=mathMin(lt.x,rb.x,lb.x,rt.x),target.y=mathMin(lt.y,rb.y,lb.y,rt.y);var tx=mathMax(lt.x,rb.x,lb.x,rt.x),ty=mathMax(lt.y,rb.y,lb.y,rt.y);target.width=tx-target.x,target.height=ty-target.y}else target!==source&&BoundingRect.copy(target,source)},BoundingRect}(),textWidthCache={};function getWidth(text,font){var cacheOfFont=textWidthCache[font=font||DEFAULT_FONT],width=(cacheOfFont=cacheOfFont||(textWidthCache[font]=new LRU(500))).get(text);return null==width&&(width=platformApi.measureText(text,font).width,cacheOfFont.put(text,width)),width}function innerGetBoundingRect(text,font,textAlign,textBaseline){text=getWidth(text,font),font=getLineHeight(font),textAlign=adjustTextX(0,text,textAlign),textBaseline=adjustTextY$1(0,font,textBaseline);return new BoundingRect(textAlign,textBaseline,text,font)}function getBoundingRect(text,font,textAlign,textBaseline){var textLines=((text||"")+"").split("\n");if(1===textLines.length)return innerGetBoundingRect(textLines[0],font,textAlign,textBaseline);for(var uniondRect=new BoundingRect(0,0,0,0),i=0;i<textLines.length;i++){var rect=innerGetBoundingRect(textLines[i],font,textAlign,textBaseline);0===i?uniondRect.copy(rect):uniondRect.union(rect)}return uniondRect}function adjustTextX(x,width,textAlign){return"right"===textAlign?x-=width:"center"===textAlign&&(x-=width/2),x}function adjustTextY$1(y,height,verticalAlign){return"middle"===verticalAlign?y-=height/2:"bottom"===verticalAlign&&(y-=height),y}function getLineHeight(font){return getWidth("",font)}function parsePercent(value,maxValue){return"string"==typeof value?0<=value.lastIndexOf("%")?parseFloat(value)/100*maxValue:parseFloat(value):value}function calculateTextPosition(out,opts,rect){var textPosition=opts.position||"inside",distance=null!=opts.distance?opts.distance:5,height=rect.height,width=rect.width,halfHeight=height/2,x=rect.x,y=rect.y,textAlign="left",textVerticalAlign="top";if(textPosition instanceof Array)x+=parsePercent(textPosition[0],rect.width),y+=parsePercent(textPosition[1],rect.height),textVerticalAlign=textAlign=null;else switch(textPosition){case"left":x-=distance,y+=halfHeight,textAlign="right",textVerticalAlign="middle";break;case"right":x+=distance+width,y+=halfHeight,textVerticalAlign="middle";break;case"top":x+=width/2,y-=distance,textAlign="center",textVerticalAlign="bottom";break;case"bottom":x+=width/2,y+=height+distance,textAlign="center";break;case"inside":x+=width/2,y+=halfHeight,textAlign="center",textVerticalAlign="middle";break;case"insideLeft":x+=distance,y+=halfHeight,textVerticalAlign="middle";break;case"insideRight":x+=width-distance,y+=halfHeight,textAlign="right",textVerticalAlign="middle";break;case"insideTop":x+=width/2,y+=distance,textAlign="center";break;case"insideBottom":x+=width/2,y+=height-distance,textAlign="center",textVerticalAlign="bottom";break;case"insideTopLeft":x+=distance,y+=distance;break;case"insideTopRight":x+=width-distance,y+=distance,textAlign="right";break;case"insideBottomLeft":x+=distance,y+=height-distance,textVerticalAlign="bottom";break;case"insideBottomRight":x+=width-distance,y+=height-distance,textAlign="right",textVerticalAlign="bottom"}return(out=out||{}).x=x,out.y=y,out.align=textAlign,out.verticalAlign=textVerticalAlign,out}var PRIMARY_STATES_KEYS=TRANSFORMABLE_PROPS.concat(["ignore"]),DEFAULT_ANIMATABLE_MAP=reduce(TRANSFORMABLE_PROPS,function(obj,key){return obj[key]=!0,obj},{ignore:!1}),tmpTextPosCalcRes={},tmpBoundingRect=new BoundingRect(0,0,0,0),Element=function(){function Element(props){this.id=guid(),this.animators=[],this.currentStates=[],this.states={},this._init(props)}function logDeprecatedError(key,xKey,yKey){logs[key+xKey+yKey]||(console.warn("DEPRECATED: '"+key+"' has been deprecated. use '"+xKey+"', '"+yKey+"' instead"),logs[key+xKey+yKey]=!0)}function createLegacyProperty(key,privateKey,xKey,yKey){function enhanceArray(self,pos){Object.defineProperty(pos,0,{get:function(){return self[xKey]},set:function(val){self[xKey]=val}}),Object.defineProperty(pos,1,{get:function(){return self[yKey]},set:function(val){self[yKey]=val}})}Object.defineProperty(elProto,key,{get:function(){var pos;return logDeprecatedError(key,xKey,yKey),this[privateKey]||(pos=this[privateKey]=[],enhanceArray(this,pos)),this[privateKey]},set:function(pos){logDeprecatedError(key,xKey,yKey),this[xKey]=pos[0],this[yKey]=pos[1],this[privateKey]=pos,enhanceArray(this,pos)}})}var elProto,logs;return Element.prototype._init=function(props){this.attr(props)},Element.prototype.drift=function(dx,dy,e){switch(this.draggable){case"horizontal":dy=0;break;case"vertical":dx=0}var m=this.transform;(m=m||(this.transform=[1,0,0,1,0,0]))[4]+=dx,m[5]+=dy,this.decomposeTransform(),this.markRedraw()},Element.prototype.beforeUpdate=function(){},Element.prototype.afterUpdate=function(){},Element.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},Element.prototype.updateInnerText=function(forceUpdate){var innerTransformable,textAlign,textVerticalAlign,textStyleChanged,textOrigin,relOriginX,relOriginY,isLocal,layoutRect,innerOrigin,textEl=this._textContent;!textEl||textEl.ignore&&!forceUpdate||(this.textConfig||(this.textConfig={}),isLocal=(forceUpdate=this.textConfig).local,textVerticalAlign=textAlign=void 0,textStyleChanged=!1,(innerTransformable=textEl.innerTransformable).parent=isLocal?this:null,innerOrigin=!1,innerTransformable.copyTransform(textEl),null!=forceUpdate.position&&(layoutRect=tmpBoundingRect,forceUpdate.layoutRect?layoutRect.copy(forceUpdate.layoutRect):layoutRect.copy(this.getBoundingRect()),isLocal||layoutRect.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(tmpTextPosCalcRes,forceUpdate,layoutRect):calculateTextPosition(tmpTextPosCalcRes,forceUpdate,layoutRect),innerTransformable.x=tmpTextPosCalcRes.x,innerTransformable.y=tmpTextPosCalcRes.y,textAlign=tmpTextPosCalcRes.align,textVerticalAlign=tmpTextPosCalcRes.verticalAlign,(textOrigin=forceUpdate.origin)&&null!=forceUpdate.rotation&&(relOriginY=relOriginX=void 0,relOriginY="center"===textOrigin?(relOriginX=.5*layoutRect.width,.5*layoutRect.height):(relOriginX=parsePercent(textOrigin[0],layoutRect.width),parsePercent(textOrigin[1],layoutRect.height)),innerOrigin=!0,innerTransformable.originX=-innerTransformable.x+relOriginX+(isLocal?0:layoutRect.x),innerTransformable.originY=-innerTransformable.y+relOriginY+(isLocal?0:layoutRect.y))),null!=forceUpdate.rotation&&(innerTransformable.rotation=forceUpdate.rotation),(textOrigin=forceUpdate.offset)&&(innerTransformable.x+=textOrigin[0],innerTransformable.y+=textOrigin[1],innerOrigin||(innerTransformable.originX=-textOrigin[0],innerTransformable.originY=-textOrigin[1])),relOriginX=null==forceUpdate.inside?"string"==typeof forceUpdate.position&&0<=forceUpdate.position.indexOf("inside"):forceUpdate.inside,relOriginY=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),innerOrigin=layoutRect=isLocal=void 0,relOriginX&&this.canBeInsideText()?(isLocal=forceUpdate.insideFill,layoutRect=forceUpdate.insideStroke,null!=isLocal&&"auto"!==isLocal||(isLocal=this.getInsideTextFill()),null!=layoutRect&&"auto"!==layoutRect||(layoutRect=this.getInsideTextStroke(isLocal),innerOrigin=!0)):(isLocal=forceUpdate.outsideFill,layoutRect=forceUpdate.outsideStroke,null!=isLocal&&"auto"!==isLocal||(isLocal=this.getOutsideFill()),null!=layoutRect&&"auto"!==layoutRect||(layoutRect=this.getOutsideStroke(isLocal),innerOrigin=!0)),(isLocal=isLocal||"#000")===relOriginY.fill&&layoutRect===relOriginY.stroke&&innerOrigin===relOriginY.autoStroke&&textAlign===relOriginY.align&&textVerticalAlign===relOriginY.verticalAlign||(textStyleChanged=!0,relOriginY.fill=isLocal,relOriginY.stroke=layoutRect,relOriginY.autoStroke=innerOrigin,relOriginY.align=textAlign,relOriginY.verticalAlign=textVerticalAlign,textEl.setDefaultTextStyle(relOriginY)),textEl.__dirty|=REDRAW_BIT,textStyleChanged&&textEl.dirtyStyle(!0))},Element.prototype.canBeInsideText=function(){return!0},Element.prototype.getInsideTextFill=function(){return"#fff"},Element.prototype.getInsideTextStroke=function(textFill){return"#000"},Element.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?"#ccc":"#333"},Element.prototype.getOutsideStroke=function(textFill){for(var backgroundColor=this.__zr&&this.__zr.getBackgroundColor(),colorArr="string"==typeof backgroundColor&&parse(backgroundColor),alpha=(colorArr=colorArr||[255,255,255,1])[3],isDark=this.__zr.isDarkMode(),i=0;i<3;i++)colorArr[i]=colorArr[i]*alpha+(isDark?0:255)*(1-alpha);return colorArr[3]=1,stringify(colorArr,"rgba")},Element.prototype.traverse=function(cb,context){},Element.prototype.attrKV=function(key,value){"textConfig"===key?this.setTextConfig(value):"textContent"===key?this.setTextContent(value):"clipPath"===key?this.setClipPath(value):"extra"===key?(this.extra=this.extra||{},extend(this.extra,value)):this[key]=value},Element.prototype.hide=function(){this.ignore=!0,this.markRedraw()},Element.prototype.show=function(){this.ignore=!1,this.markRedraw()},Element.prototype.attr=function(keyOrObj,value){if("string"==typeof keyOrObj)this.attrKV(keyOrObj,value);else if(isObject(keyOrObj))for(var keysArr=keys(keyOrObj),i=0;i<keysArr.length;i++){var key=keysArr[i];this.attrKV(key,keyOrObj[key])}return this.markRedraw(),this},Element.prototype.saveCurrentToNormalState=function(toState){this._innerSaveToNormal(toState);for(var normalState=this._normalState,i=0;i<this.animators.length;i++){var animator=this.animators[i],fromStateTransition=animator.__fromStateTransition;animator.getLoop()||fromStateTransition&&"__zr_normal__"!==fromStateTransition||(fromStateTransition=(fromStateTransition=animator.targetName)?normalState[fromStateTransition]:normalState,animator.saveTo(fromStateTransition))}},Element.prototype._innerSaveToNormal=function(toState){var normalState=(normalState=this._normalState)||(this._normalState={});toState.textConfig&&!normalState.textConfig&&(normalState.textConfig=this.textConfig),this._savePrimaryToNormal(toState,normalState,PRIMARY_STATES_KEYS)},Element.prototype._savePrimaryToNormal=function(toState,normalState,primaryKeys){for(var i=0;i<primaryKeys.length;i++){var key=primaryKeys[i];null==toState[key]||key in normalState||(normalState[key]=this[key])}},Element.prototype.hasState=function(){return 0<this.currentStates.length},Element.prototype.getState=function(name){return this.states[name]},Element.prototype.ensureState=function(name){var states=this.states;return states[name]||(states[name]={}),states[name]},Element.prototype.clearStates=function(noAnimation){this.useState("__zr_normal__",!1,noAnimation)},Element.prototype.useState=function(stateName,keepCurrentStates,noAnimation,forceUseHoverLayer){var toNormalState="__zr_normal__"===stateName,hasStates=this.hasState();if(hasStates||!toNormalState){var state,hasStates=this.currentStates,animationCfg=this.stateTransition;if(!(0<=indexOf(hasStates,stateName))||!keepCurrentStates&&1!==hasStates.length){if((state=(state=this.stateProxy&&!toNormalState?this.stateProxy(stateName):state)||this.states&&this.states[stateName])||toNormalState)return toNormalState||this.saveCurrentToNormalState(state),(hasStates=!!(state&&state.hoverLayer||forceUseHoverLayer))&&this._toggleHoverLayerFlag(!0),this._applyStateObj(stateName,state,this._normalState,keepCurrentStates,!noAnimation&&!this.__inHover&&animationCfg&&0<animationCfg.duration,animationCfg),forceUseHoverLayer=this._textContent,animationCfg=this._textGuide,forceUseHoverLayer&&forceUseHoverLayer.useState(stateName,keepCurrentStates,noAnimation,hasStates),animationCfg&&animationCfg.useState(stateName,keepCurrentStates,noAnimation,hasStates),toNormalState?(this.currentStates=[],this._normalState={}):keepCurrentStates?this.currentStates.push(stateName):this.currentStates=[stateName],this._updateAnimationTargets(),this.markRedraw(),!hasStates&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~REDRAW_BIT),state;logError("State "+stateName+" not exists.")}}},Element.prototype.useStates=function(states,noAnimation,forceUseHoverLayer){if(states.length){var stateObjects=[],currentStates=this.currentStates,len=states.length,notChange=len===currentStates.length;if(notChange)for(var i=0;i<len;i++)if(states[i]!==currentStates[i]){notChange=!1;break}if(!notChange){for(i=0;i<len;i++){var stateName=states[i],stateObj=void 0;(stateObj=(stateObj=this.stateProxy?this.stateProxy(stateName,states):stateObj)||this.states[stateName])&&stateObjects.push(stateObj)}var lastStateObj=stateObjects[len-1],lastStateObj=!!(lastStateObj&&lastStateObj.hoverLayer||forceUseHoverLayer),forceUseHoverLayer=(lastStateObj&&this._toggleHoverLayerFlag(!0),this._mergeStates(stateObjects)),animationCfg=this.stateTransition,forceUseHoverLayer=(this.saveCurrentToNormalState(forceUseHoverLayer),this._applyStateObj(states.join(","),forceUseHoverLayer,this._normalState,!1,!noAnimation&&!this.__inHover&&animationCfg&&0<animationCfg.duration,animationCfg),this._textContent),animationCfg=this._textGuide;forceUseHoverLayer&&forceUseHoverLayer.useStates(states,noAnimation,lastStateObj),animationCfg&&animationCfg.useStates(states,noAnimation,lastStateObj),this._updateAnimationTargets(),this.currentStates=states.slice(),this.markRedraw(),!lastStateObj&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~REDRAW_BIT)}}else this.clearStates()},Element.prototype._updateAnimationTargets=function(){for(var i=0;i<this.animators.length;i++){var animator=this.animators[i];animator.targetName&&animator.changeTarget(this[animator.targetName])}},Element.prototype.removeState=function(state){var currentStates,state=indexOf(this.currentStates,state);0<=state&&((currentStates=this.currentStates.slice()).splice(state,1),this.useStates(currentStates))},Element.prototype.replaceState=function(oldState,newState,forceAdd){var currentStates=this.currentStates.slice(),oldState=indexOf(currentStates,oldState),newStateExists=0<=indexOf(currentStates,newState);0<=oldState?newStateExists?currentStates.splice(oldState,1):currentStates[oldState]=newState:forceAdd&&!newStateExists&&currentStates.push(newState),this.useStates(currentStates)},Element.prototype.toggleState=function(state,enable){enable?this.useState(state,!0):this.removeState(state)},Element.prototype._mergeStates=function(states){for(var mergedTextConfig,mergedState={},i=0;i<states.length;i++){var state=states[i];extend(mergedState,state),state.textConfig&&extend(mergedTextConfig=mergedTextConfig||{},state.textConfig)}return mergedTextConfig&&(mergedState.textConfig=mergedTextConfig),mergedState},Element.prototype._applyStateObj=function(stateName,state,normalState,keepCurrentStates,transition,animationCfg){for(var needsRestoreToNormal=!(state&&keepCurrentStates),transitionTarget=(state&&state.textConfig?(this.textConfig=extend({},(keepCurrentStates?this:normalState).textConfig),extend(this.textConfig,state.textConfig)):needsRestoreToNormal&&normalState.textConfig&&(this.textConfig=normalState.textConfig),{}),hasTransition=!1,i=0;i<PRIMARY_STATES_KEYS.length;i++){var key=PRIMARY_STATES_KEYS[i],propNeedsTransition=transition&&DEFAULT_ANIMATABLE_MAP[key];state&&null!=state[key]?propNeedsTransition?(hasTransition=!0,transitionTarget[key]=state[key]):this[key]=state[key]:needsRestoreToNormal&&null!=normalState[key]&&(propNeedsTransition?(hasTransition=!0,transitionTarget[key]=normalState[key]):this[key]=normalState[key])}if(!transition)for(i=0;i<this.animators.length;i++){var animator=this.animators[i],targetName=animator.targetName;animator.getLoop()||animator.__changeFinalValue(targetName?(state||normalState)[targetName]:state||normalState)}hasTransition&&this._transitionState(stateName,transitionTarget,animationCfg)},Element.prototype._attachComponent=function(componentEl){if(componentEl.__zr&&!componentEl.__hostTarget)throw new Error("Text element has been added to zrender.");if(componentEl===this)throw new Error("Recursive component attachment.");var zr=this.__zr;zr&&componentEl.addSelfToZr(zr),componentEl.__zr=zr,componentEl.__hostTarget=this},Element.prototype._detachComponent=function(componentEl){componentEl.__zr&&componentEl.removeSelfFromZr(componentEl.__zr),componentEl.__zr=null,componentEl.__hostTarget=null},Element.prototype.getClipPath=function(){return this._clipPath},Element.prototype.setClipPath=function(clipPath){this._clipPath&&this._clipPath!==clipPath&&this.removeClipPath(),this._attachComponent(clipPath),this._clipPath=clipPath,this.markRedraw()},Element.prototype.removeClipPath=function(){var clipPath=this._clipPath;clipPath&&(this._detachComponent(clipPath),this._clipPath=null,this.markRedraw())},Element.prototype.getTextContent=function(){return this._textContent},Element.prototype.setTextContent=function(textEl){var previousTextContent=this._textContent;if(previousTextContent!==textEl){if(previousTextContent&&previousTextContent!==textEl&&this.removeTextContent(),textEl.__zr&&!textEl.__hostTarget)throw new Error("Text element has been added to zrender.");textEl.innerTransformable=new Transformable,this._attachComponent(textEl),this._textContent=textEl,this.markRedraw()}},Element.prototype.setTextConfig=function(cfg){this.textConfig||(this.textConfig={}),extend(this.textConfig,cfg),this.markRedraw()},Element.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},Element.prototype.removeTextContent=function(){var textEl=this._textContent;textEl&&(textEl.innerTransformable=null,this._detachComponent(textEl),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},Element.prototype.getTextGuideLine=function(){return this._textGuide},Element.prototype.setTextGuideLine=function(guideLine){this._textGuide&&this._textGuide!==guideLine&&this.removeTextGuideLine(),this._attachComponent(guideLine),this._textGuide=guideLine,this.markRedraw()},Element.prototype.removeTextGuideLine=function(){var textGuide=this._textGuide;textGuide&&(this._detachComponent(textGuide),this._textGuide=null,this.markRedraw())},Element.prototype.markRedraw=function(){this.__dirty|=REDRAW_BIT;var zr=this.__zr;zr&&(this.__inHover?zr.refreshHover():zr.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},Element.prototype.dirty=function(){this.markRedraw()},Element.prototype._toggleHoverLayerFlag=function(inHover){this.__inHover=inHover;var textContent=this._textContent,textGuide=this._textGuide;textContent&&(textContent.__inHover=inHover),textGuide&&(textGuide.__inHover=inHover)},Element.prototype.addSelfToZr=function(zr){if(this.__zr!==zr){this.__zr=zr;var animators=this.animators;if(animators)for(var i=0;i<animators.length;i++)zr.animation.addAnimator(animators[i]);this._clipPath&&this._clipPath.addSelfToZr(zr),this._textContent&&this._textContent.addSelfToZr(zr),this._textGuide&&this._textGuide.addSelfToZr(zr)}},Element.prototype.removeSelfFromZr=function(zr){if(this.__zr){this.__zr=null;var animators=this.animators;if(animators)for(var i=0;i<animators.length;i++)zr.animation.removeAnimator(animators[i]);this._clipPath&&this._clipPath.removeSelfFromZr(zr),this._textContent&&this._textContent.removeSelfFromZr(zr),this._textGuide&&this._textGuide.removeSelfFromZr(zr)}},Element.prototype.animate=function(key,loop,allowDiscreteAnimation){var target=key?this[key]:this;{if(target)return target=new Animator(target,loop,allowDiscreteAnimation),key&&(target.targetName=key),this.addAnimator(target,key),target;logError('Property "'+key+'" is not existed in element '+this.id)}},Element.prototype.addAnimator=function(animator,key){var zr=this.__zr,el=this;animator.during(function(){el.updateDuringAnimation(key)}).done(function(){var animators=el.animators,idx=indexOf(animators,animator);0<=idx&&animators.splice(idx,1)}),this.animators.push(animator),zr&&zr.animation.addAnimator(animator),zr&&zr.wakeUp()},Element.prototype.updateDuringAnimation=function(key){this.markRedraw()},Element.prototype.stopAnimation=function(scope,forwardToLast){for(var animators=this.animators,len=animators.length,leftAnimators=[],i=0;i<len;i++){var animator=animators[i];scope&&scope!==animator.scope?leftAnimators.push(animator):animator.stop(forwardToLast)}return this.animators=leftAnimators,this},Element.prototype.animateTo=function(target,cfg,animationProps){animateTo(this,target,cfg,animationProps)},Element.prototype.animateFrom=function(target,cfg,animationProps){animateTo(this,target,cfg,animationProps,!0)},Element.prototype._transitionState=function(stateName,target,cfg,animationProps){for(var animators=animateTo(this,target,cfg,animationProps),i=0;i<animators.length;i++)animators[i].__fromStateTransition=stateName},Element.prototype.getBoundingRect=function(){return null},Element.prototype.getPaintRect=function(){return null},Element.initDefaultProps=((elProto=Element.prototype).type="element",elProto.name="",elProto.ignore=elProto.silent=elProto.isGroup=elProto.draggable=elProto.dragging=elProto.ignoreClip=elProto.__inHover=!1,elProto.__dirty=REDRAW_BIT,logs={},void(Object.defineProperty&&(createLegacyProperty("position","_legacyPos","x","y"),createLegacyProperty("scale","_legacyScale","scaleX","scaleY"),createLegacyProperty("origin","_legacyOrigin","originX","originY")))),Element}();function animateTo(animatable,target,cfg,animationProps,reverse){function doneCb(){doneHappened=!0,--finishCount<=0&&(doneHappened?cfgDone&&cfgDone():cfgAborted&&cfgAborted())}function abortedCb(){--finishCount<=0&&(doneHappened?cfgDone&&cfgDone():cfgAborted&&cfgAborted())}var animators=[],finishCount=(!function animateToShallow(animatable,topKey,animateObj,target,cfg,animationProps,animators,reverse){var targetKeys=keys(target);var duration=cfg.duration;var delay=cfg.delay;var additive=cfg.additive;var setToFinal=cfg.setToFinal;var animateAll=!isObject(animationProps);var existsAnimators=animatable.animators;var animationKeys=[];for(var k=0;k<targetKeys.length;k++){var innerKey=targetKeys[k],targetVal=target[innerKey];null!=targetVal&&null!=animateObj[innerKey]&&(animateAll||animationProps[innerKey])?isObject(targetVal)&&!isArrayLike(targetVal)&&null==targetVal.colorStops?topKey?reverse||(animateObj[innerKey]=targetVal,animatable.updateDuringAnimation(topKey)):animateToShallow(animatable,innerKey,animateObj[innerKey],targetVal,cfg,animationProps&&animationProps[innerKey],animators,reverse):animationKeys.push(innerKey):reverse||(animateObj[innerKey]=targetVal,animatable.updateDuringAnimation(topKey),animationKeys.push(innerKey))}var keyLen=animationKeys.length;if(!additive&&keyLen)for(var idx,i=0;i<existsAnimators.length;i++)(animator=existsAnimators[i]).targetName!==topKey||animator.stopTracks(animationKeys)&&(idx=indexOf(existsAnimators,animator),existsAnimators.splice(idx,1));cfg.force||(animationKeys=filter(animationKeys,function(key){return!isValueSame(target[key],animateObj[key])}),keyLen=animationKeys.length);if(0<keyLen||cfg.force&&!animators.length){var animator,revertedSource=void 0,reversedTarget=void 0,sourceClone=void 0;if(reverse){reversedTarget={},setToFinal&&(revertedSource={});for(i=0;i<keyLen;i++){innerKey=animationKeys[i];reversedTarget[innerKey]=animateObj[innerKey],setToFinal?revertedSource[innerKey]=target[innerKey]:animateObj[innerKey]=target[innerKey]}}else if(setToFinal){sourceClone={};for(i=0;i<keyLen;i++){innerKey=animationKeys[i];sourceClone[innerKey]=cloneValue(animateObj[innerKey]),copyValue(animateObj,target,innerKey)}}(animator=new Animator(animateObj,!1,!1,additive?filter(existsAnimators,function(animator){return animator.targetName===topKey}):null)).targetName=topKey,cfg.scope&&(animator.scope=cfg.scope),setToFinal&&revertedSource&&animator.whenWithKeys(0,revertedSource,animationKeys),sourceClone&&animator.whenWithKeys(0,sourceClone,animationKeys),animator.whenWithKeys(null==duration?500:duration,reverse?reversedTarget:target,animationKeys).delay(delay||0),animatable.addAnimator(animator,topKey),animators.push(animator)}}(animatable,"",animatable,target,cfg=cfg||{},animationProps,animators,reverse),animators.length),doneHappened=!1,cfgDone=cfg.done,cfgAborted=cfg.aborted;finishCount||cfgDone&&cfgDone(),0<animators.length&&cfg.during&&animators[0].during(function(target,percent){cfg.during(percent)});for(var i=0;i<animators.length;i++){var animator=animators[i];animator.done(doneCb),animator.aborted(abortedCb),cfg.force&&animator.duration(cfg.duration),animator.start(cfg.easing)}return animators}function copyArrShallow(source,target,len){for(var i=0;i<len;i++)source[i]=target[i]}function copyValue(target,source,key){if(isArrayLike(source[key]))if(isArrayLike(target[key])||(target[key]=[]),isTypedArray(source[key])){var len=source[key].length;target[key].length!==len&&(target[key]=new source[key].constructor(len),copyArrShallow(target[key],source[key],len))}else{var sourceArr=source[key],targetArr=target[key],len0=sourceArr.length;if(isArrayLike(sourceArr[0]))for(var len1=sourceArr[0].length,i=0;i<len0;i++)targetArr[i]?copyArrShallow(targetArr[i],sourceArr[i],len1):targetArr[i]=Array.prototype.slice.call(sourceArr[i]);else copyArrShallow(targetArr,sourceArr,len0);targetArr.length=sourceArr.length}else target[key]=source[key]}function isValueSame(val1,val2){return val1===val2||isArrayLike(val1)&&isArrayLike(val2)&&function(arr0,arr1){var len=arr0.length;if(len!==arr1.length)return!1;for(var i=0;i<len;i++)if(arr0[i]!==arr1[i])return!1;return!0}(val1,val2)}mixin(Element,Eventful),mixin(Element,Transformable);var Group=function(_super){function Group(opts){var _this=_super.call(this)||this;return _this.isGroup=!0,_this._children=[],_this.attr(opts),_this}return __extends(Group,_super),Group.prototype.childrenRef=function(){return this._children},Group.prototype.children=function(){return this._children.slice()},Group.prototype.childAt=function(idx){return this._children[idx]},Group.prototype.childOfName=function(name){for(var children=this._children,i=0;i<children.length;i++)if(children[i].name===name)return children[i]},Group.prototype.childCount=function(){return this._children.length},Group.prototype.add=function(child){if(child&&(child!==this&&child.parent!==this&&(this._children.push(child),this._doAdd(child)),child.__hostTarget))throw"This elemenet has been used as an attachment";return this},Group.prototype.addBefore=function(child,nextSibling){var children;return child&&child!==this&&child.parent!==this&&nextSibling&&nextSibling.parent===this&&(0<=(nextSibling=(children=this._children).indexOf(nextSibling))&&(children.splice(nextSibling,0,child),this._doAdd(child))),this},Group.prototype.replace=function(oldChild,newChild){oldChild=indexOf(this._children,oldChild);return 0<=oldChild&&this.replaceAt(newChild,oldChild),this},Group.prototype.replaceAt=function(child,index){var children=this._children,old=children[index];return child&&child!==this&&child.parent!==this&&child!==old&&(children[index]=child,old.parent=null,(children=this.__zr)&&old.removeSelfFromZr(children),this._doAdd(child)),this},Group.prototype._doAdd=function(child){child.parent&&child.parent.remove(child);var zr=(child.parent=this).__zr;zr&&zr!==child.__zr&&child.addSelfToZr(zr),zr&&zr.refresh()},Group.prototype.remove=function(child){var zr=this.__zr,children=this._children,idx=indexOf(children,child);return idx<0||(children.splice(idx,1),child.parent=null,zr&&child.removeSelfFromZr(zr),zr&&zr.refresh()),this},Group.prototype.removeAll=function(){for(var children=this._children,zr=this.__zr,i=0;i<children.length;i++){var child=children[i];zr&&child.removeSelfFromZr(zr),child.parent=null}return children.length=0,this},Group.prototype.eachChild=function(cb,context){for(var children=this._children,i=0;i<children.length;i++){var child=children[i];cb.call(context,child,i)}return this},Group.prototype.traverse=function(cb,context){for(var i=0;i<this._children.length;i++){var child=this._children[i],stopped=cb.call(context,child);child.isGroup&&!stopped&&child.traverse(cb,context)}return this},Group.prototype.addSelfToZr=function(zr){_super.prototype.addSelfToZr.call(this,zr);for(var i=0;i<this._children.length;i++)this._children[i].addSelfToZr(zr)},Group.prototype.removeSelfFromZr=function(zr){_super.prototype.removeSelfFromZr.call(this,zr);for(var i=0;i<this._children.length;i++)this._children[i].removeSelfFromZr(zr)},Group.prototype.getBoundingRect=function(includeChildren){for(var tmpRect=new BoundingRect(0,0,0,0),children=includeChildren||this._children,tmpMat=[],rect=null,i=0;i<children.length;i++){var childRect,child=children[i];child.ignore||child.invisible||(childRect=child.getBoundingRect(),(child=child.getLocalTransform(tmpMat))?(BoundingRect.applyTransform(tmpRect,childRect,child),(rect=rect||tmpRect.clone()).union(tmpRect)):(rect=rect||childRect.clone()).union(childRect))}return rect||tmpRect},Group}(Element),painterCtors=(Group.prototype.type="group",{}),instances$1={};var ZRender=function(){function ZRender(id,dom,opts){var _this=this,storage=(this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,opts=opts||{},this.dom=dom,this.id=id,new Storage),rendererType=opts.renderer||"canvas";if(painterCtors[rendererType]||(rendererType=keys(painterCtors)[0]),!painterCtors[rendererType])throw new Error("Renderer '"+rendererType+"' is not imported. Please import it first.");opts.useDirtyRect=null!=opts.useDirtyRect&&opts.useDirtyRect;rendererType=new painterCtors[rendererType](dom,storage,opts,id),dom=opts.ssr||rendererType.ssrOnly,this.storage=storage,this.painter=rendererType,id=env.node||env.worker||dom?null:new HandlerDomProxy(rendererType.getViewportRoot(),rendererType.root);this.handler=new Handler(storage,rendererType,id,rendererType.root),this.animation=new Animation({stage:{update:dom?null:function(){return _this._flush(!0)}}}),dom||this.animation.start()}return ZRender.prototype.add=function(el){el&&(this.storage.addRoot(el),el.addSelfToZr(this),this.refresh())},ZRender.prototype.remove=function(el){el&&(this.storage.delRoot(el),el.removeSelfFromZr(this),this.refresh())},ZRender.prototype.configLayer=function(zLevel,config){this.painter.configLayer&&this.painter.configLayer(zLevel,config),this.refresh()},ZRender.prototype.setBackgroundColor=function(backgroundColor){this.painter.setBackgroundColor&&this.painter.setBackgroundColor(backgroundColor),this.refresh(),this._backgroundColor=backgroundColor,this._darkMode=function(backgroundColor){if(!backgroundColor)return!1;if("string"==typeof backgroundColor)return lum(backgroundColor,1)<.4;if(backgroundColor.colorStops){for(var colorStops=backgroundColor.colorStops,totalLum=0,len=colorStops.length,i=0;i<len;i++)totalLum+=lum(colorStops[i].color,1);return(totalLum/=len)<.4}return!1}(backgroundColor)},ZRender.prototype.getBackgroundColor=function(){return this._backgroundColor},ZRender.prototype.setDarkMode=function(darkMode){this._darkMode=darkMode},ZRender.prototype.isDarkMode=function(){return this._darkMode},ZRender.prototype.refreshImmediately=function(fromInside){fromInside||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},ZRender.prototype.refresh=function(){this._needsRefresh=!0,this.animation.start()},ZRender.prototype.flush=function(){this._flush(!1)},ZRender.prototype._flush=function(fromInside){var triggerRendered,start=getTime(),fromInside=(this._needsRefresh&&(triggerRendered=!0,this.refreshImmediately(fromInside)),this._needsRefreshHover&&(triggerRendered=!0,this.refreshHoverImmediately()),getTime());triggerRendered?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:fromInside-start})):0<this._sleepAfterStill&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},ZRender.prototype.setSleepAfterStill=function(stillFramesCount){this._sleepAfterStill=stillFramesCount},ZRender.prototype.wakeUp=function(){this.animation.start(),this._stillFrameAccum=0},ZRender.prototype.refreshHover=function(){this._needsRefreshHover=!0},ZRender.prototype.refreshHoverImmediately=function(){this._needsRefreshHover=!1,this.painter.refreshHover&&"canvas"===this.painter.getType()&&this.painter.refreshHover()},ZRender.prototype.resize=function(opts){this.painter.resize((opts=opts||{}).width,opts.height),this.handler.resize()},ZRender.prototype.clearAnimation=function(){this.animation.clear()},ZRender.prototype.getWidth=function(){return this.painter.getWidth()},ZRender.prototype.getHeight=function(){return this.painter.getHeight()},ZRender.prototype.setCursorStyle=function(cursorStyle){this.handler.setCursorStyle(cursorStyle)},ZRender.prototype.findHover=function(x,y){return this.handler.findHover(x,y)},ZRender.prototype.on=function(eventName,eventHandler,context){return this.handler.on(eventName,eventHandler,context),this},ZRender.prototype.off=function(eventName,eventHandler){this.handler.off(eventName,eventHandler)},ZRender.prototype.trigger=function(eventName,event){this.handler.trigger(eventName,event)},ZRender.prototype.clear=function(){for(var roots=this.storage.getRoots(),i=0;i<roots.length;i++)roots[i]instanceof Group&&roots[i].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()},ZRender.prototype.dispose=function(){var id;this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,id=this.id,delete instances$1[id]},ZRender}();function init$1(dom,opts){dom=new ZRender(guid(),dom,opts);return instances$1[dom.id]=dom}function registerPainter(name,Ctor){painterCtors[name]=Ctor}var zrender=(Object.freeze||Object)({init:init$1,dispose:function(zr){zr.dispose()},disposeAll:function(){for(var key in instances$1)instances$1.hasOwnProperty(key)&&instances$1[key].dispose();instances$1={}},getInstance:function(id){return instances$1[id]},registerPainter:registerPainter,version:"5.3.0"}),ROUND_SUPPORTED_PRECISION_MAX=20;function linearMap(val,domain,range,clamp){var d0=domain[0],domain=domain[1],r0=range[0],range=range[1],subDomain=domain-d0,subRange=range-r0;if(0==subDomain)return 0==subRange?r0:(r0+range)/2;if(clamp)if(0<subDomain){if(val<=d0)return r0;if(domain<=val)return range}else{if(d0<=val)return r0;if(val<=domain)return range}else{if(val===d0)return r0;if(val===domain)return range}return(val-d0)/subDomain*subRange+r0}function parsePercent$1(percent,all){switch(percent){case"center":case"middle":percent="50%";break;case"left":case"top":percent="0%";break;case"right":case"bottom":percent="100%"}return isString(percent)?percent.replace(/^\s+|\s+$/g,"").match(/%$/)?parseFloat(percent)/100*all:parseFloat(percent):null==percent?NaN:+percent}function round(x,precision,returnStr){return null==precision&&(precision=10),precision=Math.min(Math.max(0,precision),ROUND_SUPPORTED_PRECISION_MAX),x=(+x).toFixed(precision),returnStr?x:+x}function asc(arr){return arr.sort(function(a,b){return a-b}),arr}function getPrecision(val){if(val=+val,isNaN(val))return 0;if(1e-14<val)for(var e=1,i=0;i<15;i++,e*=10)if(Math.round(val*e)/e===val)return i;return getPrecisionSafe(val)}function getPrecisionSafe(val){var val=val.toString().toLowerCase(),eIndex=val.indexOf("e"),exp=0<eIndex?+val.slice(eIndex+1):0,eIndex=0<eIndex?eIndex:val.length,val=val.indexOf(".");return Math.max(0,(val<0?0:eIndex-1-val)-exp)}function getPixelPrecision(dataExtent,pixelExtent){var log=Math.log,LN10=Math.LN10,dataExtent=Math.floor(log(dataExtent[1]-dataExtent[0])/LN10),log=Math.round(log(Math.abs(pixelExtent[1]-pixelExtent[0]))/LN10),pixelExtent=Math.min(Math.max(-dataExtent+log,0),20);return isFinite(pixelExtent)?pixelExtent:20}function remRadian(radian){var pi2=2*Math.PI;return(radian%pi2+pi2)%pi2}function isRadianAroundZero(val){return-1e-4<val&&val<1e-4}var TIME_REG=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function parseDate(value){return value instanceof Date?value:isString(value)?(match=TIME_REG.exec(value))?match[8]?(hour=+match[4]||0,"Z"!==match[8].toUpperCase()&&(hour-=+match[8].slice(0,3)),new Date(Date.UTC(+match[1],+(match[2]||1)-1,+match[3]||1,hour,+(match[5]||0),+match[6]||0,match[7]?+match[7].substring(0,3):0))):new Date(+match[1],+(match[2]||1)-1,+match[3]||1,+match[4]||0,+(match[5]||0),+match[6]||0,match[7]?+match[7].substring(0,3):0):new Date(NaN):null==value?new Date(NaN):new Date(Math.round(value));var match,hour}function quantity(val){return Math.pow(10,quantityExponent(val))}function quantityExponent(val){if(0===val)return 0;var exp=Math.floor(Math.log(val)/Math.LN10);return 10<=val/Math.pow(10,exp)&&exp++,exp}function nice(val,round){var exponent=quantityExponent(val),exp10=Math.pow(10,exponent),f=val/exp10,round=round?f<1.5?1:f<2.5?2:f<4?3:f<7?5:10:f<1?1:f<2?2:f<3?3:f<5?5:10;return val=round*exp10,-20<=exponent?+val.toFixed(exponent<0?-exponent:0):val}function numericToNumber(val){var valFloat=parseFloat(val);return valFloat==val&&(0!==valFloat||!isString(val)||val.indexOf("x")<=0)?valFloat:NaN}function isNumeric(val){return!isNaN(numericToNumber(val))}function getRandomIdBase(){return Math.round(9*Math.random())}function getLeastCommonMultiple(a,b){return null==a?b:null==b?a:a*b/function getGreatestCommonDividor(a,b){return 0===b?a:getGreatestCommonDividor(b,a%b)}(a,b)}var ECHARTS_PREFIX="[ECharts] ",storedLogs={},hasConsole="undefined"!=typeof console&&console.warn&&console.log;function outputLog(type,str,onlyOnce){if(hasConsole){if(onlyOnce){if(storedLogs[str])return;storedLogs[str]=!0}console[type](ECHARTS_PREFIX+str)}}function warn(str,onlyOnce){outputLog("warn",str,onlyOnce)}function error(str,onlyOnce){outputLog("error",str,onlyOnce)}function deprecateLog(str){outputLog("warn","DEPRECATED: "+str,!0)}function deprecateReplaceLog(oldOpt,newOpt,scope){deprecateLog((scope?"["+scope+"]":"")+oldOpt+" is deprecated, use "+newOpt+" instead.")}function makePrintable(){for(var hintInfo=[],_i=0;_i<arguments.length;_i++)hintInfo[_i]=arguments[_i];function makePrintableStringIfPossible_1(val){return void 0===val?"undefined":val===1/0?"Infinity":val===-1/0?"-Infinity":eqNaN(val)?"NaN":val instanceof Date?"Date("+val.toISOString()+")":isFunction(val)?"function () { ... }":isRegExp(val)?val+"":null}return map(hintInfo,function(arg){if(isString(arg))return arg;var printableStr=makePrintableStringIfPossible_1(arg);if(null!=printableStr)return printableStr;if("undefined"==typeof JSON||!JSON.stringify)return"?";try{return JSON.stringify(arg,function(n,val){var printableStr=makePrintableStringIfPossible_1(val);return null==printableStr?val:printableStr})}catch(err){return"?"}}).join(" ")}function throwError(msg){throw new Error(msg)}function interpolateNumber$1(p0,p1,percent){return(p1-p0)*percent+p0}var DUMMY_COMPONENT_NAME_PREFIX="series\0",INTERNAL_COMPONENT_ID_PREFIX="\0_ec_\0";function normalizeToArray(value){return value instanceof Array?value:null==value?[]:[value]}function defaultEmphasis(opt,key,subOpts){if(opt){opt[key]=opt[key]||{},opt.emphasis=opt.emphasis||{},opt.emphasis[key]=opt.emphasis[key]||{};for(var i=0,len=subOpts.length;i<len;i++){var subOptName=subOpts[i];!opt.emphasis[key].hasOwnProperty(subOptName)&&opt[key].hasOwnProperty(subOptName)&&(opt.emphasis[key][subOptName]=opt[key][subOptName])}}}var TEXT_STYLE_OPTIONS=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function getDataItemValue(dataItem){return!isObject(dataItem)||isArray(dataItem)||dataItem instanceof Date?dataItem:dataItem.value}function mappingToExists(existings,newCmptOptions,mode){var idMap,isNormalMergeMode="normalMerge"===mode,isReplaceMergeMode="replaceMerge"===mode,isReplaceAllMode="replaceAll"===mode,existingIdIdxMap=(existings=existings||[],newCmptOptions=(newCmptOptions||[]).slice(),createHashMap()),mode=(each(newCmptOptions,function(cmptOption,index){isObject(cmptOption)?(null==cmptOption.id||isValidIdOrName(cmptOption.id)||warnInvalidateIdOrName(cmptOption.id),null==cmptOption.name||isValidIdOrName(cmptOption.name)||warnInvalidateIdOrName(cmptOption.name)):newCmptOptions[index]=null}),function(existings,existingIdIdxMap,mode){var result=[];if("replaceAll"===mode)return result;for(var index=0;index<existings.length;index++){var existing=existings[index];existing&&null!=existing.id&&existingIdIdxMap.set(existing.id,index),result.push({existing:"replaceMerge"===mode||isComponentIdInternal(existing)?null:existing,newOption:null,keyInfo:null,brandNew:null})}return result}(existings,existingIdIdxMap,mode));return(isNormalMergeMode||isReplaceMergeMode)&&function(result,existings,existingIdIdxMap,newCmptOptions){each(newCmptOptions,function(cmptOption,index){var optionId,existingIdx,resultItem;cmptOption&&null!=cmptOption.id&&(optionId=makeComparableKey(cmptOption.id),null!=(existingIdx=existingIdIdxMap.get(optionId))&&(assert(!(resultItem=result[existingIdx]).newOption,'Duplicated option on id "'+optionId+'".'),resultItem.newOption=cmptOption,resultItem.existing=existings[existingIdx],newCmptOptions[index]=null))})}(mode,existings,existingIdIdxMap,newCmptOptions),isNormalMergeMode&&function(result,newCmptOptions){each(newCmptOptions,function(cmptOption,index){if(cmptOption&&null!=cmptOption.name)for(var i=0;i<result.length;i++){var existing=result[i].existing;if(!result[i].newOption&&existing&&(null==existing.id||null==cmptOption.id)&&!isComponentIdInternal(cmptOption)&&!isComponentIdInternal(existing)&&keyExistAndEqual("name",existing,cmptOption))return result[i].newOption=cmptOption,void(newCmptOptions[index]=null)}})}(mode,newCmptOptions),isNormalMergeMode||isReplaceMergeMode?function(result,newCmptOptions,brandNew){each(newCmptOptions,function(cmptOption){if(cmptOption){for(var resultItem,nextIdx=0;(resultItem=result[nextIdx])&&(resultItem.newOption||isComponentIdInternal(resultItem.existing)||resultItem.existing&&null!=cmptOption.id&&!keyExistAndEqual("id",cmptOption,resultItem.existing));)nextIdx++;resultItem?(resultItem.newOption=cmptOption,resultItem.brandNew=brandNew):result.push({newOption:cmptOption,brandNew:brandNew,existing:null,keyInfo:null}),nextIdx++}})}(mode,newCmptOptions,isReplaceMergeMode):isReplaceAllMode&&function(result,newCmptOptions){each(newCmptOptions,function(cmptOption){result.push({newOption:cmptOption,brandNew:!0,existing:null,keyInfo:null})})}(mode,newCmptOptions),existings=mode,idMap=createHashMap(),each(existings,function(item){var existing=item.existing;existing&&idMap.set(existing.id,item)}),each(existings,function(item){var opt=item.newOption;assert(!opt||null==opt.id||!idMap.get(opt.id)||idMap.get(opt.id)===item,"id duplicates: "+(opt&&opt.id)),opt&&null!=opt.id&&idMap.set(opt.id,item),item.keyInfo||(item.keyInfo={})}),each(existings,function(item,index){var existing=item.existing,opt=item.newOption,keyInfo=item.keyInfo;if(isObject(opt)){if(keyInfo.name=null!=opt.name?makeComparableKey(opt.name):existing?existing.name:DUMMY_COMPONENT_NAME_PREFIX+index,existing)keyInfo.id=makeComparableKey(existing.id);else if(null!=opt.id)keyInfo.id=makeComparableKey(opt.id);else for(var idNum=0;keyInfo.id="\0"+keyInfo.name+"\0"+idNum++,idMap.get(keyInfo.id););idMap.set(keyInfo.id,item)}}),mode}function keyExistAndEqual(attr,obj1,obj2){obj1=convertOptionIdName(obj1[attr],null),obj2=convertOptionIdName(obj2[attr],null);return null!=obj1&&null!=obj2&&obj1===obj2}function makeComparableKey(val){if(null==val)throw new Error;return convertOptionIdName(val,"")}function convertOptionIdName(idOrName,defaultValue){return null==idOrName?defaultValue:isString(idOrName)?idOrName:isNumber(idOrName)||isStringSafe(idOrName)?idOrName+"":defaultValue}function warnInvalidateIdOrName(idOrName){warn("`"+idOrName+"` is invalid id or name. Must be a string or number.")}function isValidIdOrName(idOrName){return isStringSafe(idOrName)||isNumeric(idOrName)}function isNameSpecified(componentModel){componentModel=componentModel.name;return!(!componentModel||!componentModel.indexOf(DUMMY_COMPONENT_NAME_PREFIX))}function isComponentIdInternal(cmptOption){return cmptOption&&null!=cmptOption.id&&0===makeComparableKey(cmptOption.id).indexOf(INTERNAL_COMPONENT_ID_PREFIX)}function setComponentTypeToKeyInfo(mappingResult,mainType,componentModelCtor){each(mappingResult,function(item){var newOption=item.newOption;isObject(newOption)&&(item.keyInfo.mainType=mainType,item.keyInfo.subType=function(mainType,newCmptOption,existComponent,componentModelCtor){return newCmptOption.type||(existComponent?existComponent.subType:componentModelCtor.determineSubType(mainType,newCmptOption))}(mainType,newOption,item.existing,componentModelCtor))})}function queryDataIndex(data,payload){return null!=payload.dataIndexInside?payload.dataIndexInside:null!=payload.dataIndex?isArray(payload.dataIndex)?map(payload.dataIndex,function(value){return data.indexOfRawIndex(value)}):data.indexOfRawIndex(payload.dataIndex):null!=payload.name?isArray(payload.name)?map(payload.name,function(value){return data.indexOfName(value)}):data.indexOfName(payload.name):void 0}function makeInner(){var key="__ec_inner_"+innerUniqueIndex++;return function(hostObj){return hostObj[key]||(hostObj[key]={})}}var innerUniqueIndex=getRandomIdBase();function parseFinder(ecModel,finderInput,opt){var finderInput=preParseFinder(finderInput,opt),mainTypeSpecified=finderInput.mainTypeSpecified,queryOptionMap=finderInput.queryOptionMap,result=finderInput.others,defaultMainType=opt?opt.defaultMainType:null;return!mainTypeSpecified&&defaultMainType&&queryOptionMap.set(defaultMainType,{}),queryOptionMap.each(function(queryOption,mainType){queryOption=queryReferringComponents(ecModel,mainType,queryOption,{useDefault:defaultMainType===mainType,enableAll:!opt||null==opt.enableAll||opt.enableAll,enableNone:!opt||null==opt.enableNone||opt.enableNone});result[mainType+"Models"]=queryOption.models,result[mainType+"Model"]=queryOption.models[0]}),result}function preParseFinder(finderInput,opt){var obj=isString(finderInput)?((obj={})[finderInput+"Index"]=0,obj):finderInput,queryOptionMap=createHashMap(),others={},mainTypeSpecified=!1;return each(obj,function(value,key){var mainType;"dataIndex"===key||"dataIndexInside"===key?others[key]=value:(mainType=(key=key.match(/^(\w+)(Index|Id|Name)$/)||[])[1],key=(key[2]||"").toLowerCase(),!mainType||!key||opt&&opt.includeMainTypes&&indexOf(opt.includeMainTypes,mainType)<0||(mainTypeSpecified=mainTypeSpecified||!!mainType,(queryOptionMap.get(mainType)||queryOptionMap.set(mainType,{}))[key]=value))}),{mainTypeSpecified:mainTypeSpecified,queryOptionMap:queryOptionMap,others:others}}var SINGLE_REFERRING={useDefault:!0,enableAll:!1,enableNone:!1},MULTIPLE_REFERRING={useDefault:!1,enableAll:!0,enableNone:!0};function queryReferringComponents(ecModel,mainType,userOption,opt){opt=opt||SINGLE_REFERRING;var indexOption=userOption.index,idOption=userOption.id,userOption=userOption.name,result={models:null,specified:null!=indexOption||null!=idOption||null!=userOption};return result.specified?"none"===indexOption||!1===indexOption?(assert(opt.enableNone,'`"none"` or `false` is not a valid value on index option.'),result.models=[]):("all"===indexOption&&(assert(opt.enableAll,'`"all"` is not a valid value on index option.'),indexOption=idOption=userOption=null),result.models=ecModel.queryComponents({mainType:mainType,index:indexOption,id:idOption,name:userOption})):(indexOption=void 0,result.models=opt.useDefault&&(indexOption=ecModel.getComponent(mainType))?[indexOption]:[]),result}function setAttribute(dom,key,value){dom.setAttribute?dom.setAttribute(key,value):dom[key]=value}function interpolateRawValues(data,precision,sourceValue,targetValue,percent){var isAutoPrecision=null==precision||"auto"===precision;if(null==targetValue)return targetValue;if(isNumber(targetValue))return round(value=interpolateNumber$1(sourceValue||0,targetValue,percent),isAutoPrecision?Math.max(getPrecision(sourceValue||0),getPrecision(targetValue)):precision);if(isString(targetValue))return percent<1?sourceValue:targetValue;for(var interpolated=[],leftArr=sourceValue,rightArr=targetValue,length_1=Math.max(leftArr?leftArr.length:0,rightArr.length),i=0;i<length_1;++i){var rightVal,value,info=data.getDimensionInfo(i);info&&"ordinal"===info.type?interpolated[i]=(percent<1&&leftArr?leftArr:rightArr)[i]:(value=interpolateNumber$1(info=leftArr&&leftArr[i]?leftArr[i]:0,rightVal=rightArr[i],percent),interpolated[i]=round(value,isAutoPrecision?Math.max(getPrecision(info),getPrecision(rightVal)):precision))}return interpolated}var TYPE_DELIMITER=".",IS_CONTAINER="___EC__COMPONENT__CONTAINER___";function parseClassType(componentType){var ret={main:"",sub:""};return componentType&&(componentType=componentType.split(TYPE_DELIMITER),ret.main=componentType[0]||"",ret.sub=componentType[1]||""),ret}function enableClassExtend(rootClz,mandatoryMethods){(rootClz.$constructor=rootClz).extend=function(proto){each(mandatoryMethods,function(method){proto[method]||console.warn("Method `"+method+"` should be implemented"+(proto.type?" in "+proto.type:"")+".")});var ExtendedClass,_super,fn,superClass=this;function class_1(){return _super.apply(this,arguments)||this}return isFunction(fn=superClass)&&/^class\s/.test(Function.prototype.toString.call(fn))?(__extends(class_1,_super=superClass),ExtendedClass=class_1):inherits(ExtendedClass=function(){(proto.$constructor||superClass).apply(this,arguments)},this),extend(ExtendedClass.prototype,proto),ExtendedClass.___EC__EXTENDED_CLASS___=!0,ExtendedClass.extend=this.extend,ExtendedClass.superCall=superCall,ExtendedClass.superApply=superApply,ExtendedClass.superClass=superClass,ExtendedClass}}function mountExtend(SubClz,SupperClz){SubClz.extend=SupperClz.extend}var classBase=Math.round(10*Math.random());function superCall(context,methodName){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];return this.superClass.prototype[methodName].apply(context,args)}function superApply(context,methodName,args){return this.superClass.prototype[methodName].apply(context,args)}function enableClassManagement(target){var storage={};target.registerClass=function(clz){var componentType,componentFullType=clz.type||clz.prototype.type;return componentFullType&&(assert(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(componentType=componentFullType),'componentType "'+componentType+'" illegal'),(componentType=parseClassType(clz.prototype.type=componentFullType)).sub?componentType.sub!==IS_CONTAINER&&(function(componentTypeInfo){var container=storage[componentTypeInfo.main];container&&container[IS_CONTAINER]||(container=storage[componentTypeInfo.main]={___EC__COMPONENT__CONTAINER___:!0});return container}(componentType)[componentType.sub]=clz):(storage[componentType.main]&&console.warn(componentType.main+" exists."),storage[componentType.main]=clz)),clz},target.getClass=function(mainType,subType,throwWhenNotFound){var clz=storage[mainType];if(clz&&clz[IS_CONTAINER]&&(clz=subType?clz[subType]:null),throwWhenNotFound&&!clz)throw new Error(subType?"Component "+mainType+"."+(subType||"")+" is used but not imported.":mainType+".type should be specified.");return clz},target.getClassesByMainType=function(componentType){var componentType=parseClassType(componentType),result=[],componentType=storage[componentType.main];return componentType&&componentType[IS_CONTAINER]?each(componentType,function(o,type){type!==IS_CONTAINER&&result.push(o)}):result.push(componentType),result},target.hasClass=function(componentType){componentType=parseClassType(componentType);return!!storage[componentType.main]},target.getAllClassMainTypes=function(){var types=[];return each(storage,function(obj,type){types.push(type)}),types},target.hasSubTypes=function(componentType){componentType=parseClassType(componentType),componentType=storage[componentType.main];return componentType&&componentType[IS_CONTAINER]}}function makeStyleMapper(properties,ignoreParent){for(var i=0;i<properties.length;i++)properties[i][1]||(properties[i][1]=properties[i][0]);return ignoreParent=ignoreParent||!1,function(model,excludes,includes){for(var style={},i=0;i<properties.length;i++){var propName=properties[i][1];excludes&&0<=indexOf(excludes,propName)||includes&&indexOf(includes,propName)<0||null!=(propName=model.getShallow(propName,ignoreParent))&&(style[properties[i][0]]=propName)}return style}}var getAreaStyle=makeStyleMapper([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]]),AreaStyleMixin=function(){function AreaStyleMixin(){}return AreaStyleMixin.prototype.getAreaStyle=function(excludes,includes){return getAreaStyle(this,excludes,includes)},AreaStyleMixin}(),globalImageCache=new LRU(50);function createOrUpdateImage(newImageOrSrc,image,hostEl,onload,cbPayload){if(newImageOrSrc){if("string"!=typeof newImageOrSrc)return newImageOrSrc;if(image&&image.__zrImageSrc===newImageOrSrc||!hostEl)return image;var cachedImgObj=globalImageCache.get(newImageOrSrc),hostEl={hostEl:hostEl,cb:onload,cbPayload:cbPayload};return cachedImgObj?isImageReady(image=cachedImgObj.image)||cachedImgObj.pending.push(hostEl):((onload=platformApi.loadImage(newImageOrSrc,imageOnLoad,imageOnLoad)).__zrImageSrc=newImageOrSrc,globalImageCache.put(newImageOrSrc,onload.__cachedImgObj={image:onload,pending:[hostEl]})),image}return image}function imageOnLoad(){var cachedImgObj=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var i=0;i<cachedImgObj.pending.length;i++){var pendingWrap=cachedImgObj.pending[i],cb=pendingWrap.cb;cb&&cb(this,pendingWrap.cbPayload),pendingWrap.hostEl.dirty()}cachedImgObj.pending.length=0}function isImageReady(image){return image&&image.width&&image.height}var STYLE_REG=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function truncateText(text,containerWidth,font,ellipsis,options){if(!containerWidth)return"";var textLines=(text+"").split("\n");options=prepareTruncateOptions(containerWidth,font,ellipsis,options);for(var i=0,len=textLines.length;i<len;i++)textLines[i]=truncateSingleLine(textLines[i],options);return textLines.join("\n")}function prepareTruncateOptions(containerWidth,font,ellipsis,options){for(var preparedOpts=extend({},options=options||{}),minChar=(preparedOpts.font=font,ellipsis=retrieve2(ellipsis,"..."),preparedOpts.maxIterations=retrieve2(options.maxIterations,2),preparedOpts.minChar=retrieve2(options.minChar,0)),ascCharWidth=(preparedOpts.cnCharWidth=getWidth("",font),preparedOpts.ascCharWidth=getWidth("a",font)),contentWidth=(preparedOpts.placeholder=retrieve2(options.placeholder,""),containerWidth=Math.max(0,containerWidth-1)),i=0;i<minChar&&ascCharWidth<=contentWidth;i++)contentWidth-=ascCharWidth;options=getWidth(ellipsis,font);return contentWidth<options&&(ellipsis="",options=0),contentWidth=containerWidth-options,preparedOpts.ellipsis=ellipsis,preparedOpts.ellipsisWidth=options,preparedOpts.contentWidth=contentWidth,preparedOpts.containerWidth=containerWidth,preparedOpts}function truncateSingleLine(textLine,options){var containerWidth=options.containerWidth,font=options.font,contentWidth=options.contentWidth;if(!containerWidth)return"";if((lineWidth=getWidth(textLine,font))<=containerWidth)return textLine;for(var j=0;;j++){if(lineWidth<=contentWidth||j>=options.maxIterations){textLine+=options.ellipsis;break}var subLength=0===j?function(text,contentWidth,ascCharWidth,cnCharWidth){for(var width=0,i=0,len=text.length;i<len&&width<contentWidth;i++){var charCode=text.charCodeAt(i);width+=0<=charCode&&charCode<=127?ascCharWidth:cnCharWidth}return i}(textLine,contentWidth,options.ascCharWidth,options.cnCharWidth):0<lineWidth?Math.floor(textLine.length*contentWidth/lineWidth):0,lineWidth=getWidth(textLine=textLine.substr(0,subLength),font)}return textLine=""===textLine?options.placeholder:textLine}var RichTextToken=function(){},RichTextLine=function(tokens){this.tokens=[],tokens&&(this.tokens=tokens)},RichTextContentBlock=function(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[]};function parseRichText(text,style){var contentBlock=new RichTextContentBlock;if(null!=text&&(text+=""),!text)return contentBlock;for(var result,topWidth=style.width,topHeight=style.height,overflow=style.overflow,wrapInfo="break"!==overflow&&"breakAll"!==overflow||null==topWidth?null:{width:topWidth,accumWidth:0,breakAll:"breakAll"===overflow},lastIndex=STYLE_REG.lastIndex=0;null!=(result=STYLE_REG.exec(text));){var matchedIndex=result.index;lastIndex<matchedIndex&&pushTokens(contentBlock,text.substring(lastIndex,matchedIndex),style,wrapInfo),pushTokens(contentBlock,result[2],style,wrapInfo,result[1]),lastIndex=STYLE_REG.lastIndex}lastIndex<text.length&&pushTokens(contentBlock,text.substring(lastIndex,text.length),style,wrapInfo);var newImageOrSrc,pendingList=[],calculatedHeight=0,calculatedWidth=0,stlPadding=style.padding,truncate="truncate"===overflow,truncateLine="truncate"===style.lineOverflow;function finishLine(line,lineWidth,lineHeight){line.width=lineWidth,line.lineHeight=lineHeight,calculatedHeight+=lineHeight,calculatedWidth=Math.max(calculatedWidth,lineWidth)}outer:for(var i=0;i<contentBlock.lines.length;i++){for(var line=contentBlock.lines[i],lineHeight=0,lineWidth=0,j=0;j<line.tokens.length;j++){var tokenStyle=(token=line.tokens[j]).styleName&&style.rich[token.styleName]||{},textPadding=token.textPadding=tokenStyle.padding,paddingH=textPadding?textPadding[1]+textPadding[3]:0,font=token.font=tokenStyle.font||style.font,tokenHeight=(token.contentHeight=getLineHeight(font),retrieve2(tokenStyle.height,token.contentHeight));if(token.innerHeight=tokenHeight,textPadding&&(tokenHeight+=textPadding[0]+textPadding[2]),token.height=tokenHeight,token.lineHeight=retrieve3(tokenStyle.lineHeight,style.lineHeight,tokenHeight),token.align=tokenStyle&&tokenStyle.align||style.align,token.verticalAlign=tokenStyle&&tokenStyle.verticalAlign||"middle",truncateLine&&null!=topHeight&&calculatedHeight+token.lineHeight>topHeight){0<j?(line.tokens=line.tokens.slice(0,j),finishLine(line,lineWidth,lineHeight),contentBlock.lines=contentBlock.lines.slice(0,i+1)):contentBlock.lines=contentBlock.lines.slice(0,i);break outer}var cachedImgObj,textPadding=tokenStyle.width,tokenWidthNotSpecified=null==textPadding||"auto"===textPadding;"string"==typeof textPadding&&"%"===textPadding.charAt(textPadding.length-1)?(token.percentWidth=textPadding,pendingList.push(token),token.contentWidth=getWidth(token.text,font)):(tokenWidthNotSpecified&&(textPadding=(textPadding=tokenStyle.backgroundColor)&&textPadding.image)&&(cachedImgObj=void 0,isImageReady(textPadding="string"==typeof(newImageOrSrc=textPadding)?(cachedImgObj=globalImageCache.get(newImageOrSrc))&&cachedImgObj.image:newImageOrSrc)&&(token.width=Math.max(token.width,textPadding.width*tokenHeight/textPadding.height))),null!=(cachedImgObj=truncate&&null!=topWidth?topWidth-lineWidth:null)&&cachedImgObj<token.width?!tokenWidthNotSpecified||cachedImgObj<paddingH?(token.text="",token.width=token.contentWidth=0):(token.text=truncateText(token.text,cachedImgObj-paddingH,font,style.ellipsis,{minChar:style.truncateMinChar}),token.width=token.contentWidth=getWidth(token.text,font)):token.contentWidth=getWidth(token.text,font)),token.width+=paddingH,lineWidth+=token.width,tokenStyle&&(lineHeight=Math.max(lineHeight,token.lineHeight))}finishLine(line,lineWidth,lineHeight)}contentBlock.outerWidth=contentBlock.width=retrieve2(topWidth,calculatedWidth),contentBlock.outerHeight=contentBlock.height=retrieve2(topHeight,calculatedHeight),contentBlock.contentHeight=calculatedHeight,contentBlock.contentWidth=calculatedWidth,stlPadding&&(contentBlock.outerWidth+=stlPadding[1]+stlPadding[3],contentBlock.outerHeight+=stlPadding[0]+stlPadding[2]);for(i=0;i<pendingList.length;i++){var token,percentWidth=(token=pendingList[i]).percentWidth;token.width=parseInt(percentWidth,10)/100*contentBlock.width}return contentBlock}function pushTokens(block,str,style,wrapInfo,styleName){var strLines,linesWidths,isEmptyStr=""===str,tokenStyle=styleName&&style.rich[styleName]||{},lines=block.lines,font=tokenStyle.font||style.font,newLine=!1;wrapInfo?(style=(block=tokenStyle.padding)?block[1]+block[3]:0,null!=tokenStyle.width&&"auto"!==tokenStyle.width?(block=parsePercent(tokenStyle.width,wrapInfo.width)+style,0<lines.length&&block+wrapInfo.accumWidth>wrapInfo.width&&(strLines=str.split("\n"),newLine=!0),wrapInfo.accumWidth=block):(block=wrapText(str,font,wrapInfo.width,wrapInfo.breakAll,wrapInfo.accumWidth),wrapInfo.accumWidth=block.accumWidth+style,linesWidths=block.linesWidths,strLines=block.lines)):strLines=str.split("\n");for(var i=0;i<strLines.length;i++){var tokens,tokensLen,text=strLines[i],token=new RichTextToken;token.styleName=styleName,token.text=text,token.isLineHolder=!text&&!isEmptyStr,"number"==typeof tokenStyle.width?token.width=tokenStyle.width:token.width=linesWidths?linesWidths[i]:getWidth(text,font),i||newLine?lines.push(new RichTextLine([token])):1===(tokensLen=(tokens=(lines[lines.length-1]||(lines[0]=new RichTextLine)).tokens).length)&&tokens[0].isLineHolder?tokens[0]=token:!text&&tokensLen&&!isEmptyStr||tokens.push(token)}}var breakCharMap=reduce(",&?/;] ".split(""),function(obj,ch){return obj[ch]=!0,obj},{});function wrapText(text,font,lineWidth,isBreakAll,lastAccumWidth){for(var lines=[],linesWidths=[],line="",currentWord="",currentWordWidth=0,accumWidth=0,i=0;i<text.length;i++){var chWidth,inWord,ch=text.charAt(i);"\n"===ch?(currentWord&&(line+=currentWord,accumWidth+=currentWordWidth),lines.push(line),linesWidths.push(accumWidth),currentWord=line="",accumWidth=currentWordWidth=0):(chWidth=getWidth(ch,font),inWord=!isBreakAll&&!function(ch){return!function(ch){return 33<=(ch=ch.charCodeAt(0))&&ch<=383}(ch)||!!breakCharMap[ch]}(ch),(lines.length?lineWidth<accumWidth+chWidth:lineWidth<lastAccumWidth+accumWidth+chWidth)?accumWidth?(line||currentWord)&&(accumWidth=inWord?(line||(line=currentWord,currentWord="",accumWidth=currentWordWidth=0),lines.push(line),linesWidths.push(accumWidth-currentWordWidth),currentWord+=ch,line="",currentWordWidth+=chWidth):(currentWord&&(line+=currentWord,currentWord="",currentWordWidth=0),lines.push(line),linesWidths.push(accumWidth),line=ch,chWidth)):inWord?(lines.push(currentWord),linesWidths.push(currentWordWidth),currentWord=ch,currentWordWidth=chWidth):(lines.push(ch),linesWidths.push(chWidth)):(accumWidth+=chWidth,inWord?(currentWord+=ch,currentWordWidth+=chWidth):(currentWord&&(line+=currentWord,currentWord="",currentWordWidth=0),line+=ch)))}return lines.length||line||(line=text,currentWord="",currentWordWidth=0),currentWord&&(line+=currentWord),line&&(lines.push(line),linesWidths.push(accumWidth)),1===lines.length&&(accumWidth+=lastAccumWidth),{accumWidth:accumWidth,lines:lines,linesWidths:linesWidths}}var STYLE_MAGIC_KEY="__zr_style_"+Math.round(10*Math.random()),DEFAULT_COMMON_STYLE={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},DEFAULT_COMMON_ANIMATION_PROPS={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}},PRIMARY_STATES_KEYS$1=(DEFAULT_COMMON_STYLE[STYLE_MAGIC_KEY]=!0,["z","z2","invisible"]),PRIMARY_STATES_KEYS_IN_HOVER_LAYER=["invisible"],Element=function(_super){function Displayable(props){return _super.call(this,props)||this}var dispProto;return __extends(Displayable,_super),Displayable.prototype._init=function(props){for(var keysArr=keys(props),i=0;i<keysArr.length;i++){var key=keysArr[i];"style"===key?this.useStyle(props[key]):_super.prototype.attrKV.call(this,key,props[key])}this.style||this.useStyle({})},Displayable.prototype.beforeBrush=function(){},Displayable.prototype.afterBrush=function(){},Displayable.prototype.innerBeforeBrush=function(){},Displayable.prototype.innerAfterBrush=function(){},Displayable.prototype.shouldBePainted=function(viewWidth,viewHeight,considerClipPath,considerAncestors){var m=this.transform;if(this.ignore||this.invisible||0===this.style.opacity||this.culling&&function(el,width,height){tmpRect.copy(el.getBoundingRect()),el.transform&&tmpRect.applyTransform(el.transform);return viewRect.width=width,viewRect.height=height,!tmpRect.intersect(viewRect)}(this,viewWidth,viewHeight)||m&&!m[0]&&!m[3])return!1;if(considerClipPath&&this.__clipPaths)for(var i=0;i<this.__clipPaths.length;++i)if(this.__clipPaths[i].isZeroArea())return!1;if(considerAncestors&&this.parent)for(var parent_1=this.parent;parent_1;){if(parent_1.ignore)return!1;parent_1=parent_1.parent}return!0},Displayable.prototype.contain=function(x,y){return this.rectContain(x,y)},Displayable.prototype.traverse=function(cb,context){cb.call(context,this)},Displayable.prototype.rectContain=function(x,y){x=this.transformCoordToLocal(x,y);return this.getBoundingRect().contain(x[0],x[1])},Displayable.prototype.getPaintRect=function(){var elRect,shadowSize,shadowOffsetX,style,transform,rect=this._paintRect;return this._paintRect&&!this.__dirty||(transform=this.transform,elRect=this.getBoundingRect(),shadowSize=(style=this.style).shadowBlur||0,shadowOffsetX=style.shadowOffsetX||0,style=style.shadowOffsetY||0,rect=this._paintRect||(this._paintRect=new BoundingRect(0,0,0,0)),transform?BoundingRect.applyTransform(rect,elRect,transform):rect.copy(elRect),(shadowSize||shadowOffsetX||style)&&(rect.width+=2*shadowSize+Math.abs(shadowOffsetX),rect.height+=2*shadowSize+Math.abs(style),rect.x=Math.min(rect.x,rect.x+shadowOffsetX-shadowSize),rect.y=Math.min(rect.y,rect.y+style-shadowSize)),transform=this.dirtyRectTolerance,rect.isZero()||(rect.x=Math.floor(rect.x-transform),rect.y=Math.floor(rect.y-transform),rect.width=Math.ceil(rect.width+1+2*transform),rect.height=Math.ceil(rect.height+1+2*transform))),rect},Displayable.prototype.setPrevPaintRect=function(paintRect){paintRect?(this._prevPaintRect=this._prevPaintRect||new BoundingRect(0,0,0,0),this._prevPaintRect.copy(paintRect)):this._prevPaintRect=null},Displayable.prototype.getPrevPaintRect=function(){return this._prevPaintRect},Displayable.prototype.animateStyle=function(loop){return this.animate("style",loop)},Displayable.prototype.updateDuringAnimation=function(targetKey){"style"===targetKey?this.dirtyStyle():this.markRedraw()},Displayable.prototype.attrKV=function(key,value){"style"!==key?_super.prototype.attrKV.call(this,key,value):this.style?this.setStyle(value):this.useStyle(value)},Displayable.prototype.setStyle=function(keyOrObj,value){return"string"==typeof keyOrObj?this.style[keyOrObj]=value:extend(this.style,keyOrObj),this.dirtyStyle(),this},Displayable.prototype.dirtyStyle=function(notRedraw){notRedraw||this.markRedraw(),this.__dirty|=2,this._rect&&(this._rect=null)},Displayable.prototype.dirty=function(){this.dirtyStyle()},Displayable.prototype.styleChanged=function(){return!!(2&this.__dirty)},Displayable.prototype.styleUpdated=function(){this.__dirty&=-3},Displayable.prototype.createStyle=function(obj){return createObject(DEFAULT_COMMON_STYLE,obj)},Displayable.prototype.useStyle=function(obj){obj[STYLE_MAGIC_KEY]||(obj=this.createStyle(obj)),this.__inHover?this.__hoverStyle=obj:this.style=obj,this.dirtyStyle()},Displayable.prototype.isStyleObject=function(obj){return obj[STYLE_MAGIC_KEY]},Displayable.prototype._innerSaveToNormal=function(toState){_super.prototype._innerSaveToNormal.call(this,toState);var normalState=this._normalState;toState.style&&!normalState.style&&(normalState.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(toState,normalState,PRIMARY_STATES_KEYS$1)},Displayable.prototype._applyStateObj=function(stateName,state,normalState,keepCurrentStates,transition,animationCfg){_super.prototype._applyStateObj.call(this,stateName,state,normalState,keepCurrentStates,transition,animationCfg);var targetStyle,needsRestoreToNormal=!(state&&keepCurrentStates);if(state&&state.style?transition?keepCurrentStates?targetStyle=state.style:(targetStyle=this._mergeStyle(this.createStyle(),normalState.style),this._mergeStyle(targetStyle,state.style)):(targetStyle=this._mergeStyle(this.createStyle(),(keepCurrentStates?this:normalState).style),this._mergeStyle(targetStyle,state.style)):needsRestoreToNormal&&(targetStyle=normalState.style),targetStyle)if(transition){var sourceStyle=this.style;if(this.style=this.createStyle(needsRestoreToNormal?{}:sourceStyle),needsRestoreToNormal)for(var changedKeys=keys(sourceStyle),i=0;i<changedKeys.length;i++)(key=changedKeys[i])in targetStyle&&(targetStyle[key]=targetStyle[key],this.style[key]=sourceStyle[key]);for(var targetKeys=keys(targetStyle),i=0;i<targetKeys.length;i++){var key=targetKeys[i];this.style[key]=this.style[key]}this._transitionState(stateName,{style:targetStyle},animationCfg,this.getAnimationStyleProps())}else this.useStyle(targetStyle);for(var statesKeys=this.__inHover?PRIMARY_STATES_KEYS_IN_HOVER_LAYER:PRIMARY_STATES_KEYS$1,i=0;i<statesKeys.length;i++){key=statesKeys[i];state&&null!=state[key]?this[key]=state[key]:needsRestoreToNormal&&null!=normalState[key]&&(this[key]=normalState[key])}},Displayable.prototype._mergeStates=function(states){for(var mergedStyle,mergedState=_super.prototype._mergeStates.call(this,states),i=0;i<states.length;i++){var state=states[i];state.style&&this._mergeStyle(mergedStyle=mergedStyle||{},state.style)}return mergedStyle&&(mergedState.style=mergedStyle),mergedState},Displayable.prototype._mergeStyle=function(targetStyle,sourceStyle){return extend(targetStyle,sourceStyle),targetStyle},Displayable.prototype.getAnimationStyleProps=function(){return DEFAULT_COMMON_ANIMATION_PROPS},Displayable.initDefaultProps=((dispProto=Displayable.prototype).type="displayable",dispProto.invisible=!1,dispProto.z=0,dispProto.z2=0,dispProto.zlevel=0,dispProto.culling=!1,dispProto.cursor="pointer",dispProto.rectHover=!1,dispProto.incremental=!1,dispProto._rect=null,dispProto.dirtyRectTolerance=0,void(dispProto.__dirty=2|REDRAW_BIT)),Displayable}(Element),tmpRect=new BoundingRect(0,0,0,0),viewRect=new BoundingRect(0,0,0,0);var mathMin$2=Math.min,mathMax$2=Math.max,mathSin$1=Math.sin,mathCos$1=Math.cos,PI2$1=2*Math.PI,start=create(),end=create(),extremity=create();function fromLine(x0,y0,x1,y1,min$$1,max$$1){min$$1[0]=mathMin$2(x0,x1),min$$1[1]=mathMin$2(y0,y1),max$$1[0]=mathMax$2(x0,x1),max$$1[1]=mathMax$2(y0,y1)}var xDim=[],yDim=[];var CMD={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},tmpOutX=[],tmpOutY=[],min$1=[],max$1=[],min2=[],max2=[],mathMin$1=Math.min,mathMax$1=Math.max,mathCos=Math.cos,mathSin=Math.sin,mathAbs=Math.abs,PI=Math.PI,PI2=2*PI,hasTypedArray="undefined"!=typeof Float32Array,tmpAngles=[];function modPI2(radian){return Math.round(radian/PI*1e8)/1e8%2*PI}var PathProxy=function(){function PathProxy(notSaveData){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,notSaveData&&(this._saveData=!1),this._saveData&&(this.data=[])}var proto;return PathProxy.prototype.increaseVersion=function(){this._version++},PathProxy.prototype.getVersion=function(){return this._version},PathProxy.prototype.setScale=function(sx,sy,segmentIgnoreThreshold){0<(segmentIgnoreThreshold=segmentIgnoreThreshold||0)&&(this._ux=mathAbs(segmentIgnoreThreshold/devicePixelRatio/sx)||0,this._uy=mathAbs(segmentIgnoreThreshold/devicePixelRatio/sy)||0)},PathProxy.prototype.setDPR=function(dpr){this.dpr=dpr},PathProxy.prototype.setContext=function(ctx){this._ctx=ctx},PathProxy.prototype.getContext=function(){return this._ctx},PathProxy.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},PathProxy.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},PathProxy.prototype.moveTo=function(x,y){return this._drawPendingPt(),this.addData(CMD.M,x,y),this._ctx&&this._ctx.moveTo(x,y),this._x0=x,this._y0=y,this._xi=x,this._yi=y,this},PathProxy.prototype.lineTo=function(x,y){var dx=mathAbs(x-this._xi),dy=mathAbs(y-this._yi),exceedUnit=dx>this._ux||dy>this._uy;return this.addData(CMD.L,x,y),this._ctx&&exceedUnit&&this._ctx.lineTo(x,y),exceedUnit?(this._xi=x,this._yi=y,this._pendingPtDist=0):(exceedUnit=dx*dx+dy*dy)>this._pendingPtDist&&(this._pendingPtX=x,this._pendingPtY=y,this._pendingPtDist=exceedUnit),this},PathProxy.prototype.bezierCurveTo=function(x1,y1,x2,y2,x3,y3){return this._drawPendingPt(),this.addData(CMD.C,x1,y1,x2,y2,x3,y3),this._ctx&&this._ctx.bezierCurveTo(x1,y1,x2,y2,x3,y3),this._xi=x3,this._yi=y3,this},PathProxy.prototype.quadraticCurveTo=function(x1,y1,x2,y2){return this._drawPendingPt(),this.addData(CMD.Q,x1,y1,x2,y2),this._ctx&&this._ctx.quadraticCurveTo(x1,y1,x2,y2),this._xi=x2,this._yi=y2,this},PathProxy.prototype.arc=function(cx,cy,r,startAngle,endAngle,anticlockwise){return this._drawPendingPt(),tmpAngles[0]=startAngle,tmpAngles[1]=endAngle,function(angles,anticlockwise){var newStartAngle=modPI2(angles[0]),delta=(newStartAngle<0&&(newStartAngle+=PI2),newStartAngle-angles[0]),newEndAngle=angles[1];newEndAngle+=delta,!anticlockwise&&PI2<=newEndAngle-newStartAngle?newEndAngle=newStartAngle+PI2:anticlockwise&&PI2<=newStartAngle-newEndAngle?newEndAngle=newStartAngle-PI2:!anticlockwise&&newEndAngle<newStartAngle?newEndAngle=newStartAngle+(PI2-modPI2(newStartAngle-newEndAngle)):anticlockwise&&newStartAngle<newEndAngle&&(newEndAngle=newStartAngle-(PI2-modPI2(newEndAngle-newStartAngle))),angles[0]=newStartAngle,angles[1]=newEndAngle}(tmpAngles,anticlockwise),startAngle=tmpAngles[0],endAngle=tmpAngles[1],this.addData(CMD.A,cx,cy,r,r,startAngle,endAngle-startAngle,0,anticlockwise?0:1),this._ctx&&this._ctx.arc(cx,cy,r,startAngle,endAngle,anticlockwise),this._xi=mathCos(endAngle)*r+cx,this._yi=mathSin(endAngle)*r+cy,this},PathProxy.prototype.arcTo=function(x1,y1,x2,y2,radius){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(x1,y1,x2,y2,radius),this},PathProxy.prototype.rect=function(x,y,w,h){return this._drawPendingPt(),this._ctx&&this._ctx.rect(x,y,w,h),this.addData(CMD.R,x,y,w,h),this},PathProxy.prototype.closePath=function(){this._drawPendingPt(),this.addData(CMD.Z);var ctx=this._ctx,x0=this._x0,y0=this._y0;return ctx&&ctx.closePath(),this._xi=x0,this._yi=y0,this},PathProxy.prototype.fill=function(ctx){ctx&&ctx.fill(),this.toStatic()},PathProxy.prototype.stroke=function(ctx){ctx&&ctx.stroke(),this.toStatic()},PathProxy.prototype.len=function(){return this._len},PathProxy.prototype.setData=function(data){var len$$1=data.length;this.data&&this.data.length===len$$1||!hasTypedArray||(this.data=new Float32Array(len$$1));for(var i=0;i<len$$1;i++)this.data[i]=data[i];this._len=len$$1},PathProxy.prototype.appendPath=function(path){for(var len$$1=(path=path instanceof Array?path:[path]).length,appendSize=0,offset=this._len,i=0;i<len$$1;i++)appendSize+=path[i].len();hasTypedArray&&this.data instanceof Float32Array&&(this.data=new Float32Array(offset+appendSize));for(i=0;i<len$$1;i++)for(var appendPathData=path[i].data,k=0;k<appendPathData.length;k++)this.data[offset++]=appendPathData[k];this._len=offset},PathProxy.prototype.addData=function(cmd,a,b,c,d,e,f,g,h){if(this._saveData){var data=this.data;this._len+arguments.length>data.length&&(this._expandData(),data=this.data);for(var i=0;i<arguments.length;i++)data[this._len++]=arguments[i]}},PathProxy.prototype._drawPendingPt=function(){0<this._pendingPtDist&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},PathProxy.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var newData=[],i=0;i<this._len;i++)newData[i]=this.data[i];this.data=newData}},PathProxy.prototype.toStatic=function(){var data;this._saveData&&(this._drawPendingPt(),(data=this.data)instanceof Array&&(data.length=this._len,hasTypedArray&&11<this._len&&(this.data=new Float32Array(data))))},PathProxy.prototype.getBoundingRect=function(){min$1[0]=min$1[1]=min2[0]=min2[1]=Number.MAX_VALUE,max$1[0]=max$1[1]=max2[0]=max2[1]=-Number.MAX_VALUE;for(var data=this.data,xi=0,yi=0,x0=0,y0=0,i=0;i<this._len;){var cmd=data[i++],isFirst=1===i;switch(isFirst&&(x0=xi=data[i],y0=yi=data[i+1]),cmd){case CMD.M:xi=x0=data[i++],yi=y0=data[i++],min2[0]=x0,min2[1]=y0,max2[0]=x0,max2[1]=y0;break;case CMD.L:fromLine(xi,yi,data[i],data[i+1],min2,max2),xi=data[i++],yi=data[i++];break;case CMD.C:!function(x0,y0,x1,y1,x2,y2,x3,y3,min$$1,max$$1){var cubicExtrema$$1=cubicExtrema,cubicAt$$1=cubicAt,n=cubicExtrema$$1(x0,x1,x2,x3,xDim);min$$1[0]=1/0,min$$1[1]=1/0,max$$1[0]=-1/0,max$$1[1]=-1/0;for(var i=0;i<n;i++){var x=cubicAt$$1(x0,x1,x2,x3,xDim[i]);min$$1[0]=mathMin$2(x,min$$1[0]),max$$1[0]=mathMax$2(x,max$$1[0])}for(n=cubicExtrema$$1(y0,y1,y2,y3,yDim),i=0;i<n;i++){var y=cubicAt$$1(y0,y1,y2,y3,yDim[i]);min$$1[1]=mathMin$2(y,min$$1[1]),max$$1[1]=mathMax$2(y,max$$1[1])}min$$1[0]=mathMin$2(x0,min$$1[0]),max$$1[0]=mathMax$2(x0,max$$1[0]),min$$1[0]=mathMin$2(x3,min$$1[0]),max$$1[0]=mathMax$2(x3,max$$1[0]),min$$1[1]=mathMin$2(y0,min$$1[1]),max$$1[1]=mathMax$2(y0,max$$1[1]),min$$1[1]=mathMin$2(y3,min$$1[1]),max$$1[1]=mathMax$2(y3,max$$1[1])}(xi,yi,data[i++],data[i++],data[i++],data[i++],data[i],data[i+1],min2,max2),xi=data[i++],yi=data[i++];break;case CMD.Q:!function(x0,y0,x1,y1,x2,y2,min$$1,max$$1){var quadraticAt$$1=quadraticAt,tx=mathMax$2(mathMin$2((quadraticExtremum$$1=quadraticExtremum)(x0,x1,x2),1),0),quadraticExtremum$$1=mathMax$2(mathMin$2(quadraticExtremum$$1(y0,y1,y2),1),0),x1=quadraticAt$$1(x0,x1,x2,tx),tx=quadraticAt$$1(y0,y1,y2,quadraticExtremum$$1);min$$1[0]=mathMin$2(x0,x2,x1),min$$1[1]=mathMin$2(y0,y2,tx),max$$1[0]=mathMax$2(x0,x2,x1),max$$1[1]=mathMax$2(y0,y2,tx)}(xi,yi,data[i++],data[i++],data[i],data[i+1],min2,max2),xi=data[i++],yi=data[i++];break;case CMD.A:var cx=data[i++],cy=data[i++],rx=data[i++],ry=data[i++],startAngle=data[i++],endAngle=data[i++]+startAngle,anticlockwise=(i+=1,!data[i++]);isFirst&&(x0=mathCos(startAngle)*rx+cx,y0=mathSin(startAngle)*ry+cy),!function(x,y,rx,ry,startAngle,endAngle,anticlockwise,min$$1,max$$1){var vec2Min=min,vec2Max=max,diff=Math.abs(startAngle-endAngle);if(diff%PI2$1<1e-4&&1e-4<diff)return min$$1[0]=x-rx,min$$1[1]=y-ry,max$$1[0]=x+rx,max$$1[1]=y+ry;start[0]=mathCos$1(startAngle)*rx+x,start[1]=mathSin$1(startAngle)*ry+y,end[0]=mathCos$1(endAngle)*rx+x,end[1]=mathSin$1(endAngle)*ry+y,vec2Min(min$$1,start,end),vec2Max(max$$1,start,end),(startAngle%=PI2$1)<0&&(startAngle+=PI2$1),(endAngle%=PI2$1)<0&&(endAngle+=PI2$1),endAngle<startAngle&&!anticlockwise?endAngle+=PI2$1:startAngle<endAngle&&anticlockwise&&(startAngle+=PI2$1),anticlockwise&&(diff=endAngle,endAngle=startAngle,startAngle=diff);for(var angle=0;angle<endAngle;angle+=Math.PI/2)startAngle<angle&&(extremity[0]=mathCos$1(angle)*rx+x,extremity[1]=mathSin$1(angle)*ry+y,vec2Min(min$$1,extremity,min$$1),vec2Max(max$$1,extremity,max$$1))}(cx,cy,rx,ry,startAngle,endAngle,anticlockwise,min2,max2),xi=mathCos(endAngle)*rx+cx,yi=mathSin(endAngle)*ry+cy;break;case CMD.R:fromLine(x0=xi=data[i++],y0=yi=data[i++],x0+data[i++],y0+data[i++],min2,max2);break;case CMD.Z:xi=x0,yi=y0}min(min$1,min$1,min2),max(max$1,max$1,max2)}return 0===i&&(min$1[0]=min$1[1]=max$1[0]=max$1[1]=0),new BoundingRect(min$1[0],min$1[1],max$1[0]-min$1[0],max$1[1]-min$1[1])},PathProxy.prototype._calculateLength=function(){for(var data=this.data,len$$1=this._len,ux=this._ux,uy=this._uy,xi=0,yi=0,x0=0,y0=0,pathSegLen=(this._pathSegLen||(this._pathSegLen=[]),this._pathSegLen),pathTotalLen=0,segCount=0,i=0;i<len$$1;){var cmd=data[i++],isFirst=1===i,l=(isFirst&&(x0=xi=data[i],y0=yi=data[i+1]),-1);switch(cmd){case CMD.M:xi=x0=data[i++],yi=y0=data[i++];break;case CMD.L:var x2=data[i++],dy=(y2=data[i++])-yi;(mathAbs(dx=x2-xi)>ux||mathAbs(dy)>uy||i===len$$1-1)&&(l=Math.sqrt(dx*dx+dy*dy),xi=x2,yi=y2);break;case CMD.C:var x1=data[i++],y1=data[i++],x2=data[i++],y2=data[i++],x3=data[i++],y3=data[i++],l=function(x0,y0,x1,y1,x2,y2,x3,y3,iteration){for(var px=x0,py=y0,d=0,step=1/iteration,i=1;i<=iteration;i++){var t=i*step,x=cubicAt(x0,x1,x2,x3,t),t=cubicAt(y0,y1,y2,y3,t),dx=x-px,dy=t-py;d+=Math.sqrt(dx*dx+dy*dy),px=x,py=t}return d}(xi,yi,x1,y1,x2,y2,x3,y3,10),xi=x3,yi=y3;break;case CMD.Q:l=function(x0,y0,x1,y1,x2,y2,iteration){for(var px=x0,py=y0,d=0,step=1/iteration,i=1;i<=iteration;i++){var t=i*step,x=quadraticAt(x0,x1,x2,t),t=quadraticAt(y0,y1,y2,t),dx=x-px,dy=t-py;d+=Math.sqrt(dx*dx+dy*dy),px=x,py=t}return d}(xi,yi,x1=data[i++],y1=data[i++],x2=data[i++],y2=data[i++],10),xi=x2,yi=y2;break;case CMD.A:var x3=data[i++],y3=data[i++],rx=data[i++],ry=data[i++],startAngle=data[i++],delta=data[i++],endAngle=delta+startAngle;i+=1,data[i++];isFirst&&(x0=mathCos(startAngle)*rx+x3,y0=mathSin(startAngle)*ry+y3),l=mathMax$1(rx,ry)*mathMin$1(PI2,Math.abs(delta)),xi=mathCos(endAngle)*rx+x3,yi=mathSin(endAngle)*ry+y3;break;case CMD.R:x0=xi=data[i++],y0=yi=data[i++];l=2*data[i++]+2*data[i++];break;case CMD.Z:var dx=x0-xi,dy=y0-yi;l=Math.sqrt(dx*dx+dy*dy),xi=x0,yi=y0}0<=l&&(pathTotalLen+=pathSegLen[segCount++]=l)}return this._pathLen=pathTotalLen},PathProxy.prototype.rebuildPath=function(ctx,percent){var x0,y0,xi,yi,pathSegLen,displayedLength,pendingPtX,pendingPtY,d=this.data,ux=this._ux,uy=this._uy,len$$1=this._len,drawPart=percent<1,accumLength=0,segCount=0,pendingPtDist=0;if(!drawPart||(this._pathSegLen||this._calculateLength(),pathSegLen=this._pathSegLen,displayedLength=percent*this._pathLen))lo:for(var i=0;i<len$$1;){var cmd=d[i++],isFirst=1===i;switch(isFirst&&(x0=xi=d[i],y0=yi=d[i+1]),cmd!==CMD.L&&0<pendingPtDist&&(ctx.lineTo(pendingPtX,pendingPtY),pendingPtDist=0),cmd){case CMD.M:x0=xi=d[i++],y0=yi=d[i++],ctx.moveTo(xi,yi);break;case CMD.L:var x=d[i++],y=d[i++],dx=mathAbs(x-xi),dy=mathAbs(y-yi);if(ux<dx||uy<dy){if(drawPart){if(displayedLength<accumLength+(l=pathSegLen[segCount++])){var t=(displayedLength-accumLength)/l;ctx.lineTo(xi*(1-t)+x*t,yi*(1-t)+y*t);break lo}accumLength+=l}ctx.lineTo(x,y),xi=x,yi=y,pendingPtDist=0}else{dx=dx*dx+dy*dy;pendingPtDist<dx&&(pendingPtX=x,pendingPtY=y,pendingPtDist=dx)}break;case CMD.C:var x1=d[i++],y1=d[i++],x2=d[i++],y2=d[i++],dy=d[i++],dx=d[i++];if(drawPart){if(displayedLength<accumLength+(l=pathSegLen[segCount++])){cubicSubdivide(xi,x1,x2,dy,t=(displayedLength-accumLength)/l,tmpOutX),cubicSubdivide(yi,y1,y2,dx,t,tmpOutY),ctx.bezierCurveTo(tmpOutX[1],tmpOutY[1],tmpOutX[2],tmpOutY[2],tmpOutX[3],tmpOutY[3]);break lo}accumLength+=l}ctx.bezierCurveTo(x1,y1,x2,y2,dy,dx),xi=dy,yi=dx;break;case CMD.Q:x1=d[i++],y1=d[i++],x2=d[i++],y2=d[i++];if(drawPart){if(displayedLength<accumLength+(l=pathSegLen[segCount++])){quadraticSubdivide(xi,x1,x2,t=(displayedLength-accumLength)/l,tmpOutX),quadraticSubdivide(yi,y1,y2,t,tmpOutY),ctx.quadraticCurveTo(tmpOutX[1],tmpOutY[1],tmpOutX[2],tmpOutY[2]);break lo}accumLength+=l}ctx.quadraticCurveTo(x1,y1,x2,y2),xi=x2,yi=y2;break;case CMD.A:var cx=d[i++],cy=d[i++],rx=d[i++],ry=d[i++],startAngle=d[i++],delta=d[i++],psi=d[i++],anticlockwise=!d[i++],r=ry<rx?rx:ry,isEllipse=.001<mathAbs(rx-ry),endAngle=startAngle+delta,breakBuild=!1;if(drawPart&&(displayedLength<accumLength+(l=pathSegLen[segCount++])&&(endAngle=startAngle+delta*(displayedLength-accumLength)/l,breakBuild=!0),accumLength+=l),isEllipse&&ctx.ellipse?ctx.ellipse(cx,cy,rx,ry,psi,startAngle,endAngle,anticlockwise):ctx.arc(cx,cy,r,startAngle,endAngle,anticlockwise),breakBuild)break lo;isFirst&&(x0=mathCos(startAngle)*rx+cx,y0=mathSin(startAngle)*ry+cy),xi=mathCos(endAngle)*rx+cx,yi=mathSin(endAngle)*ry+cy;break;case CMD.R:x0=xi=d[i],y0=yi=d[i+1],x=d[i++],y=d[i++];var l,delta=d[i++],isEllipse=d[i++];if(drawPart){if(displayedLength<accumLength+(l=pathSegLen[segCount++])){psi=displayedLength-accumLength;ctx.moveTo(x,y),ctx.lineTo(x+mathMin$1(psi,delta),y),0<(psi-=delta)&&ctx.lineTo(x+delta,y+mathMin$1(psi,isEllipse)),0<(psi-=isEllipse)&&ctx.lineTo(x+mathMax$1(delta-psi,0),y+isEllipse),0<(psi-=delta)&&ctx.lineTo(x,y+mathMax$1(isEllipse-psi,0));break lo}accumLength+=l}ctx.rect(x,y,delta,isEllipse);break;case CMD.Z:if(drawPart){if(displayedLength<accumLength+(l=pathSegLen[segCount++])){t=(displayedLength-accumLength)/l;ctx.lineTo(xi*(1-t)+x0*t,yi*(1-t)+y0*t);break lo}accumLength+=l}ctx.closePath(),xi=x0,yi=y0}}},PathProxy.prototype.clone=function(){var newProxy=new PathProxy,data=this.data;return newProxy.data=data.slice?data.slice():Array.prototype.slice.call(data),newProxy._len=this._len,newProxy},PathProxy.CMD=CMD,PathProxy.initDefaultProps=((proto=PathProxy.prototype)._saveData=!0,proto._ux=0,proto._uy=0,proto._pendingPtDist=0,void(proto._version=0)),PathProxy}();function containStroke$1(x0,y0,x1,y1,lineWidth,x,y){if(0!==lineWidth){var _a=0;if(!(y0+lineWidth<y&&y1+lineWidth<y||y<y0-lineWidth&&y<y1-lineWidth||x0+lineWidth<x&&x1+lineWidth<x||x<x0-lineWidth&&x<x1-lineWidth)){if(x0===x1)return Math.abs(x-x0)<=lineWidth/2;x=(_a=(y0-y1)/(x0-x1))*x-y+(x0*y1-x1*y0)/(x0-x1);return x*x/(_a*_a+1)<=lineWidth/2*lineWidth/2}}}var PI2$4=2*Math.PI;function normalizeRadian(angle){return(angle%=PI2$4)<0&&(angle+=PI2$4),angle}var PI2$3=2*Math.PI;function windingLine(x0,y0,x1,y1,x,y){if(y0<y&&y1<y||y<y0&&y<y1)return 0;if(y1===y0)return 0;var y=(y-y0)/(y1-y0),dir=y1<y0?1:-1,y1=(1!=y&&0!=y||(dir=y1<y0?.5:-.5),y*(x1-x0)+x0);return y1===x?1/0:x<y1?dir:0}var CMD$1=PathProxy.CMD,PI2$2=2*Math.PI,EPSILON$3=1e-4;var roots=[-1,-1,-1],extrema=[-1,-1];function windingCubic(x0,y0,x1,y1,x2,y2,x3,y3,x,y){if(y0<y&&y1<y&&y2<y&&y3<y||y<y0&&y<y1&&y<y2&&y<y3)return 0;var nRoots=cubicRootAt(y0,y1,y2,y3,y,roots);if(0===nRoots)return 0;for(var tmp,w=0,nExtrema=-1,y0_=void 0,y1_=void 0,i=0;i<nRoots;i++){var t=roots[i],unit=0===t||1===t?.5:1;cubicAt(x0,x1,x2,x3,t)<x||(nExtrema<0&&(nExtrema=cubicExtrema(y0,y1,y2,y3,extrema),extrema[1]<extrema[0]&&1<nExtrema&&(tmp=void 0,tmp=extrema[0],extrema[0]=extrema[1],extrema[1]=tmp),y0_=cubicAt(y0,y1,y2,y3,extrema[0]),1<nExtrema&&(y1_=cubicAt(y0,y1,y2,y3,extrema[1]))),2===nExtrema?t<extrema[0]?w+=y0_<y0?unit:-unit:t<extrema[1]?w+=y1_<y0_?unit:-unit:w+=y3<y1_?unit:-unit:t<extrema[0]?w+=y0_<y0?unit:-unit:w+=y3<y0_?unit:-unit)}return w}function windingQuadratic(x0,y0,x1,y1,x2,y2,x,y){if(y0<y&&y1<y&&y2<y||y<y0&&y<y1&&y<y2)return 0;var nRoots=function(p0,p1,p2,val,roots){var t1,t2,p2=p0-2*p1+p2,p1=2*(p1-p0),p0=p0-val,val=0;return isAroundZero(p2)?isNotAroundZero(p1)&&0<=(t1=-p0/p1)&&t1<=1&&(roots[val++]=t1):isAroundZero(p0=p1*p1-4*p2*p0)?0<=(t1=-p1/(2*p2))&&t1<=1&&(roots[val++]=t1):0<p0&&(t2=(-p1-(p0=mathSqrt(p0)))/(2*p2),0<=(t1=(-p1+p0)/(2*p2))&&t1<=1&&(roots[val++]=t1),0<=t2&&t2<=1&&(roots[val++]=t2)),val}(y0,y1,y2,y,roots);if(0===nRoots)return 0;var t=quadraticExtremum(y0,y1,y2);if(0<=t&&t<=1){for(var w=0,y_=quadraticAt(y0,y1,y2,t),i=0;i<nRoots;i++){var unit=0===roots[i]||1===roots[i]?.5:1;quadraticAt(x0,x1,x2,roots[i])<x||(roots[i]<t?w+=y_<y0?unit:-unit:w+=y2<y_?unit:-unit)}return w}return unit=0===roots[0]||1===roots[0]?.5:1,quadraticAt(x0,x1,x2,roots[0])<x?0:y2<y0?unit:-unit}function containPath(path,lineWidth,isStroke,x,y){for(var b,data=path.data,len=path.len(),w=0,xi=0,yi=0,x0=0,y0=0,i=0;i<len;){var cmd=data[i++],isFirst=1===i;switch(cmd===CMD$1.M&&1<i&&(isStroke||(w+=windingLine(xi,yi,x0,y0,x,y))),isFirst&&(x0=xi=data[i],y0=yi=data[i+1]),cmd){case CMD$1.M:xi=x0=data[i++],yi=y0=data[i++];break;case CMD$1.L:if(isStroke){if(containStroke$1(xi,yi,data[i],data[i+1],lineWidth,x,y))return!0}else w+=windingLine(xi,yi,data[i],data[i+1],x,y)||0;xi=data[i++],yi=data[i++];break;case CMD$1.C:if(isStroke){if(function(x0,y0,x1,y1,x2,y2,x3,y3,lineWidth,x,y){if(0!==lineWidth)return y0+lineWidth<y&&y1+lineWidth<y&&y2+lineWidth<y&&y3+lineWidth<y||y<y0-lineWidth&&y<y1-lineWidth&&y<y2-lineWidth&&y<y3-lineWidth||x0+lineWidth<x&&x1+lineWidth<x&&x2+lineWidth<x&&x3+lineWidth<x||x<x0-lineWidth&&x<x1-lineWidth&&x<x2-lineWidth&&x<x3-lineWidth?void 0:cubicProjectPoint(x0,y0,x1,y1,x2,y2,x3,y3,x,y,null)<=lineWidth/2}(xi,yi,data[i++],data[i++],data[i++],data[i++],data[i],data[i+1],lineWidth,x,y))return!0}else w+=windingCubic(xi,yi,data[i++],data[i++],data[i++],data[i++],data[i],data[i+1],x,y)||0;xi=data[i++],yi=data[i++];break;case CMD$1.Q:if(isStroke){if(function(x0,y0,x1,y1,x2,y2,lineWidth,x,y){if(0!==lineWidth)return y0+lineWidth<y&&y1+lineWidth<y&&y2+lineWidth<y||y<y0-lineWidth&&y<y1-lineWidth&&y<y2-lineWidth||x0+lineWidth<x&&x1+lineWidth<x&&x2+lineWidth<x||x<x0-lineWidth&&x<x1-lineWidth&&x<x2-lineWidth?void 0:quadraticProjectPoint(x0,y0,x1,y1,x2,y2,x,y,null)<=lineWidth/2}(xi,yi,data[i++],data[i++],data[i],data[i+1],lineWidth,x,y))return!0}else w+=windingQuadratic(xi,yi,data[i++],data[i++],data[i],data[i+1],x,y)||0;xi=data[i++],yi=data[i++];break;case CMD$1.A:var cx=data[i++],cy=data[i++],rx=data[i++],ry=data[i++],theta=data[i++],dTheta=data[i++],anticlockwise=(i+=1,!!(1-data[i++])),x1=Math.cos(theta)*rx+cx,y1=Math.sin(theta)*ry+cy,_x=(isFirst?(x0=x1,y0=y1):w+=windingLine(xi,yi,x1,y1,x,y),(x-cx)*ry/rx+cx);if(isStroke){if(function(cx,cy,r,startAngle,endAngle,anticlockwise,lineWidth,x,y){if(0!==lineWidth){cx=(x-=cx,y-=cy,Math.sqrt(x*x+y*y));if(!(r<cx-lineWidth||cx+lineWidth<r)){if(Math.abs(startAngle-endAngle)%PI2$3<1e-4)return 1;(endAngle=anticlockwise?(cy=startAngle,startAngle=normalizeRadian(endAngle),normalizeRadian(cy)):(startAngle=normalizeRadian(startAngle),normalizeRadian(endAngle)))<startAngle&&(endAngle+=PI2$3);cx=Math.atan2(y,x);return cx<0&&(cx+=PI2$3),startAngle<=cx&&cx<=endAngle||startAngle<=cx+PI2$3&&cx+PI2$3<=endAngle}}}(cx,cy,ry,theta,theta+dTheta,anticlockwise,lineWidth,_x,y))return!0}else w+=function(cx,cy,r,startAngle,endAngle,anticlockwise,x,y){if(r<(y-=cy)||y<-r)return 0;var cy=Math.sqrt(r*r-y*y);if(roots[0]=-cy,roots[1]=cy,(r=Math.abs(startAngle-endAngle))<1e-4)return 0;if(PI2$2-1e-4<=r)return endAngle=PI2$2,dir=anticlockwise?1:-1,x>=roots[startAngle=0]+cx&&x<=roots[1]+cx?dir:0;endAngle<startAngle&&(cy=startAngle,startAngle=endAngle,endAngle=cy),startAngle<0&&(startAngle+=PI2$2,endAngle+=PI2$2);for(var w=0,i=0;i<2;i++){var dir,x_=roots[i];x<x_+cx&&(dir=anticlockwise?1:-1,(startAngle<=(x_=(x_=Math.atan2(y,x_))<0?PI2$2+x_:x_)&&x_<=endAngle||startAngle<=x_+PI2$2&&x_+PI2$2<=endAngle)&&(w+=dir=x_>Math.PI/2&&x_<1.5*Math.PI?-dir:dir))}return w}(cx,cy,ry,theta,theta+dTheta,anticlockwise,_x,y);xi=Math.cos(theta+dTheta)*rx+cx,yi=Math.sin(theta+dTheta)*ry+cy;break;case CMD$1.R:x0=xi=data[i++],y0=yi=data[i++];if(x1=x0+data[i++],y1=y0+data[i++],isStroke){if(containStroke$1(x0,y0,x1,y0,lineWidth,x,y)||containStroke$1(x1,y0,x1,y1,lineWidth,x,y)||containStroke$1(x1,y1,x0,y1,lineWidth,x,y)||containStroke$1(x0,y1,x0,y0,lineWidth,x,y))return!0}else w=(w+=windingLine(x1,y0,x1,y1,x,y))+windingLine(x0,y1,x0,y0,x,y);break;case CMD$1.Z:if(isStroke){if(containStroke$1(xi,yi,x0,y0,lineWidth,x,y))return!0}else w+=windingLine(xi,yi,x0,y0,x,y);xi=x0,yi=y0}}return isStroke||(path=yi,b=y0,Math.abs(path-b)<EPSILON$3)||(w+=windingLine(xi,yi,x0,y0,x,y)||0),0!==w}var DEFAULT_PATH_STYLE=defaults({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},DEFAULT_COMMON_STYLE),DEFAULT_PATH_ANIMATION_PROPS={style:defaults({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)},pathCopyParams=TRANSFORMABLE_PROPS.concat(["invisible","culling","z","z2","zlevel","parent"]),Path=function(_super){function Path(opts){return _super.call(this,opts)||this}var pathProto;return __extends(Path,_super),Path.prototype.update=function(){var _this=this,style=(_super.prototype.update.call(this),this.style);if(style.decal){var key,decalEl=this._decalEl=this._decalEl||new Path,decalElStyle=(decalEl.buildPath===Path.prototype.buildPath&&(decalEl.buildPath=function(ctx){_this.buildPath(ctx,_this.shape)}),decalEl.silent=!0,decalEl.style);for(key in style)decalElStyle[key]!==style[key]&&(decalElStyle[key]=style[key]);decalElStyle.fill=style.fill?style.decal:null,decalElStyle.decal=null,decalElStyle.shadowColor=null,style.strokeFirst&&(decalElStyle.stroke=null);for(var i=0;i<pathCopyParams.length;++i)decalEl[pathCopyParams[i]]=this[pathCopyParams[i]];decalEl.__dirty|=REDRAW_BIT}else this._decalEl&&(this._decalEl=null)},Path.prototype.getDecalElement=function(){return this._decalEl},Path.prototype._init=function(props){var keysArr=keys(props),defaultStyle=(this.shape=this.getDefaultShape(),this.getDefaultStyle());defaultStyle&&this.useStyle(defaultStyle);for(var i=0;i<keysArr.length;i++){var key=keysArr[i],value=props[key];"style"===key?this.style?extend(this.style,value):this.useStyle(value):"shape"===key?extend(this.shape,value):_super.prototype.attrKV.call(this,key,value)}this.style||this.useStyle({})},Path.prototype.getDefaultStyle=function(){return null},Path.prototype.getDefaultShape=function(){return{}},Path.prototype.canBeInsideText=function(){return this.hasFill()},Path.prototype.getInsideTextFill=function(){var fillLum,pathFill=this.style.fill;if("none"!==pathFill){if(isString(pathFill))return.5<(fillLum=lum(pathFill,0))?"#333":.2<fillLum?"#eee":"#ccc";if(pathFill)return"#ccc"}return"#333"},Path.prototype.getInsideTextStroke=function(textFill){var pathFill=this.style.fill;if(isString(pathFill)){var zr=this.__zr;if(!(!zr||!zr.isDarkMode())==lum(textFill,0)<.4)return pathFill}},Path.prototype.buildPath=function(ctx,shapeCfg,inBatch){},Path.prototype.pathUpdated=function(){this.__dirty&=~SHAPE_CHANGED_BIT},Path.prototype.getUpdatedPathProxy=function(inBatch){return this.path||this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,inBatch),this.path},Path.prototype.createPathProxy=function(){this.path=new PathProxy(!1)},Path.prototype.hasStroke=function(){var style=this.style,stroke=style.stroke;return!(null==stroke||"none"===stroke||!(0<style.lineWidth))},Path.prototype.hasFill=function(){var fill=this.style.fill;return null!=fill&&"none"!==fill},Path.prototype.getBoundingRect=function(){var firstInvoke,path,rect=this._rect,style=this.style,needsUpdateRect=!rect;return needsUpdateRect&&(firstInvoke=!1,this.path||(firstInvoke=!0,this.createPathProxy()),path=this.path,(firstInvoke||this.__dirty&SHAPE_CHANGED_BIT)&&(path.beginPath(),this.buildPath(path,this.shape,!1),this.pathUpdated()),rect=path.getBoundingRect()),this._rect=rect,this.hasStroke()&&this.path&&0<this.path.len()?(firstInvoke=this._rectStroke||(this._rectStroke=rect.clone()),(this.__dirty||needsUpdateRect)&&(firstInvoke.copy(rect),path=style.strokeNoScale?this.getLineScale():1,needsUpdateRect=style.lineWidth,this.hasFill()||(style=this.strokeContainThreshold,needsUpdateRect=Math.max(needsUpdateRect,null==style?4:style)),1e-10<path&&(firstInvoke.width+=needsUpdateRect/path,firstInvoke.height+=needsUpdateRect/path,firstInvoke.x-=needsUpdateRect/path/2,firstInvoke.y-=needsUpdateRect/path/2)),firstInvoke):rect},Path.prototype.contain=function(x,y){var localPos=this.transformCoordToLocal(x,y),rect=this.getBoundingRect(),style=this.style;if(x=localPos[0],y=localPos[1],rect.contain(x,y)){localPos=this.path;if(this.hasStroke()){rect=style.lineWidth,style=style.strokeNoScale?this.getLineScale():1;if(1e-10<style&&function(pathProxy,lineWidth,x,y){return containPath(pathProxy,lineWidth,!0,x,y)}(localPos,(rect=this.hasFill()?rect:Math.max(rect,this.strokeContainThreshold))/style,x,y))return!0}if(this.hasFill())return function(pathProxy,x,y){return containPath(pathProxy,0,!1,x,y)}(localPos,x,y)}return!1},Path.prototype.dirtyShape=function(){this.__dirty|=SHAPE_CHANGED_BIT,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},Path.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},Path.prototype.animateShape=function(loop){return this.animate("shape",loop)},Path.prototype.updateDuringAnimation=function(targetKey){"style"===targetKey?this.dirtyStyle():"shape"===targetKey?this.dirtyShape():this.markRedraw()},Path.prototype.attrKV=function(key,value){"shape"===key?this.setShape(value):_super.prototype.attrKV.call(this,key,value)},Path.prototype.setShape=function(keyOrObj,value){var shape=(shape=this.shape)||(this.shape={});return"string"==typeof keyOrObj?shape[keyOrObj]=value:extend(shape,keyOrObj),this.dirtyShape(),this},Path.prototype.shapeChanged=function(){return!!(this.__dirty&SHAPE_CHANGED_BIT)},Path.prototype.createStyle=function(obj){return createObject(DEFAULT_PATH_STYLE,obj)},Path.prototype._innerSaveToNormal=function(toState){_super.prototype._innerSaveToNormal.call(this,toState);var normalState=this._normalState;toState.shape&&!normalState.shape&&(normalState.shape=extend({},this.shape))},Path.prototype._applyStateObj=function(stateName,state,normalState,keepCurrentStates,transition,animationCfg){_super.prototype._applyStateObj.call(this,stateName,state,normalState,keepCurrentStates,transition,animationCfg);var targetShape,needsRestoreToNormal=!(state&&keepCurrentStates);if(state&&state.shape?transition?keepCurrentStates?targetShape=state.shape:(targetShape=extend({},normalState.shape),extend(targetShape,state.shape)):(targetShape=extend({},(keepCurrentStates?this:normalState).shape),extend(targetShape,state.shape)):needsRestoreToNormal&&(targetShape=normalState.shape),targetShape)if(transition){this.shape=extend({},this.shape);for(var targetShapePrimaryProps={},shapeKeys=keys(targetShape),i=0;i<shapeKeys.length;i++){var key=shapeKeys[i];"object"==typeof targetShape[key]?this.shape[key]=targetShape[key]:targetShapePrimaryProps[key]=targetShape[key]}this._transitionState(stateName,{shape:targetShapePrimaryProps},animationCfg)}else this.shape=targetShape,this.dirtyShape()},Path.prototype._mergeStates=function(states){for(var mergedShape,mergedState=_super.prototype._mergeStates.call(this,states),i=0;i<states.length;i++){var state=states[i];state.shape&&this._mergeStyle(mergedShape=mergedShape||{},state.shape)}return mergedShape&&(mergedState.shape=mergedShape),mergedState},Path.prototype.getAnimationStyleProps=function(){return DEFAULT_PATH_ANIMATION_PROPS},Path.prototype.isZeroArea=function(){return!1},Path.extend=function(defaultProps){var key,Sub=function(_super){function Sub(opts){var _this=_super.call(this,opts)||this;return defaultProps.init&&defaultProps.init.call(_this,opts),_this}return __extends(Sub,_super),Sub.prototype.getDefaultStyle=function(){return clone(defaultProps.style)},Sub.prototype.getDefaultShape=function(){return clone(defaultProps.shape)},Sub}(Path);for(key in defaultProps)"function"==typeof defaultProps[key]&&(Sub.prototype[key]=defaultProps[key]);return Sub},Path.initDefaultProps=((pathProto=Path.prototype).type="path",pathProto.strokeContainThreshold=5,pathProto.segmentIgnoreThreshold=0,pathProto.subPixelOptimize=!1,pathProto.autoBatch=!1,void(pathProto.__dirty=2|REDRAW_BIT|SHAPE_CHANGED_BIT)),Path}(Element),DEFAULT_TSPAN_STYLE=defaults({strokeFirst:!0,font:DEFAULT_FONT,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},DEFAULT_PATH_STYLE),TSpan=function(_super){function TSpan(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(TSpan,_super),TSpan.prototype.hasStroke=function(){var style=this.style,stroke=style.stroke;return null!=stroke&&"none"!==stroke&&0<style.lineWidth},TSpan.prototype.hasFill=function(){var fill=this.style.fill;return null!=fill&&"none"!==fill},TSpan.prototype.createStyle=function(obj){return createObject(DEFAULT_TSPAN_STYLE,obj)},TSpan.prototype.setBoundingRect=function(rect){this._rect=rect},TSpan.prototype.getBoundingRect=function(){var text,style=this.style;return this._rect||(null!=(text=style.text)?text+="":text="",(text=getBoundingRect(text,style.font,style.textAlign,style.textBaseline)).x+=style.x||0,text.y+=style.y||0,this.hasStroke()&&(style=style.lineWidth,text.x-=style/2,text.y-=style/2,text.width+=style,text.height+=style),this._rect=text),this._rect},TSpan.initDefaultProps=void(TSpan.prototype.dirtyRectTolerance=10),TSpan}(Element),DEFAULT_IMAGE_STYLE=(TSpan.prototype.type="tspan",defaults({x:0,y:0},DEFAULT_COMMON_STYLE)),DEFAULT_IMAGE_ANIMATION_PROPS={style:defaults({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)};var ZRImage=function(_super){function ZRImage(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ZRImage,_super),ZRImage.prototype.createStyle=function(obj){return createObject(DEFAULT_IMAGE_STYLE,obj)},ZRImage.prototype._getSize=function(dim){var style=this.style,size=style[dim];if(null!=size)return size;size=(size=style.image)&&"string"!=typeof size&&size.width&&size.height?style.image:this.__image;if(!size)return 0;var otherDim="width"===dim?"height":"width",style=style[otherDim];return null==style?size[dim]:size[dim]/size[otherDim]*style},ZRImage.prototype.getWidth=function(){return this._getSize("width")},ZRImage.prototype.getHeight=function(){return this._getSize("height")},ZRImage.prototype.getAnimationStyleProps=function(){return DEFAULT_IMAGE_ANIMATION_PROPS},ZRImage.prototype.getBoundingRect=function(){var style=this.style;return this._rect||(this._rect=new BoundingRect(style.x||0,style.y||0,this.getWidth(),this.getHeight())),this._rect},ZRImage}(Element);ZRImage.prototype.type="image";var round$1=Math.round;function subPixelOptimizeLine(outputShape,inputShape,style){var x1,x2,y1;if(inputShape)return x1=inputShape.x1,x2=inputShape.x2,y1=inputShape.y1,inputShape=inputShape.y2,outputShape.x1=x1,outputShape.x2=x2,outputShape.y1=y1,outputShape.y2=inputShape,style=style&&style.lineWidth,style&&(round$1(2*x1)===round$1(2*x2)&&(outputShape.x1=outputShape.x2=subPixelOptimize(x1,style,!0)),round$1(2*y1)===round$1(2*inputShape)&&(outputShape.y1=outputShape.y2=subPixelOptimize(y1,style,!0))),outputShape}function subPixelOptimizeRect(outputShape,inputShape,style){var originX,originY,originWidth;if(inputShape)return originX=inputShape.x,originY=inputShape.y,originWidth=inputShape.width,inputShape=inputShape.height,outputShape.x=originX,outputShape.y=originY,outputShape.width=originWidth,outputShape.height=inputShape,style=style&&style.lineWidth,style&&(outputShape.x=subPixelOptimize(originX,style,!0),outputShape.y=subPixelOptimize(originY,style,!0),outputShape.width=Math.max(subPixelOptimize(originX+originWidth,style,!1)-outputShape.x,0===originWidth?0:1),outputShape.height=Math.max(subPixelOptimize(originY+inputShape,style,!1)-outputShape.y,0===inputShape?0:1)),outputShape}function subPixelOptimize(position,lineWidth,positiveOrNegative){if(!lineWidth)return position;position=round$1(2*position);return(position+round$1(lineWidth))%2==0?position/2:(position+(positiveOrNegative?1:-1))/2}var RectShape=function(){this.x=0,this.y=0,this.width=0,this.height=0},subPixelOptimizeOutputShape={},Rect=function(_super){function Rect(opts){return _super.call(this,opts)||this}return __extends(Rect,_super),Rect.prototype.getDefaultShape=function(){return new RectShape},Rect.prototype.buildPath=function(ctx,shape){var optimizedShape,x,y,width,height;this.subPixelOptimize?(x=(optimizedShape=subPixelOptimizeRect(subPixelOptimizeOutputShape,shape,this.style)).x,y=optimizedShape.y,width=optimizedShape.width,height=optimizedShape.height,optimizedShape.r=shape.r,shape=optimizedShape):(x=shape.x,y=shape.y,width=shape.width,height=shape.height),shape.r?function(ctx,shape){var r1,r2,r3,r4,total,x=shape.x,y=shape.y,width=shape.width,height=shape.height,shape=shape.r;width<0&&(x+=width,width=-width),height<0&&(y+=height,height=-height),"number"==typeof shape?r1=r2=r3=r4=shape:shape instanceof Array?1===shape.length?r1=r2=r3=r4=shape[0]:2===shape.length?(r1=r3=shape[0],r2=r4=shape[1]):3===shape.length?(r1=shape[0],r2=r4=shape[1],r3=shape[2]):(r1=shape[0],r2=shape[1],r3=shape[2],r4=shape[3]):r1=r2=r3=r4=0,width<r1+r2&&(r1*=width/(total=r1+r2),r2*=width/total),width<r3+r4&&(r3*=width/(total=r3+r4),r4*=width/total),height<r2+r3&&(r2*=height/(total=r2+r3),r3*=height/total),height<r1+r4&&(r1*=height/(total=r1+r4),r4*=height/total),ctx.moveTo(x+r1,y),ctx.lineTo(x+width-r2,y),0!==r2&&ctx.arc(x+width-r2,y+r2,r2,-Math.PI/2,0),ctx.lineTo(x+width,y+height-r3),0!==r3&&ctx.arc(x+width-r3,y+height-r3,r3,0,Math.PI/2),ctx.lineTo(x+r4,y+height),0!==r4&&ctx.arc(x+r4,y+height-r4,r4,Math.PI/2,Math.PI),ctx.lineTo(x,y+r1),0!==r1&&ctx.arc(x+r1,y+r1,r1,Math.PI,1.5*Math.PI)}(ctx,shape):ctx.rect(x,y,width,height)},Rect.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},Rect}(Path),DEFAULT_RICH_TEXT_COLOR=(Rect.prototype.type="rect",{fill:"#000"}),DEFAULT_TEXT_ANIMATION_PROPS={style:defaults({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)},ZRText=function(_super){function ZRText(opts){var _this=_super.call(this)||this;return _this.type="text",_this._children=[],_this._defaultStyle=DEFAULT_RICH_TEXT_COLOR,_this.attr(opts),_this}return __extends(ZRText,_super),ZRText.prototype.childrenRef=function(){return this._children},ZRText.prototype.update=function(){_super.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var i=0;i<this._children.length;i++){var child=this._children[i];child.zlevel=this.zlevel,child.z=this.z,child.z2=this.z2,child.culling=this.culling,child.cursor=this.cursor,child.invisible=this.invisible}},ZRText.prototype.updateTransform=function(){var innerTransformable=this.innerTransformable;innerTransformable?(innerTransformable.updateTransform(),innerTransformable.transform&&(this.transform=innerTransformable.transform)):_super.prototype.updateTransform.call(this)},ZRText.prototype.getLocalTransform=function(m){var innerTransformable=this.innerTransformable;return innerTransformable?innerTransformable.getLocalTransform(m):_super.prototype.getLocalTransform.call(this,m)},ZRText.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),_super.prototype.getComputedTransform.call(this)},ZRText.prototype._updateSubTexts=function(){var style;this._childCursor=0,normalizeStyle(style=this.style),each(style.rich,normalizeStyle),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},ZRText.prototype.addSelfToZr=function(zr){_super.prototype.addSelfToZr.call(this,zr);for(var i=0;i<this._children.length;i++)this._children[i].__zr=zr},ZRText.prototype.removeSelfFromZr=function(zr){_super.prototype.removeSelfFromZr.call(this,zr);for(var i=0;i<this._children.length;i++)this._children[i].__zr=null},ZRText.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var tmpRect=new BoundingRect(0,0,0,0),children=this._children,tmpMat=[],rect=null,i=0;i<children.length;i++){var child=children[i],childRect=child.getBoundingRect(),child=child.getLocalTransform(tmpMat);child?(tmpRect.copy(childRect),tmpRect.applyTransform(child),(rect=rect||tmpRect.clone()).union(tmpRect)):(rect=rect||childRect.clone()).union(childRect)}this._rect=rect||tmpRect}return this._rect},ZRText.prototype.setDefaultTextStyle=function(defaultTextStyle){this._defaultStyle=defaultTextStyle||DEFAULT_RICH_TEXT_COLOR},ZRText.prototype.setTextContent=function(textContent){throw new Error("Can't attach text on another text")},ZRText.prototype._mergeStyle=function(targetStyle,sourceStyle){if(!sourceStyle)return targetStyle;var sourceRich=sourceStyle.rich,targetRich=targetStyle.rich||sourceRich&&{};return extend(targetStyle,sourceStyle),sourceRich&&targetRich?(this._mergeRich(targetRich,sourceRich),targetStyle.rich=targetRich):targetRich&&(targetStyle.rich=targetRich),targetStyle},ZRText.prototype._mergeRich=function(targetRich,sourceRich){for(var richNames=keys(sourceRich),i=0;i<richNames.length;i++){var richName=richNames[i];targetRich[richName]=targetRich[richName]||{},extend(targetRich[richName],sourceRich[richName])}},ZRText.prototype.getAnimationStyleProps=function(){return DEFAULT_TEXT_ANIMATION_PROPS},ZRText.prototype._getOrCreateChild=function(Ctor){var child=this._children[this._childCursor];return child&&child instanceof Ctor||(child=new Ctor),(this._children[this._childCursor++]=child).__zr=this.__zr,child.parent=this,child},ZRText.prototype._updatePlainTexts=function(){for(var boxX,style=this.style,textFont=style.font||DEFAULT_FONT,textPadding=style.padding,contentBlock=function(text,style){null!=text&&(text+="");var lines,overflow=style.overflow,padding=style.padding,font=style.font,truncate="truncate"===overflow,calculatedLineHeight=getLineHeight(font),lineHeight=retrieve2(style.lineHeight,calculatedLineHeight),bgColorDrawn=!!style.backgroundColor,truncateLineOverflow="truncate"===style.lineOverflow,width=style.width,overflow=(lines=null==width||"break"!==overflow&&"breakAll"!==overflow?text?text.split("\n"):[]:text?wrapText(text,style.font,width,"breakAll"===overflow,0).lines:[]).length*lineHeight,height=retrieve2(style.height,overflow);if(height<overflow&&truncateLineOverflow&&(truncateLineOverflow=Math.floor(height/lineHeight),lines=lines.slice(0,truncateLineOverflow)),text&&truncate&&null!=width)for(var options=prepareTruncateOptions(width,font,style.ellipsis,{minChar:style.truncateMinChar,placeholder:style.placeholder}),i=0;i<lines.length;i++)lines[i]=truncateSingleLine(lines[i],options);for(var truncateLineOverflow=height,contentWidth=0,i=0;i<lines.length;i++)contentWidth=Math.max(getWidth(lines[i],font),contentWidth);return null==width&&(width=contentWidth),text=contentWidth,padding&&(truncateLineOverflow+=padding[0]+padding[2],text+=padding[1]+padding[3],width+=padding[1]+padding[3]),{lines:lines,height:height,outerWidth:text=bgColorDrawn?width:text,outerHeight:truncateLineOverflow,lineHeight:lineHeight,calculatedLineHeight:calculatedLineHeight,contentWidth:contentWidth,contentHeight:overflow,width:width}}(getStyleText(style),style),needDrawBg=needDrawBackground(style),bgColorDrawn=!!style.backgroundColor,outerHeight=contentBlock.outerHeight,outerWidth=contentBlock.outerWidth,contentWidth=contentBlock.contentWidth,textLines=contentBlock.lines,lineHeight=contentBlock.lineHeight,defaultStyle=this._defaultStyle,baseX=style.x||0,baseY=style.y||0,textAlign=style.align||defaultStyle.align||"left",verticalAlign=style.verticalAlign||defaultStyle.verticalAlign||"top",textX=baseX,textY=adjustTextY$1(baseY,contentBlock.contentHeight,verticalAlign),defaultLineWidth=((needDrawBg||textPadding)&&(boxX=adjustTextX(baseX,outerWidth,textAlign),baseY=adjustTextY$1(baseY,outerHeight,verticalAlign),needDrawBg&&this._renderBackground(style,style,boxX,baseY,outerWidth,outerHeight)),textY+=lineHeight/2,textPadding&&(textX=getTextXForPadding(baseX,textAlign,textPadding),"top"===verticalAlign?textY+=textPadding[0]:"bottom"===verticalAlign&&(textY-=textPadding[2])),0),needDrawBg=!1,textFill=(getFill("fill"in style?style.fill:(needDrawBg=!0,defaultStyle.fill))),textStroke=(getStroke("stroke"in style?style.stroke:bgColorDrawn||defaultStyle.autoStroke&&!needDrawBg?null:(defaultLineWidth=2,defaultStyle.stroke))),hasShadow=0<style.textShadowBlur,fixedBoundingRect=null!=style.width&&("truncate"===style.overflow||"break"===style.overflow||"breakAll"===style.overflow),calculatedLineHeight=contentBlock.calculatedLineHeight,i=0;i<textLines.length;i++){var el=this._getOrCreateChild(TSpan),subElStyle=el.createStyle();el.useStyle(subElStyle),subElStyle.text=textLines[i],subElStyle.x=textX,subElStyle.y=textY,textAlign&&(subElStyle.textAlign=textAlign),subElStyle.textBaseline="middle",subElStyle.opacity=style.opacity,subElStyle.strokeFirst=!0,hasShadow&&(subElStyle.shadowBlur=style.textShadowBlur||0,subElStyle.shadowColor=style.textShadowColor||"transparent",subElStyle.shadowOffsetX=style.textShadowOffsetX||0,subElStyle.shadowOffsetY=style.textShadowOffsetY||0),subElStyle.stroke=textStroke,subElStyle.fill=textFill,textStroke&&(subElStyle.lineWidth=style.lineWidth||defaultLineWidth,subElStyle.lineDash=style.lineDash,subElStyle.lineDashOffset=style.lineDashOffset||0),subElStyle.font=textFont,setSeparateFont(subElStyle,style),textY+=lineHeight,fixedBoundingRect&&el.setBoundingRect(new BoundingRect(adjustTextX(subElStyle.x,style.width,subElStyle.textAlign),adjustTextY$1(subElStyle.y,calculatedLineHeight,subElStyle.textBaseline),contentWidth,calculatedLineHeight))}},ZRText.prototype._updateRichTexts=function(){for(var style=this.style,contentBlock=parseRichText(getStyleText(style),style),contentWidth=contentBlock.width,outerWidth=contentBlock.outerWidth,outerHeight=contentBlock.outerHeight,textPadding=style.padding,baseX=style.x||0,baseY=style.y||0,defaultStyle=this._defaultStyle,textAlign=style.align||defaultStyle.align,defaultStyle=style.verticalAlign||defaultStyle.verticalAlign,baseX=adjustTextX(baseX,outerWidth,textAlign),textAlign=adjustTextY$1(baseY,outerHeight,defaultStyle),xLeft=baseX,lineTop=textAlign,xRight=(textPadding&&(xLeft+=textPadding[3],lineTop+=textPadding[0]),xLeft+contentWidth),bgColorDrawn=(needDrawBackground(style)&&this._renderBackground(style,style,baseX,textAlign,outerWidth,outerHeight),!!style.backgroundColor),i=0;i<contentBlock.lines.length;i++){for(var line=contentBlock.lines[i],tokens=line.tokens,tokenCount=tokens.length,lineHeight=line.lineHeight,remainedWidth=line.width,leftIndex=0,lineXLeft=xLeft,lineXRight=xRight,rightIndex=tokenCount-1,token=void 0;leftIndex<tokenCount&&(!(token=tokens[leftIndex]).align||"left"===token.align);)this._placeToken(token,style,lineHeight,lineTop,lineXLeft,"left",bgColorDrawn),remainedWidth-=token.width,lineXLeft+=token.width,leftIndex++;for(;0<=rightIndex&&"right"===(token=tokens[rightIndex]).align;)this._placeToken(token,style,lineHeight,lineTop,lineXRight,"right",bgColorDrawn),remainedWidth-=token.width,lineXRight-=token.width,rightIndex--;for(lineXLeft+=(contentWidth-(lineXLeft-xLeft)-(xRight-lineXRight)-remainedWidth)/2;leftIndex<=rightIndex;)token=tokens[leftIndex],this._placeToken(token,style,lineHeight,lineTop,lineXLeft+token.width/2,"center",bgColorDrawn),lineXLeft+=token.width,leftIndex++;lineTop+=lineHeight}},ZRText.prototype._placeToken=function(token,style,lineHeight,lineTop,x,textAlign,parentBgColorDrawn){var tokenStyle=style.rich[token.styleName]||{},verticalAlign=(tokenStyle.text=token.text,token.verticalAlign),y=lineTop+lineHeight/2;"top"===verticalAlign?y=lineTop+token.height/2:"bottom"===verticalAlign&&(y=lineTop+lineHeight-token.height/2);!token.isLineHolder&&needDrawBackground(tokenStyle)&&this._renderBackground(tokenStyle,style,"right"===textAlign?x-token.width:"center"===textAlign?x-token.width/2:x,y-token.height/2,token.width,token.height);var verticalAlign=!!tokenStyle.backgroundColor,lineTop=token.textPadding,lineHeight=(lineTop&&(x=getTextXForPadding(x,textAlign,lineTop),y-=token.height/2-lineTop[0]-token.innerHeight/2),this._getOrCreateChild(TSpan)),lineTop=lineHeight.createStyle(),defaultStyle=(lineHeight.useStyle(lineTop),this._defaultStyle),useDefaultFill=!1,defaultLineWidth=0,textFill=getFill("fill"in tokenStyle?tokenStyle.fill:"fill"in style?style.fill:(useDefaultFill=!0,defaultStyle.fill)),verticalAlign=getStroke("stroke"in tokenStyle?tokenStyle.stroke:"stroke"in style?style.stroke:verticalAlign||parentBgColorDrawn||defaultStyle.autoStroke&&!useDefaultFill?null:(defaultLineWidth=2,defaultStyle.stroke)),parentBgColorDrawn=0<tokenStyle.textShadowBlur||0<style.textShadowBlur,useDefaultFill=(lineTop.text=token.text,lineTop.x=x,lineTop.y=y,parentBgColorDrawn&&(lineTop.shadowBlur=tokenStyle.textShadowBlur||style.textShadowBlur||0,lineTop.shadowColor=tokenStyle.textShadowColor||style.textShadowColor||"transparent",lineTop.shadowOffsetX=tokenStyle.textShadowOffsetX||style.textShadowOffsetX||0,lineTop.shadowOffsetY=tokenStyle.textShadowOffsetY||style.textShadowOffsetY||0),lineTop.textAlign=textAlign,lineTop.textBaseline="middle",lineTop.font=token.font||DEFAULT_FONT,lineTop.opacity=retrieve3(tokenStyle.opacity,style.opacity,1),setSeparateFont(lineTop,tokenStyle),verticalAlign&&(lineTop.lineWidth=retrieve3(tokenStyle.lineWidth,style.lineWidth,defaultLineWidth),lineTop.lineDash=retrieve2(tokenStyle.lineDash,style.lineDash),lineTop.lineDashOffset=style.lineDashOffset||0,lineTop.stroke=verticalAlign),textFill&&(lineTop.fill=textFill),token.contentWidth),defaultStyle=token.contentHeight;lineHeight.setBoundingRect(new BoundingRect(adjustTextX(lineTop.x,useDefaultFill,lineTop.textAlign),adjustTextY$1(lineTop.y,defaultStyle,lineTop.textBaseline),useDefaultFill,defaultStyle))},ZRText.prototype._renderBackground=function(style,topStyle,x,y,width,height){var rectEl,imgEl,rectShape,rectStyle,textBackgroundColor=style.backgroundColor,textBorderWidth=style.borderWidth,textBorderColor=style.borderColor,isImageBg=textBackgroundColor&&textBackgroundColor.image,isPlainOrGradientBg=textBackgroundColor&&!isImageBg,textBorderRadius=style.borderRadius,self=this,textBorderRadius=((isPlainOrGradientBg||style.lineHeight||textBorderWidth&&textBorderColor)&&((rectEl=this._getOrCreateChild(Rect)).useStyle(rectEl.createStyle()),rectEl.style.fill=null,(rectShape=rectEl.shape).x=x,rectShape.y=y,rectShape.width=width,rectShape.height=height,rectShape.r=textBorderRadius,rectEl.dirtyShape()),isPlainOrGradientBg?((rectStyle=rectEl.style).fill=textBackgroundColor||null,rectStyle.fillOpacity=retrieve2(style.fillOpacity,1)):isImageBg&&((imgEl=this._getOrCreateChild(ZRImage)).onload=function(){self.dirtyStyle()},(rectShape=imgEl.style).image=textBackgroundColor.image,rectShape.x=x,rectShape.y=y,rectShape.width=width,rectShape.height=height),textBorderWidth&&textBorderColor&&((rectStyle=rectEl.style).lineWidth=textBorderWidth,rectStyle.stroke=textBorderColor,rectStyle.strokeOpacity=retrieve2(style.strokeOpacity,1),rectStyle.lineDash=style.borderDash,rectStyle.lineDashOffset=style.borderDashOffset||0,rectEl.strokeContainThreshold=0,rectEl.hasFill()&&rectEl.hasStroke()&&(rectStyle.strokeFirst=!0,rectStyle.lineWidth*=2)),(rectEl||imgEl).style);textBorderRadius.shadowBlur=style.shadowBlur||0,textBorderRadius.shadowColor=style.shadowColor||"transparent",textBorderRadius.shadowOffsetX=style.shadowOffsetX||0,textBorderRadius.shadowOffsetY=style.shadowOffsetY||0,textBorderRadius.opacity=retrieve3(style.opacity,topStyle.opacity,1)},ZRText.makeFont=function(style){var fontSize,font="";return(font=function(style){return null!=style.fontSize||style.fontFamily||style.fontWeight}(style)?[style.fontStyle,style.fontWeight,"string"!=typeof(fontSize=style.fontSize)||-1===fontSize.indexOf("px")&&-1===fontSize.indexOf("rem")&&-1===fontSize.indexOf("em")?isNaN(+fontSize)?"12px":fontSize+"px":fontSize,style.fontFamily||"sans-serif"].join(" "):font)&&trim(font)||style.textFont||style.font},ZRText}(Element),VALID_TEXT_ALIGN={left:!0,right:1,center:1},VALID_TEXT_VERTICAL_ALIGN={top:1,bottom:1,middle:1},FONT_PARTS=["fontStyle","fontWeight","fontSize","fontFamily"];function setSeparateFont(targetStyle,sourceStyle){for(var i=0;i<FONT_PARTS.length;i++){var fontProp=FONT_PARTS[i],val=sourceStyle[fontProp];null!=val&&(targetStyle[fontProp]=val)}}function normalizeStyle(style){var textAlign;style&&(style.font=ZRText.makeFont(style),textAlign=style.align,style.align=null==(textAlign="middle"===textAlign?"center":textAlign)||VALID_TEXT_ALIGN[textAlign]?textAlign:"left",textAlign=style.verticalAlign,style.verticalAlign=null==(textAlign="center"===textAlign?"middle":textAlign)||VALID_TEXT_VERTICAL_ALIGN[textAlign]?textAlign:"top",style.padding&&(style.padding=normalizeCssArray(style.padding)))}function getStroke(stroke,lineWidth){return null==stroke||lineWidth<=0||"transparent"===stroke||"none"===stroke?null:stroke.image||stroke.colorStops?"#000":stroke}function getFill(fill){return null==fill||"none"===fill?null:fill.image||fill.colorStops?"#000":fill}function getTextXForPadding(x,textAlign,textPadding){return"right"===textAlign?x-textPadding[1]:"center"===textAlign?x+textPadding[3]/2-textPadding[1]/2:x+textPadding[3]}function getStyleText(style){style=style.text;return null!=style&&(style+=""),style}function needDrawBackground(style){return!!(style.backgroundColor||style.lineHeight||style.borderWidth&&style.borderColor)}var getECData=makeInner(),_highlightNextDigit=1,_highlightKeyMap={},getSavedStates=makeInner(),getComponentStates=makeInner(),HOVER_STATE_NORMAL=0,HOVER_STATE_BLUR=1,HOVER_STATE_EMPHASIS=2,SPECIAL_STATES=["emphasis","blur","select"],DISPLAY_STATES=["normal","emphasis","blur","select"],HIGHLIGHT_ACTION_TYPE="highlight",DOWNPLAY_ACTION_TYPE="downplay",SELECT_ACTION_TYPE="select",UNSELECT_ACTION_TYPE="unselect",TOGGLE_SELECT_ACTION_TYPE="toggleSelect";function hasFillOrStroke(fillOrStroke){return null!=fillOrStroke&&"none"!==fillOrStroke}var liftedColorCache=new LRU(100);function liftColor(color){var liftedColor;return isString(color)?((liftedColor=liftedColorCache.get(color))||(liftedColor=lift(color,-.1),liftedColorCache.put(color,liftedColor)),liftedColor):null!=color.colorStops?((liftedColor=extend({},color)).colorStops=map(color.colorStops,function(stop){return{offset:stop.offset,color:lift(stop.color,-.1)}}),liftedColor):color}function doChangeHoverState(el,stateName,hoverStateEnum){el.onHoverStateChange&&(el.hoverState||0)!==hoverStateEnum&&el.onHoverStateChange(stateName),el.hoverState=hoverStateEnum}function singleEnterEmphasis(el){doChangeHoverState(el,"emphasis",HOVER_STATE_EMPHASIS)}function singleLeaveEmphasis(el){el.hoverState===HOVER_STATE_EMPHASIS&&doChangeHoverState(el,"normal",HOVER_STATE_NORMAL)}function singleEnterBlur(el){doChangeHoverState(el,"blur",HOVER_STATE_BLUR)}function singleLeaveBlur(el){el.hoverState===HOVER_STATE_BLUR&&doChangeHoverState(el,"normal",HOVER_STATE_NORMAL)}function singleEnterSelect(el){el.selected=!0}function singleLeaveSelect(el){el.selected=!1}function traverseUpdateState(el,updater,commonParam){updater(el,commonParam),el.isGroup&&el.traverse(function(child){updater(child,commonParam)})}function setStatesFlag(el,stateName){switch(stateName){case"emphasis":el.hoverState=HOVER_STATE_EMPHASIS;break;case"normal":el.hoverState=HOVER_STATE_NORMAL;break;case"blur":el.hoverState=HOVER_STATE_BLUR;break;case"select":el.selected=!0}}function createBlurDefaultState(el,stateName,state){var hasBlur=0<=indexOf(el.currentStates,stateName),currentOpacity=el.style.opacity,el=hasBlur?null:function(el,props,toStateName,defaultValue){for(var style=el.style,fromState={},i=0;i<props.length;i++){var propName=props[i],val=style[propName];fromState[propName]=null==val?defaultValue&&defaultValue[propName]:val}for(i=0;i<el.animators.length;i++){var animator=el.animators[i];animator.__fromStateTransition&&animator.__fromStateTransition.indexOf(toStateName)<0&&"style"===animator.targetName&&animator.saveTo(fromState,props)}return fromState}(el,["opacity"],stateName,{opacity:1}),stateName=(state=state||{}).style||{};return null==stateName.opacity&&(state=extend({},state),stateName=extend({opacity:hasBlur?currentOpacity:.1*el.opacity},stateName),state.style=stateName),state}function elementStateProxy(stateName,targetStates){var state=this.states[stateName];if(this.style){if("emphasis"===stateName)return function(el,targetStates,state){var store,fromFill,targetStates=targetStates&&0<=indexOf(targetStates,"select"),cloned=!1;return el instanceof Path&&(store=getSavedStates(el),fromFill=targetStates&&store.selectFill||store.normalFill,targetStates=targetStates&&store.selectStroke||store.normalStroke,(hasFillOrStroke(fromFill)||hasFillOrStroke(targetStates))&&("inherit"===(store=(state=state||{}).style||{}).fill?(cloned=!0,state=extend({},state),(store=extend({},store)).fill=fromFill):!hasFillOrStroke(store.fill)&&hasFillOrStroke(fromFill)?(cloned=!0,state=extend({},state),(store=extend({},store)).fill=liftColor(fromFill)):!hasFillOrStroke(store.stroke)&&hasFillOrStroke(targetStates)&&(cloned||(state=extend({},state),store=extend({},store)),store.stroke=liftColor(targetStates)),state.style=store)),state&&null==state.z2&&(cloned||(state=extend({},state)),fromFill=el.z2EmphasisLift,state.z2=el.z2+(null!=fromFill?fromFill:10)),state}(this,targetStates,state);if("blur"===stateName)return createBlurDefaultState(this,stateName,state);if("select"===stateName)return function(el,state){var z2SelectLift;return state&&null==state.z2&&(state=extend({},state),z2SelectLift=el.z2SelectLift,state.z2=el.z2+(null!=z2SelectLift?z2SelectLift:9)),state}(this,state)}return state}function setDefaultStateProxy(el){el.stateProxy=elementStateProxy;var textContent=el.getTextContent(),el=el.getTextGuideLine();textContent&&(textContent.stateProxy=elementStateProxy),el&&(el.stateProxy=elementStateProxy)}function enterEmphasisWhenMouseOver(el,e){shouldSilent(el,e)||el.__highByOuter||traverseUpdateState(el,singleEnterEmphasis)}function leaveEmphasisWhenMouseOut(el,e){shouldSilent(el,e)||el.__highByOuter||traverseUpdateState(el,singleLeaveEmphasis)}function enterEmphasis(el,highlightDigit){el.__highByOuter|=1<<(highlightDigit||0),traverseUpdateState(el,singleEnterEmphasis)}function leaveEmphasis(el,highlightDigit){(el.__highByOuter&=~(1<<(highlightDigit||0)))||traverseUpdateState(el,singleLeaveEmphasis)}function leaveBlur(el){traverseUpdateState(el,singleLeaveBlur)}function enterSelect(el){traverseUpdateState(el,singleEnterSelect)}function leaveSelect(el){traverseUpdateState(el,singleLeaveSelect)}function shouldSilent(el,e){return el.__highDownSilentOnTouch&&e.zrByTouch}function allLeaveBlur(api){api.getModel().eachComponent(function(componentType,componentModel){var componentStates=getComponentStates(componentModel);componentStates.isBlured&&("series"===componentType?api.getViewOfSeriesModel(componentModel):api.getViewOfComponentModel(componentModel)).group.traverse(function(child){singleLeaveBlur(child)}),componentStates.isBlured=!1})}function blurSeries(targetSeriesIndex,focus,blurScope,api){var targetSeriesModel,targetCoordSys,blurredSeries,ecModel=api.getModel();function leaveBlurOfIndices(data,dataIndices){for(var i=0;i<dataIndices.length;i++){var itemEl=data.getItemGraphicEl(dataIndices[i]);itemEl&&leaveBlur(itemEl)}}blurScope=blurScope||"coordinateSystem",null!=targetSeriesIndex&&focus&&"none"!==focus&&(targetSeriesModel=ecModel.getSeriesByIndex(targetSeriesIndex),(targetCoordSys=targetSeriesModel.coordinateSystem)&&targetCoordSys.master&&(targetCoordSys=targetCoordSys.master),blurredSeries=[],ecModel.eachSeries(function(seriesModel){var sameSeries=targetSeriesModel===seriesModel,coordSys=seriesModel.coordinateSystem,coordSys=(coordSys=coordSys&&coordSys.master?coordSys.master:coordSys)&&targetCoordSys?coordSys===targetCoordSys:sameSeries;if(!("series"===blurScope&&!sameSeries||"coordinateSystem"===blurScope&&!coordSys||"series"===focus&&sameSeries)){if(api.getViewOfSeriesModel(seriesModel).group.traverse(function(child){singleEnterBlur(child)}),isArrayLike(focus))leaveBlurOfIndices(seriesModel.getData(),focus);else if(isObject(focus))for(var dataTypes=keys(focus),d=0;d<dataTypes.length;d++)leaveBlurOfIndices(seriesModel.getData(dataTypes[d]),focus[dataTypes[d]]);blurredSeries.push(seriesModel),getComponentStates(seriesModel).isBlured=!0}}),ecModel.eachComponent(function(componentType,componentModel){"series"!==componentType&&(componentType=api.getViewOfComponentModel(componentModel))&&componentType.blurSeries&&componentType.blurSeries(blurredSeries,ecModel)}))}function blurComponent(componentMainType,componentIndex,api){null!=componentMainType&&null!=componentIndex&&(componentMainType=api.getModel().getComponent(componentMainType,componentIndex))&&(getComponentStates(componentMainType).isBlured=!0,(componentIndex=api.getViewOfComponentModel(componentMainType))&&componentIndex.focusBlurEnabled&&componentIndex.group.traverse(function(child){singleEnterBlur(child)}))}function findComponentHighDownDispatchers(componentMainType,componentIndex,name,api){var ret={focusSelf:!1,dispatchers:null};if(null==componentMainType||"series"===componentMainType||null==componentIndex||null==name)return ret;componentMainType=api.getModel().getComponent(componentMainType,componentIndex);if(!componentMainType)return ret;componentIndex=api.getViewOfComponentModel(componentMainType);if(!componentIndex||!componentIndex.findHighDownDispatchers)return ret;for(var focusSelf,dispatchers=componentIndex.findHighDownDispatchers(name),i=0;i<dispatchers.length;i++)if(isHighDownDispatcher(dispatchers[i])||error("param should be highDownDispatcher"),"self"===getECData(dispatchers[i]).focus){focusSelf=!0;break}return{focusSelf:focusSelf,dispatchers:dispatchers}}function updateSeriesElementSelection(seriesModel){each(seriesModel.getAllData(),function(_a){var data=_a.data,type=_a.type;data.eachItemGraphicEl(function(el,idx){(seriesModel.isSelected(idx,type)?enterSelect:leaveSelect)(el)})})}function enableHoverEmphasis(el,focus,blurScope){setAsHighDownDispatcher(el,!0),traverseUpdateState(el,setDefaultStateProxy),function(el,focus,blurScope){el=getECData(el);null!=focus?(el.focus=focus,el.blurScope=blurScope):el.focus&&(el.focus=null)}(el,focus,blurScope)}function toggleHoverEmphasis(el,focus,blurScope,isDisabled){isDisabled?function(el){setAsHighDownDispatcher(el,!1)}(el):enableHoverEmphasis(el,focus,blurScope)}var OTHER_STATES=["emphasis","blur","select"],defaultStyleGetterMap={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function setStatesStylesFromModel(el,itemModel,styleType,getter){styleType=styleType||"itemStyle";for(var i=0;i<OTHER_STATES.length;i++){var stateName=OTHER_STATES[i],model=itemModel.getModel([stateName,styleType]);el.ensureState(stateName).style=getter?getter(model):model[defaultStyleGetterMap[styleType]]()}}function setAsHighDownDispatcher(el,asDispatcher){var asDispatcher=!1===asDispatcher,extendedEl=el;el.highDownSilentOnTouch&&(extendedEl.__highDownSilentOnTouch=el.highDownSilentOnTouch),asDispatcher&&!extendedEl.__highDownDispatcher||(extendedEl.__highByOuter=extendedEl.__highByOuter||0,extendedEl.__highDownDispatcher=!asDispatcher)}function isHighDownDispatcher(el){return!(!el||!el.__highDownDispatcher)}function isSelectChangePayload(payload){payload=payload.type;return payload===SELECT_ACTION_TYPE||payload===UNSELECT_ACTION_TYPE||payload===TOGGLE_SELECT_ACTION_TYPE}function isHighDownPayload(payload){payload=payload.type;return payload===HIGHLIGHT_ACTION_TYPE||payload===DOWNPLAY_ACTION_TYPE}var CMD$2=PathProxy.CMD,points=[[],[],[]],mathSqrt$2=Math.sqrt,mathAtan2=Math.atan2;var mathSqrt$1=Math.sqrt,mathSin$2=Math.sin,mathCos$2=Math.cos,PI$1=Math.PI;function vMag(v){return Math.sqrt(v[0]*v[0]+v[1]*v[1])}function vRatio(u,v){return(u[0]*v[0]+u[1]*v[1])/(vMag(u)*vMag(v))}function vAngle(u,v){return(u[0]*v[1]<u[1]*v[0]?-1:1)*Math.acos(vRatio(u,v))}function processArc(x1,y1,x2,y2,fa,fs,rx,ry,psiDeg,cmd,path){var psiDeg=psiDeg*(PI$1/180),xp=mathCos$2(psiDeg)*(x1-x2)/2+mathSin$2(psiDeg)*(y1-y2)/2,yp=-1*mathSin$2(psiDeg)*(x1-x2)/2+mathCos$2(psiDeg)*(y1-y2)/2,lambda=xp*xp/(rx*rx)+yp*yp/(ry*ry),lambda=(1<lambda&&(rx*=mathSqrt$1(lambda),ry*=mathSqrt$1(lambda)),(fa===fs?-1:1)*mathSqrt$1((rx*rx*(ry*ry)-rx*rx*(yp*yp)-ry*ry*(xp*xp))/(rx*rx*(yp*yp)+ry*ry*(xp*xp)))||0),fa=lambda*rx*yp/ry,lambda=lambda*-ry*xp/rx,x1=(x1+x2)/2+mathCos$2(psiDeg)*fa-mathSin$2(psiDeg)*lambda,x2=(y1+y2)/2+mathSin$2(psiDeg)*fa+mathCos$2(psiDeg)*lambda,y1=vAngle([1,0],[(xp-fa)/rx,(yp-lambda)/ry]),y2=[(xp-fa)/rx,(yp-lambda)/ry],xp=[(-1*xp-fa)/rx,(-1*yp-lambda)/ry],fa=vAngle(y2,xp);vRatio(y2,xp)<=-1&&(fa=PI$1),(fa=1<=vRatio(y2,xp)?0:fa)<0&&(yp=Math.round(fa/PI$1*1e6)/1e6,fa=2*PI$1+yp%2*PI$1),path.addData(cmd,x1,x2,rx,ry,y1,fa,psiDeg,fs)}var commandReg=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/gi,numberReg=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;var SVGPath=function(_super){function SVGPath(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(SVGPath,_super),SVGPath.prototype.applyTransform=function(m){},SVGPath}(Path);function isPathProxy(path){return null!=path.setData}function createPathOptions(str,opts){var pathProxy=function(data){var path=new PathProxy;if(!data)return path;var prevCmd,cpx=0,cpy=0,subpathX=cpx,subpathY=cpy,CMD=PathProxy.CMD,cmdList=data.match(commandReg);if(!cmdList)return path;for(var l=0;l<cmdList.length;l++){for(var cmdText=cmdList[l],cmdStr=cmdText.charAt(0),cmd=void 0,p=cmdText.match(numberReg)||[],pLen=p.length,i=0;i<pLen;i++)p[i]=parseFloat(p[i]);for(var off=0;off<pLen;){var ctlPtx=void 0,ctlPty=void 0,rx=void 0,ry=void 0,psi=void 0,fa=void 0,fs=void 0,x1=cpx,y1=cpy,len=void 0,pathData=void 0;switch(cmdStr){case"l":cpx+=p[off++],cpy+=p[off++],cmd=CMD.L,path.addData(cmd,cpx,cpy);break;case"L":cpx=p[off++],cpy=p[off++],cmd=CMD.L,path.addData(cmd,cpx,cpy);break;case"m":cpx+=p[off++],cpy+=p[off++],cmd=CMD.M,path.addData(cmd,cpx,cpy),subpathX=cpx,subpathY=cpy,cmdStr="l";break;case"M":cpx=p[off++],cpy=p[off++],cmd=CMD.M,path.addData(cmd,cpx,cpy),subpathX=cpx,subpathY=cpy,cmdStr="L";break;case"h":cpx+=p[off++],cmd=CMD.L,path.addData(cmd,cpx,cpy);break;case"H":cpx=p[off++],cmd=CMD.L,path.addData(cmd,cpx,cpy);break;case"v":cpy+=p[off++],cmd=CMD.L,path.addData(cmd,cpx,cpy);break;case"V":cpy=p[off++],cmd=CMD.L,path.addData(cmd,cpx,cpy);break;case"C":cmd=CMD.C,path.addData(cmd,p[off++],p[off++],p[off++],p[off++],p[off++],p[off++]),cpx=p[off-2],cpy=p[off-1];break;case"c":cmd=CMD.C,path.addData(cmd,p[off++]+cpx,p[off++]+cpy,p[off++]+cpx,p[off++]+cpy,p[off++]+cpx,p[off++]+cpy),cpx+=p[off-2],cpy+=p[off-1];break;case"S":ctlPtx=cpx,ctlPty=cpy,len=path.len(),pathData=path.data,prevCmd===CMD.C&&(ctlPtx+=cpx-pathData[len-4],ctlPty+=cpy-pathData[len-3]),cmd=CMD.C,x1=p[off++],y1=p[off++],cpx=p[off++],cpy=p[off++],path.addData(cmd,ctlPtx,ctlPty,x1,y1,cpx,cpy);break;case"s":ctlPtx=cpx,ctlPty=cpy,len=path.len(),pathData=path.data,prevCmd===CMD.C&&(ctlPtx+=cpx-pathData[len-4],ctlPty+=cpy-pathData[len-3]),cmd=CMD.C,x1=cpx+p[off++],y1=cpy+p[off++],cpx+=p[off++],cpy+=p[off++],path.addData(cmd,ctlPtx,ctlPty,x1,y1,cpx,cpy);break;case"Q":x1=p[off++],y1=p[off++],cpx=p[off++],cpy=p[off++],cmd=CMD.Q,path.addData(cmd,x1,y1,cpx,cpy);break;case"q":x1=p[off++]+cpx,y1=p[off++]+cpy,cpx+=p[off++],cpy+=p[off++],cmd=CMD.Q,path.addData(cmd,x1,y1,cpx,cpy);break;case"T":ctlPtx=cpx,ctlPty=cpy,len=path.len(),pathData=path.data,prevCmd===CMD.Q&&(ctlPtx+=cpx-pathData[len-4],ctlPty+=cpy-pathData[len-3]),cpx=p[off++],cpy=p[off++],cmd=CMD.Q,path.addData(cmd,ctlPtx,ctlPty,cpx,cpy);break;case"t":ctlPtx=cpx,ctlPty=cpy,len=path.len(),pathData=path.data,prevCmd===CMD.Q&&(ctlPtx+=cpx-pathData[len-4],ctlPty+=cpy-pathData[len-3]),cpx+=p[off++],cpy+=p[off++],cmd=CMD.Q,path.addData(cmd,ctlPtx,ctlPty,cpx,cpy);break;case"A":rx=p[off++],ry=p[off++],psi=p[off++],fa=p[off++],fs=p[off++],processArc(x1=cpx,y1=cpy,cpx=p[off++],cpy=p[off++],fa,fs,rx,ry,psi,cmd=CMD.A,path);break;case"a":rx=p[off++],ry=p[off++],psi=p[off++],fa=p[off++],fs=p[off++],processArc(x1=cpx,y1=cpy,cpx+=p[off++],cpy+=p[off++],fa,fs,rx,ry,psi,cmd=CMD.A,path)}}"z"!==cmdStr&&"Z"!==cmdStr||(cmd=CMD.Z,path.addData(cmd),cpx=subpathX,cpy=subpathY),prevCmd=cmd}return path.toStatic(),path}(str),str=extend({},opts);return str.buildPath=function(path){var ctx;isPathProxy(path)?(path.setData(pathProxy.data),(ctx=path.getContext())&&path.rebuildPath(ctx,1)):pathProxy.rebuildPath(ctx=path,1)},str.applyTransform=function(m){!function(path,m){if(m){for(var cmd,nPoint,k,p,data=path.data,len$$1=path.len(),M=CMD$2.M,C=CMD$2.C,L=CMD$2.L,R=CMD$2.R,A=CMD$2.A,Q=CMD$2.Q,i=0,j=0;i<len$$1;){switch(cmd=data[i++],j=i,nPoint=0,cmd){case M:case L:nPoint=1;break;case C:nPoint=3;break;case Q:nPoint=2;break;case A:var x=m[4],y=m[5],sx=mathSqrt$2(m[0]*m[0]+m[1]*m[1]),sy=mathSqrt$2(m[2]*m[2]+m[3]*m[3]),angle=mathAtan2(-m[1]/sy,m[0]/sx);data[i]*=sx,data[i++]+=x,data[i]*=sy,data[i++]+=y,data[i++]*=sx,data[i++]*=sy,data[i++]+=angle,data[i++]+=angle,j=i+=2;break;case R:p[0]=data[i++],p[1]=data[i++],applyTransform(p,p,m),data[j++]=p[0],data[j++]=p[1],p[0]+=data[i++],p[1]+=data[i++],applyTransform(p,p,m),data[j++]=p[0],data[j++]=p[1]}for(k=0;k<nPoint;k++){var p_1=points[k];p_1[0]=data[i++],p_1[1]=data[i++],applyTransform(p_1,p_1,m),data[j++]=p_1[0],data[j++]=p_1[1]}}path.increaseVersion()}}(pathProxy,m),this.dirtyShape()},str}var CircleShape=function(){this.cx=0,this.cy=0,this.r=0},Circle=function(_super){function Circle(opts){return _super.call(this,opts)||this}return __extends(Circle,_super),Circle.prototype.getDefaultShape=function(){return new CircleShape},Circle.prototype.buildPath=function(ctx,shape){ctx.moveTo(shape.cx+shape.r,shape.cy),ctx.arc(shape.cx,shape.cy,shape.r,0,2*Math.PI)},Circle}(Path),EllipseShape=(Circle.prototype.type="circle",function(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}),Ellipse=function(_super){function Ellipse(opts){return _super.call(this,opts)||this}return __extends(Ellipse,_super),Ellipse.prototype.getDefaultShape=function(){return new EllipseShape},Ellipse.prototype.buildPath=function(ctx,shape){var k=.5522848,x=shape.cx,y=shape.cy,a=shape.rx,shape=shape.ry,ox=a*k,k=shape*k;ctx.moveTo(x-a,y),ctx.bezierCurveTo(x-a,y-k,x-ox,y-shape,x,y-shape),ctx.bezierCurveTo(x+ox,y-shape,x+a,y-k,x+a,y),ctx.bezierCurveTo(x+a,y+k,x+ox,y+shape,x,y+shape),ctx.bezierCurveTo(x-ox,y+shape,x-a,y+k,x-a,y),ctx.closePath()},Ellipse}(Path),PI$2=(Ellipse.prototype.type="ellipse",Math.PI),PI2$5=2*PI$2,mathSin$3=Math.sin,mathCos$3=Math.cos,mathACos=Math.acos,mathATan2=Math.atan2,mathAbs$1=Math.abs,mathSqrt$3=Math.sqrt,mathMax$4=Math.max,mathMin$4=Math.min,e=1e-4;function computeCornerTangents(x0,y0,x1,y1,radius,cr,clockwise){var x01=x0-x1,y01=y0-y1,clockwise=(clockwise?cr:-cr)/mathSqrt$3(x01*x01+y01*y01),y01=clockwise*y01,clockwise=-clockwise*x01,x01=x0+y01,x0=y0+clockwise,y0=x1+y01,x1=y1+clockwise,y1=(x01+y0)/2,y00=(x0+x1)/2,dx=y0-x01,dy=x1-x0,d2=dx*dx+dy*dy,cr=radius-cr,x01=x01*x1-y0*x0,x1=(dy<0?-1:1)*mathSqrt$3(mathMax$4(0,cr*cr*d2-x01*x01)),y0=(x01*dy-dx*x1)/d2,x0=(-x01*dx-dy*x1)/d2,cx1=(x01*dy+dx*x1)/d2,x01=(-x01*dx+dy*x1)/d2,dx=y0-y1,dy=x0-y00,x1=cx1-y1,d2=x01-y00;return x1*x1+d2*d2<dx*dx+dy*dy&&(y0=cx1,x0=x01),{cx:y0,cy:x0,x0:-y01,y0:-clockwise,x1:y0*(radius/cr-1),y1:x0*(radius/cr-1)}}function buildPath$1(ctx,shape){var endAngle,cx,cy,clockwise,mod,icrEnd,ocrStart,ocrEnd,ocrMax,icrMax,xrs,yrs,xire,yire,hasArc,arc,limitedOcrMax,limitedIcrMax,xre,yre,xirs,yirs,ocrs,ocre,icrs,icre,crStart,crEnd,ct0,ct1,radius=mathMax$4(shape.r,0),innerRadius=mathMax$4(shape.r0||0,0),hasRadius=0<radius;(hasRadius||0<innerRadius)&&(hasRadius||(radius=innerRadius,innerRadius=0),radius<innerRadius&&(hasRadius=radius,radius=innerRadius,innerRadius=hasRadius),hasRadius=shape.startAngle,endAngle=shape.endAngle,isNaN(hasRadius)||isNaN(endAngle)||(cx=shape.cx,cy=shape.cy,clockwise=!!shape.clockwise,arc=mathAbs$1(endAngle-hasRadius),e<(mod=PI2$5<arc&&arc%PI2$5)&&(arc=mod),e<radius?PI2$5-e<arc?(ctx.moveTo(cx+radius*mathCos$3(hasRadius),cy+radius*mathSin$3(hasRadius)),ctx.arc(cx,cy,radius,hasRadius,endAngle,!clockwise),e<innerRadius&&(ctx.moveTo(cx+innerRadius*mathCos$3(endAngle),cy+innerRadius*mathSin$3(endAngle)),ctx.arc(cx,cy,innerRadius,endAngle,hasRadius,clockwise))):(yirs=xirs=yre=xre=limitedIcrMax=limitedOcrMax=icrMax=ocrMax=icre=icrs=ocre=ocrs=ocrEnd=ocrStart=icrEnd=mod=void 0,xrs=radius*mathCos$3(hasRadius),yrs=radius*mathSin$3(hasRadius),xire=innerRadius*mathCos$3(endAngle),yire=innerRadius*mathSin$3(endAngle),(hasArc=e<arc)&&((shape=shape.cornerRadius)&&(mod=(shape=function(cr){if(isArray(cr)){var len=cr.length;if(!len)return cr;len=1===len?[cr[0],cr[0],0,0]:2===len?[cr[0],cr[0],cr[1],cr[1]]:3===len?cr.concat(cr[2]):cr}else len=[cr,cr,cr,cr];return len}(shape))[0],icrEnd=shape[1],ocrStart=shape[2],ocrEnd=shape[3]),shape=mathAbs$1(radius-innerRadius)/2,ocrs=mathMin$4(shape,ocrStart),ocre=mathMin$4(shape,ocrEnd),icrs=mathMin$4(shape,mod),icre=mathMin$4(shape,icrEnd),limitedOcrMax=ocrMax=mathMax$4(ocrs,ocre),limitedIcrMax=icrMax=mathMax$4(icrs,icre),(e<ocrMax||e<icrMax)&&(xre=radius*mathCos$3(endAngle),yre=radius*mathSin$3(endAngle),xirs=innerRadius*mathCos$3(hasRadius),yirs=innerRadius*mathSin$3(hasRadius),arc<PI$2&&((shape=function(x0,y0,x1,y1,x2,y2,x3,y3){var t=(y3=y3-y2)*(x1=x1-x0)-(x3=x3-x2)*(y1=y1-y0);if(!(t*t<e))return[x0+(t=(x3*(y0-y2)-y3*(x0-x2))/t)*x1,y0+t*y1]}(xrs,yrs,xirs,yirs,xre,yre,xire,yire))&&(ocrs=xrs-shape[0],ocre=yrs-shape[1],icrs=xre-shape[0],icre=yre-shape[1],arc=1/mathSin$3(mathACos((ocrs*icrs+ocre*icre)/(mathSqrt$3(ocrs*ocrs+ocre*ocre)*mathSqrt$3(icrs*icrs+icre*icre)))/2),ocrs=mathSqrt$3(shape[0]*shape[0]+shape[1]*shape[1]),limitedOcrMax=mathMin$4(ocrMax,(radius-ocrs)/(1+arc)),limitedIcrMax=mathMin$4(icrMax,(innerRadius-ocrs)/(arc-1)))))),hasArc?e<limitedOcrMax?(crStart=mathMin$4(ocrStart,limitedOcrMax),crEnd=mathMin$4(ocrEnd,limitedOcrMax),ct0=computeCornerTangents(xirs,yirs,xrs,yrs,radius,crStart,clockwise),ct1=computeCornerTangents(xre,yre,xire,yire,radius,crEnd,clockwise),ctx.moveTo(cx+ct0.cx+ct0.x0,cy+ct0.cy+ct0.y0),limitedOcrMax<ocrMax&&crStart===crEnd?ctx.arc(cx+ct0.cx,cy+ct0.cy,limitedOcrMax,mathATan2(ct0.y0,ct0.x0),mathATan2(ct1.y0,ct1.x0),!clockwise):(0<crStart&&ctx.arc(cx+ct0.cx,cy+ct0.cy,crStart,mathATan2(ct0.y0,ct0.x0),mathATan2(ct0.y1,ct0.x1),!clockwise),ctx.arc(cx,cy,radius,mathATan2(ct0.cy+ct0.y1,ct0.cx+ct0.x1),mathATan2(ct1.cy+ct1.y1,ct1.cx+ct1.x1),!clockwise),0<crEnd&&ctx.arc(cx+ct1.cx,cy+ct1.cy,crEnd,mathATan2(ct1.y1,ct1.x1),mathATan2(ct1.y0,ct1.x0),!clockwise))):(ctx.moveTo(cx+xrs,cy+yrs),ctx.arc(cx,cy,radius,hasRadius,endAngle,!clockwise)):ctx.moveTo(cx+xrs,cy+yrs),e<innerRadius&&hasArc?e<limitedIcrMax?(crStart=mathMin$4(mod,limitedIcrMax),ct0=computeCornerTangents(xire,yire,xre,yre,innerRadius,-(crEnd=mathMin$4(icrEnd,limitedIcrMax)),clockwise),ct1=computeCornerTangents(xrs,yrs,xirs,yirs,innerRadius,-crStart,clockwise),ctx.lineTo(cx+ct0.cx+ct0.x0,cy+ct0.cy+ct0.y0),limitedIcrMax<icrMax&&crStart===crEnd?ctx.arc(cx+ct0.cx,cy+ct0.cy,limitedIcrMax,mathATan2(ct0.y0,ct0.x0),mathATan2(ct1.y0,ct1.x0),!clockwise):(0<crEnd&&ctx.arc(cx+ct0.cx,cy+ct0.cy,crEnd,mathATan2(ct0.y0,ct0.x0),mathATan2(ct0.y1,ct0.x1),!clockwise),ctx.arc(cx,cy,innerRadius,mathATan2(ct0.cy+ct0.y1,ct0.cx+ct0.x1),mathATan2(ct1.cy+ct1.y1,ct1.cx+ct1.x1),clockwise),0<crStart&&ctx.arc(cx+ct1.cx,cy+ct1.cy,crStart,mathATan2(ct1.y1,ct1.x1),mathATan2(ct1.y0,ct1.x0),!clockwise))):(ctx.lineTo(cx+xire,cy+yire),ctx.arc(cx,cy,innerRadius,endAngle,hasRadius,clockwise)):ctx.lineTo(cx+xire,cy+yire)):ctx.moveTo(cx,cy),ctx.closePath()))}var SectorShape=function(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.cornerRadius=0},Sector=function(_super){function Sector(opts){return _super.call(this,opts)||this}return __extends(Sector,_super),Sector.prototype.getDefaultShape=function(){return new SectorShape},Sector.prototype.buildPath=function(ctx,shape){buildPath$1(ctx,shape)},Sector.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},Sector}(Path),RingShape=(Sector.prototype.type="sector",function(){this.cx=0,this.cy=0,this.r=0,this.r0=0}),Ring=function(_super){function Ring(opts){return _super.call(this,opts)||this}return __extends(Ring,_super),Ring.prototype.getDefaultShape=function(){return new RingShape},Ring.prototype.buildPath=function(ctx,shape){var x=shape.cx,y=shape.cy,PI2=2*Math.PI;ctx.moveTo(x+shape.r,y),ctx.arc(x,y,shape.r,0,PI2,!1),ctx.moveTo(x+shape.r0,y),ctx.arc(x,y,shape.r0,0,PI2,!0)},Ring}(Path);function buildPath$2(ctx,shape,closePath){var smooth=shape.smooth,points=shape.points;if(points&&2<=points.length){if(smooth)for(var controlPoints=function(points,smooth,isLoop,constraint){var prevPoint,nextPoint,cps=[],v=[],v1=[],v2=[];if(constraint){for(var min$$1=[1/0,1/0],max$$1=[-1/0,-1/0],i=0,len$$1=points.length;i<len$$1;i++)min(min$$1,min$$1,points[i]),max(max$$1,max$$1,points[i]);min(min$$1,min$$1,constraint[0]),max(max$$1,max$$1,constraint[1])}for(i=0,len$$1=points.length;i<len$$1;i++){var point=points[i];if(isLoop)prevPoint=points[i?i-1:len$$1-1],nextPoint=points[(i+1)%len$$1];else{if(0===i||i===len$$1-1){cps.push(clone$1(points[i]));continue}prevPoint=points[i-1],nextPoint=points[i+1]}sub(v,nextPoint,prevPoint),scale(v,v,smooth);var d0=distance(point,prevPoint),d1=distance(point,nextPoint),sum=d0+d1,sum=(0!==sum&&(d0/=sum,d1/=sum),scale(v1,v,-d0),scale(v2,v,d1),add([],point,v1)),d0=add([],point,v2);constraint&&(max(sum,sum,min$$1),min(sum,sum,max$$1),max(d0,d0,min$$1),min(d0,d0,max$$1)),cps.push(sum),cps.push(d0)}return isLoop&&cps.push(cps.shift()),cps}(points,smooth,closePath,shape.smoothConstraint),len=(ctx.moveTo(points[0][0],points[0][1]),points.length),i=0;i<(closePath?len:len-1);i++){var cp1=controlPoints[2*i],cp2=controlPoints[2*i+1],p=points[(i+1)%len];ctx.bezierCurveTo(cp1[0],cp1[1],cp2[0],cp2[1],p[0],p[1])}else{ctx.moveTo(points[0][0],points[0][1]);for(var i=1,l=points.length;i<l;i++)ctx.lineTo(points[i][0],points[i][1])}closePath&&ctx.closePath()}}Ring.prototype.type="ring";var PolygonShape=function(){this.points=null,this.smooth=0,this.smoothConstraint=null},Polygon=function(_super){function Polygon(opts){return _super.call(this,opts)||this}return __extends(Polygon,_super),Polygon.prototype.getDefaultShape=function(){return new PolygonShape},Polygon.prototype.buildPath=function(ctx,shape){buildPath$2(ctx,shape,!0)},Polygon}(Path),PolylineShape=(Polygon.prototype.type="polygon",function(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}),Polyline=function(_super){function Polyline(opts){return _super.call(this,opts)||this}return __extends(Polyline,_super),Polyline.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},Polyline.prototype.getDefaultShape=function(){return new PolylineShape},Polyline.prototype.buildPath=function(ctx,shape){buildPath$2(ctx,shape,!1)},Polyline}(Path),subPixelOptimizeOutputShape$1=(Polyline.prototype.type="polyline",{}),LineShape=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1},Line=function(_super){function Line(opts){return _super.call(this,opts)||this}return __extends(Line,_super),Line.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},Line.prototype.getDefaultShape=function(){return new LineShape},Line.prototype.buildPath=function(ctx,shape){optimizedShape=this.subPixelOptimize?(x1=(optimizedShape=subPixelOptimizeLine(subPixelOptimizeOutputShape$1,shape,this.style)).x1,y1=optimizedShape.y1,x2=optimizedShape.x2,optimizedShape.y2):(x1=shape.x1,y1=shape.y1,x2=shape.x2,shape.y2);var x1,y1,x2,optimizedShape,shape=shape.percent;0!==shape&&(ctx.moveTo(x1,y1),shape<1&&(x2=x1*(1-shape)+x2*shape,optimizedShape=y1*(1-shape)+optimizedShape*shape),ctx.lineTo(x2,optimizedShape))},Line.prototype.pointAt=function(p){var shape=this.shape;return[shape.x1*(1-p)+shape.x2*p,shape.y1*(1-p)+shape.y2*p]},Line}(Path),out=(Line.prototype.type="line",[]),BezierCurveShape=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1};function someVectorAt(shape,t,isTangent){var cpx2=shape.cpx2,cpy2=shape.cpy2;return null!=cpx2||null!=cpy2?[(isTangent?cubicDerivativeAt:cubicAt)(shape.x1,shape.cpx1,shape.cpx2,shape.x2,t),(isTangent?cubicDerivativeAt:cubicAt)(shape.y1,shape.cpy1,shape.cpy2,shape.y2,t)]:[(isTangent?quadraticDerivativeAt:quadraticAt)(shape.x1,shape.cpx1,shape.x2,t),(isTangent?quadraticDerivativeAt:quadraticAt)(shape.y1,shape.cpy1,shape.y2,t)]}var BezierCurve=function(_super){function BezierCurve(opts){return _super.call(this,opts)||this}return __extends(BezierCurve,_super),BezierCurve.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},BezierCurve.prototype.getDefaultShape=function(){return new BezierCurveShape},BezierCurve.prototype.buildPath=function(ctx,shape){var x1=shape.x1,y1=shape.y1,x2=shape.x2,y2=shape.y2,cpx1=shape.cpx1,cpy1=shape.cpy1,cpx2=shape.cpx2,cpy2=shape.cpy2,shape=shape.percent;0!==shape&&(ctx.moveTo(x1,y1),null==cpx2||null==cpy2?(shape<1&&(quadraticSubdivide(x1,cpx1,x2,shape,out),cpx1=out[1],x2=out[2],quadraticSubdivide(y1,cpy1,y2,shape,out),cpy1=out[1],y2=out[2]),ctx.quadraticCurveTo(cpx1,cpy1,x2,y2)):(shape<1&&(cubicSubdivide(x1,cpx1,cpx2,x2,shape,out),cpx1=out[1],cpx2=out[2],x2=out[3],cubicSubdivide(y1,cpy1,cpy2,y2,shape,out),cpy1=out[1],cpy2=out[2],y2=out[3]),ctx.bezierCurveTo(cpx1,cpy1,cpx2,cpy2,x2,y2)))},BezierCurve.prototype.pointAt=function(t){return someVectorAt(this.shape,t,!1)},BezierCurve.prototype.tangentAt=function(t){t=someVectorAt(this.shape,t,!0);return normalize(t,t)},BezierCurve}(Path),ArcShape=(BezierCurve.prototype.type="bezier-curve",function(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0}),Arc=function(_super){function Arc(opts){return _super.call(this,opts)||this}return __extends(Arc,_super),Arc.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},Arc.prototype.getDefaultShape=function(){return new ArcShape},Arc.prototype.buildPath=function(ctx,shape){var x=shape.cx,y=shape.cy,r=Math.max(shape.r,0),startAngle=shape.startAngle,endAngle=shape.endAngle,shape=shape.clockwise,unitX=Math.cos(startAngle),unitY=Math.sin(startAngle);ctx.moveTo(unitX*r+x,unitY*r+y),ctx.arc(x,y,r,startAngle,endAngle,!shape)},Arc}(Path),CompoundPath=(Arc.prototype.type="arc",function(_super){function CompoundPath(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type="compound",_this}return __extends(CompoundPath,_super),CompoundPath.prototype._updatePathDirty=function(){for(var paths=this.shape.paths,dirtyPath=this.shapeChanged(),i=0;i<paths.length;i++)dirtyPath=dirtyPath||paths[i].shapeChanged();dirtyPath&&this.dirtyShape()},CompoundPath.prototype.beforeBrush=function(){this._updatePathDirty();for(var paths=this.shape.paths||[],scale=this.getGlobalScale(),i=0;i<paths.length;i++)paths[i].path||paths[i].createPathProxy(),paths[i].path.setScale(scale[0],scale[1],paths[i].segmentIgnoreThreshold)},CompoundPath.prototype.buildPath=function(ctx,shape){for(var paths=shape.paths||[],i=0;i<paths.length;i++)paths[i].buildPath(ctx,paths[i].shape,!0)},CompoundPath.prototype.afterBrush=function(){for(var paths=this.shape.paths||[],i=0;i<paths.length;i++)paths[i].pathUpdated()},CompoundPath.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),Path.prototype.getBoundingRect.call(this)},CompoundPath}(Path)),Gradient=function(){function Gradient(colorStops){this.colorStops=colorStops||[]}return Gradient.prototype.addColorStop=function(offset,color){this.colorStops.push({offset:offset,color:color})},Gradient}(),LinearGradient=function(_super){function LinearGradient(x,y,x2,y2,colorStops,globalCoord){colorStops=_super.call(this,colorStops)||this;return colorStops.x=null==x?0:x,colorStops.y=null==y?0:y,colorStops.x2=null==x2?1:x2,colorStops.y2=null==y2?0:y2,colorStops.type="linear",colorStops.global=globalCoord||!1,colorStops}return __extends(LinearGradient,_super),LinearGradient}(Gradient),Gradient=function(_super){function RadialGradient(x,y,r,colorStops,globalCoord){colorStops=_super.call(this,colorStops)||this;return colorStops.x=null==x?.5:x,colorStops.y=null==y?.5:y,colorStops.r=null==r?.5:r,colorStops.type="radial",colorStops.global=globalCoord||!1,colorStops}return __extends(RadialGradient,_super),RadialGradient}(Gradient),extent=[0,0],extent2=[0,0],minTv$1=new Point,maxTv$1=new Point,OrientedBoundingRect=function(){function OrientedBoundingRect(rect,transform){this._corners=[],this._axes=[],this._origin=[0,0];for(var i=0;i<4;i++)this._corners[i]=new Point;for(i=0;i<2;i++)this._axes[i]=new Point;rect&&this.fromBoundingRect(rect,transform)}return OrientedBoundingRect.prototype.fromBoundingRect=function(rect,transform){var corners=this._corners,axes=this._axes,x=rect.x,y=rect.y,x2=x+rect.width,rect=y+rect.height;if(corners[0].set(x,y),corners[1].set(x2,y),corners[2].set(x2,rect),corners[3].set(x,rect),transform)for(var i=0;i<4;i++)corners[i].transform(transform);Point.sub(axes[0],corners[1],corners[0]),Point.sub(axes[1],corners[3],corners[0]),axes[0].normalize(),axes[1].normalize();for(i=0;i<2;i++)this._origin[i]=axes[i].dot(corners[0])},OrientedBoundingRect.prototype.intersect=function(other,mtv){var overlapped=!0,noMtv=!mtv;return minTv$1.set(1/0,1/0),maxTv$1.set(0,0),!this._intersectCheckOneSide(this,other,minTv$1,maxTv$1,noMtv,1)&&(overlapped=!1,noMtv)||!this._intersectCheckOneSide(other,this,minTv$1,maxTv$1,noMtv,-1)&&(overlapped=!1,noMtv)||noMtv||Point.copy(mtv,overlapped?minTv$1:maxTv$1),overlapped},OrientedBoundingRect.prototype._intersectCheckOneSide=function(self,other,minTv,maxTv,noMtv,inverse){for(var overlapped=!0,i=0;i<2;i++){var axis=this._axes[i];if(this._getProjMinMaxOnAxis(i,self._corners,extent),this._getProjMinMaxOnAxis(i,other._corners,extent2),extent[1]<extent2[0]||extent2[1]<extent[0]){if(overlapped=!1,noMtv)return overlapped;var dist0=Math.abs(extent2[0]-extent[1]),dist1=Math.abs(extent[0]-extent2[1]);Math.min(dist0,dist1)>maxTv.len()&&(dist0<dist1?Point.scale(maxTv,axis,-dist0*inverse):Point.scale(maxTv,axis,dist1*inverse))}else minTv&&(dist0=Math.abs(extent2[0]-extent[1]),dist1=Math.abs(extent[0]-extent2[1]),Math.min(dist0,dist1)<minTv.len()&&(dist0<dist1?Point.scale(minTv,axis,dist0*inverse):Point.scale(minTv,axis,-dist1*inverse)))}return overlapped},OrientedBoundingRect.prototype._getProjMinMaxOnAxis=function(dim,corners,out){for(var axis=this._axes[dim],origin=this._origin,proj=corners[0].dot(axis)+origin[dim],min=proj,max=proj,i=1;i<corners.length;i++)var proj_1=corners[i].dot(axis)+origin[dim],min=Math.min(proj_1,min),max=Math.max(proj_1,max);out[0]=min,out[1]=max},OrientedBoundingRect}(),m=[],Element=function(_super){function IncrementalDisplayable(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.notClear=!0,_this.incremental=!0,_this._displayables=[],_this._temporaryDisplayables=[],_this._cursor=0,_this}return __extends(IncrementalDisplayable,_super),IncrementalDisplayable.prototype.traverse=function(cb,context){cb.call(context,this)},IncrementalDisplayable.prototype.useStyle=function(){this.style={}},IncrementalDisplayable.prototype.getCursor=function(){return this._cursor},IncrementalDisplayable.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},IncrementalDisplayable.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},IncrementalDisplayable.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},IncrementalDisplayable.prototype.addDisplayable=function(displayable,notPersistent){(notPersistent?this._temporaryDisplayables:this._displayables).push(displayable),this.markRedraw()},IncrementalDisplayable.prototype.addDisplayables=function(displayables,notPersistent){notPersistent=notPersistent||!1;for(var i=0;i<displayables.length;i++)this.addDisplayable(displayables[i],notPersistent)},IncrementalDisplayable.prototype.getDisplayables=function(){return this._displayables},IncrementalDisplayable.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},IncrementalDisplayable.prototype.eachPendingDisplayable=function(cb){for(var i=this._cursor;i<this._displayables.length;i++)cb&&cb(this._displayables[i]);for(i=0;i<this._temporaryDisplayables.length;i++)cb&&cb(this._temporaryDisplayables[i])},IncrementalDisplayable.prototype.update=function(){this.updateTransform();for(var i=this._cursor;i<this._displayables.length;i++)(displayable=this._displayables[i]).parent=this,displayable.update(),displayable.parent=null;for(var displayable,i=0;i<this._temporaryDisplayables.length;i++)(displayable=this._temporaryDisplayables[i]).parent=this,displayable.update(),displayable.parent=null},IncrementalDisplayable.prototype.getBoundingRect=function(){if(!this._rect){for(var rect=new BoundingRect(1/0,1/0,-1/0,-1/0),i=0;i<this._displayables.length;i++){var displayable=this._displayables[i],childRect=displayable.getBoundingRect().clone();displayable.needLocalTransform()&&childRect.applyTransform(displayable.getLocalTransform(m)),rect.union(childRect)}this._rect=rect}return this._rect},IncrementalDisplayable.prototype.contain=function(x,y){var localPos=this.transformCoordToLocal(x,y);if(this.getBoundingRect().contain(localPos[0],localPos[1]))for(var i=0;i<this._displayables.length;i++)if(this._displayables[i].contain(x,y))return!0;return!1},IncrementalDisplayable}(Element),transitionStore=makeInner();function animateOrSetProps(animationType,el,props,animatableModel,dataIndex,cb,during){var isFrom=!1,isRemove=(isFunction(dataIndex)?(during=cb,cb=dataIndex,dataIndex=null):isObject(dataIndex)&&(cb=dataIndex.cb,during=dataIndex.during,isFrom=dataIndex.isFrom,removeOpt=dataIndex.removeOpt,dataIndex=dataIndex.dataIndex),"leave"===animationType),removeOpt=(isRemove||el.stopAnimation("leave"),function(animationType,animatableModel,dataIndex,extraOpts,extraDelayParams){var updatePayload;animatableModel&&animatableModel.ecModel&&(updatePayload=(updatePayload=animatableModel.ecModel.getUpdatePayload())&&updatePayload.animation);var duration,easing,delay,animationType="update"===animationType;return animatableModel&&animatableModel.isAnimationEnabled()?(delay=easing=duration=void 0,delay=extraOpts?(duration=retrieve2(extraOpts.duration,200),easing=retrieve2(extraOpts.easing,"cubicOut"),0):(duration=animatableModel.getShallow(animationType?"animationDurationUpdate":"animationDuration"),easing=animatableModel.getShallow(animationType?"animationEasingUpdate":"animationEasing"),animatableModel.getShallow(animationType?"animationDelayUpdate":"animationDelay")),updatePayload&&(null!=updatePayload.duration&&(duration=updatePayload.duration),null!=updatePayload.easing&&(easing=updatePayload.easing),null!=updatePayload.delay&&(delay=updatePayload.delay)),isFunction(delay)&&(delay=delay(dataIndex,extraDelayParams)),{duration:(duration=isFunction(duration)?duration(dataIndex):duration)||0,delay:delay,easing:easing}):null}(animationType,animatableModel,dataIndex,isRemove?removeOpt||{}:null,animatableModel&&animatableModel.getAnimationDelayParams?animatableModel.getAnimationDelayParams(el,dataIndex):null));removeOpt&&0<removeOpt.duration?(animatableModel={duration:removeOpt.duration,delay:removeOpt.delay||0,easing:removeOpt.easing,done:cb,force:!!cb||!!during,setToFinal:!isRemove,scope:animationType,during:during},isFrom?el.animateFrom(props,animatableModel):el.animateTo(props,animatableModel)):(el.stopAnimation(),isFrom||el.attr(props),during&&during(1),cb&&cb())}function updateProps(el,props,animatableModel,dataIndex,cb,during){animateOrSetProps("update",el,props,animatableModel,dataIndex,cb,during)}function initProps(el,props,animatableModel,dataIndex,cb,during){animateOrSetProps("enter",el,props,animatableModel,dataIndex,cb,during)}function isElementRemoved(el){if(!el.__zr)return!0;for(var i=0;i<el.animators.length;i++)if("leave"===el.animators[i].scope)return!0;return!1}function removeElement(el,props,animatableModel,dataIndex,cb,during){isElementRemoved(el)||animateOrSetProps("leave",el,props,animatableModel,dataIndex,cb,during)}function fadeOutDisplayable(el,animatableModel,dataIndex,done){el.removeTextContent(),el.removeTextGuideLine(),removeElement(el,{style:{opacity:0}},animatableModel,dataIndex,done)}function removeElementWithFadeOut(el,animatableModel,dataIndex){function doRemove(){el.parent&&el.parent.remove(el)}el.isGroup?el.traverse(function(disp){disp.isGroup||fadeOutDisplayable(disp,animatableModel,dataIndex,doRemove)}):fadeOutDisplayable(el,animatableModel,dataIndex,doRemove)}function saveOldStyle(el){transitionStore(el).oldStyle=el.style}var mathMax$3=Math.max,mathMin$3=Math.min,_customShapeMap={};function extendShape(opts){return Path.extend(opts)}var extendPathFromString=function(str,defaultOpts){var innerOpts=createPathOptions(str,defaultOpts);return function(_super){function Sub(opts){opts=_super.call(this,opts)||this;return opts.applyTransform=innerOpts.applyTransform,opts.buildPath=innerOpts.buildPath,opts}return __extends(Sub,_super),Sub}(SVGPath)};function extendPath(pathData,opts){return extendPathFromString(pathData,opts)}function registerShape(name,ShapeClass){_customShapeMap[name]=ShapeClass}function getShapeClass(name){if(_customShapeMap.hasOwnProperty(name))return _customShapeMap[name]}function makePath(pathData,opts,rect,layout){pathData=function(str,opts){return new SVGPath(createPathOptions(str,opts))}(pathData,opts);return rect&&("center"===layout&&(rect=centerGraphic(rect,pathData.getBoundingRect())),resizePath(pathData,rect)),pathData}function makeImage(imageUrl,rect,layout){var zrImg=new ZRImage({style:{image:imageUrl,x:rect.x,y:rect.y,width:rect.width,height:rect.height},onload:function(img){"center"===layout&&(img={width:img.width,height:img.height},zrImg.setStyle(centerGraphic(rect,img)))}});return zrImg}function centerGraphic(rect,boundingRect){var boundingRect=boundingRect.width/boundingRect.height,width=rect.height*boundingRect,boundingRect=width<=rect.width?rect.height:(width=rect.width)/boundingRect;return{x:rect.x+rect.width/2-width/2,y:rect.y+rect.height/2-boundingRect/2,width:width,height:boundingRect}}function mergePath(pathEls,opts){for(var pathList=[],len=pathEls.length,i=0;i<len;i++){var pathEl=pathEls[i];pathList.push(pathEl.getUpdatedPathProxy(!0))}return(opts=new Path(opts)).createPathProxy(),opts.buildPath=function(path){var ctx;isPathProxy(path)&&(path.appendPath(pathList),(ctx=path.getContext())&&path.rebuildPath(ctx,1))},opts}function resizePath(path,rect){path.applyTransform&&(rect=path.getBoundingRect().calculateTransform(rect),path.applyTransform(rect))}var subPixelOptimize$1=subPixelOptimize;function getTransform(target,ancestor){for(var mat=identity([]);target&&target!==ancestor;)mul$1(mat,target.getLocalTransform(),mat),target=target.parent;return mat}function applyTransform$1(target,transform,invert$$1){return transform&&!isArrayLike(transform)&&(transform=Transformable.getLocalTransform(transform)),applyTransform([],target,transform=invert$$1?invert([],transform):transform)}function transformDirection(direction,transform,invert$$1){var hBase=0===transform[4]||0===transform[5]||0===transform[0]?1:Math.abs(2*transform[4]/transform[0]),vBase=0===transform[4]||0===transform[5]||0===transform[2]?1:Math.abs(2*transform[4]/transform[2]),hBase=applyTransform$1(["left"===direction?-hBase:"right"===direction?hBase:0,"top"===direction?-vBase:"bottom"===direction?vBase:0],transform,invert$$1);return Math.abs(hBase[0])>Math.abs(hBase[1])?0<hBase[0]?"right":"left":0<hBase[1]?"bottom":"top"}function groupTransition(g1,g2,animatableModel){var elMap1,elMap;function getAnimatableProps(el){var obj={x:el.x,y:el.y,rotation:el.rotation};return null!=el.shape&&(obj.shape=extend({},el.shape)),obj}g1&&g2&&(elMap={},g1.traverse(function(el){!el.isGroup&&el.anid&&(elMap[el.anid]=el)}),elMap1=elMap,g2.traverse(function(el){var oldEl,newProp;!el.isGroup&&el.anid&&(oldEl=elMap1[el.anid])&&(newProp=getAnimatableProps(el),el.attr(getAnimatableProps(oldEl)),updateProps(el,newProp,animatableModel,getECData(el).dataIndex))}))}function clipPointsByRect(points,rect){return map(points,function(point){var x=point[0],x=mathMax$3(x,rect.x),point=(x=mathMin$3(x,rect.x+rect.width),point[1]),point=mathMax$3(point,rect.y);return[x,mathMin$3(point,rect.y+rect.height)]})}function clipRectByRect(targetRect,rect){var x=mathMax$3(targetRect.x,rect.x),x2=mathMin$3(targetRect.x+targetRect.width,rect.x+rect.width),y=mathMax$3(targetRect.y,rect.y),targetRect=mathMin$3(targetRect.y+targetRect.height,rect.y+rect.height);if(x<=x2&&y<=targetRect)return{x:x,y:y,width:x2-x,height:targetRect-y}}function createIcon(iconStr,opt,rect){var opt=extend({rectHover:!0},opt),style=opt.style={strokeNoScale:!0};if(rect=rect||{x:-1,y:-1,width:2,height:2},iconStr)return 0===iconStr.indexOf("image://")?(style.image=iconStr.slice(8),defaults(style,rect),new ZRImage(opt)):makePath(iconStr.replace("path://",""),opt,rect,"center")}function lineLineIntersect(a1x,a1y,a2x,a2y,b1x,b1y,b2x,b2y){var a2x=a2x-a1x,a2y=a2y-a1y,b2x=b2x-b1x,b2y=b2y-b1y,nmCrossProduct=b2x*a2y-a2x*b2y;if((val=nmCrossProduct)<=1e-6&&-1e-6<=val)return!1;var val=a1x-b1x,a1x=a1y-b1y,b1x=(val*a2y-a2x*a1x)/nmCrossProduct;if(b1x<0||1<b1x)return!1;a1y=(val*b2y-b2x*a1x)/nmCrossProduct;return!(a1y<0||1<a1y)}function setTooltipConfig(opt){var itemTooltipOption=opt.itemTooltipOption,componentModel=opt.componentModel,itemName=opt.itemName,itemTooltipOption=isString(itemTooltipOption)?{formatter:itemTooltipOption}:itemTooltipOption,mainType=componentModel.mainType,componentModel=componentModel.componentIndex,formatterParams={componentType:mainType,name:itemName,$vars:["name"]},formatterParamsExtra=(formatterParams[mainType+"Index"]=componentModel,opt.formatterParamsExtra),opt=(formatterParamsExtra&&each(keys(formatterParamsExtra),function(key){hasOwn(formatterParams,key)||(formatterParams[key]=formatterParamsExtra[key],formatterParams.$vars.push(key))}),getECData(opt.el));opt.componentMainType=mainType,opt.componentIndex=componentModel,opt.tooltipConfig={name:itemName,option:defaults({content:itemName,formatterParams:formatterParams},itemTooltipOption)}}function traverseElement(el,cb){var stopped;(stopped=el.isGroup?cb(el):stopped)||el.traverse(cb)}function traverseElements(els,cb){if(els)if(isArray(els))for(var i=0;i<els.length;i++)traverseElement(els[i],cb);else traverseElement(els,cb)}registerShape("circle",Circle),registerShape("ellipse",Ellipse),registerShape("sector",Sector),registerShape("ring",Ring),registerShape("polygon",Polygon),registerShape("polyline",Polyline),registerShape("rect",Rect),registerShape("line",Line),registerShape("bezierCurve",BezierCurve),registerShape("arc",Arc);var graphic=(Object.freeze||Object)({updateProps:updateProps,initProps:initProps,removeElement:removeElement,removeElementWithFadeOut:removeElementWithFadeOut,isElementRemoved:isElementRemoved,extendShape:extendShape,extendPath:extendPath,registerShape:registerShape,getShapeClass:getShapeClass,makePath:makePath,makeImage:makeImage,mergePath:mergePath,resizePath:resizePath,subPixelOptimizeLine:function(param){return subPixelOptimizeLine(param.shape,param.shape,param.style),param},subPixelOptimizeRect:function(param){return subPixelOptimizeRect(param.shape,param.shape,param.style),param},subPixelOptimize:subPixelOptimize$1,getTransform:getTransform,applyTransform:applyTransform$1,transformDirection:transformDirection,groupTransition:groupTransition,clipPointsByRect:clipPointsByRect,clipRectByRect:clipRectByRect,createIcon:createIcon,linePolygonIntersect:function(a1x,a1y,a2x,a2y,points){for(var i=0,p2=points[points.length-1];i<points.length;i++){var p=points[i];if(lineLineIntersect(a1x,a1y,a2x,a2y,p[0],p[1],p2[0],p2[1]))return!0;p2=p}},lineLineIntersect:lineLineIntersect,setTooltipConfig:setTooltipConfig,traverseElements:traverseElements,Group:Group,Image:ZRImage,Text:ZRText,Circle:Circle,Ellipse:Ellipse,Sector:Sector,Ring:Ring,Polygon:Polygon,Polyline:Polyline,Rect:Rect,Line:Line,BezierCurve:BezierCurve,Arc:Arc,IncrementalDisplayable:Element,CompoundPath:CompoundPath,LinearGradient:LinearGradient,RadialGradient:Gradient,BoundingRect:BoundingRect,OrientedBoundingRect:OrientedBoundingRect,Point:Point,Path:Path}),EMPTY_OBJ={};function setLabelText(label,labelTexts){for(var i=0;i<SPECIAL_STATES.length;i++){var stateName=SPECIAL_STATES[i],text=labelTexts[stateName],stateName=label.ensureState(stateName);stateName.style=stateName.style||{},stateName.style.text=text}var oldStates=label.currentStates.slice();label.clearStates(!0),label.setStyle({text:labelTexts.normal}),label.useStates(oldStates,!0)}function getLabelText(opt,stateModels,interpolatedValue){for(var baseText,labelFetcher=opt.labelFetcher,labelDataIndex=opt.labelDataIndex,labelDimIndex=opt.labelDimIndex,normalModel=stateModels.normal,statesText={normal:baseText=null==(baseText=labelFetcher?labelFetcher.getFormattedLabel(labelDataIndex,"normal",null,labelDimIndex,normalModel&&normalModel.get("formatter"),null!=interpolatedValue?{interpolatedValue:interpolatedValue}:null):baseText)?isFunction(opt.defaultText)?opt.defaultText(labelDataIndex,opt,interpolatedValue):opt.defaultText:baseText},i=0;i<SPECIAL_STATES.length;i++){var stateName=SPECIAL_STATES[i],stateModel=stateModels[stateName];statesText[stateName]=retrieve2(labelFetcher?labelFetcher.getFormattedLabel(labelDataIndex,stateName,null,labelDimIndex,stateModel&&stateModel.get("formatter")):null,baseText)}return statesText}function setLabelStyle(targetEl,labelStatesModels,opt,stateSpecified){opt=opt||EMPTY_OBJ;for(var isSetOnText=targetEl instanceof ZRText,needsCreateText=!1,i=0;i<DISPLAY_STATES.length;i++)if((stateModel=labelStatesModels[DISPLAY_STATES[i]])&&stateModel.getShallow("show")){needsCreateText=!0;break}var textContent=isSetOnText?targetEl:targetEl.getTextContent();if(needsCreateText){isSetOnText||(textContent||(textContent=new ZRText,targetEl.setTextContent(textContent)),targetEl.stateProxy&&(textContent.stateProxy=targetEl.stateProxy));var labelStatesTexts=getLabelText(opt,labelStatesModels),normalModel=labelStatesModels.normal,showNormal=!!normalModel.getShallow("show"),normalStyle=createTextStyle(normalModel,stateSpecified&&stateSpecified.normal,opt,!1,!isSetOnText);normalStyle.text=labelStatesTexts.normal,isSetOnText||targetEl.setTextConfig(createTextConfig(normalModel,opt,!1));for(i=0;i<SPECIAL_STATES.length;i++){var stateModel,stateObj,stateShow,stateName=SPECIAL_STATES[i];(stateModel=labelStatesModels[stateName])&&(stateObj=textContent.ensureState(stateName),(stateShow=!!retrieve2(stateModel.getShallow("show"),showNormal))!=showNormal&&(stateObj.ignore=!stateShow),stateObj.style=createTextStyle(stateModel,stateSpecified&&stateSpecified[stateName],opt,!0,!isSetOnText),stateObj.style.text=labelStatesTexts[stateName],isSetOnText||(targetEl.ensureState(stateName).textConfig=createTextConfig(stateModel,opt,!0)))}textContent.silent=!!normalModel.getShallow("silent"),null!=textContent.style.x&&(normalStyle.x=textContent.style.x),null!=textContent.style.y&&(normalStyle.y=textContent.style.y),textContent.ignore=!showNormal,textContent.useStyle(normalStyle),textContent.dirty(),opt.enableTextSetter&&(labelInner(textContent).setLabelText=function(interpolatedValue){interpolatedValue=getLabelText(opt,labelStatesModels,interpolatedValue);setLabelText(textContent,interpolatedValue)})}else textContent&&(textContent.ignore=!0);targetEl.dirty()}function getLabelStatesModels(itemModel,labelName){for(var statesModels={normal:itemModel.getModel(labelName=labelName||"label")},i=0;i<SPECIAL_STATES.length;i++){var stateName=SPECIAL_STATES[i];statesModels[stateName]=itemModel.getModel([stateName,labelName])}return statesModels}function createTextStyle(textStyleModel,specifiedTextStyle,opt,isNotNormal,isAttached){var textStyle={};return function(textStyle,textStyleModel,opt,isNotNormal,isAttached){opt=opt||EMPTY_OBJ;var richResult,ecModel=textStyleModel.ecModel,globalTextStyle=ecModel&&ecModel.option.textStyle,richItemNames=function(textStyleModel){var richItemNameMap;for(;textStyleModel&&textStyleModel!==textStyleModel.ecModel;){var rich=(textStyleModel.option||EMPTY_OBJ).rich;if(rich){richItemNameMap=richItemNameMap||{};for(var richKeys=keys(rich),i=0;i<richKeys.length;i++){var richKey=richKeys[i];richItemNameMap[richKey]=1}}textStyleModel=textStyleModel.parentModel}return richItemNameMap}(textStyleModel);if(richItemNames)for(var name_1 in richResult={},richItemNames){var richTextStyle;richItemNames.hasOwnProperty(name_1)&&(richTextStyle=textStyleModel.getModel(["rich",name_1]),setTokenTextStyle(richResult[name_1]={},richTextStyle,globalTextStyle,opt,isNotNormal,isAttached,!1,!0))}richResult&&(textStyle.rich=richResult);ecModel=textStyleModel.get("overflow");ecModel&&(textStyle.overflow=ecModel);ecModel=textStyleModel.get("minMargin");null!=ecModel&&(textStyle.margin=ecModel);setTokenTextStyle(textStyle,textStyleModel,globalTextStyle,opt,isNotNormal,isAttached,!0,!1)}(textStyle,textStyleModel,opt,isNotNormal,isAttached),specifiedTextStyle&&extend(textStyle,specifiedTextStyle),textStyle}function createTextConfig(textStyleModel,opt,isNotNormal){opt=opt||{};var textConfig={},labelRotate=textStyleModel.getShallow("rotate"),labelDistance=retrieve2(textStyleModel.getShallow("distance"),isNotNormal?null:5),labelOffset=textStyleModel.getShallow("offset"),isNotNormal=textStyleModel.getShallow("position")||(isNotNormal?null:"inside");return null!=(isNotNormal="outside"===isNotNormal?opt.defaultOutsidePosition||"top":isNotNormal)&&(textConfig.position=isNotNormal),null!=labelOffset&&(textConfig.offset=labelOffset),null!=labelRotate&&(labelRotate*=Math.PI/180,textConfig.rotation=labelRotate),null!=labelDistance&&(textConfig.distance=labelDistance),textConfig.outsideFill="inherit"===textStyleModel.get("color")?opt.inheritColor||null:"auto",textConfig}var TEXT_PROPS_WITH_GLOBAL=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],TEXT_PROPS_SELF=["align","lineHeight","width","height","tag","verticalAlign"],TEXT_PROPS_BOX=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function setTokenTextStyle(textStyle,textStyleModel,globalTextStyle,opt,isNotNormal,isAttached,isBlock,inRich){globalTextStyle=!isNotNormal&&globalTextStyle||EMPTY_OBJ;var inheritColor=opt&&opt.inheritColor,fillColor=textStyleModel.getShallow("color"),strokeColor=textStyleModel.getShallow("textBorderColor"),opacity=retrieve2(textStyleModel.getShallow("opacity"),globalTextStyle.opacity),fillColor=("inherit"!==fillColor&&"auto"!==fillColor||("auto"===fillColor&&deprecateReplaceLog("color: 'auto'","color: 'inherit'"),fillColor=inheritColor||null),"inherit"!==strokeColor&&"auto"!==strokeColor||("auto"===strokeColor&&deprecateReplaceLog("color: 'auto'","color: 'inherit'"),strokeColor=inheritColor||null),isAttached||(fillColor=fillColor||globalTextStyle.color,strokeColor=strokeColor||globalTextStyle.textBorderColor),null!=fillColor&&(textStyle.fill=fillColor),null!=strokeColor&&(textStyle.stroke=strokeColor),retrieve2(textStyleModel.getShallow("textBorderWidth"),globalTextStyle.textBorderWidth)),strokeColor=(null!=fillColor&&(textStyle.lineWidth=fillColor),retrieve2(textStyleModel.getShallow("textBorderType"),globalTextStyle.textBorderType)),fillColor=(null!=strokeColor&&(textStyle.lineDash=strokeColor),retrieve2(textStyleModel.getShallow("textBorderDashOffset"),globalTextStyle.textBorderDashOffset));null!=fillColor&&(textStyle.lineDashOffset=fillColor),null!=(opacity=isNotNormal||null!=opacity||inRich?opacity:opt&&opt.defaultOpacity)&&(textStyle.opacity=opacity),isNotNormal||isAttached||null==textStyle.fill&&opt.inheritColor&&(textStyle.fill=opt.inheritColor);for(var i=0;i<TEXT_PROPS_WITH_GLOBAL.length;i++){var key=TEXT_PROPS_WITH_GLOBAL[i];null!=(val=retrieve2(textStyleModel.getShallow(key),globalTextStyle[key]))&&(textStyle[key]=val)}for(var i=0;i<TEXT_PROPS_SELF.length;i++){key=TEXT_PROPS_SELF[i];null!=(val=textStyleModel.getShallow(key))&&(textStyle[key]=val)}if(null!=textStyle.verticalAlign||null!=(strokeColor=textStyleModel.getShallow("baseline"))&&(textStyle.verticalAlign=strokeColor),!isBlock||!opt.disableBox){for(i=0;i<TEXT_PROPS_BOX.length;i++){var val,key=TEXT_PROPS_BOX[i];null!=(val=textStyleModel.getShallow(key))&&(textStyle[key]=val)}fillColor=textStyleModel.getShallow("borderType");null!=fillColor&&(textStyle.borderDash=fillColor),"auto"!==textStyle.backgroundColor&&"inherit"!==textStyle.backgroundColor||!inheritColor||("auto"===textStyle.backgroundColor&&deprecateReplaceLog("backgroundColor: 'auto'","backgroundColor: 'inherit'"),textStyle.backgroundColor=inheritColor),"auto"!==textStyle.borderColor&&"inherit"!==textStyle.borderColor||!inheritColor||("auto"===textStyle.borderColor&&deprecateReplaceLog("borderColor: 'auto'","borderColor: 'inherit'"),textStyle.borderColor=inheritColor)}}var labelInner=makeInner();function animateLabelValue(textEl,dataIndex,data,animatableModel,labelFetcher){var defaultInterpolatedText,currValue,targetValue,labelInnerStore=labelInner(textEl);labelInnerStore.valueAnimation&&labelInnerStore.prevValue!==labelInnerStore.value&&(defaultInterpolatedText=labelInnerStore.defaultInterpolatedText,currValue=retrieve2(labelInnerStore.interpolatedValue,labelInnerStore.prevValue),targetValue=labelInnerStore.value,textEl.percent=0,(null==labelInnerStore.prevValue?initProps:updateProps)(textEl,{percent:1},animatableModel,dataIndex,null,function(percent){var interpolated=interpolateRawValues(data,labelInnerStore.precision,currValue,targetValue,percent),percent=(labelInnerStore.interpolatedValue=1===percent?null:interpolated,getLabelText({labelDataIndex:dataIndex,labelFetcher:labelFetcher,defaultText:defaultInterpolatedText?defaultInterpolatedText(interpolated):interpolated+""},labelInnerStore.statesModels,interpolated));setLabelText(textEl,percent)}))}var classAttr,PATH_COLOR=["textStyle","color"],textStyleParams=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],tmpText=new ZRText,subPixelOptimize$1=function(){function TextStyleMixin(){}return TextStyleMixin.prototype.getTextColor=function(isEmphasis){var ecModel=this.ecModel;return this.getShallow("color")||(!isEmphasis&&ecModel?ecModel.get(PATH_COLOR):null)},TextStyleMixin.prototype.getFont=function(){return opt={fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},ecModel=(ecModel=this.ecModel)&&ecModel.getModel("textStyle"),trim([opt.fontStyle||ecModel&&ecModel.getShallow("fontStyle")||"",opt.fontWeight||ecModel&&ecModel.getShallow("fontWeight")||"",(opt.fontSize||ecModel&&ecModel.getShallow("fontSize")||12)+"px",opt.fontFamily||ecModel&&ecModel.getShallow("fontFamily")||"sans-serif"].join(" "));var opt,ecModel},TextStyleMixin.prototype.getTextRect=function(text){for(var style={text:text,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},i=0;i<textStyleParams.length;i++)style[textStyleParams[i]]=this.getShallow(textStyleParams[i]);return tmpText.useStyle(style),tmpText.update(),tmpText.getBoundingRect()},TextStyleMixin}(),LINE_STYLE_KEY_MAP=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],getLineStyle=makeStyleMapper(LINE_STYLE_KEY_MAP),LineStyleMixin=function(){function LineStyleMixin(){}return LineStyleMixin.prototype.getLineStyle=function(excludes){return getLineStyle(this,excludes)},LineStyleMixin}(),ITEM_STYLE_KEY_MAP=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],getItemStyle=makeStyleMapper(ITEM_STYLE_KEY_MAP),ItemStyleMixin=function(){function ItemStyleMixin(){}return ItemStyleMixin.prototype.getItemStyle=function(excludes,includes){return getItemStyle(this,excludes,includes)},ItemStyleMixin}(),Model=function(){function Model(option,parentModel,ecModel){this.parentModel=parentModel,this.ecModel=ecModel,this.option=option}return Model.prototype.init=function(option,parentModel,ecModel){for(var rest=[],_i=3;_i<arguments.length;_i++)rest[_i-3]=arguments[_i]},Model.prototype.mergeOption=function(option,ecModel){merge(this.option,option,!0)},Model.prototype.get=function(path,ignoreParent){return null==path?this.option:this._doGet(this.parsePath(path),!ignoreParent&&this.parentModel)},Model.prototype.getShallow=function(key,ignoreParent){var option=this.option,option=null==option?option:option[key];return null!=option||ignoreParent||(ignoreParent=this.parentModel)&&(option=ignoreParent.getShallow(key)),option},Model.prototype.getModel=function(path,parentModel){var hasPath=null!=path,path=hasPath?this.parsePath(path):null;return new Model(hasPath?this._doGet(path):this.option,parentModel=parentModel||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(path)),this.ecModel)},Model.prototype.isEmpty=function(){return null==this.option},Model.prototype.restoreData=function(){},Model.prototype.clone=function(){return new this.constructor(clone(this.option))},Model.prototype.parsePath=function(path){return"string"==typeof path?path.split("."):path},Model.prototype.resolveParentPath=function(path){return path},Model.prototype.isAnimationEnabled=function(){if(!env.node&&this.option)return null!=this.option.animation?!!this.option.animation:this.parentModel?this.parentModel.isAnimationEnabled():void 0},Model.prototype._doGet=function(pathArr,parentModel){var obj=this.option;if(!pathArr)return obj;for(var i=0;i<pathArr.length&&(!pathArr[i]||null!=(obj=obj&&"object"==typeof obj?obj[pathArr[i]]:null));i++);return obj=null==obj&&parentModel?parentModel._doGet(this.resolveParentPath(pathArr),parentModel.parentModel):obj},Model}(),base=(enableClassExtend(Model),target=Model,classAttr=["__\0is_clz",classBase++].join("_"),target.prototype[classAttr]=!0,assert(!target.isInstance,'The method "is" can not be defined.'),target.isInstance=function(obj){return!(!obj||!obj[classAttr])},mixin(Model,LineStyleMixin),mixin(Model,ItemStyleMixin),mixin(Model,AreaStyleMixin),mixin(Model,subPixelOptimize$1),Math.round(10*Math.random()));function getUID(type){return[type||"",base++].join("_")}function inheritDefaultOption(superOption,subOption){return merge(merge({},superOption,!0),subOption,!0)}var LOCALE_ZH="ZH",LOCALE_EN="EN",DEFAULT_LOCALE=LOCALE_EN,localeStorage={},localeModels={},SYSTEM_LANG=env.domSupported&&-1<(document.documentElement.lang||navigator.language||navigator.browserLanguage).toUpperCase().indexOf(LOCALE_ZH)?LOCALE_ZH:DEFAULT_LOCALE;function registerLocale(locale,localeObj){locale=locale.toUpperCase(),localeModels[locale]=new Model(localeObj),localeStorage[locale]=localeObj}registerLocale(LOCALE_EN,{time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}}),registerLocale(LOCALE_ZH,{time:{month:["","","","","","","","","","","",""],monthAbbr:["1","2","3","4","5","6","7","8","9","10","11","12"],dayOfWeek:["","","","","","",""],dayOfWeekAbbr:["","","","","","",""]},legend:{selector:{all:"",inverse:""}},toolbox:{brush:{title:{rect:"",polygon:"",lineX:"",lineY:"",keep:"",clear:""}},dataView:{title:"",lang:["","",""]},dataZoom:{title:{zoom:"",back:""}},magicType:{title:{line:"",bar:"",stack:"",tiled:""}},restore:{title:""},saveAsImage:{title:"",lang:[""]}},series:{typeNames:{pie:"",bar:"",line:"",scatter:"",effectScatter:"",radar:"",tree:"",treemap:"",boxplot:"",candlestick:"K",k:"K",heatmap:"",map:"",parallel:"",lines:"",graph:"",sankey:"",funnel:"",gauge:"",pictorialBar:"",themeRiver:"",sunburst:""}},aria:{general:{withTitle:"{title}",withoutTitle:""},series:{single:{prefix:"",withName:"{seriesType}{seriesName}",withoutName:"{seriesType}"},multiple:{prefix:"{seriesCount}",withName:"{seriesId}{seriesName}{seriesType}",withoutName:"{seriesId}{seriesType}",separator:{middle:"",end:""}}},data:{allData:"",partialData:"{displayCnt}",withName:"{name}{value}",withoutName:"{value}",separator:{middle:"",end:""}}}});var ONE_SECOND=1e3,ONE_MINUTE=60*ONE_SECOND,ONE_HOUR=60*ONE_MINUTE,ONE_DAY=24*ONE_HOUR,classBase=365*ONE_DAY,defaultLeveledFormatter={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},fullLeveledFormatter={year:"{yyyy}",month:"{yyyy}-{MM}",day:"{yyyy}-{MM}-{dd}",hour:"{yyyy}-{MM}-{dd} "+defaultLeveledFormatter.hour,minute:"{yyyy}-{MM}-{dd} "+defaultLeveledFormatter.minute,second:"{yyyy}-{MM}-{dd} "+defaultLeveledFormatter.second,millisecond:defaultLeveledFormatter.none},primaryTimeUnits=["year","month","day","hour","minute","second","millisecond"],timeUnits=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function pad(str,len){return"0000".substr(0,len-(str+="").length)+str}function getPrimaryTimeUnit(timeUnit){switch(timeUnit){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return timeUnit}}function format(time,template,isUTC,lang){var time=parseDate(time),y=time[fullYearGetterName(isUTC)](),M=time[monthGetterName(isUTC)]()+1,q=Math.floor((M-1)/4)+1,d=time[dateGetterName(isUTC)](),e=time["get"+(isUTC?"UTC":"")+"Day"](),H=time[hoursGetterName(isUTC)](),h=(H-1)%12+1,m=time[minutesGetterName(isUTC)](),s=time[secondsGetterName(isUTC)](),time=time[millisecondsGetterName(isUTC)](),isUTC=(lang instanceof Model?lang:function(lang){return localeModels[lang]}(lang||SYSTEM_LANG)||localeModels[DEFAULT_LOCALE]).getModel("time"),lang=isUTC.get("month"),monthAbbr=isUTC.get("monthAbbr"),dayOfWeek=isUTC.get("dayOfWeek"),isUTC=isUTC.get("dayOfWeekAbbr");return(template||"").replace(/{yyyy}/g,y+"").replace(/{yy}/g,y%100+"").replace(/{Q}/g,q+"").replace(/{MMMM}/g,lang[M-1]).replace(/{MMM}/g,monthAbbr[M-1]).replace(/{MM}/g,pad(M,2)).replace(/{M}/g,M+"").replace(/{dd}/g,pad(d,2)).replace(/{d}/g,d+"").replace(/{eeee}/g,dayOfWeek[e]).replace(/{ee}/g,isUTC[e]).replace(/{e}/g,e+"").replace(/{HH}/g,pad(H,2)).replace(/{H}/g,H+"").replace(/{hh}/g,pad(h+"",2)).replace(/{h}/g,h+"").replace(/{mm}/g,pad(m,2)).replace(/{m}/g,m+"").replace(/{ss}/g,pad(s,2)).replace(/{s}/g,s+"").replace(/{SSS}/g,pad(time,3)).replace(/{S}/g,time+"")}function getUnitFromValue(value,isUTC){var value=parseDate(value),M=value[monthGetterName(isUTC)]()+1,d=value[dateGetterName(isUTC)](),h=value[hoursGetterName(isUTC)](),m=value[minutesGetterName(isUTC)](),s=value[secondsGetterName(isUTC)](),value=0===value[millisecondsGetterName(isUTC)](),isUTC=value&&0===s,s=isUTC&&0===m,m=s&&0===h,h=m&&1===d;return h&&1===M?"year":h?"month":m?"day":s?"hour":isUTC?"minute":value?"second":"millisecond"}function getUnitValue(value,unit,isUTC){var date=isNumber(value)?parseDate(value):value;switch(unit=unit||getUnitFromValue(value,isUTC)){case"year":return date[fullYearGetterName(isUTC)]();case"half-year":return 6<=date[monthGetterName(isUTC)]()?1:0;case"quarter":return Math.floor((date[monthGetterName(isUTC)]()+1)/4);case"month":return date[monthGetterName(isUTC)]();case"day":return date[dateGetterName(isUTC)]();case"half-day":return date[hoursGetterName(isUTC)]()/24;case"hour":return date[hoursGetterName(isUTC)]();case"minute":return date[minutesGetterName(isUTC)]();case"second":return date[secondsGetterName(isUTC)]();case"millisecond":return date[millisecondsGetterName(isUTC)]()}}function fullYearGetterName(isUTC){return isUTC?"getUTCFullYear":"getFullYear"}function monthGetterName(isUTC){return isUTC?"getUTCMonth":"getMonth"}function dateGetterName(isUTC){return isUTC?"getUTCDate":"getDate"}function hoursGetterName(isUTC){return isUTC?"getUTCHours":"getHours"}function minutesGetterName(isUTC){return isUTC?"getUTCMinutes":"getMinutes"}function secondsGetterName(isUTC){return isUTC?"getUTCSeconds":"getSeconds"}function millisecondsGetterName(isUTC){return isUTC?"getUTCMilliseconds":"getMilliseconds"}function monthSetterName(isUTC){return isUTC?"setUTCMonth":"setMonth"}function dateSetterName(isUTC){return isUTC?"setUTCDate":"setDate"}function hoursSetterName(isUTC){return isUTC?"setUTCHours":"setHours"}function minutesSetterName(isUTC){return isUTC?"setUTCMinutes":"setMinutes"}function secondsSetterName(isUTC){return isUTC?"setUTCSeconds":"setSeconds"}function millisecondsSetterName(isUTC){return isUTC?"setUTCMilliseconds":"setMilliseconds"}function addCommas(x){if(!isNumeric(x))return isString(x)?x:"-";x=(x+"").split(".");return x[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(1<x.length?"."+x[1]:"")}function toCamelCase(str,upperCaseFirst){return str=(str||"").toLowerCase().replace(/-(.)/g,function(match,group1){return group1.toUpperCase()}),str=upperCaseFirst&&str?str.charAt(0).toUpperCase()+str.slice(1):str}var normalizeCssArray$1=normalizeCssArray,replaceReg=/([&<>"'])/g,replaceMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function encodeHTML(source){return null==source?"":(source+"").replace(replaceReg,function(str,c){return replaceMap[c]})}function makeValueReadable(value,valueType,useUTC){function stringToUserReadable(str){return str&&trim(str)?str:"-"}function isNumberUserReadable(num){return null!=num&&!isNaN(num)&&isFinite(num)}var isTypeTime="time"===valueType,isValueDate=value instanceof Date;if(isTypeTime||isValueDate){isTypeTime=isTypeTime?parseDate(value):value;if(!isNaN(+isTypeTime))return format(isTypeTime,"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}",useUTC);if(isValueDate)return"-"}if("ordinal"===valueType)return isStringSafe(value)?stringToUserReadable(value):isNumber(value)&&isNumberUserReadable(value)?value+"":"-";isTypeTime=numericToNumber(value);return isNumberUserReadable(isTypeTime)?addCommas(isTypeTime):isStringSafe(value)?stringToUserReadable(value):"boolean"==typeof value?value+"":"-"}function wrapVar(varName,seriesIdx){return"{"+varName+(null==seriesIdx?"":seriesIdx)+"}"}var TPL_VAR_ALIAS=["a","b","c","d","e","f","g"];function formatTpl(tpl,paramsList,encode){var seriesLen=(paramsList=isArray(paramsList)?paramsList:[paramsList]).length;if(!seriesLen)return"";for(var $vars=paramsList[0].$vars||[],i=0;i<$vars.length;i++){var alias=TPL_VAR_ALIAS[i];tpl=tpl.replace(wrapVar(alias),wrapVar(alias,0))}for(var seriesIdx=0;seriesIdx<seriesLen;seriesIdx++)for(var k=0;k<$vars.length;k++){var val=paramsList[seriesIdx][$vars[k]];tpl=tpl.replace(wrapVar(TPL_VAR_ALIAS[k],seriesIdx),encode?encodeHTML(val):val)}return tpl}function getTooltipMarker(inOpt,extraCssText){var inOpt=isString(inOpt)?{color:inOpt,extraCssText:extraCssText}:inOpt||{},color=inOpt.color,type=inOpt.type,renderMode=(extraCssText=inOpt.extraCssText,inOpt.renderMode||"html");return color?"html"===renderMode?"subItem"===type?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+encodeHTML(color)+";"+(extraCssText||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+encodeHTML(color)+";"+(extraCssText||"")+'"></span>':{renderMode:renderMode,content:"{"+(inOpt.markerId||"markerX")+"|}  ",style:"subItem"===type?{width:4,height:4,borderRadius:2,backgroundColor:color}:{width:10,height:10,borderRadius:5,backgroundColor:color}}:""}function convertToColorString(color,defaultColor){return defaultColor=defaultColor||"transparent",isString(color)?color:isObject(color)&&color.colorStops&&(color.colorStops[0]||{}).color||defaultColor}var each$1=each,LOCATION_PARAMS=["left","right","top","bottom","width","height"],HV_NAMES=[["width","left","right"],["height","top","bottom"]];function boxLayout(orient,group,gap,maxWidth,maxHeight){var x=0,y=0,currentLineMaxSize=(null==maxWidth&&(maxWidth=1/0),null==maxHeight&&(maxHeight=1/0),0);group.eachChild(function(child,idx){var nextX,moveX,nextY,rect=child.getBoundingRect(),idx=group.childAt(idx+1),idx=idx&&idx.getBoundingRect();currentLineMaxSize="horizontal"===orient?(moveX=rect.width+(idx?-idx.x+rect.x:0),maxWidth<(nextX=x+moveX)||child.newline?(x=0,nextX=moveX,y+=currentLineMaxSize+gap,rect.height):Math.max(currentLineMaxSize,rect.height)):(moveX=rect.height+(idx?-idx.y+rect.y:0),maxHeight<(nextY=y+moveX)||child.newline?(x+=currentLineMaxSize+gap,y=0,nextY=moveX,rect.width):Math.max(currentLineMaxSize,rect.width)),child.newline||(child.x=x,child.y=y,child.markRedraw(),"horizontal"===orient?x=nextX+gap:y=nextY+gap)})}curry(boxLayout,"vertical"),curry(boxLayout,"horizontal");function getLayoutRect(positionInfo,containerRect,margin){margin=normalizeCssArray$1(margin||0);var containerWidth=containerRect.width,containerHeight=containerRect.height,left=parsePercent$1(positionInfo.left,containerWidth),top=parsePercent$1(positionInfo.top,containerHeight),containerRect=parsePercent$1(positionInfo.right,containerWidth),bottom=parsePercent$1(positionInfo.bottom,containerHeight),width=parsePercent$1(positionInfo.width,containerWidth),height=parsePercent$1(positionInfo.height,containerHeight),verticalMargin=margin[2]+margin[0],horizontalMargin=margin[1]+margin[3],aspect=positionInfo.aspect;switch(isNaN(width)&&(width=containerWidth-containerRect-horizontalMargin-left),isNaN(height)&&(height=containerHeight-bottom-verticalMargin-top),null!=aspect&&(isNaN(width)&&isNaN(height)&&(containerWidth/containerHeight<aspect?width=.8*containerWidth:height=.8*containerHeight),isNaN(width)&&(width=aspect*height),isNaN(height)&&(height=width/aspect)),isNaN(left)&&(left=containerWidth-containerRect-width-horizontalMargin),isNaN(top)&&(top=containerHeight-bottom-height-verticalMargin),positionInfo.left||positionInfo.right){case"center":left=containerWidth/2-width/2-margin[3];break;case"right":left=containerWidth-width-horizontalMargin}switch(positionInfo.top||positionInfo.bottom){case"middle":case"center":top=containerHeight/2-height/2-margin[0];break;case"bottom":top=containerHeight-height-verticalMargin}left=left||0,top=top||0,isNaN(width)&&(width=containerWidth-horizontalMargin-left-(containerRect||0)),isNaN(height)&&(height=containerHeight-verticalMargin-top-(bottom||0));aspect=new BoundingRect(left+margin[3],top+margin[0],width,height);return aspect.margin=margin,aspect}function fetchLayoutMode(ins){ins=ins.layoutMode||ins.constructor.layoutMode;return isObject(ins)?ins:ins?{type:ins}:null}function mergeLayoutParam(targetOption,newOption,opt){var ignoreSize=opt&&opt.ignoreSize,opt=(isArray(ignoreSize)||(ignoreSize=[ignoreSize,ignoreSize]),merge$$1(HV_NAMES[0],0)),vResult=merge$$1(HV_NAMES[1],1);function merge$$1(names,hvIdx){var newParams={},newValueCount=0,merged={},mergedValueCount=0;if(each$1(names,function(name){merged[name]=targetOption[name]}),each$1(names,function(name){hasProp(newOption,name)&&(newParams[name]=merged[name]=newOption[name]),hasValue(newParams,name)&&newValueCount++,hasValue(merged,name)&&mergedValueCount++}),ignoreSize[hvIdx])return hasValue(newOption,names[1])?merged[names[2]]=null:hasValue(newOption,names[2])&&(merged[names[1]]=null),merged;if(2!==mergedValueCount&&newValueCount){if(2<=newValueCount)return newParams;for(var i=0;i<names.length;i++){var name_1=names[i];if(!hasProp(newParams,name_1)&&hasProp(targetOption,name_1)){newParams[name_1]=targetOption[name_1];break}}return newParams}return merged}function hasProp(obj,name){return obj.hasOwnProperty(name)}function hasValue(obj,name){return null!=obj[name]&&"auto"!==obj[name]}function copy(names,target,source){each$1(names,function(name){target[name]=source[name]})}copy(HV_NAMES[0],targetOption,opt),copy(HV_NAMES[1],targetOption,vResult)}function getLayoutParams(source){return function(target,source){return source&&target&&each$1(LOCATION_PARAMS,function(name){source.hasOwnProperty(name)&&(target[name]=source[name])}),target}({},source)}var dependencyGetter,inner=makeInner(),ComponentModel=function(_super){function ComponentModel(option,parentModel,ecModel){option=_super.call(this,option,parentModel,ecModel)||this;return option.uid=getUID("ec_cpt_model"),option}var proto;return __extends(ComponentModel,_super),ComponentModel.prototype.init=function(option,parentModel,ecModel){this.mergeDefaultAndTheme(option,ecModel)},ComponentModel.prototype.mergeDefaultAndTheme=function(option,ecModel){var layoutMode=fetchLayoutMode(this),inputPositionParams=layoutMode?getLayoutParams(option):{};merge(option,ecModel.getTheme().get(this.mainType)),merge(option,this.getDefaultOption()),layoutMode&&mergeLayoutParam(option,inputPositionParams,layoutMode)},ComponentModel.prototype.mergeOption=function(option,ecModel){merge(this.option,option,!0);var layoutMode=fetchLayoutMode(this);layoutMode&&mergeLayoutParam(this.option,option,layoutMode)},ComponentModel.prototype.optionUpdated=function(newCptOption,isInit){},ComponentModel.prototype.getDefaultOption=function(){var ctor=this.constructor;if(!function(clz){return clz&&clz.___EC__EXTENDED_CLASS___}(ctor))return ctor.defaultOption;var fields=inner(this);if(!fields.defaultOption){for(var optList=[],clz=ctor;clz;){var opt=clz.prototype.defaultOption;opt&&optList.push(opt),clz=clz.superClass}for(var defaultOption={},i=optList.length-1;0<=i;i--)defaultOption=merge(defaultOption,optList[i],!0);fields.defaultOption=defaultOption}return fields.defaultOption},ComponentModel.prototype.getReferringComponents=function(mainType,opt){var idKey=mainType+"Id";return queryReferringComponents(this.ecModel,mainType,{index:this.get(mainType+"Index",!0),id:this.get(idKey,!0)},opt)},ComponentModel.prototype.getBoxLayoutParams=function(){return{left:this.get("left"),top:this.get("top"),right:this.get("right"),bottom:this.get("bottom"),width:this.get("width"),height:this.get("height")}},ComponentModel.prototype.getZLevelKey=function(){return""},ComponentModel.prototype.setZLevel=function(zlevel){this.option.zlevel=zlevel},ComponentModel.protoInitialize=((proto=ComponentModel.prototype).type="component",proto.id="",proto.name="",proto.mainType="",proto.subType="",void(proto.componentIndex=0)),ComponentModel}(Model);function createDependencyGraphItem(graph,name){return graph[name]||(graph[name]={predecessor:[],successor:[]}),graph[name]}mountExtend(ComponentModel,Model),enableClassManagement(ComponentModel),function(target){var subTypeDefaulters={};target.registerSubTypeDefaulter=function(componentType,defaulter){componentType=parseClassType(componentType);subTypeDefaulters[componentType.main]=defaulter},target.determineSubType=function(componentType,option){var componentTypeMain,type=option.type;return type||(componentTypeMain=parseClassType(componentType).main,target.hasSubTypes(componentType)&&subTypeDefaulters[componentTypeMain]&&(type=subTypeDefaulters[componentTypeMain](option))),type}}(ComponentModel),dependencyGetter=function(componentType){var deps=[];each(ComponentModel.getClassesByMainType(componentType),function(clz){deps=deps.concat(clz.dependencies||clz.prototype.dependencies||[])}),deps=map(deps,function(type){return parseClassType(type).main}),"dataset"!==componentType&&indexOf(deps,"dataset")<=0&&deps.unshift("dataset");return deps},ComponentModel.topologicalTravel=function(targetNameList,fullNameList,callback,context){if(targetNameList.length){var result=function(fullNameList){var graph={},noEntryList=[];return each(fullNameList,function(name){var thisItem=createDependencyGraphItem(graph,name),availableDeps=function(originalDeps,fullNameList){var availableDeps=[];return each(originalDeps,function(dep){0<=indexOf(fullNameList,dep)&&availableDeps.push(dep)}),availableDeps}(thisItem.originalDeps=dependencyGetter(name),fullNameList);thisItem.entryCount=availableDeps.length,0===thisItem.entryCount&&noEntryList.push(name),each(availableDeps,function(dependentName){indexOf(thisItem.predecessor,dependentName)<0&&thisItem.predecessor.push(dependentName);var thatItem=createDependencyGraphItem(graph,dependentName);indexOf(thatItem.successor,dependentName)<0&&thatItem.successor.push(name)})}),{graph:graph,noEntryList:noEntryList}}(fullNameList),graph=result.graph,noEntryList=result.noEntryList,targetNameSet={};for(each(targetNameList,function(name){targetNameSet[name]=!0});noEntryList.length;){var currComponentType=noEntryList.pop(),currVertex=graph[currComponentType],isInTargetNameSet=!!targetNameSet[currComponentType];isInTargetNameSet&&(callback.call(context,currComponentType,currVertex.originalDeps.slice()),delete targetNameSet[currComponentType]),each(currVertex.successor,isInTargetNameSet?removeEdgeAndAdd:removeEdge)}each(targetNameSet,function(){var errMsg=makePrintable("Circular dependency may exists: ",targetNameSet,targetNameList,fullNameList);throw new Error(errMsg)})}function removeEdge(succComponentType){graph[succComponentType].entryCount--,0===graph[succComponentType].entryCount&&noEntryList.push(succComponentType)}function removeEdgeAndAdd(succComponentType){targetNameSet[succComponentType]=!0,removeEdge(succComponentType)}};var target="",LineStyleMixin=("undefined"!=typeof navigator&&(target=navigator.platform||""),"rgba(0, 0, 0, 0.2)"),globalDefault={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:LineStyleMixin,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:LineStyleMixin,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:LineStyleMixin,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:LineStyleMixin,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:LineStyleMixin,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:LineStyleMixin,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:target.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1},VISUAL_DIMENSIONS=new HashMap(["tooltip","label","itemName","itemId","itemGroupId","seriesName"]),SOURCE_FORMAT_ORIGINAL="original",SOURCE_FORMAT_ARRAY_ROWS="arrayRows",SOURCE_FORMAT_OBJECT_ROWS="objectRows",SOURCE_FORMAT_KEYED_COLUMNS="keyedColumns",SOURCE_FORMAT_TYPED_ARRAY="typedArray",SOURCE_FORMAT_UNKNOWN="unknown",SERIES_LAYOUT_BY_COLUMN="column",SERIES_LAYOUT_BY_ROW="row",BE_ORDINAL={Must:1,Might:2,Not:3},innerGlobalModel=makeInner();function makeSeriesEncodeForAxisCoordSys(coordDimensions,seriesModel,source){var encode={},datasetModel=querySeriesUpstreamDatasetModel(seriesModel);if(!datasetModel||!coordDimensions)return encode;var baseCategoryDimIndex,categoryWayValueDimStart,encodeItemName=[],encodeSeriesName=[],seriesModel=seriesModel.ecModel,seriesModel=innerGlobalModel(seriesModel).datasetMap,datasetModel=datasetModel.uid+"_"+source.seriesLayoutBy,datasetRecord=(each(coordDimensions=coordDimensions.slice(),function(coordDimInfoLoose,coordDimIdx){coordDimInfoLoose=isObject(coordDimInfoLoose)?coordDimInfoLoose:coordDimensions[coordDimIdx]={name:coordDimInfoLoose};"ordinal"===coordDimInfoLoose.type&&null==baseCategoryDimIndex&&(baseCategoryDimIndex=coordDimIdx,categoryWayValueDimStart=getDataDimCountOnCoordDim(coordDimInfoLoose)),encode[coordDimInfoLoose.name]=[]}),seriesModel.get(datasetModel)||seriesModel.set(datasetModel,{categoryWayDim:categoryWayValueDimStart,valueWayDim:0}));function pushDim(dimIdxArr,idxFrom,idxCount){for(var i=0;i<idxCount;i++)dimIdxArr.push(idxFrom+i)}function getDataDimCountOnCoordDim(coordDimInfo){coordDimInfo=coordDimInfo.dimsDef;return coordDimInfo?coordDimInfo.length:1}return each(coordDimensions,function(coordDimInfo,coordDimIdx){var start,coordDimName=coordDimInfo.name,coordDimInfo=getDataDimCountOnCoordDim(coordDimInfo);null==baseCategoryDimIndex?(start=datasetRecord.valueWayDim,pushDim(encode[coordDimName],start,coordDimInfo),pushDim(encodeSeriesName,start,coordDimInfo),datasetRecord.valueWayDim+=coordDimInfo):baseCategoryDimIndex===coordDimIdx?(pushDim(encode[coordDimName],0,coordDimInfo),pushDim(encodeItemName,0,coordDimInfo)):(start=datasetRecord.categoryWayDim,pushDim(encode[coordDimName],start,coordDimInfo),pushDim(encodeSeriesName,start,coordDimInfo),datasetRecord.categoryWayDim+=coordDimInfo)}),encodeItemName.length&&(encode.itemName=encodeItemName),encodeSeriesName.length&&(encode.seriesName=encodeSeriesName),encode}function querySeriesUpstreamDatasetModel(seriesModel){if(!seriesModel.get("data",!0))return queryReferringComponents(seriesModel.ecModel,"dataset",{index:seriesModel.get("datasetIndex",!0),id:seriesModel.get("datasetId",!0)},SINGLE_REFERRING).models[0]}function guessOrdinal(source,dimIndex){return function(data,sourceFormat,seriesLayoutBy,dimensionsDefine,startIndex,dimIndex){var result,dimName,dimType;if(isTypedArray(data))return BE_ORDINAL.Not;dimensionsDefine&&(isObject(dimensionsDefine=dimensionsDefine[dimIndex])?(dimName=dimensionsDefine.name,dimType=dimensionsDefine.type):isString(dimensionsDefine)&&(dimName=dimensionsDefine));if(null!=dimType)return"ordinal"===dimType?BE_ORDINAL.Must:BE_ORDINAL.Not;if(sourceFormat===SOURCE_FORMAT_ARRAY_ROWS){var dataArrayRows=data;if(seriesLayoutBy===SERIES_LAYOUT_BY_ROW){for(var sample=dataArrayRows[dimIndex],i=0;i<(sample||[]).length&&i<5;i++)if(null!=(result=detectValue(sample[startIndex+i])))return result}else for(i=0;i<dataArrayRows.length&&i<5;i++){var row=dataArrayRows[startIndex+i];if(row&&null!=(result=detectValue(row[dimIndex])))return result}}else if(sourceFormat===SOURCE_FORMAT_OBJECT_ROWS){var dataObjectRows=data;if(!dimName)return BE_ORDINAL.Not;for(i=0;i<dataObjectRows.length&&i<5;i++)if((item=dataObjectRows[i])&&null!=(result=detectValue(item[dimName])))return result}else if(sourceFormat===SOURCE_FORMAT_KEYED_COLUMNS){dimensionsDefine=data;if(!dimName)return BE_ORDINAL.Not;if(!(sample=dimensionsDefine[dimName])||isTypedArray(sample))return BE_ORDINAL.Not;for(i=0;i<sample.length&&i<5;i++)if(null!=(result=detectValue(sample[i])))return result}else if(sourceFormat===SOURCE_FORMAT_ORIGINAL)for(var dataOriginal=data,i=0;i<dataOriginal.length&&i<5;i++){var item,val=getDataItemValue(item=dataOriginal[i]);if(!isArray(val))return BE_ORDINAL.Not;if(null!=(result=detectValue(val[dimIndex])))return result}function detectValue(val){var beStr=isString(val);return null!=val&&isFinite(val)&&""!==val?beStr?BE_ORDINAL.Might:BE_ORDINAL.Not:beStr&&"-"!==val?BE_ORDINAL.Must:void 0}return BE_ORDINAL.Not}(source.data,source.sourceFormat,source.seriesLayoutBy,source.dimensionsDefine,source.startIndex,dimIndex)}var internalOptionCreatorMap=createHashMap();var reCreateSeriesIndices,assertSeriesInitialized,initBase,innerColor=makeInner(),PaletteMixin=(makeInner(),function(){function PaletteMixin(){}return PaletteMixin.prototype.getColorFromPalette=function(name,scope,requestNum){var defaultPalette=normalizeToArray(this.get("color",!0)),layeredPalette=this.get("colorLayer",!0);return function(that,inner,defaultPalette,layeredPalette,name,scope,requestNum){inner=inner(scope=scope||that),that=inner.paletteIdx||0,scope=inner.paletteNameMap=inner.paletteNameMap||{};if(scope.hasOwnProperty(name))return scope[name];if((layeredPalette=(layeredPalette=null!=requestNum&&layeredPalette?function(palettes,requestColorNum){for(var paletteNum=palettes.length,i=0;i<paletteNum;i++)if(palettes[i].length>requestColorNum)return palettes[i];return palettes[paletteNum-1]}(layeredPalette,requestNum):defaultPalette)||defaultPalette)&&layeredPalette.length)return requestNum=layeredPalette[that],name&&(scope[name]=requestNum),inner.paletteIdx=(that+1)%layeredPalette.length,requestNum}(this,innerColor,defaultPalette,layeredPalette,name,scope,requestNum)},PaletteMixin.prototype.clearColorPalette=function(){var that,inner;(inner=innerColor)(that=this).paletteIdx=0,inner(that).paletteNameMap={}},PaletteMixin}());var BUITIN_COMPONENTS_MAP={grid:"GridComponent",polar:"PolarComponent",geo:"GeoComponent",singleAxis:"SingleAxisComponent",parallel:"ParallelComponent",calendar:"CalendarComponent",graphic:"GraphicComponent",toolbox:"ToolboxComponent",tooltip:"TooltipComponent",axisPointer:"AxisPointerComponent",brush:"BrushComponent",title:"TitleComponent",timeline:"TimelineComponent",markPoint:"MarkPointComponent",markLine:"MarkLineComponent",markArea:"MarkAreaComponent",legend:"LegendComponent",dataZoom:"DataZoomComponent",visualMap:"VisualMapComponent",xAxis:"GridComponent",yAxis:"GridComponent",angleAxis:"PolarComponent",radiusAxis:"PolarComponent"},BUILTIN_CHARTS_MAP={line:"LineChart",bar:"BarChart",pie:"PieChart",scatter:"ScatterChart",radar:"RadarChart",map:"MapChart",tree:"TreeChart",treemap:"TreemapChart",graph:"GraphChart",gauge:"GaugeChart",funnel:"FunnelChart",parallel:"ParallelChart",sankey:"SankeyChart",boxplot:"BoxplotChart",candlestick:"CandlestickChart",effectScatter:"EffectScatterChart",lines:"LinesChart",heatmap:"HeatmapChart",pictorialBar:"PictorialBarChart",themeRiver:"ThemeRiverChart",sunburst:"SunburstChart",custom:"CustomChart"},componetsMissingLogPrinted={};var GlobalModel=function(_super){function GlobalModel(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(GlobalModel,_super),GlobalModel.prototype.init=function(option,parentModel,ecModel,theme,locale,optionManager){theme=theme||{},this.option=null,this._theme=new Model(theme),this._locale=new Model(locale),this._optionManager=optionManager},GlobalModel.prototype.setOption=function(option,opts,optionPreprocessorFuncs){assert(null!=option,"option is null/undefined"),assert(1!==option["\0_ec_inner"],"please use chart.getOption()");opts=normalizeSetOptionInput(opts);this._optionManager.setOption(option,optionPreprocessorFuncs,opts),this._resetOption(null,opts)},GlobalModel.prototype.resetOption=function(type,opt){return this._resetOption(type,normalizeSetOptionInput(opt))},GlobalModel.prototype._resetOption=function(type,opt){var baseOption,optionChanged=!1,optionManager=this._optionManager;return type&&"recreate"!==type||(each(baseOption=optionManager.mountOption("recreate"===type),function(componentOption,mainType){var componentImportName;ComponentModel.hasClass(mainType)||(componentImportName=BUITIN_COMPONENTS_MAP[mainType])&&!componetsMissingLogPrinted[componentImportName]&&(error("Component "+mainType+" is used but not imported.\nimport { "+componentImportName+" } from 'echarts/components';\necharts.use(["+componentImportName+"]);"),componetsMissingLogPrinted[componentImportName]=!0)}),this.option&&"recreate"!==type?(this.restoreData(),this._mergeOption(baseOption,opt)):initBase(this,baseOption),optionChanged=!0),"timeline"!==type&&"media"!==type||this.restoreData(),type&&"recreate"!==type&&"timeline"!==type||(baseOption=optionManager.getTimelineOption(this))&&(optionChanged=!0,this._mergeOption(baseOption,opt)),type&&"recreate"!==type&&"media"!==type||(type=optionManager.getMediaOption(this)).length&&each(type,function(mediaOption){optionChanged=!0,this._mergeOption(mediaOption,opt)},this),optionChanged},GlobalModel.prototype.mergeOption=function(option){this._mergeOption(option,null)},GlobalModel.prototype._mergeOption=function(newOption,opt){var option=this.option,componentsMap=this._componentsMap,componentsCount=this._componentsCount,newCmptTypes=[],newCmptTypeMap=createHashMap(),replaceMergeMainTypeMap=opt&&opt.replaceMergeMainTypeMap;innerGlobalModel(this).datasetMap=createHashMap(),each(newOption,function(componentOption,mainType){null!=componentOption&&(ComponentModel.hasClass(mainType)?mainType&&(newCmptTypes.push(mainType),newCmptTypeMap.set(mainType,!0)):option[mainType]=null==option[mainType]?clone(componentOption):merge(option[mainType],componentOption,!0))}),replaceMergeMainTypeMap&&replaceMergeMainTypeMap.each(function(val,mainTypeInReplaceMerge){ComponentModel.hasClass(mainTypeInReplaceMerge)&&!newCmptTypeMap.get(mainTypeInReplaceMerge)&&(newCmptTypes.push(mainTypeInReplaceMerge),newCmptTypeMap.set(mainTypeInReplaceMerge,!0))}),ComponentModel.topologicalTravel(newCmptTypes,ComponentModel.getAllClassMainTypes(),function(mainType){var tooltipExists,tooltipWarningLogged,newCmptOptionList=function(ecModel,mainType,newCmptOptionList){if(!(mainType=internalOptionCreatorMap.get(mainType)))return newCmptOptionList;var internalOptions=mainType(ecModel);if(!internalOptions)return newCmptOptionList;for(var i=0;i<internalOptions.length;i++)assert(isComponentIdInternal(internalOptions[i]));return newCmptOptionList.concat(internalOptions)}(this,mainType,normalizeToArray(newOption[mainType])),oldCmptList=componentsMap.get(mainType),mergeMode=oldCmptList?replaceMergeMainTypeMap&&replaceMergeMainTypeMap.get(mainType)?"replaceMerge":"normalMerge":"replaceAll",oldCmptList=mappingToExists(oldCmptList,newCmptOptionList,mergeMode),optionsByMainType=(setComponentTypeToKeyInfo(oldCmptList,mainType,ComponentModel),option[mainType]=null,componentsMap.set(mainType,null),componentsCount.set(mainType,0),[]),cmptsByMainType=[],cmptsCountByMainType=0;each(oldCmptList,function(resultItem,index){var componentModel=resultItem.existing,newCmptOption=resultItem.newOption;if(newCmptOption){var subType,seriesImportName,ComponentModelClass=ComponentModel.getClass(mainType,resultItem.keyInfo.subType,!("series"===mainType));if(!ComponentModelClass)return subType=resultItem.keyInfo.subType,seriesImportName=BUILTIN_CHARTS_MAP[subType],void(componetsMissingLogPrinted[subType]||(componetsMissingLogPrinted[subType]=!0,error(seriesImportName?"Series "+subType+" is used but not imported.\nimport { "+seriesImportName+" } from 'echarts/charts';\necharts.use(["+seriesImportName+"]);":"Unkown series "+subType)));if("tooltip"===mainType){if(tooltipExists)return void(tooltipWarningLogged||(warn("Currently only one tooltip component is allowed."),tooltipWarningLogged=!0));tooltipExists=!0}componentModel&&componentModel.constructor===ComponentModelClass?(componentModel.name=resultItem.keyInfo.name,componentModel.mergeOption(newCmptOption,this),componentModel.optionUpdated(newCmptOption,!1)):(seriesImportName=extend({componentIndex:index},resultItem.keyInfo),extend(componentModel=new ComponentModelClass(newCmptOption,this,this,seriesImportName),seriesImportName),resultItem.brandNew&&(componentModel.__requireNewView=!0),componentModel.init(newCmptOption,this,this),componentModel.optionUpdated(null,!0))}else componentModel&&(componentModel.mergeOption({},this),componentModel.optionUpdated({},!1));componentModel?(optionsByMainType.push(componentModel.option),cmptsByMainType.push(componentModel),cmptsCountByMainType++):(optionsByMainType.push(void 0),cmptsByMainType.push(void 0))},this),option[mainType]=optionsByMainType,componentsMap.set(mainType,cmptsByMainType),componentsCount.set(mainType,cmptsCountByMainType),"series"===mainType&&reCreateSeriesIndices(this)},this),this._seriesIndices||reCreateSeriesIndices(this)},GlobalModel.prototype.getOption=function(){var option=clone(this.option);return each(option,function(optInMainType,mainType){if(ComponentModel.hasClass(mainType)){for(var opts=normalizeToArray(optInMainType),realLen=opts.length,metNonInner=!1,i=realLen-1;0<=i;i--)opts[i]&&!isComponentIdInternal(opts[i])?metNonInner=!0:(opts[i]=null,metNonInner||realLen--);opts.length=realLen,option[mainType]=opts}}),delete option["\0_ec_inner"],option},GlobalModel.prototype.getTheme=function(){return this._theme},GlobalModel.prototype.getLocaleModel=function(){return this._locale},GlobalModel.prototype.setUpdatePayload=function(payload){this._payload=payload},GlobalModel.prototype.getUpdatePayload=function(){return this._payload},GlobalModel.prototype.getComponent=function(mainType,idx){var list=this._componentsMap.get(mainType);if(list){mainType=list[idx||0];if(mainType)return mainType;if(null==idx)for(var i=0;i<list.length;i++)if(list[i])return list[i]}},GlobalModel.prototype.queryComponents=function(condition){var mainType=condition.mainType;if(!mainType)return[];var result,index=condition.index,id=condition.id,name=condition.name,cmpts=this._componentsMap.get(mainType);return cmpts&&cmpts.length?(null!=index?(result=[],each(normalizeToArray(index),function(idx){cmpts[idx]&&result.push(cmpts[idx])})):result=null!=id?queryByIdOrName("id",id,cmpts):null!=name?queryByIdOrName("name",name,cmpts):filter(cmpts,function(cmpt){return!!cmpt}),filterBySubType(result,condition)):[]},GlobalModel.prototype.findComponents=function(condition){var nameAttr,query=condition.query,mainType=condition.mainType,indexAttr=(indexAttr=mainType+"Index",idAttr=mainType+"Id",nameAttr=mainType+"Name",!(query=query)||null==query[indexAttr]&&null==query[idAttr]&&null==query[nameAttr]?null:{mainType:mainType,index:query[indexAttr],id:query[idAttr],name:query[nameAttr]}),idAttr=indexAttr?this.queryComponents(indexAttr):filter(this._componentsMap.get(mainType),function(cmpt){return!!cmpt});return query=filterBySubType(idAttr,condition),condition.filter?filter(query,condition.filter):query},GlobalModel.prototype.eachComponent=function(mainType,cb,context){var componentsMap=this._componentsMap;if(isFunction(mainType)){var ctxForAll_1=cb,cbForAll_1=mainType;componentsMap.each(function(cmpts,componentType){for(var i=0;cmpts&&i<cmpts.length;i++){var cmpt=cmpts[i];cmpt&&cbForAll_1.call(ctxForAll_1,componentType,cmpt,cmpt.componentIndex)}})}else for(var cmpts=isString(mainType)?componentsMap.get(mainType):isObject(mainType)?this.findComponents(mainType):null,i=0;cmpts&&i<cmpts.length;i++){var cmpt=cmpts[i];cmpt&&cb.call(context,cmpt,cmpt.componentIndex)}},GlobalModel.prototype.getSeriesByName=function(name){var nameStr=convertOptionIdName(name,null);return filter(this._componentsMap.get("series"),function(oneSeries){return!!oneSeries&&null!=nameStr&&oneSeries.name===nameStr})},GlobalModel.prototype.getSeriesByIndex=function(seriesIndex){return this._componentsMap.get("series")[seriesIndex]},GlobalModel.prototype.getSeriesByType=function(subType){return filter(this._componentsMap.get("series"),function(oneSeries){return!!oneSeries&&oneSeries.subType===subType})},GlobalModel.prototype.getSeries=function(){return filter(this._componentsMap.get("series"),function(oneSeries){return!!oneSeries})},GlobalModel.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},GlobalModel.prototype.eachSeries=function(cb,context){assertSeriesInitialized(this),each(this._seriesIndices,function(rawSeriesIndex){var series=this._componentsMap.get("series")[rawSeriesIndex];cb.call(context,series,rawSeriesIndex)},this)},GlobalModel.prototype.eachRawSeries=function(cb,context){each(this._componentsMap.get("series"),function(series){series&&cb.call(context,series,series.componentIndex)})},GlobalModel.prototype.eachSeriesByType=function(subType,cb,context){assertSeriesInitialized(this),each(this._seriesIndices,function(rawSeriesIndex){var series=this._componentsMap.get("series")[rawSeriesIndex];series.subType===subType&&cb.call(context,series,rawSeriesIndex)},this)},GlobalModel.prototype.eachRawSeriesByType=function(subType,cb,context){return each(this.getSeriesByType(subType),cb,context)},GlobalModel.prototype.isSeriesFiltered=function(seriesModel){return assertSeriesInitialized(this),null==this._seriesIndicesMap.get(seriesModel.componentIndex)},GlobalModel.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},GlobalModel.prototype.filterSeries=function(cb,context){assertSeriesInitialized(this);var newSeriesIndices=[];each(this._seriesIndices,function(seriesRawIdx){var series=this._componentsMap.get("series")[seriesRawIdx];cb.call(context,series,seriesRawIdx)&&newSeriesIndices.push(seriesRawIdx)},this),this._seriesIndices=newSeriesIndices,this._seriesIndicesMap=createHashMap(newSeriesIndices)},GlobalModel.prototype.restoreData=function(payload){reCreateSeriesIndices(this);var componentsMap=this._componentsMap,componentTypes=[];componentsMap.each(function(components,componentType){ComponentModel.hasClass(componentType)&&componentTypes.push(componentType)}),ComponentModel.topologicalTravel(componentTypes,ComponentModel.getAllClassMainTypes(),function(componentType){each(componentsMap.get(componentType),function(component){!component||"series"===componentType&&function(seriesModel,payload){{var index,id;if(payload)return index=payload.seriesIndex,id=payload.seriesId,payload=payload.seriesName,null!=index&&seriesModel.componentIndex!==index||null!=id&&seriesModel.id!==id||null!=payload&&seriesModel.name!==payload}}(component,payload)||component.restoreData()})})},GlobalModel.internalField=(reCreateSeriesIndices=function(ecModel){var seriesIndices=ecModel._seriesIndices=[];each(ecModel._componentsMap.get("series"),function(series){series&&seriesIndices.push(series.componentIndex)}),ecModel._seriesIndicesMap=createHashMap(seriesIndices)},assertSeriesInitialized=function(ecModel){if(!ecModel._seriesIndices)throw new Error("Option should contains series.")},void(initBase=function(ecModel,baseOption){ecModel.option={},ecModel.option["\0_ec_inner"]=1,ecModel._componentsMap=new HashMap({series:[]}),ecModel._componentsCount=createHashMap();var option,notMergeColorLayer,airaOption=baseOption.aria;isObject(airaOption)&&null==airaOption.enabled&&(airaOption.enabled=!0),option=baseOption,airaOption=ecModel._theme.option,notMergeColorLayer=option.color&&!option.colorLayer,each(airaOption,function(themeItem,name){"colorLayer"===name&&notMergeColorLayer||ComponentModel.hasClass(name)||("object"==typeof themeItem?option[name]=option[name]?merge(option[name],themeItem,!1):clone(themeItem):null==option[name]&&(option[name]=themeItem))}),merge(baseOption,globalDefault,!1),ecModel._mergeOption(baseOption,null)})),GlobalModel}(Model);function queryByIdOrName(attr,idOrName,cmpts){var keyMap_1,idName_1;return isArray(idOrName)?(keyMap_1=createHashMap(),each(idOrName,function(idOrNameItem){null!=idOrNameItem&&null!=convertOptionIdName(idOrNameItem,null)&&keyMap_1.set(idOrNameItem,!0)}),filter(cmpts,function(cmpt){return cmpt&&keyMap_1.get(cmpt[attr])})):(idName_1=convertOptionIdName(idOrName,null),filter(cmpts,function(cmpt){return cmpt&&null!=idName_1&&cmpt[attr]===idName_1}))}function filterBySubType(components,condition){return condition.hasOwnProperty("subType")?filter(components,function(cmpt){return cmpt&&cmpt.subType===condition.subType}):components}function normalizeSetOptionInput(opts){var replaceMergeMainTypeMap=createHashMap();return opts&&each(normalizeToArray(opts.replaceMerge),function(mainType){assert(ComponentModel.hasClass(mainType),'"'+mainType+'" is not valid component main type in "replaceMerge"'),replaceMergeMainTypeMap.set(mainType,!0)}),{replaceMergeMainTypeMap:replaceMergeMainTypeMap}}mixin(GlobalModel,PaletteMixin);function ExtensionAPI(ecInstance){each(availableMethods,function(methodName){this[methodName]=bind(ecInstance[methodName],ecInstance)},this)}var availableMethods=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],coordinateSystemCreators={},CoordinateSystemManager=function(){function CoordinateSystemManager(){this._coordinateSystems=[]}return CoordinateSystemManager.prototype.create=function(ecModel,api){var coordinateSystems=[];each(coordinateSystemCreators,function(creater,type){creater=creater.create(ecModel,api);coordinateSystems=coordinateSystems.concat(creater||[])}),this._coordinateSystems=coordinateSystems},CoordinateSystemManager.prototype.update=function(ecModel,api){each(this._coordinateSystems,function(coordSys){coordSys.update&&coordSys.update(ecModel,api)})},CoordinateSystemManager.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},CoordinateSystemManager.register=function(type,creator){coordinateSystemCreators[type]=creator},CoordinateSystemManager.get=function(type){return coordinateSystemCreators[type]},CoordinateSystemManager}(),QUERY_REG=/^(min|max)?(.+)$/,OptionManager=function(){function OptionManager(api){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=api}return OptionManager.prototype.setOption=function(rawOption,optionPreprocessorFuncs,opt){rawOption&&(each(normalizeToArray(rawOption.series),function(series){series&&series.data&&isTypedArray(series.data)&&setAsPrimitive(series.data)}),each(normalizeToArray(rawOption.dataset),function(dataset){dataset&&dataset.source&&isTypedArray(dataset.source)&&setAsPrimitive(dataset.source)})),rawOption=clone(rawOption);var optionBackup=this._optionBackup,rawOption=function(rawOption,optionPreprocessorFuncs,isNew){var mediaDefault,baseOption,mediaList=[],declaredBaseOption=rawOption.baseOption,timelineOnRoot=rawOption.timeline,timelineOptionsOnRoot=rawOption.options,mediaOnRoot=rawOption.media,hasMedia=!!rawOption.media,hasTimeline=!!(timelineOptionsOnRoot||timelineOnRoot||declaredBaseOption&&declaredBaseOption.timeline);declaredBaseOption?(baseOption=declaredBaseOption).timeline||(baseOption.timeline=timelineOnRoot):((hasTimeline||hasMedia)&&(rawOption.options=rawOption.media=null),baseOption=rawOption);hasMedia&&(isArray(mediaOnRoot)?each(mediaOnRoot,function(singleMedia){singleMedia&&!singleMedia.option&&isObject(singleMedia.query)&&isObject(singleMedia.query.option)&&error("Illegal media option. Must be like { media: [ { query: {}, option: {} } ] }"),singleMedia&&singleMedia.option&&(singleMedia.query?mediaList.push(singleMedia):mediaDefault=mediaDefault||singleMedia)}):error("Illegal media option. Must be an array. Like { media: [ {...}, {...} ] }"));function doPreprocess(option){each(optionPreprocessorFuncs,function(preProcess){preProcess(option,isNew)})}return doPreprocess(baseOption),each(timelineOptionsOnRoot,doPreprocess),each(mediaList,function(media){return doPreprocess(media.option)}),{baseOption:baseOption,timelineOptions:timelineOptionsOnRoot||[],mediaDefault:mediaDefault,mediaList:mediaList}}(rawOption,optionPreprocessorFuncs,!optionBackup);this._newBaseOption=rawOption.baseOption,optionBackup?(rawOption.timelineOptions.length&&(optionBackup.timelineOptions=rawOption.timelineOptions),rawOption.mediaList.length&&(optionBackup.mediaList=rawOption.mediaList),rawOption.mediaDefault&&(optionBackup.mediaDefault=rawOption.mediaDefault)):this._optionBackup=rawOption},OptionManager.prototype.mountOption=function(isRecreate){var optionBackup=this._optionBackup;return this._timelineOptions=optionBackup.timelineOptions,this._mediaList=optionBackup.mediaList,this._mediaDefault=optionBackup.mediaDefault,this._currentMediaIndices=[],clone(isRecreate?optionBackup.baseOption:this._newBaseOption)},OptionManager.prototype.getTimelineOption=function(ecModel){var option,timelineOptions=this._timelineOptions;return option=timelineOptions.length&&(ecModel=ecModel.getComponent("timeline"))?clone(timelineOptions[ecModel.getCurrentIndex()]):option},OptionManager.prototype.getMediaOption=function(ecModel){var ecWidth=this._api.getWidth(),ecHeight=this._api.getHeight(),mediaList=this._mediaList,mediaDefault=this._mediaDefault,indices=[],result=[];if(!mediaList.length&&!mediaDefault)return result;for(var indices1,indices2,i=0,len=mediaList.length;i<len;i++)!function(query,ecWidth,ecHeight){var realMap={width:ecWidth,height:ecHeight,aspectratio:ecWidth/ecHeight},applicatable=!0;return each(query,function(value,attr){var operator,attr=attr.match(QUERY_REG);attr&&attr[1]&&attr[2]&&(operator=attr[1],attr=attr[2].toLowerCase(),function(real,expect,operator){return"min"===operator?expect<=real:"max"===operator?real<=expect:real===expect}(realMap[attr],value,operator)||(applicatable=!1))}),applicatable}(mediaList[i].query,ecWidth,ecHeight)||indices.push(i);return(indices=!indices.length&&mediaDefault?[-1]:indices).length&&(indices1=indices,indices2=this._currentMediaIndices,indices1.join(",")!==indices2.join(","))&&(result=map(indices,function(index){return clone((-1===index?mediaDefault:mediaList[index]).option)})),this._currentMediaIndices=indices,result},OptionManager}();var each$2=each,isObject$1=isObject,POSSIBLE_STYLES=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function compatEC2ItemStyle(opt){var itemStyleOpt=opt&&opt.itemStyle;if(itemStyleOpt)for(var i=0,len=POSSIBLE_STYLES.length;i<len;i++){var styleName=POSSIBLE_STYLES[i],normalItemStyleOpt=itemStyleOpt.normal,emphasisItemStyleOpt=itemStyleOpt.emphasis;normalItemStyleOpt&&normalItemStyleOpt[styleName]&&(deprecateReplaceLog("itemStyle.normal."+styleName,styleName),opt[styleName]=opt[styleName]||{},opt[styleName].normal?merge(opt[styleName].normal,normalItemStyleOpt[styleName]):opt[styleName].normal=normalItemStyleOpt[styleName],normalItemStyleOpt[styleName]=null),emphasisItemStyleOpt&&emphasisItemStyleOpt[styleName]&&(deprecateReplaceLog("itemStyle.emphasis."+styleName,"emphasis."+styleName),opt[styleName]=opt[styleName]||{},opt[styleName].emphasis?merge(opt[styleName].emphasis,emphasisItemStyleOpt[styleName]):opt[styleName].emphasis=emphasisItemStyleOpt[styleName],emphasisItemStyleOpt[styleName]=null)}}function convertNormalEmphasis(opt,optType,useExtend){var normalOpt,emphasisOpt;opt&&opt[optType]&&(opt[optType].normal||opt[optType].emphasis)&&(normalOpt=opt[optType].normal,emphasisOpt=opt[optType].emphasis,normalOpt&&(deprecateLog("'normal' hierarchy in "+optType+" has been removed since 4.0. All style properties are configured in "+optType+" directly now."),useExtend?(opt[optType].normal=opt[optType].emphasis=null,defaults(opt[optType],normalOpt)):opt[optType]=normalOpt),emphasisOpt&&(deprecateLog(optType+".emphasis has been changed to emphasis."+optType+" since 4.0"),opt.emphasis=opt.emphasis||{},(opt.emphasis[optType]=emphasisOpt).focus&&(opt.emphasis.focus=emphasisOpt.focus),emphasisOpt.blurScope&&(opt.emphasis.blurScope=emphasisOpt.blurScope)))}function removeEC3NormalStatus(opt){convertNormalEmphasis(opt,"itemStyle"),convertNormalEmphasis(opt,"lineStyle"),convertNormalEmphasis(opt,"areaStyle"),convertNormalEmphasis(opt,"label"),convertNormalEmphasis(opt,"labelLine"),convertNormalEmphasis(opt,"upperLabel"),convertNormalEmphasis(opt,"edgeLabel")}function compatTextStyle(opt,propName){var labelOptSingle=isObject$1(opt)&&opt[propName],textStyle=isObject$1(labelOptSingle)&&labelOptSingle.textStyle;if(textStyle){deprecateLog("textStyle hierarchy in "+propName+" has been removed since 4.0. All textStyle properties are configured in "+propName+" directly now.");for(var i=0,len=TEXT_STYLE_OPTIONS.length;i<len;i++){var textPropName=TEXT_STYLE_OPTIONS[i];textStyle.hasOwnProperty(textPropName)&&(labelOptSingle[textPropName]=textStyle[textPropName])}}}function compatEC3CommonStyles(opt){opt&&(removeEC3NormalStatus(opt),compatTextStyle(opt,"label"),opt.emphasis&&compatTextStyle(opt.emphasis,"label"))}function toArr(o){return isArray(o)?o:o?[o]:[]}function toObj(o){return(isArray(o)?o[0]:o)||{}}function globalCompatStyle(option,isTheme){each$2(toArr(option.series),function(seriesOpt){isObject$1(seriesOpt)&&function(seriesOpt){if(isObject$1(seriesOpt)){compatEC2ItemStyle(seriesOpt),removeEC3NormalStatus(seriesOpt),compatTextStyle(seriesOpt,"label"),compatTextStyle(seriesOpt,"upperLabel"),compatTextStyle(seriesOpt,"edgeLabel"),seriesOpt.emphasis&&(compatTextStyle(seriesOpt.emphasis,"label"),compatTextStyle(seriesOpt.emphasis,"upperLabel"),compatTextStyle(seriesOpt.emphasis,"edgeLabel"));var markPoint=seriesOpt.markPoint,markLine=(markPoint&&(compatEC2ItemStyle(markPoint),compatEC3CommonStyles(markPoint)),seriesOpt.markLine),markArea=(markLine&&(compatEC2ItemStyle(markLine),compatEC3CommonStyles(markLine)),seriesOpt.markArea),data=(markArea&&compatEC3CommonStyles(markArea),seriesOpt.data);if("graph"===seriesOpt.type){var data=data||seriesOpt.nodes,edgeData=seriesOpt.links||seriesOpt.edges;if(edgeData&&!isTypedArray(edgeData))for(var i=0;i<edgeData.length;i++)compatEC3CommonStyles(edgeData[i]);each(seriesOpt.categories,function(opt){removeEC3NormalStatus(opt)})}if(data&&!isTypedArray(data))for(i=0;i<data.length;i++)compatEC3CommonStyles(data[i]);if((markPoint=seriesOpt.markPoint)&&markPoint.data)for(var mpData=markPoint.data,i=0;i<mpData.length;i++)compatEC3CommonStyles(mpData[i]);if((markLine=seriesOpt.markLine)&&markLine.data)for(var mlData=markLine.data,i=0;i<mlData.length;i++)isArray(mlData[i])?(compatEC3CommonStyles(mlData[i][0]),compatEC3CommonStyles(mlData[i][1])):compatEC3CommonStyles(mlData[i]);"gauge"===seriesOpt.type?(compatTextStyle(seriesOpt,"axisLabel"),compatTextStyle(seriesOpt,"title"),compatTextStyle(seriesOpt,"detail")):"treemap"===seriesOpt.type?(convertNormalEmphasis(seriesOpt.breadcrumb,"itemStyle"),each(seriesOpt.levels,function(opt){removeEC3NormalStatus(opt)})):"tree"===seriesOpt.type&&removeEC3NormalStatus(seriesOpt.leaves)}}(seriesOpt)});var axes=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];isTheme&&axes.push("valueAxis","categoryAxis","logAxis","timeAxis"),each$2(axes,function(axisName){each$2(toArr(option[axisName]),function(axisOpt){axisOpt&&(compatTextStyle(axisOpt,"axisLabel"),compatTextStyle(axisOpt.axisPointer,"label"))})}),each$2(toArr(option.parallel),function(parallelOpt){parallelOpt=parallelOpt&&parallelOpt.parallelAxisDefault;compatTextStyle(parallelOpt,"axisLabel"),compatTextStyle(parallelOpt&&parallelOpt.axisPointer,"label")}),each$2(toArr(option.calendar),function(calendarOpt){convertNormalEmphasis(calendarOpt,"itemStyle"),compatTextStyle(calendarOpt,"dayLabel"),compatTextStyle(calendarOpt,"monthLabel"),compatTextStyle(calendarOpt,"yearLabel")}),each$2(toArr(option.radar),function(radarOpt){compatTextStyle(radarOpt,"name"),radarOpt.name&&null==radarOpt.axisName&&(radarOpt.axisName=radarOpt.name,delete radarOpt.name,deprecateLog("name property in radar component has been changed to axisName")),null!=radarOpt.nameGap&&null==radarOpt.axisNameGap&&(radarOpt.axisNameGap=radarOpt.nameGap,delete radarOpt.nameGap,deprecateLog("nameGap property in radar component has been changed to axisNameGap")),each$2(radarOpt.indicator,function(indicatorOpt){indicatorOpt.text&&deprecateReplaceLog("text","name","radar.indicator")})}),each$2(toArr(option.geo),function(geoOpt){isObject$1(geoOpt)&&(compatEC3CommonStyles(geoOpt),each$2(toArr(geoOpt.regions),function(regionObj){compatEC3CommonStyles(regionObj)}))}),each$2(toArr(option.timeline),function(timelineOpt){compatEC3CommonStyles(timelineOpt),convertNormalEmphasis(timelineOpt,"label"),convertNormalEmphasis(timelineOpt,"itemStyle"),convertNormalEmphasis(timelineOpt,"controlStyle",!0);timelineOpt=timelineOpt.data;isArray(timelineOpt)&&each(timelineOpt,function(item){isObject(item)&&(convertNormalEmphasis(item,"label"),convertNormalEmphasis(item,"itemStyle"))})}),each$2(toArr(option.toolbox),function(toolboxOpt){convertNormalEmphasis(toolboxOpt,"iconStyle"),each$2(toolboxOpt.feature,function(featureOpt){convertNormalEmphasis(featureOpt,"iconStyle")})}),compatTextStyle(toObj(option.axisPointer),"label"),compatTextStyle(toObj(option.tooltip).axisPointer,"label")}function compatLayoutProperties(option){option&&each(LAYOUT_PROPERTIES,function(prop){prop[0]in option&&!(prop[1]in option)&&(option[prop[1]]=option[prop[0]])})}var LAYOUT_PROPERTIES=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],COMPATITABLE_COMPONENTS=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],BAR_ITEM_STYLE_MAP=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function compatBarItemStyle(option){var itemStyle=option&&option.itemStyle;if(itemStyle)for(var i=0;i<BAR_ITEM_STYLE_MAP.length;i++){var oldName=BAR_ITEM_STYLE_MAP[i][1],newName=BAR_ITEM_STYLE_MAP[i][0];null!=itemStyle[oldName]&&(itemStyle[newName]=itemStyle[oldName],deprecateReplaceLog(oldName,newName))}}function compatPieLabel(option){option&&"edge"===option.alignTo&&null!=option.margin&&null==option.edgeDistance&&(deprecateReplaceLog("label.margin","label.edgeDistance","pie"),option.edgeDistance=option.margin)}function compatSunburstState(option){option&&option.downplay&&!option.blur&&(option.blur=option.downplay,deprecateReplaceLog("downplay","blur","sunburst"))}function globalBackwardCompat(option,isTheme){globalCompatStyle(option,isTheme),option.series=normalizeToArray(option.series),each(option.series,function(seriesOpt){if(isObject(seriesOpt)){var data,seriesType=seriesOpt.type;if("line"===seriesType)null!=seriesOpt.clipOverflow&&(seriesOpt.clip=seriesOpt.clipOverflow,deprecateReplaceLog("clipOverflow","clip","line"));else if("pie"===seriesType||"gauge"===seriesType){if(null!=seriesOpt.clockWise&&(seriesOpt.clockwise=seriesOpt.clockWise,deprecateReplaceLog("clockWise","clockwise")),compatPieLabel(seriesOpt.label),(data=seriesOpt.data)&&!isTypedArray(data))for(var i=0;i<data.length;i++)compatPieLabel(data[i]);null!=seriesOpt.hoverOffset&&(seriesOpt.emphasis=seriesOpt.emphasis||{},(seriesOpt.emphasis.scaleSize=null)&&(deprecateReplaceLog("hoverOffset","emphasis.scaleSize"),seriesOpt.emphasis.scaleSize=seriesOpt.hoverOffset))}else if("gauge"===seriesType){var pointerColor=function(opt,path){for(var pathArr=path.split(","),obj=opt,i=0;i<pathArr.length&&null!=(obj=obj&&obj[pathArr[i]]);i++);return obj}(seriesOpt,"pointer.color");null!=pointerColor&&function(opt,path,val,overwrite){for(var key,pathArr=path.split(","),obj=opt,i=0;i<pathArr.length-1;i++)null==obj[key=pathArr[i]]&&(obj[key]={}),obj=obj[key];!overwrite&&null!=obj[pathArr[i]]||(obj[pathArr[i]]=val)}(seriesOpt,"itemStyle.color",pointerColor)}else if("bar"===seriesType){if(compatBarItemStyle(seriesOpt),compatBarItemStyle(seriesOpt.backgroundStyle),compatBarItemStyle(seriesOpt.emphasis),(data=seriesOpt.data)&&!isTypedArray(data))for(i=0;i<data.length;i++)"object"==typeof data[i]&&(compatBarItemStyle(data[i]),compatBarItemStyle(data[i]&&data[i].emphasis))}else"sunburst"===seriesType?((pointerColor=seriesOpt.highlightPolicy)&&(seriesOpt.emphasis=seriesOpt.emphasis||{},seriesOpt.emphasis.focus||(seriesOpt.emphasis.focus=pointerColor,deprecateReplaceLog("highlightPolicy","emphasis.focus","sunburst"))),compatSunburstState(seriesOpt),function traverseTree(data,cb){if(data)for(var i=0;i<data.length;i++)cb(data[i]),data[i]&&traverseTree(data[i].children,cb)}(seriesOpt.data,compatSunburstState)):"graph"===seriesType||"sankey"===seriesType?(pointerColor=seriesOpt)&&null!=pointerColor.focusNodeAdjacency&&(pointerColor.emphasis=pointerColor.emphasis||{},null==pointerColor.emphasis.focus&&(deprecateReplaceLog("focusNodeAdjacency","emphasis: { focus: 'adjacency'}","graph/sankey"),pointerColor.emphasis.focus="adjacency")):"map"===seriesType&&(seriesOpt.mapType&&!seriesOpt.map&&(deprecateReplaceLog("mapType","map","map"),seriesOpt.map=seriesOpt.mapType),seriesOpt.mapLocation&&(deprecateLog("`mapLocation` is not used anymore."),defaults(seriesOpt,seriesOpt.mapLocation)));null!=seriesOpt.hoverAnimation&&(seriesOpt.emphasis=seriesOpt.emphasis||{},seriesOpt.emphasis&&null==seriesOpt.emphasis.scale&&(deprecateReplaceLog("hoverAnimation","emphasis.scale"),seriesOpt.emphasis.scale=seriesOpt.hoverAnimation)),compatLayoutProperties(seriesOpt)}}),option.dataRange&&(option.visualMap=option.dataRange),each(COMPATITABLE_COMPONENTS,function(componentName){componentName=option[componentName];componentName&&each(componentName=isArray(componentName)?componentName:[componentName],function(option){compatLayoutProperties(option)})})}function calculateStack(stackInfoList){each(stackInfoList,function(targetStackInfo,idxInStack){var resultVal=[],resultNaN=[NaN,NaN],dims=[targetStackInfo.stackResultDimension,targetStackInfo.stackedOverDimension],targetData=targetStackInfo.data,isStackedByIndex=targetStackInfo.isStackedByIndex;targetData.modify(dims,function(v0,v1,dataIndex){var byValue,stackedDataRawIndex,sum=targetData.get(targetStackInfo.stackedDimension,dataIndex);if(isNaN(sum))return resultNaN;isStackedByIndex?stackedDataRawIndex=targetData.getRawIndex(dataIndex):byValue=targetData.get(targetStackInfo.stackedByDimension,dataIndex);for(var val0,val1,maxPrecision,stackedOver=NaN,j=idxInStack-1;0<=j;j--){var stackInfo=stackInfoList[j];if(0<=(stackedDataRawIndex=isStackedByIndex?stackedDataRawIndex:stackInfo.data.rawIndexOf(stackInfo.stackedByDimension,byValue))){stackInfo=stackInfo.data.getByRawIndex(stackInfo.stackResultDimension,stackedDataRawIndex);if(0<=sum&&0<stackInfo||sum<=0&&stackInfo<0){val0=sum,val1=stackInfo,maxPrecision=void 0,maxPrecision=Math.max(getPrecision(val0),getPrecision(val1)),val0+=val1,sum=ROUND_SUPPORTED_PRECISION_MAX<maxPrecision?val0:round(val0,maxPrecision),stackedOver=stackInfo;break}}}return resultVal[0]=sum,resultVal[1]=stackedOver,resultVal})})}var providerMethods,mountMethods,SourceImpl=function(fields){this.data=fields.data||(fields.sourceFormat===SOURCE_FORMAT_KEYED_COLUMNS?{}:[]),this.sourceFormat=fields.sourceFormat||SOURCE_FORMAT_UNKNOWN,this.seriesLayoutBy=fields.seriesLayoutBy||SERIES_LAYOUT_BY_COLUMN,this.startIndex=fields.startIndex||0,this.dimensionsDetectedCount=fields.dimensionsDetectedCount,this.metaRawOption=fields.metaRawOption;var dimensionsDefine=this.dimensionsDefine=fields.dimensionsDefine;if(dimensionsDefine)for(var i=0;i<dimensionsDefine.length;i++){var dim=dimensionsDefine[i];null==dim.type&&guessOrdinal(this,i)===BE_ORDINAL.Must&&(dim.type="ordinal")}};function isSourceInstance(val){return val instanceof SourceImpl}function createSource(sourceData,thisMetaRawOption,sourceFormat){sourceFormat=sourceFormat||detectSourceFormat(sourceData);var seriesLayoutBy=thisMetaRawOption.seriesLayoutBy,determined=function(data,sourceFormat,seriesLayoutBy,sourceHeader,dimensionsDefine){var dimensionsDetectedCount,startIndex;if(!data)return{dimensionsDefine:normalizeDimensionsOption(dimensionsDefine),startIndex:startIndex,dimensionsDetectedCount:dimensionsDetectedCount};{var dataArrayRows;sourceFormat===SOURCE_FORMAT_ARRAY_ROWS?(dataArrayRows=data,"auto"===sourceHeader||null==sourceHeader?arrayRowsTravelFirst(function(val){null!=val&&"-"!==val&&(isString(val)?null==startIndex&&(startIndex=1):startIndex=0)},seriesLayoutBy,dataArrayRows,10):startIndex=isNumber(sourceHeader)?sourceHeader:sourceHeader?1:0,dimensionsDefine||1!==startIndex||(dimensionsDefine=[],arrayRowsTravelFirst(function(val,index){dimensionsDefine[index]=null!=val?val+"":""},seriesLayoutBy,dataArrayRows,1/0)),dimensionsDetectedCount=dimensionsDefine?dimensionsDefine.length:seriesLayoutBy===SERIES_LAYOUT_BY_ROW?dataArrayRows.length:dataArrayRows[0]?dataArrayRows[0].length:null):sourceFormat===SOURCE_FORMAT_OBJECT_ROWS?dimensionsDefine=dimensionsDefine||function(data){var obj,firstIndex=0;for(;firstIndex<data.length&&!(obj=data[firstIndex++]););{var dimensions_1;if(obj)return dimensions_1=[],each(obj,function(value,key){dimensions_1.push(key)}),dimensions_1}}(data):sourceFormat===SOURCE_FORMAT_KEYED_COLUMNS?dimensionsDefine||(dimensionsDefine=[],each(data,function(colArr,key){dimensionsDefine.push(key)})):sourceFormat===SOURCE_FORMAT_ORIGINAL?(sourceHeader=getDataItemValue(data[0]),dimensionsDetectedCount=isArray(sourceHeader)&&sourceHeader.length||1):sourceFormat===SOURCE_FORMAT_TYPED_ARRAY&&assert(!!dimensionsDefine,"dimensions must be given if data is TypedArray.")}return{startIndex:startIndex,dimensionsDefine:normalizeDimensionsOption(dimensionsDefine),dimensionsDetectedCount:dimensionsDetectedCount}}(sourceData,sourceFormat,seriesLayoutBy,thisMetaRawOption.sourceHeader,thisMetaRawOption.dimensions);return new SourceImpl({data:sourceData,sourceFormat:sourceFormat,seriesLayoutBy:seriesLayoutBy,dimensionsDefine:determined.dimensionsDefine,startIndex:determined.startIndex,dimensionsDetectedCount:determined.dimensionsDetectedCount,metaRawOption:clone(thisMetaRawOption)})}function createSourceFromSeriesDataOption(data){return new SourceImpl({data:data,sourceFormat:isTypedArray(data)?SOURCE_FORMAT_TYPED_ARRAY:SOURCE_FORMAT_ORIGINAL})}function detectSourceFormat(data){var sourceFormat=SOURCE_FORMAT_UNKNOWN;if(isTypedArray(data))sourceFormat=SOURCE_FORMAT_TYPED_ARRAY;else if(isArray(data)){0===data.length&&(sourceFormat=SOURCE_FORMAT_ARRAY_ROWS);for(var i=0,len=data.length;i<len;i++){var item=data[i];if(null!=item){if(isArray(item)){sourceFormat=SOURCE_FORMAT_ARRAY_ROWS;break}if(isObject(item)){sourceFormat=SOURCE_FORMAT_OBJECT_ROWS;break}}}}else if(isObject(data))for(var key in data)if(hasOwn(data,key)&&isArrayLike(data[key])){sourceFormat=SOURCE_FORMAT_KEYED_COLUMNS;break}return sourceFormat}function normalizeDimensionsOption(dimensionsDefine){var nameMap;if(dimensionsDefine)return nameMap=createHashMap(),map(dimensionsDefine,function(rawItem,index){rawItem={name:(rawItem=isObject(rawItem)?rawItem:{name:rawItem}).name,displayName:rawItem.displayName,type:rawItem.type};if(null==rawItem.name)return rawItem;rawItem.name+="",null==rawItem.displayName&&(rawItem.displayName=rawItem.name);var exist=nameMap.get(rawItem.name);return exist?rawItem.name+="-"+exist.count++:nameMap.set(rawItem.name,{count:1}),rawItem})}function arrayRowsTravelFirst(cb,seriesLayoutBy,data,maxLoop){if(seriesLayoutBy===SERIES_LAYOUT_BY_ROW)for(var i=0;i<data.length&&i<maxLoop;i++)cb(data[i]?data[i][0]:null,i);else for(var value0=data[0]||[],i=0;i<value0.length&&i<maxLoop;i++)cb(value0[i],i)}function shouldRetrieveDataByName(source){source=source.sourceFormat;return source===SOURCE_FORMAT_OBJECT_ROWS||source===SOURCE_FORMAT_KEYED_COLUMNS}function getItemSimply(rawData,startIndex,dimsDef,idx){return rawData[idx]}var DefaultDataProvider=function(){function DefaultDataProvider(sourceParam,dimSize){var sourceParam=isSourceInstance(sourceParam)?sourceParam:createSourceFromSeriesDataOption(sourceParam),data=(this._source=sourceParam,this._data=sourceParam.data);if(sourceParam.sourceFormat===SOURCE_FORMAT_TYPED_ARRAY){if(null==dimSize)throw new Error("Typed array data must specify dimension size");this._offset=0,this._dimSize=dimSize,this._data=data}mountMethods(this,data,sourceParam)}var proto,getItemForTypedArray,fillStorageForTypedArray,countForTypedArray;function appendDataSimply(newData){for(var i=0;i<newData.length;i++)this._data.push(newData[i])}return DefaultDataProvider.prototype.getSource=function(){return this._source},DefaultDataProvider.prototype.count=function(){return 0},DefaultDataProvider.prototype.getItem=function(idx,out){},DefaultDataProvider.prototype.appendData=function(newData){},DefaultDataProvider.prototype.clean=function(){},DefaultDataProvider.protoInitialize=((proto=DefaultDataProvider.prototype).pure=!1,void(proto.persistent=!0)),DefaultDataProvider.internalField=(mountMethods=function(provider,data,source){var sourceFormat=source.sourceFormat,seriesLayoutBy=source.seriesLayoutBy,startIndex=source.startIndex,source=source.dimensionsDefine,methods=providerMethods[getMethodMapKey(sourceFormat,seriesLayoutBy)];assert(methods,"Invalide sourceFormat: "+sourceFormat),extend(provider,methods),sourceFormat===SOURCE_FORMAT_TYPED_ARRAY?(provider.getItem=getItemForTypedArray,provider.count=countForTypedArray,provider.fillStorage=fillStorageForTypedArray):(methods=getRawSourceItemGetter(sourceFormat,seriesLayoutBy),provider.getItem=bind(methods,null,data,startIndex,source),methods=getRawSourceDataCounter(sourceFormat,seriesLayoutBy),provider.count=bind(methods,null,data,startIndex,source))},getItemForTypedArray=function(idx,out){idx-=this._offset,out=out||[];for(var data=this._data,dimSize=this._dimSize,offset=dimSize*idx,i=0;i<dimSize;i++)out[i]=data[offset+i];return out},fillStorageForTypedArray=function(start,end,storage,extent){for(var data=this._data,dimSize=this._dimSize,dim=0;dim<dimSize;dim++){for(var dimExtent=extent[dim],min=null==dimExtent[0]?1/0:dimExtent[0],max=null==dimExtent[1]?-1/0:dimExtent[1],count=end-start,arr=storage[dim],i=0;i<count;i++){var val=data[i*dimSize+dim];(arr[start+i]=val)<min&&(min=val),max<val&&(max=val)}dimExtent[0]=min,dimExtent[1]=max}},countForTypedArray=function(){return this._data?this._data.length/this._dimSize:0},(proto={})[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_COLUMN]={pure:!0,appendData:appendDataSimply},proto[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_ROW]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},proto[SOURCE_FORMAT_OBJECT_ROWS]={pure:!0,appendData:appendDataSimply},proto[SOURCE_FORMAT_KEYED_COLUMNS]={pure:!0,appendData:function(newData){var data=this._data;each(newData,function(newCol,key){for(var oldCol=data[key]||(data[key]=[]),i=0;i<(newCol||[]).length;i++)oldCol.push(newCol[i])})}},proto[SOURCE_FORMAT_ORIGINAL]={appendData:appendDataSimply},proto[SOURCE_FORMAT_TYPED_ARRAY]={persistent:!1,pure:!0,appendData:function(newData){assert(isTypedArray(newData),"Added data must be TypedArray if data in initialization is TypedArray"),this._data=newData},clean:function(){this._offset+=this.count(),this._data=null}},void(providerMethods=proto)),DefaultDataProvider}(),rawSourceItemGetterMap=((ItemStyleMixin={})[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_COLUMN]=function(rawData,startIndex,dimsDef,idx){return rawData[idx+startIndex]},ItemStyleMixin[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_ROW]=function(rawData,startIndex,dimsDef,idx,out){idx+=startIndex;for(var item=out||[],data=rawData,i=0;i<data.length;i++){var row=data[i];item[i]=row?row[idx]:null}return item},ItemStyleMixin[SOURCE_FORMAT_OBJECT_ROWS]=getItemSimply,ItemStyleMixin[SOURCE_FORMAT_KEYED_COLUMNS]=function(rawData,startIndex,dimsDef,idx,out){for(var item=out||[],i=0;i<dimsDef.length;i++){var dimName=dimsDef[i].name;if(null==dimName)throw new Error;dimName=rawData[dimName];item[i]=dimName?dimName[idx]:null}return item},ItemStyleMixin[SOURCE_FORMAT_ORIGINAL]=getItemSimply,ItemStyleMixin);function getRawSourceItemGetter(sourceFormat,seriesLayoutBy){var method=rawSourceItemGetterMap[getMethodMapKey(sourceFormat,seriesLayoutBy)];return assert(method,'Do not support get item on "'+sourceFormat+'", "'+seriesLayoutBy+'".'),method}function countSimply(rawData,startIndex,dimsDef){return rawData.length}(AreaStyleMixin={})[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_COLUMN]=function(rawData,startIndex,dimsDef){return Math.max(0,rawData.length-startIndex)},AreaStyleMixin[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_ROW]=function(rawData,startIndex,dimsDef){rawData=rawData[0];return rawData?Math.max(0,rawData.length-startIndex):0},AreaStyleMixin[SOURCE_FORMAT_OBJECT_ROWS]=countSimply,AreaStyleMixin[SOURCE_FORMAT_KEYED_COLUMNS]=function(rawData,startIndex,dimsDef){dimsDef=dimsDef[0].name;if(null==dimsDef)throw new Error;rawData=rawData[dimsDef];return rawData?rawData.length:0},AreaStyleMixin[SOURCE_FORMAT_ORIGINAL]=countSimply;var rawSourceDataCounterMap=AreaStyleMixin;function getRawSourceDataCounter(sourceFormat,seriesLayoutBy){var method=rawSourceDataCounterMap[getMethodMapKey(sourceFormat,seriesLayoutBy)];return assert(method,'Do not suppport count on "'+sourceFormat+'", "'+seriesLayoutBy+'".'),method}function getRawValueSimply(dataItem,dimIndex,property){return dataItem[dimIndex]}(subPixelOptimize$1={})[SOURCE_FORMAT_ARRAY_ROWS]=getRawValueSimply,subPixelOptimize$1[SOURCE_FORMAT_OBJECT_ROWS]=function(dataItem,dimIndex,property){return dataItem[property]},subPixelOptimize$1[SOURCE_FORMAT_KEYED_COLUMNS]=getRawValueSimply,subPixelOptimize$1[SOURCE_FORMAT_ORIGINAL]=function(dataItem,dimIndex,property){dataItem=getDataItemValue(dataItem);return dataItem instanceof Array?dataItem[dimIndex]:dataItem},subPixelOptimize$1[SOURCE_FORMAT_TYPED_ARRAY]=getRawValueSimply;var rawSourceValueGetterMap=subPixelOptimize$1;function getRawSourceValueGetter(sourceFormat){var method=rawSourceValueGetterMap[sourceFormat];return assert(method,'Do not suppport get value on "'+sourceFormat+'".'),method}function getMethodMapKey(sourceFormat,seriesLayoutBy){return sourceFormat===SOURCE_FORMAT_ARRAY_ROWS?sourceFormat+"_"+seriesLayoutBy:sourceFormat}function retrieveRawValue(data,dataIndex,dim){if(data){var sourceFormat,store,dataIndex=data.getRawDataItem(dataIndex);if(null!=dataIndex)return sourceFormat=(store=data.getStore()).getSource().sourceFormat,null!=dim?(data=data.getDimensionIndex(dim),dim=store.getDimensionProperty(data),getRawSourceValueGetter(sourceFormat)(dataIndex,data,dim)):(store=dataIndex,sourceFormat===SOURCE_FORMAT_ORIGINAL?getDataItemValue(dataIndex):store)}}var DIMENSION_LABEL_REG=/\{@(.+?)\}/g,LineStyleMixin=function(){function DataFormatMixin(){}return DataFormatMixin.prototype.getDataParams=function(dataIndex,dataType){var data=this.getData(dataType),rawValue=this.getRawValue(dataIndex,dataType),rawDataIndex=data.getRawIndex(dataIndex),name=data.getName(dataIndex),itemOpt=data.getRawDataItem(dataIndex),style=data.getItemVisual(dataIndex,"style"),dataIndex=style&&style[data.getItemVisual(dataIndex,"drawType")||"fill"],style=style&&style.stroke,mainType=this.mainType,isSeries="series"===mainType,data=data.userOutput&&data.userOutput.get();return{componentType:mainType,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:isSeries?this.subType:null,seriesIndex:this.seriesIndex,seriesId:isSeries?this.id:null,seriesName:isSeries?this.name:null,name:name,dataIndex:rawDataIndex,data:itemOpt,dataType:dataType,value:rawValue,color:dataIndex,borderColor:style,dimensionNames:data?data.fullDimensions:null,encode:data?data.encode:null,$vars:["seriesName","name","value"]}},DataFormatMixin.prototype.getFormattedLabel=function(dataIndex,status,dataType,labelDimIndex,formatter,extendParams){status=status||"normal";var data=this.getData(dataType),dataType=this.getDataParams(dataIndex,dataType);return extendParams&&(dataType.value=extendParams.interpolatedValue),null!=labelDimIndex&&isArray(dataType.value)&&(dataType.value=dataType.value[labelDimIndex]),isFunction(formatter=formatter||data.getItemModel(dataIndex).get("normal"===status?["label","formatter"]:[status,"label","formatter"]))?(dataType.status=status,dataType.dimensionIndex=labelDimIndex,formatter(dataType)):isString(formatter)?formatTpl(formatter,dataType).replace(DIMENSION_LABEL_REG,function(origin,dimStr){var len=dimStr.length,dimLoose=dimStr,len=("["===dimLoose.charAt(0)&&"]"===dimLoose.charAt(len-1)&&(dimLoose=+dimLoose.slice(1,len-1),isNaN(dimLoose)&&error("Invalide label formatter: @"+dimStr+", only support @[0], @[1], @[2], ...")),retrieveRawValue(data,dataIndex,dimLoose));return extendParams&&isArray(extendParams.interpolatedValue)&&(0<=(dimStr=data.getDimensionIndex(dimLoose))&&(len=extendParams.interpolatedValue[dimStr])),null!=len?len+"":""}):void 0},DataFormatMixin.prototype.getRawValue=function(idx,dataType){return retrieveRawValue(this.getData(dataType),idx)},DataFormatMixin.prototype.formatTooltip=function(dataIndex,multipleSeries,dataType){},DataFormatMixin}();function normalizeTooltipFormatResult(result){var markupText,markupFragment;return isObject(result)?result.type?markupFragment=result:console.warn("The return type of `formatTooltip` is not supported: "+makePrintable(result)):markupText=result,{text:markupText,frag:markupFragment}}function createTask(define){return new Task(define)}var Task=function(){function Task(define){this._reset=(define=define||{}).reset,this._plan=define.plan,this._count=define.count,this._onDirty=define.onDirty,this._dirty=!0}return Task.prototype.perform=function(performArgs){var planResult,forceFirstProgress,upTask=this._upstream,skip=performArgs&&performArgs.skip,context=(this._dirty&&upTask&&((context=this.context).data=context.outputData=upTask.context.outputData),this.__pipeline&&(this.__pipeline.currentTask=this),this._plan&&!skip&&(planResult=this._plan(this.context)),normalizeModBy(this._modBy)),lastModDataCount=this._modDataCount||0,modBy=normalizeModBy(performArgs&&performArgs.modBy),modDataCount=performArgs&&performArgs.modDataCount||0;function normalizeModBy(val){return val=1<=val?val:1}context===modBy&&lastModDataCount===modDataCount||(planResult="reset"),!this._dirty&&"reset"!==planResult||(this._dirty=!1,forceFirstProgress=this._doReset(skip)),this._modBy=modBy,this._modDataCount=modDataCount;context=performArgs&&performArgs.step;if(upTask?(assert(null!=upTask._outputDueEnd),this._dueEnd=upTask._outputDueEnd):(assert(!this._progress||this._count),this._dueEnd=this._count?this._count(this.context):1/0),this._progress){var start=this._dueIndex,end=Math.min(null!=context?this._dueIndex+context:1/0,this._dueEnd);if(!skip&&(forceFirstProgress||start<end)){var progress=this._progress;if(isArray(progress))for(var i=0;i<progress.length;i++)this._doProgress(progress[i],start,end,modBy,modDataCount);else this._doProgress(progress,start,end,modBy,modDataCount)}this._dueIndex=end;lastModDataCount=null!=this._settedOutputEnd?this._settedOutputEnd:end;assert(lastModDataCount>=this._outputDueEnd),this._outputDueEnd=lastModDataCount}else this._dueIndex=this._outputDueEnd=null!=this._settedOutputEnd?this._settedOutputEnd:this._dueEnd;return this.unfinished()},Task.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},Task.prototype._doProgress=function(progress,start,end,modBy,modDataCount){iterator.reset(start,end,modBy,modDataCount),this._callingProgress=progress,this._callingProgress({start:start,end:end,count:end-start,next:iterator.next},this.context)},Task.prototype._doReset=function(skip){this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null,!skip&&this._reset&&((progress=this._reset(this.context))&&progress.progress&&(forceFirstProgress=progress.forceFirstProgress,progress=progress.progress),isArray(progress)&&!progress.length&&(progress=null)),this._progress=progress,this._modBy=this._modDataCount=null;var progress,forceFirstProgress,skip=this._downstream;return skip&&skip.dirty(),forceFirstProgress},Task.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},Task.prototype.pipe=function(downTask){assert(downTask&&!downTask._disposed&&downTask!==this),this._downstream===downTask&&!this._dirty||((this._downstream=downTask)._upstream=this,downTask.dirty())},Task.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},Task.prototype.getUpstream=function(){return this._upstream},Task.prototype.getDownstream=function(){return this._downstream},Task.prototype.setOutputEnd=function(end){this._outputDueEnd=this._settedOutputEnd=end},Task}(),iterator=function(){var end,current,modBy,modDataCount,winCount,it={reset:function(s,e,sStep,sCount){current=s,end=e,modBy=sStep,modDataCount=sCount,winCount=Math.ceil(modDataCount/modBy),it.next=1<modBy&&0<modDataCount?modNext:sequentialNext}};return it;function sequentialNext(){return current<end?current++:null}function modNext(){var dataIndex=current%winCount*modBy+Math.ceil(current/winCount),dataIndex=end<=current?null:dataIndex<modDataCount?dataIndex:current;return current++,dataIndex}}();function parseDataValue(value,opt){opt=opt&&opt.type;return"ordinal"===opt?value:null==(value="time"!==opt||isNumber(value)||null==value||"-"===value?value:+parseDate(value))||""===value?NaN:+value}new HashMap({number:function(val){return parseFloat(val)},time:function(val){return+parseDate(val)},trim:function(val){return isString(val)?trim(val):val}});var ORDER_COMPARISON_OP_MAP={lt:function(lval,rval){return lval<rval},lte:function(lval,rval){return lval<=rval},gt:function(lval,rval){return rval<lval},gte:function(lval,rval){return rval<=lval}},SortOrderComparator=(function(){function FilterOrderComparator(op,rval){isNumber(rval)||throwError('rvalue of "<", ">", "<=", ">=" can only be number in filter.'),this._opFn=ORDER_COMPARISON_OP_MAP[op],this._rvalFloat=numericToNumber(rval)}FilterOrderComparator.prototype.evaluate=function(lval){return isNumber(lval)?this._opFn(lval,this._rvalFloat):this._opFn(numericToNumber(lval),this._rvalFloat)}}(),function(){function SortOrderComparator(order,incomparable){order="desc"===order;this._resultLT=order?1:-1,this._incomparable="min"===(incomparable=null==incomparable?order?"min":"max":incomparable)?-1/0:1/0}return SortOrderComparator.prototype.evaluate=function(lval,rval){var lvalFloat=isNumber(lval)?lval:numericToNumber(lval),rvalFloat=isNumber(rval)?rval:numericToNumber(rval),lvalNotNumeric=isNaN(lvalFloat),rvalNotNumeric=isNaN(rvalFloat);return lvalNotNumeric&&(lvalFloat=this._incomparable),rvalNotNumeric&&(rvalFloat=this._incomparable),lvalNotNumeric&&rvalNotNumeric&&(lvalNotNumeric=isString(lval),rvalNotNumeric=isString(rval),lvalNotNumeric&&(lvalFloat=rvalNotNumeric?lval:0),rvalNotNumeric&&(rvalFloat=lvalNotNumeric?rval:0)),lvalFloat<rvalFloat?this._resultLT:rvalFloat<lvalFloat?-this._resultLT:0},SortOrderComparator}()),ExternalSource=(function(){function FilterEqualityComparator(isEq,rval){this._rval=rval,this._isEQ=isEq,this._rvalTypeof=typeof rval,this._rvalFloat=numericToNumber(rval)}FilterEqualityComparator.prototype.evaluate=function(lval){var lvalTypeof,eqResult=lval===this._rval;return eqResult||((lvalTypeof=typeof lval)===this._rvalTypeof||"number"!=lvalTypeof&&"number"!==this._rvalTypeof||(eqResult=numericToNumber(lval)===this._rvalFloat)),this._isEQ?eqResult:!eqResult}}(),function(){function ExternalSource(){}return ExternalSource.prototype.getRawData=function(){throw new Error("not supported")},ExternalSource.prototype.getRawDataItem=function(dataIndex){throw new Error("not supported")},ExternalSource.prototype.cloneRawData=function(){},ExternalSource.prototype.getDimensionInfo=function(dim){},ExternalSource.prototype.cloneAllDimensionInfo=function(){},ExternalSource.prototype.count=function(){},ExternalSource.prototype.retrieveValue=function(dataIndex,dimIndex){},ExternalSource.prototype.retrieveValueFromItem=function(dataItem,dimIndex){},ExternalSource.prototype.convertValue=parseDataValue,ExternalSource}());function getRawData(upstream){var sourceFormat=upstream.sourceFormat;return isSupportedSourceFormat(sourceFormat)||throwError("`getRawData` is not supported in source format "+sourceFormat),upstream.data}function cloneRawData(upstream){var sourceFormat=upstream.sourceFormat,data=upstream.data;if(isSupportedSourceFormat(sourceFormat)||throwError("`cloneRawData` is not supported in source format "+sourceFormat),sourceFormat===SOURCE_FORMAT_ARRAY_ROWS){for(var result=[],i=0,len=data.length;i<len;i++)result.push(data[i].slice());return result}if(sourceFormat===SOURCE_FORMAT_OBJECT_ROWS){for(result=[],i=0,len=data.length;i<len;i++)result.push(extend({},data[i]));return result}}function getDimensionInfo(dimensions,dimsByName,dim){if(null!=dim)return isNumber(dim)||!isNaN(dim)&&!hasOwn(dimsByName,dim)?dimensions[dim]:hasOwn(dimsByName,dim)?dimsByName[dim]:void 0}function cloneAllDimensionInfo(dimensions){return clone(dimensions)}var externalTransformMap=createHashMap();function applyDataTransform(rawTransOption,sourceList,infoForPrint){var pipedTransOption=normalizeToArray(rawTransOption),pipeLen=pipedTransOption.length;pipeLen||throwError("If `transform` declared, it should at least contain one transform.");for(var i=0,len=pipeLen;i<len;i++)sourceList=function(transOption,upSourceList,infoForPrint,pipeIndex){upSourceList.length||throwError("Must have at least one upstream dataset.");isObject(transOption)||throwError("transform declaration must be an object rather than "+typeof transOption+".");var transType=transOption.type,externalTransform=externalTransformMap.get(transType);externalTransform||throwError('Can not find transform on type "'+transType+'".');transType=map(upSourceList,function(upSource){return function(internalSource,externalTransform){var extSource=new ExternalSource,data=internalSource.data,sourceFormat=extSource.sourceFormat=internalSource.sourceFormat,sourceHeaderCount=internalSource.startIndex,dimensions=(internalSource.seriesLayoutBy!==SERIES_LAYOUT_BY_COLUMN&&throwError('`seriesLayoutBy` of upstream dataset can only be "column" in data transform.'),[]),dimsByName={};if(dimsDef=internalSource.dimensionsDefine)each(dimsDef,function(dimDef,idx){var name=dimDef.name,idx={index:idx,name:name,displayName:dimDef.displayName};dimensions.push(idx),null!=name&&(hasOwn(dimsByName,name)&&throwError('dimension name "'+name+'" duplicated.'),dimsByName[name]=idx)});else for(var i=0;i<internalSource.dimensionsDetectedCount;i++)dimensions.push({index:i});var rawItemGetter=getRawSourceItemGetter(sourceFormat,SERIES_LAYOUT_BY_COLUMN),dimsDef=(externalTransform.__isBuiltIn&&(extSource.getRawDataItem=function(dataIndex){return rawItemGetter(data,sourceHeaderCount,dimensions,dataIndex)},extSource.getRawData=bind(getRawData,null,internalSource)),extSource.cloneRawData=bind(cloneRawData,null,internalSource),getRawSourceDataCounter(sourceFormat,SERIES_LAYOUT_BY_COLUMN)),rawValueGetter=(extSource.count=bind(dimsDef,null,data,sourceHeaderCount,dimensions),getRawSourceValueGetter(sourceFormat)),retrieveValueFromItem=(extSource.retrieveValue=function(dataIndex,dimIndex){dataIndex=rawItemGetter(data,sourceHeaderCount,dimensions,dataIndex);return retrieveValueFromItem(dataIndex,dimIndex)},extSource.retrieveValueFromItem=function(dataItem,dimIndex){var dimDef;if(null!=dataItem)return dimDef=dimensions[dimIndex],dimDef?rawValueGetter(dataItem,dimIndex,dimDef.name):void 0});return extSource.getDimensionInfo=bind(getDimensionInfo,null,dimensions,dimsByName),extSource.cloneAllDimensionInfo=bind(cloneAllDimensionInfo,null,dimensions),extSource}(upSource,externalTransform)}),transType=normalizeToArray(externalTransform.transform({upstream:transType[0],upstreamList:transType,config:clone(transOption.config)}));transOption.print&&!function(str,onlyOnce){outputLog("log",str,onlyOnce)}(map(transType,function(extSource){return["=== dataset index: "+infoForPrint.datasetIndex+(null!=pipeIndex?" === pipe index: "+pipeIndex:"")+" ===","- transform result data:",makePrintable(extSource.data),"- transform result dimensions:",makePrintable(extSource.dimensions)].join("\n")}).join("\n"));return map(transType,function(result,resultIndex){isObject(result)||throwError("A transform should not return some empty results."),result.data||throwError("Transform result data should be not be null or undefined");isSupportedSourceFormat(detectSourceFormat(result.data))||throwError("Transform result data should be array rows or object rows.");var firstUpSource=upSourceList[0],resultIndex=firstUpSource&&0===resultIndex&&!result.dimensions?((resultIndex=firstUpSource.startIndex)&&(result.data=firstUpSource.data.slice(0,resultIndex).concat(result.data)),{seriesLayoutBy:SERIES_LAYOUT_BY_COLUMN,sourceHeader:resultIndex,dimensions:firstUpSource.metaRawOption.dimensions}):{seriesLayoutBy:SERIES_LAYOUT_BY_COLUMN,sourceHeader:0,dimensions:result.dimensions};return createSource(result.data,resultIndex,null)})}(pipedTransOption[i],sourceList,infoForPrint,1===pipeLen?null:i),i!==len-1&&(sourceList.length=Math.max(sourceList.length,1));return sourceList}function isSupportedSourceFormat(sourceFormat){return sourceFormat===SOURCE_FORMAT_ARRAY_ROWS||sourceFormat===SOURCE_FORMAT_OBJECT_ROWS}var defaultDimValueGetters,CtorUint32Array="undefined"==typeof Uint32Array?Array:Uint32Array,CtorUint16Array="undefined"==typeof Uint16Array?Array:Uint16Array,CtorInt32Array="undefined"==typeof Int32Array?Array:Int32Array,target="undefined"==typeof Float64Array?Array:Float64Array,dataCtors={float:target,int:CtorInt32Array,ordinal:Array,number:Array,time:target};function getIndicesCtor(rawCount){return 65535<rawCount?CtorUint32Array:CtorUint16Array}function prepareStore(store,dimIdx,dimType,end,append){dimType=dataCtors[dimType||"float"];if(append){var oldStore=store[dimIdx],oldLen=oldStore&&oldStore.length;if(oldLen!==end){for(var newStore=new dimType(end),j=0;j<oldLen;j++)newStore[j]=oldStore[j];store[dimIdx]=newStore}}else store[dimIdx]=new dimType(end)}var DataStore=function(){function DataStore(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=createHashMap()}function getDimValueSimply(dataItem,property,dataIndex,dimIndex){return parseDataValue(dataItem[dimIndex],this._dimensions[dimIndex])}return DataStore.prototype.initData=function(provider,inputDimensions,dimValueGetter){assert(isFunction(provider.getItem)&&isFunction(provider.count),"Inavlid data provider."),this._provider=provider,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var source=provider.getSource(),defaultGetter=this.defaultDimValueGetter=defaultDimValueGetters[source.sourceFormat],willRetrieveDataByName=(this._dimValueGetter=dimValueGetter||defaultGetter,this._rawExtent=[],shouldRetrieveDataByName(source));this._dimensions=map(inputDimensions,function(dim){return willRetrieveDataByName&&assert(null!=dim.property),{type:dim.type,property:dim.property}}),this._initDataFromProvider(0,provider.count())},DataStore.prototype.getProvider=function(){return this._provider},DataStore.prototype.getSource=function(){return this._provider.getSource()},DataStore.prototype.ensureCalculationDimension=function(dimName,type){var calcDimNameToIdx=this._calcDimNameToIdx,dimensions=this._dimensions,calcDimIdx=calcDimNameToIdx.get(dimName);if(null!=calcDimIdx){if(dimensions[calcDimIdx].type===type)return calcDimIdx}else calcDimIdx=dimensions.length;return dimensions[calcDimIdx]={type:type},calcDimNameToIdx.set(dimName,calcDimIdx),this._chunks[calcDimIdx]=new dataCtors[type||"float"](this._rawCount),this._rawExtent[calcDimIdx]=[1/0,-1/0],calcDimIdx},DataStore.prototype.collectOrdinalMeta=function(dimIdx,ordinalMeta){for(var chunk=this._chunks[dimIdx],dim=this._dimensions[dimIdx],rawExtents=this._rawExtent,offset=dim.ordinalOffset||0,len=chunk.length,dimRawExtent=(0===offset&&(rawExtents[dimIdx]=[1/0,-1/0]),rawExtents[dimIdx]),i=offset;i<len;i++){var val=chunk[i]=ordinalMeta.parseAndCollect(chunk[i]);dimRawExtent[0]=Math.min(val,dimRawExtent[0]),dimRawExtent[1]=Math.max(val,dimRawExtent[1])}dim.ordinalMeta=ordinalMeta,dim.ordinalOffset=len,dim.type="ordinal"},DataStore.prototype.getOrdinalMeta=function(dimIdx){return this._dimensions[dimIdx].ordinalMeta},DataStore.prototype.getDimensionProperty=function(dimIndex){dimIndex=this._dimensions[dimIndex];return dimIndex&&dimIndex.property},DataStore.prototype.appendData=function(data){assert(!this._indices,"appendData can only be called on raw data.");var provider=this._provider,start=this.count(),data=(provider.appendData(data),provider.count());return provider.persistent||(data+=start),start<data&&this._initDataFromProvider(start,data,!0),[start,data]},DataStore.prototype.appendValues=function(values,minFillLen){for(var chunks=this._chunks,dimensions=this._dimensions,dimLen=dimensions.length,rawExtent=this._rawExtent,start=this.count(),end=start+Math.max(values.length,minFillLen||0),i=0;i<dimLen;i++)prepareStore(chunks,i,(dim=dimensions[i]).type,end,!0);for(var emptyDataItem=[],idx=start;idx<end;idx++)for(var sourceIdx=idx-start,dimIdx=0;dimIdx<dimLen;dimIdx++){var dim=dimensions[dimIdx],val=defaultDimValueGetters.arrayRows.call(this,values[sourceIdx]||emptyDataItem,dim.property,sourceIdx,dimIdx),dimRawExtent=(chunks[dimIdx][idx]=val,rawExtent[dimIdx]);val<dimRawExtent[0]&&(dimRawExtent[0]=val),val>dimRawExtent[1]&&(dimRawExtent[1]=val)}return{start:start,end:this._rawCount=this._count=end}},DataStore.prototype._initDataFromProvider=function(start,end,append){for(var provider=this._provider,chunks=this._chunks,dimensions=this._dimensions,dimLen=dimensions.length,rawExtent=this._rawExtent,dimNames=map(dimensions,function(dim){return dim.property}),i=0;i<dimLen;i++){var dim=dimensions[i];rawExtent[i]||(rawExtent[i]=[1/0,-1/0]),prepareStore(chunks,i,dim.type,end,append)}if(provider.fillStorage)provider.fillStorage(start,end,chunks,rawExtent);else for(var dataItem=[],idx=start;idx<end;idx++)for(var dataItem=provider.getItem(idx,dataItem),dimIdx=0;dimIdx<dimLen;dimIdx++){var dimStorage=chunks[dimIdx],val=this._dimValueGetter(dataItem,dimNames[dimIdx],idx,dimIdx),dimStorage=(dimStorage[idx]=val,rawExtent[dimIdx]);val<dimStorage[0]&&(dimStorage[0]=val),val>dimStorage[1]&&(dimStorage[1]=val)}!provider.persistent&&provider.clean&&provider.clean(),this._rawCount=this._count=end,this._extent=[]},DataStore.prototype.count=function(){return this._count},DataStore.prototype.get=function(dim,idx){if(!(0<=idx&&idx<this._count))return NaN;dim=this._chunks[dim];return dim?dim[this.getRawIndex(idx)]:NaN},DataStore.prototype.getValues=function(dimensions,idx){var values=[],dimArr=[];if(null==idx){idx=dimensions,dimensions=[];for(var i=0;i<this._dimensions.length;i++)dimArr.push(i)}else dimArr=dimensions;for(var i=0,len=dimArr.length;i<len;i++)values.push(this.get(dimArr[i],idx));return values},DataStore.prototype.getByRawIndex=function(dim,rawIdx){if(!(0<=rawIdx&&rawIdx<this._rawCount))return NaN;dim=this._chunks[dim];return dim?dim[rawIdx]:NaN},DataStore.prototype.getSum=function(dim){var sum=0;if(this._chunks[dim])for(var i=0,len=this.count();i<len;i++){var value=this.get(dim,i);isNaN(value)||(sum+=value)}return sum},DataStore.prototype.getMedian=function(dim){var dimDataArray=[],dim=(this.each([dim],function(val){isNaN(val)||dimDataArray.push(val)}),dimDataArray.sort(function(a,b){return a-b})),len=this.count();return 0===len?0:len%2==1?dim[(len-1)/2]:(dim[len/2]+dim[len/2-1])/2},DataStore.prototype.indexOfRawIndex=function(rawIndex){if(rawIndex>=this._rawCount||rawIndex<0)return-1;if(!this._indices)return rawIndex;var indices=this._indices,rawDataIndex=indices[rawIndex];if(null!=rawDataIndex&&rawDataIndex<this._count&&rawDataIndex===rawIndex)return rawIndex;for(var left=0,right=this._count-1;left<=right;){var mid=(left+right)/2|0;if(indices[mid]<rawIndex)left=1+mid;else{if(!(indices[mid]>rawIndex))return mid;right=mid-1}}return-1},DataStore.prototype.indicesOfNearest=function(dim,value,maxDistance){var dimData=this._chunks[dim],nearestIndices=[];if(!dimData)return nearestIndices;null==maxDistance&&(maxDistance=1/0);for(var minDist=1/0,minDiff=-1,nearestIndicesLen=0,i=0,len=this.count();i<len;i++){var diff=value-dimData[this.getRawIndex(i)],dist=Math.abs(diff);dist<=maxDistance&&((dist<minDist||dist===minDist&&0<=diff&&minDiff<0)&&(minDist=dist,minDiff=diff,nearestIndicesLen=0),diff===minDiff&&(nearestIndices[nearestIndicesLen++]=i))}return nearestIndices.length=nearestIndicesLen,nearestIndices},DataStore.prototype.getIndices=function(){var indices=this._indices;if(indices){var Ctor=indices.constructor,thisCount=this._count;if(Ctor===Array)for(var newIndices=new Ctor(thisCount),i=0;i<thisCount;i++)newIndices[i]=indices[i];else newIndices=new Ctor(indices.buffer,0,thisCount)}else{newIndices=new(Ctor=getIndicesCtor(this._rawCount))(this.count());for(i=0;i<newIndices.length;i++)newIndices[i]=i}return newIndices},DataStore.prototype.filter=function(dims,cb){if(!this._count)return this;for(var newStore=this.clone(),count=newStore.count(),newIndices=new(getIndicesCtor(newStore._rawCount))(count),value=[],dimSize=dims.length,offset=0,dim0=dims[0],chunks=newStore._chunks,i=0;i<count;i++){var keep=void 0,rawIdx=newStore.getRawIndex(i);if(0===dimSize)keep=cb(i);else if(1===dimSize)keep=cb(chunks[dim0][rawIdx],i);else{for(var k=0;k<dimSize;k++)value[k]=chunks[dims[k]][rawIdx];value[k]=i,keep=cb.apply(null,value)}keep&&(newIndices[offset++]=rawIdx)}return offset<count&&(newStore._indices=newIndices),newStore._count=offset,newStore._extent=[],newStore._updateGetRawIdx(),newStore},DataStore.prototype.selectRange=function(range){var newStore=this.clone(),len=newStore._count;if(!len)return this;var dims=keys(range),dimSize=dims.length;if(!dimSize)return this;var originalCount=newStore.count(),newIndices=new(getIndicesCtor(newStore._rawCount))(originalCount),offset=0,dim0=dims[0],min=range[dim0][0],max=range[dim0][1],storeArr=newStore._chunks,dim0=!1;if(!newStore._indices){var idx=0;if(1===dimSize){for(var dimStorage=storeArr[dims[0]],i=0;i<len;i++)(min<=(val=dimStorage[i])&&val<=max||isNaN(val))&&(newIndices[offset++]=idx),idx++;dim0=!0}else if(2===dimSize){for(var dimStorage=storeArr[dims[0]],dimStorage2=storeArr[dims[1]],min2=range[dims[1]][0],max2=range[dims[1]][1],i=0;i<len;i++){var val=dimStorage[i],val2=dimStorage2[i];(min<=val&&val<=max||isNaN(val))&&(min2<=val2&&val2<=max2||isNaN(val2))&&(newIndices[offset++]=idx),idx++}dim0=!0}}if(!dim0)if(1===dimSize)for(i=0;i<originalCount;i++){var rawIndex=newStore.getRawIndex(i);(min<=(val=storeArr[dims[0]][rawIndex])&&val<=max||isNaN(val))&&(newIndices[offset++]=rawIndex)}else for(i=0;i<originalCount;i++){for(var keep=!0,rawIndex=newStore.getRawIndex(i),k=0;k<dimSize;k++){var dimk=dims[k];((val=storeArr[dimk][rawIndex])<range[dimk][0]||val>range[dimk][1])&&(keep=!1)}keep&&(newIndices[offset++]=newStore.getRawIndex(i))}return offset<originalCount&&(newStore._indices=newIndices),newStore._count=offset,newStore._extent=[],newStore._updateGetRawIdx(),newStore},DataStore.prototype.map=function(dims,cb){var target=this.clone(dims);return this._updateDims(target,dims,cb),target},DataStore.prototype.modify=function(dims,cb){this._updateDims(this,dims,cb)},DataStore.prototype._updateDims=function(target,dims,cb){for(var targetChunks=target._chunks,tmpRetValue=[],dimSize=dims.length,dataCount=target.count(),values=[],rawExtent=target._rawExtent,i=0;i<dims.length;i++)rawExtent[dims[i]]=[1/0,-1/0];for(var dataIndex=0;dataIndex<dataCount;dataIndex++){for(var rawIndex=target.getRawIndex(dataIndex),k=0;k<dimSize;k++)values[k]=targetChunks[dims[k]][rawIndex];values[dimSize]=dataIndex;var retValue=cb&&cb.apply(null,values);if(null!=retValue){"object"!=typeof retValue&&(tmpRetValue[0]=retValue,retValue=tmpRetValue);for(i=0;i<retValue.length;i++){var dim=dims[i],val=retValue[i],rawExtentOnDim=rawExtent[dim],dim=targetChunks[dim];dim&&(dim[rawIndex]=val),val<rawExtentOnDim[0]&&(rawExtentOnDim[0]=val),val>rawExtentOnDim[1]&&(rawExtentOnDim[1]=val)}}}},DataStore.prototype.lttbDownSample=function(valueDimension,rate){var area,target=this.clone([valueDimension],!0),dimStore=target._chunks[valueDimension],len=this.count(),sampledIndex=0,frameSize=Math.floor(1/rate),currentRawIndex=this.getRawIndex(0),newIndices=new(getIndicesCtor(this._rawCount))(Math.min(2*(Math.ceil(len/frameSize)+2),len));newIndices[sampledIndex++]=currentRawIndex;for(var i=1;i<len-1;i+=frameSize){for(var nextFrameStart=Math.min(i+frameSize,len-1),nextFrameEnd=Math.min(i+2*frameSize,len),avgX=(nextFrameEnd+nextFrameStart)/2,avgY=0,idx=nextFrameStart;idx<nextFrameEnd;idx++){var y=dimStore[rawIndex=this.getRawIndex(idx)];isNaN(y)||(avgY+=y)}avgY/=nextFrameEnd-nextFrameStart;for(var nextFrameStart=i,frameEnd=Math.min(i+frameSize,len),pointAX=i-1,pointAY=dimStore[currentRawIndex],maxArea=-1,nextRawIndex=nextFrameStart,firstNaNIndex=-1,countNaN=0,idx=nextFrameStart;idx<frameEnd;idx++){var rawIndex,y=dimStore[rawIndex=this.getRawIndex(idx)];isNaN(y)?(countNaN++,firstNaNIndex<0&&(firstNaNIndex=rawIndex)):maxArea<(area=Math.abs((pointAX-avgX)*(y-pointAY)-(pointAX-idx)*(avgY-pointAY)))&&(maxArea=area,nextRawIndex=rawIndex)}0<countNaN&&countNaN<frameEnd-nextFrameStart&&(newIndices[sampledIndex++]=Math.min(firstNaNIndex,nextRawIndex),nextRawIndex=Math.max(firstNaNIndex,nextRawIndex)),currentRawIndex=newIndices[sampledIndex++]=nextRawIndex}return newIndices[sampledIndex++]=this.getRawIndex(len-1),target._count=sampledIndex,target._indices=newIndices,target.getRawIndex=this._getRawIdx,target},DataStore.prototype.downSample=function(dimension,rate,sampleValue,sampleIndex){for(var target=this.clone([dimension],!0),targetStorage=target._chunks,frameValues=[],frameSize=Math.floor(1/rate),dimStore=targetStorage[dimension],len=this.count(),rawExtentOnDim=target._rawExtent[dimension]=[1/0,-1/0],newIndices=new(getIndicesCtor(this._rawCount))(Math.ceil(len/frameSize)),offset=0,i=0;i<len;i+=frameSize){len-i<frameSize&&(frameValues.length=frameSize=len-i);for(var k=0;k<frameSize;k++){var dataIdx=this.getRawIndex(i+k);frameValues[k]=dimStore[dataIdx]}var value=sampleValue(frameValues),sampleFrameIdx=this.getRawIndex(Math.min(i+sampleIndex(frameValues,value)||0,len-1));(dimStore[sampleFrameIdx]=value)<rawExtentOnDim[0]&&(rawExtentOnDim[0]=value),value>rawExtentOnDim[1]&&(rawExtentOnDim[1]=value),newIndices[offset++]=sampleFrameIdx}return target._count=offset,target._indices=newIndices,target._updateGetRawIdx(),target},DataStore.prototype.each=function(dims,cb){if(this._count)for(var dimSize=dims.length,chunks=this._chunks,i=0,len=this.count();i<len;i++){var rawIdx=this.getRawIndex(i);switch(dimSize){case 0:cb(i);break;case 1:cb(chunks[dims[0]][rawIdx],i);break;case 2:cb(chunks[dims[0]][rawIdx],chunks[dims[1]][rawIdx],i);break;default:for(var k=0,value=[];k<dimSize;k++)value[k]=chunks[dims[k]][rawIdx];value[k]=i,cb.apply(null,value)}}},DataStore.prototype.getDataExtent=function(dim){var dimData=this._chunks[dim],initialExtent=[1/0,-1/0];if(!dimData)return initialExtent;var currEnd=this.count();if(!this._indices)return this._rawExtent[dim].slice();if(dimExtent=this._extent[dim])return dimExtent.slice();for(var dimExtent,min=(dimExtent=initialExtent)[0],max=dimExtent[1],i=0;i<currEnd;i++){var value=dimData[this.getRawIndex(i)];value<min&&(min=value),max<value&&(max=value)}return this._extent[dim]=dimExtent=[min,max]},DataStore.prototype.getRawDataItem=function(idx){var rawIdx=this.getRawIndex(idx);if(this._provider.persistent)return this._provider.getItem(rawIdx);for(var val=[],chunks=this._chunks,i=0;i<chunks.length;i++)val.push(chunks[i][rawIdx]);return val},DataStore.prototype.clone=function(clonedDims,ignoreIndices){var originalChunk,Ctor,target=new DataStore,chunks=this._chunks,clonedDimsMap=clonedDims&&reduce(clonedDims,function(obj,dimIdx){return obj[dimIdx]=!0,obj},{});if(clonedDimsMap)for(var i=0;i<chunks.length;i++)target._chunks[i]=clonedDimsMap[i]?(originalChunk=chunks[i],Ctor=void 0,(Ctor=originalChunk.constructor)===Array?originalChunk.slice():new Ctor(originalChunk)):chunks[i];else target._chunks=chunks;return this._copyCommonProps(target),ignoreIndices||(target._indices=this._cloneIndices()),target._updateGetRawIdx(),target},DataStore.prototype._copyCommonProps=function(target){target._count=this._count,target._rawCount=this._rawCount,target._provider=this._provider,target._dimensions=this._dimensions,target._extent=clone(this._extent),target._rawExtent=clone(this._rawExtent)},DataStore.prototype._cloneIndices=function(){if(this._indices){var Ctor=this._indices.constructor,indices=void 0;if(Ctor===Array)for(var thisCount=this._indices.length,indices=new Ctor(thisCount),i=0;i<thisCount;i++)indices[i]=this._indices[i];else indices=new Ctor(this._indices);return indices}return null},DataStore.prototype._getRawIdxIdentity=function(idx){return idx},DataStore.prototype._getRawIdx=function(idx){return idx<this._count&&0<=idx?this._indices[idx]:-1},DataStore.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},DataStore.internalField=void(defaultDimValueGetters={arrayRows:getDimValueSimply,objectRows:function(dataItem,property,dataIndex,dimIndex){return parseDataValue(dataItem[property],this._dimensions[dimIndex])},keyedColumns:getDimValueSimply,original:function(dataItem,property,dataIndex,dimIndex){dataItem=dataItem&&(null==dataItem.value?dataItem:dataItem.value);return parseDataValue(dataItem instanceof Array?dataItem[dimIndex]:dataItem,this._dimensions[dimIndex])},typedArray:function(dataItem,property,dataIndex,dimIndex){return dataItem[dimIndex]}}),DataStore}(),SourceManager=function(){function SourceManager(sourceHost){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=sourceHost}return SourceManager.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},SourceManager.prototype._setLocalSource=function(sourceList,upstreamSignList){this._sourceList=sourceList,this._upstreamSignList=upstreamSignList,this._versionSignBase++,9e10<this._versionSignBase&&(this._versionSignBase=0)},SourceManager.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},SourceManager.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},SourceManager.prototype._createSource=function(){this._setLocalSource([],[]);var sourceFormat,upSourceMgr,sourceHeader,seriesModel,upSource,data,seriesLayoutBy,sourceHost=this._sourceHost,upSourceMgrList=this._getUpstreamSourceManagers(),hasUpstream=!!upSourceMgrList.length;isSeries(sourceHost)?(seriesModel=sourceHost,upSource=sourceFormat=data=void 0,upSourceMgr=hasUpstream?((upSourceMgr=upSourceMgrList[0]).prepareSource(),data=(upSource=upSourceMgr.getSource()).data,sourceFormat=upSource.sourceFormat,[upSourceMgr._getVersionSign()]):(sourceFormat=isTypedArray(data=seriesModel.get("data",!0))?SOURCE_FORMAT_TYPED_ARRAY:SOURCE_FORMAT_ORIGINAL,[]),seriesModel=this._getSourceMetaRawOption()||{},upSource=upSource&&upSource.metaRawOption||{},seriesLayoutBy=retrieve2(seriesModel.seriesLayoutBy,upSource.seriesLayoutBy)||null,sourceHeader=retrieve2(seriesModel.sourceHeader,upSource.sourceHeader),seriesModel=retrieve2(seriesModel.dimensions,upSource.dimensions),upSource=seriesLayoutBy!==upSource.seriesLayoutBy||!!sourceHeader!=!!upSource.sourceHeader||seriesModel?[createSource(data,{seriesLayoutBy:seriesLayoutBy,sourceHeader:sourceHeader,dimensions:seriesModel},sourceFormat)]:[]):(data=sourceHost,upSourceMgr=hasUpstream?(upSource=(seriesLayoutBy=this._applyTransform(upSourceMgrList)).sourceList,seriesLayoutBy.upstreamSignList):(upSource=[createSource(data.get("source",!0),this._getSourceMetaRawOption(),null)],[])),assert(upSource&&upSourceMgr),this._setLocalSource(upSource,upSourceMgr)},SourceManager.prototype._applyTransform=function(upMgrList){var sourceList,datasetModel=this._sourceHost,transformOption=datasetModel.get("transform",!0),fromTransformResult=datasetModel.get("fromTransformResult",!0),upSourceList=(assert(null!=fromTransformResult||null!=transformOption),null!=fromTransformResult&&(1!==upMgrList.length&&doThrow("When using `fromTransformResult`, there should be only one upstream dataset")),[]),upstreamSignList=[];return each(upMgrList,function(upMgr){upMgr.prepareSource();var upSource=upMgr.getSource(fromTransformResult||0);null==fromTransformResult||upSource||doThrow("Can not retrieve result by `fromTransformResult`: "+fromTransformResult),upSourceList.push(upSource),upstreamSignList.push(upMgr._getVersionSign())}),transformOption?sourceList=applyDataTransform(transformOption,upSourceList,{datasetIndex:datasetModel.componentIndex}):null!=fromTransformResult&&(sourceList=[(upMgrList=upSourceList[0],new SourceImpl({data:upMgrList.data,sourceFormat:upMgrList.sourceFormat,seriesLayoutBy:upMgrList.seriesLayoutBy,dimensionsDefine:clone(upMgrList.dimensionsDefine),startIndex:upMgrList.startIndex,dimensionsDetectedCount:upMgrList.dimensionsDetectedCount}))]),{sourceList:sourceList,upstreamSignList:upstreamSignList}},SourceManager.prototype._isDirty=function(){if(this._dirty)return!0;for(var upSourceMgrList=this._getUpstreamSourceManagers(),i=0;i<upSourceMgrList.length;i++){var upSrcMgr=upSourceMgrList[i];if(upSrcMgr._isDirty()||this._upstreamSignList[i]!==upSrcMgr._getVersionSign())return!0}},SourceManager.prototype.getSource=function(sourceIndex){var source=this._sourceList[sourceIndex=sourceIndex||0];return source||(source=this._getUpstreamSourceManagers())[0]&&source[0].getSource(sourceIndex)},SourceManager.prototype.getSharedDataStore=function(seriesDimRequest){assert(isSeries(this._sourceHost),"Can only call getDataStore on series source manager.");var schema=seriesDimRequest.makeStoreSchema();return this._innerGetDataStore(schema.dimensions,seriesDimRequest.source,schema.hash)},SourceManager.prototype._innerGetDataStore=function(storeDims,seriesSource,sourceReadKey){var upSourceMgr,storeList=this._storeList,cachedStoreMap=storeList[0],storeList=(cachedStoreMap=cachedStoreMap||(storeList[0]={}))[sourceReadKey];return storeList||(upSourceMgr=this._getUpstreamSourceManagers()[0],isSeries(this._sourceHost)&&upSourceMgr?storeList=upSourceMgr._innerGetDataStore(storeDims,seriesSource,sourceReadKey):(storeList=new DataStore).initData(new DefaultDataProvider(seriesSource,storeDims.length),storeDims),cachedStoreMap[sourceReadKey]=storeList),storeList},SourceManager.prototype._getUpstreamSourceManagers=function(){var datasetModel,sourceHost=this._sourceHost;return isSeries(sourceHost)?(datasetModel=querySeriesUpstreamDatasetModel(sourceHost))?[datasetModel.getSourceManager()]:[]:map(function(datasetModel){return datasetModel.get("transform",!0)||datasetModel.get("fromTransformResult",!0)?queryReferringComponents(datasetModel.ecModel,"dataset",{index:datasetModel.get("fromDatasetIndex",!0),id:datasetModel.get("fromDatasetId",!0)},SINGLE_REFERRING).models:[]}(sourceHost),function(datasetModel){return datasetModel.getSourceManager()})},SourceManager.prototype._getSourceMetaRawOption=function(){var seriesLayoutBy,sourceHeader,dimensions,sourceHost=this._sourceHost;return isSeries(sourceHost)?(seriesLayoutBy=sourceHost.get("seriesLayoutBy",!0),sourceHeader=sourceHost.get("sourceHeader",!0),dimensions=sourceHost.get("dimensions",!0)):this._getUpstreamSourceManagers().length||(seriesLayoutBy=(sourceHost=sourceHost).get("seriesLayoutBy",!0),sourceHeader=sourceHost.get("sourceHeader",!0),dimensions=sourceHost.get("dimensions",!0)),{seriesLayoutBy:seriesLayoutBy,sourceHeader:sourceHeader,dimensions:dimensions}},SourceManager}();function disableTransformOptionMerge(datasetModel){datasetModel.option.transform&&setAsPrimitive(datasetModel.option.transform)}function isSeries(sourceHost){return"series"===sourceHost.mainType}function doThrow(errMsg){throw new Error(errMsg)}var TOOLTIP_LINE_HEIGHT_CSS="line-height:1";function getTooltipTextStyle(textStyle,renderMode){var nameFontColor=textStyle.color||"#6e7079",nameFontSize=textStyle.fontSize||12,nameFontWeight=textStyle.fontWeight||"400",valueFontColor=textStyle.color||"#464646",valueFontSize=textStyle.fontSize||14,textStyle=textStyle.fontWeight||"900";return"html"===renderMode?{nameStyle:"font-size:"+encodeHTML(nameFontSize+"")+"px;color:"+encodeHTML(nameFontColor)+";font-weight:"+encodeHTML(nameFontWeight+""),valueStyle:"font-size:"+encodeHTML(valueFontSize+"")+"px;color:"+encodeHTML(valueFontColor)+";font-weight:"+encodeHTML(textStyle+"")}:{nameStyle:{fontSize:nameFontSize,fill:nameFontColor,fontWeight:nameFontWeight},valueStyle:{fontSize:valueFontSize,fill:valueFontColor,fontWeight:textStyle}}}var HTML_GAPS=[0,10,20,30],RICH_TEXT_GAPS=["","\n","\n\n","\n\n\n"];function createTooltipMarkup(type,option){return option.type=type,option}function getBuilder(frag){return"section"===frag.type?buildSection:buildNameValue}function buildSection(ctx,fragment,topMarginForOuterGap,toolTipTextStyle){var comparator_1,noHeader=fragment.noHeader,gaps=(gapLevel=function getBlockGapLevel(frag){var gapLevel_1,subBlockLen,hasInnerGap_1;return"section"===frag.type?(gapLevel_1=0,subBlockLen=frag.blocks.length,hasInnerGap_1=1<subBlockLen||0<subBlockLen&&!frag.noHeader,each(frag.blocks,function(subBlock){var subGapLevel=getBlockGapLevel(subBlock);gapLevel_1<=subGapLevel&&(gapLevel_1=subGapLevel+ +(hasInnerGap_1&&(!subGapLevel||"section"===subBlock.type&&!subBlock.noHeader)))}),gapLevel_1):0}(fragment),{html:HTML_GAPS[gapLevel],richText:RICH_TEXT_GAPS[gapLevel]}),subMarkupTextList=[],gapLevel=fragment.blocks||[],orderMode=(assert(!gapLevel||isArray(gapLevel)),gapLevel=gapLevel||[],ctx.orderMode),orderMap=(fragment.sortBlocks&&orderMode&&(gapLevel=gapLevel.slice(),hasOwn(orderMap={valueAsc:"asc",valueDesc:"desc"},orderMode)?(comparator_1=new SortOrderComparator(orderMap[orderMode],null),gapLevel.sort(function(a,b){return comparator_1.evaluate(a.sortParam,b.sortParam)})):"seriesDesc"===orderMode&&gapLevel.reverse()),each(gapLevel,function(subBlock,idx){var valueFormatter=fragment.valueFormatter,valueFormatter=getBuilder(subBlock)(valueFormatter?extend(extend({},ctx),{valueFormatter:valueFormatter}):ctx,subBlock,0<idx?gaps.html:0,toolTipTextStyle);null!=valueFormatter&&subMarkupTextList.push(valueFormatter)}),"richText"===ctx.renderMode?subMarkupTextList.join(gaps.richText):wrapBlockHTML(subMarkupTextList.join(""),noHeader?topMarginForOuterGap:gaps.html));if(noHeader)return orderMap;orderMode=makeValueReadable(fragment.header,"ordinal",ctx.useUTC),gapLevel=getTooltipTextStyle(toolTipTextStyle,ctx.renderMode).nameStyle;return"richText"===ctx.renderMode?wrapInlineNameRichText(ctx,orderMode,gapLevel)+gaps.richText+orderMap:wrapBlockHTML('<div style="'+gapLevel+";"+TOOLTIP_LINE_HEIGHT_CSS+';">'+encodeHTML(orderMode)+"</div>"+orderMap,topMarginForOuterGap)}function buildNameValue(ctx,fragment,topMarginForOuterGap,toolTipTextStyle){var markerStr,valueTypeOption,valueCloseToMarker,nameStyle,renderMode=ctx.renderMode,noName=fragment.noName,noValue=fragment.noValue,noMarker=!fragment.markerType,name=fragment.name,useUTC=ctx.useUTC,valueFormatter=fragment.valueFormatter||ctx.valueFormatter||function(value){return map(value=isArray(value)?value:[value],function(val,idx){return makeValueReadable(val,isArray(valueTypeOption)?valueTypeOption[idx]:valueTypeOption,useUTC)})};if(!noName||!noValue)return markerStr=noMarker?"":ctx.markupStyleCreator.makeTooltipMarker(fragment.markerType,fragment.markerColor||"#333",renderMode),name=noName?"":makeValueReadable(name,"ordinal",useUTC),valueTypeOption=fragment.valueType,valueFormatter=noValue?[]:valueFormatter(fragment.value),fragment=!noMarker||!noName,valueCloseToMarker=!noMarker&&noName,toolTipTextStyle=getTooltipTextStyle(toolTipTextStyle,renderMode),nameStyle=toolTipTextStyle.nameStyle,toolTipTextStyle=toolTipTextStyle.valueStyle,"richText"===renderMode?(noMarker?"":markerStr)+(noName?"":wrapInlineNameRichText(ctx,name,nameStyle))+(noValue?"":function(ctx,values,alignRight,valueCloseToMarker,style){style=[style],valueCloseToMarker=valueCloseToMarker?10:20;return alignRight&&style.push({padding:[0,0,0,valueCloseToMarker],align:"right"}),ctx.markupStyleCreator.wrapRichTextStyle(isArray(values)?values.join("  "):values,style)}(ctx,valueFormatter,fragment,valueCloseToMarker,toolTipTextStyle)):wrapBlockHTML((noMarker?"":markerStr)+(noName?"":function(name,leftHasMarker,style){return'<span style="'+style+";"+(leftHasMarker?"margin-left:2px":"")+'">'+encodeHTML(name)+"</span>"}(name,!noMarker,nameStyle))+(noValue?"":function(valueList,alignRight,valueCloseToMarker,style){valueCloseToMarker=valueCloseToMarker?"10px":"20px",alignRight=alignRight?"float:right;margin-left:"+valueCloseToMarker:"";return valueList=isArray(valueList)?valueList:[valueList],'<span style="'+alignRight+";"+style+'">'+map(valueList,encodeHTML).join("&nbsp;&nbsp;")+"</span>"}(valueFormatter,fragment,valueCloseToMarker,toolTipTextStyle)),topMarginForOuterGap)}function buildTooltipMarkup(fragment,markupStyleCreator,renderMode,orderMode,useUTC,toolTipTextStyle){if(fragment)return getBuilder(fragment)({useUTC:useUTC,renderMode:renderMode,orderMode:orderMode,markupStyleCreator:markupStyleCreator,valueFormatter:fragment.valueFormatter},fragment,0,toolTipTextStyle)}function wrapBlockHTML(encodedContent,topGap){return'<div style="'+("margin: "+topGap+"px 0 0")+";"+TOOLTIP_LINE_HEIGHT_CSS+';">'+encodedContent+'<div style="clear:both"></div></div>'}function wrapInlineNameRichText(ctx,name,style){return ctx.markupStyleCreator.wrapRichTextStyle(name,style)}function getPaddingFromTooltipModel(model,renderMode){model=model.get("padding");return null!=model?model:"richText"===renderMode?[8,10]:10}var TooltipMarkupStyleCreator=function(){function TooltipMarkupStyleCreator(){this.richTextStyles={},this._nextStyleNameId=getRandomIdBase()}return TooltipMarkupStyleCreator.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},TooltipMarkupStyleCreator.prototype.makeTooltipMarker=function(markerType,colorStr,renderMode){var markerId="richText"===renderMode?this._generateStyleName():null,colorStr=getTooltipMarker({color:colorStr,type:markerType,renderMode:renderMode,markerId:markerId});return isString(colorStr)?colorStr:(assert(markerId),this.richTextStyles[markerId]=colorStr.style,colorStr.content)},TooltipMarkupStyleCreator.prototype.wrapRichTextStyle=function(text,styles){var finalStl={},styles=(isArray(styles)?each(styles,function(stl){return extend(finalStl,stl)}):extend(finalStl,styles),this._generateStyleName());return this.richTextStyles[styles]=finalStl,"{"+styles+"|"+text+"}"},TooltipMarkupStyleCreator}();function defaultSeriesFormatTooltip(opt){var inlineValue,inlineValueType,subBlocks,formatArrResult,series=opt.series,dataIndex=opt.dataIndex,opt=opt.multipleSeries,data=series.getData(),tooltipDims=data.mapDimensionsAll("defaultedTooltip"),tooltipDimLen=tooltipDims.length,value=series.getRawValue(dataIndex),isValueArr=isArray(value),markerColor=function(series,dataIndex){return convertToColorString(series.getData().getItemVisual(dataIndex,"style")[series.visualDrawType])}(series,dataIndex),tooltipDims=(1<tooltipDimLen||isValueArr&&!tooltipDimLen?(inlineValue=(formatArrResult=function(value,series,dataIndex,tooltipDims,colorStr){var data=series.getData(),isValueMultipleLine=reduce(value,function(isValueMultipleLine,val,idx){idx=data.getDimensionInfo(idx);return isValueMultipleLine||idx&&!1!==idx.tooltip&&null!=idx.displayName},!1),inlineValues=[],inlineValueTypes=[],blocks=[];function setEachItem(val,dim){dim=data.getDimensionInfo(dim);dim&&!1!==dim.otherDims.tooltip&&(isValueMultipleLine?blocks.push(createTooltipMarkup("nameValue",{markerType:"subItem",markerColor:colorStr,name:dim.displayName,value:val,valueType:dim.type})):(inlineValues.push(val),inlineValueTypes.push(dim.type)))}return tooltipDims.length?each(tooltipDims,function(dim){setEachItem(retrieveRawValue(data,dataIndex,dim),dim)}):each(value,setEachItem),{inlineValues:inlineValues,inlineValueTypes:inlineValueTypes,blocks:blocks}}(value,series,dataIndex,tooltipDims,markerColor)).inlineValues,inlineValueType=formatArrResult.inlineValueTypes,subBlocks=formatArrResult.blocks,formatArrResult=formatArrResult.inlineValues[0]):tooltipDimLen?(tooltipDimLen=data.getDimensionInfo(tooltipDims[0]),formatArrResult=inlineValue=retrieveRawValue(data,dataIndex,tooltipDims[0]),inlineValueType=tooltipDimLen.type):formatArrResult=inlineValue=isValueArr?value[0]:value,isNameSpecified(series)),tooltipDimLen=tooltipDims&&series.name||"",isValueArr=data.getName(dataIndex),value=opt?tooltipDimLen:isValueArr;return createTooltipMarkup("section",{header:tooltipDimLen,noHeader:opt||!tooltipDims,sortParam:formatArrResult,blocks:[createTooltipMarkup("nameValue",{markerType:"item",markerColor:markerColor,name:value,noName:!trim(value),value:inlineValue,valueType:inlineValueType})].concat(subBlocks||[])})}var inner$1=makeInner();function getSelectionKey(data,dataIndex){return data.getName(dataIndex)||data.getId(dataIndex)}var SeriesModel=function(_super){function SeriesModel(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._selectedDataIndicesMap={},_this}var proto;return __extends(SeriesModel,_super),SeriesModel.prototype.init=function(option,parentModel,ecModel){this.seriesIndex=this.componentIndex,this.dataTask=createTask({count:dataTaskCount,reset:dataTaskReset}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(option,ecModel);(inner$1(this).sourceManager=new SourceManager(this)).prepareSource();option=this.getInitialData(option,ecModel);wrapData(option,this),assert(this.dataTask.context.data=option,"getInitialData returned invalid data."),inner$1(this).dataBeforeProcessed=option,autoSeriesName(this),this._initSelectedMapFromData(option)},SeriesModel.prototype.mergeDefaultAndTheme=function(option,ecModel){var layoutMode=fetchLayoutMode(this),inputPositionParams=layoutMode?getLayoutParams(option):{},themeSubType=this.subType;ComponentModel.hasClass(themeSubType),merge(option,ecModel.getTheme().get(this.subType)),merge(option,this.getDefaultOption()),defaultEmphasis(option,"label",["show"]),this.fillDataTextStyle(option.data),layoutMode&&mergeLayoutParam(option,inputPositionParams,layoutMode)},SeriesModel.prototype.mergeOption=function(newSeriesOption,ecModel){newSeriesOption=merge(this.option,newSeriesOption,!0),this.fillDataTextStyle(newSeriesOption.data);var layoutMode=fetchLayoutMode(this),layoutMode=(layoutMode&&mergeLayoutParam(this.option,newSeriesOption,layoutMode),inner$1(this).sourceManager),layoutMode=(layoutMode.dirty(),layoutMode.prepareSource(),this.getInitialData(newSeriesOption,ecModel));wrapData(layoutMode,this),this.dataTask.dirty(),this.dataTask.context.data=layoutMode,inner$1(this).dataBeforeProcessed=layoutMode,autoSeriesName(this),this._initSelectedMapFromData(layoutMode)},SeriesModel.prototype.fillDataTextStyle=function(data){if(data&&!isTypedArray(data))for(var props=["show"],i=0;i<data.length;i++)data[i]&&data[i].label&&defaultEmphasis(data[i],"label",props)},SeriesModel.prototype.getInitialData=function(option,ecModel){},SeriesModel.prototype.appendData=function(params){this.getRawData().appendData(params.data)},SeriesModel.prototype.getData=function(dataType){var task=getCurrentTask(this);return task?(task=task.context.data,null==dataType?task:task.getLinkedData(dataType)):inner$1(this).data},SeriesModel.prototype.getAllData=function(){var mainData=this.getData();return mainData&&mainData.getLinkedDataAll?mainData.getLinkedDataAll():[{data:mainData}]},SeriesModel.prototype.setData=function(data){var context,task=getCurrentTask(this);task&&((context=task.context).outputData=data,task!==this.dataTask&&(context.data=data)),inner$1(this).data=data},SeriesModel.prototype.getEncode=function(){var encode=this.get("encode",!0);if(encode)return createHashMap(encode)},SeriesModel.prototype.getSourceManager=function(){return inner$1(this).sourceManager},SeriesModel.prototype.getSource=function(){return this.getSourceManager().getSource()},SeriesModel.prototype.getRawData=function(){return inner$1(this).dataBeforeProcessed},SeriesModel.prototype.getColorBy=function(){return this.get("colorBy")||"series"},SeriesModel.prototype.isColorBySeries=function(){return"series"===this.getColorBy()},SeriesModel.prototype.getBaseAxis=function(){var coordSys=this.coordinateSystem;return coordSys&&coordSys.getBaseAxis&&coordSys.getBaseAxis()},SeriesModel.prototype.formatTooltip=function(dataIndex,multipleSeries,dataType){return defaultSeriesFormatTooltip({series:this,dataIndex:dataIndex,multipleSeries:multipleSeries})},SeriesModel.prototype.isAnimationEnabled=function(){var ecModel=this.ecModel;if(env.node&&(!ecModel||!ecModel.ssr))return!1;ecModel=this.getShallow("animation");return!!(ecModel=ecModel&&this.getData().count()>this.getShallow("animationThreshold")?!1:ecModel)},SeriesModel.prototype.restoreData=function(){this.dataTask.dirty()},SeriesModel.prototype.getColorFromPalette=function(name,scope,requestColorNum){var ecModel=this.ecModel;return PaletteMixin.prototype.getColorFromPalette.call(this,name,scope,requestColorNum)||ecModel.getColorFromPalette(name,scope,requestColorNum)},SeriesModel.prototype.coordDimToDataDim=function(coordDim){return this.getRawData().mapDimensionsAll(coordDim)},SeriesModel.prototype.getProgressive=function(){return this.get("progressive")},SeriesModel.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},SeriesModel.prototype.select=function(innerDataIndices,dataType){this._innerSelect(this.getData(dataType),innerDataIndices)},SeriesModel.prototype.unselect=function(innerDataIndices,dataType){var selectedMap=this.option.selectedMap;if(selectedMap){var selectedMode=this.option.selectedMode,data=this.getData(dataType);if("series"===selectedMode||"all"===selectedMap)return this.option.selectedMap={},void(this._selectedDataIndicesMap={});for(var i=0;i<innerDataIndices.length;i++){var nameOrId=getSelectionKey(data,innerDataIndices[i]);selectedMap[nameOrId]=!1,this._selectedDataIndicesMap[nameOrId]=-1}}},SeriesModel.prototype.toggleSelect=function(innerDataIndices,dataType){for(var tmpArr=[],i=0;i<innerDataIndices.length;i++)tmpArr[0]=innerDataIndices[i],this.isSelected(innerDataIndices[i],dataType)?this.unselect(tmpArr,dataType):this.select(tmpArr,dataType)},SeriesModel.prototype.getSelectedDataIndices=function(){if("all"===this.option.selectedMap)return[].slice.call(this.getData().getIndices());for(var selectedDataIndicesMap=this._selectedDataIndicesMap,nameOrIds=keys(selectedDataIndicesMap),dataIndices=[],i=0;i<nameOrIds.length;i++){var dataIndex=selectedDataIndicesMap[nameOrIds[i]];0<=dataIndex&&dataIndices.push(dataIndex)}return dataIndices},SeriesModel.prototype.isSelected=function(dataIndex,dataType){var selectedMap=this.option.selectedMap;if(!selectedMap)return!1;dataType=this.getData(dataType);return("all"===selectedMap||selectedMap[getSelectionKey(dataType,dataIndex)])&&!dataType.getItemModel(dataIndex).get(["select","disabled"])},SeriesModel.prototype.isUniversalTransitionEnabled=function(){if(this.__universalTransitionEnabled)return!0;var universalTransitionOpt=this.option.universalTransition;return!!universalTransitionOpt&&(!0===universalTransitionOpt||universalTransitionOpt&&universalTransitionOpt.enabled)},SeriesModel.prototype._innerSelect=function(data,innerDataIndices){var option=this.option,selectedMode=option.selectedMode,len=innerDataIndices.length;if(selectedMode&&len)if("series"===selectedMode)option.selectedMap="all";else if("multiple"===selectedMode){isObject(option.selectedMap)||(option.selectedMap={});for(var selectedMap=option.selectedMap,i=0;i<len;i++){var nameOrId,dataIndex=innerDataIndices[i];selectedMap[nameOrId=getSelectionKey(data,dataIndex)]=!0,this._selectedDataIndicesMap[nameOrId]=data.getRawIndex(dataIndex)}}else"single"!==selectedMode&&!0!==selectedMode||(nameOrId=getSelectionKey(data,selectedMode=innerDataIndices[len-1]),option.selectedMap=((option={})[nameOrId]=!0,option),this._selectedDataIndicesMap=((option={})[nameOrId]=data.getRawIndex(selectedMode),option))},SeriesModel.prototype._initSelectedMapFromData=function(data){var dataIndices;this.option.selectedMap||(dataIndices=[],data.hasItemOption&&data.each(function(idx){var rawItem=data.getRawDataItem(idx);rawItem&&rawItem.selected&&dataIndices.push(idx)}),0<dataIndices.length&&this._innerSelect(data,dataIndices))},SeriesModel.registerClass=function(clz){return ComponentModel.registerClass(clz)},SeriesModel.protoInitialize=((proto=SeriesModel.prototype).type="series.__base__",proto.seriesIndex=0,proto.ignoreStyleOnData=!1,proto.hasSymbolVisual=!1,proto.defaultSymbol="circle",proto.visualStyleAccessPath="itemStyle",void(proto.visualDrawType="fill")),SeriesModel}(ComponentModel);function autoSeriesName(seriesModel){var name=seriesModel.name;isNameSpecified(seriesModel)||(seriesModel.name=function(seriesModel){var data=seriesModel.getRawData(),seriesModel=data.mapDimensionsAll("seriesName"),nameArr=[];return each(seriesModel,function(dataDim){dataDim=data.getDimensionInfo(dataDim);dataDim.displayName&&nameArr.push(dataDim.displayName)}),nameArr.join(" ")}(seriesModel)||name)}function dataTaskCount(context){return context.model.getRawData().count()}function dataTaskReset(context){context=context.model;return context.setData(context.getRawData().cloneShallow()),dataTaskProgress}function dataTaskProgress(param,context){context.outputData&&param.end>context.outputData.count()&&context.model.getRawData().cloneShallow(context.outputData)}function wrapData(data,seriesModel){each(concatArray(data.CHANGABLE_METHODS,data.DOWNSAMPLE_METHODS),function(methodName){data.wrapMethod(methodName,curry(onDataChange,seriesModel))})}function onDataChange(seriesModel,newList){seriesModel=getCurrentTask(seriesModel);return seriesModel&&seriesModel.setOutputEnd((newList||this).count()),newList}function getCurrentTask(seriesModel){var agentStubMap,scheduler=(seriesModel.ecModel||{}).scheduler,scheduler=scheduler&&scheduler.getPipeline(seriesModel.uid);if(scheduler)return(scheduler=scheduler.currentTask)&&(agentStubMap=scheduler.agentStubMap)?agentStubMap.get(seriesModel.uid):scheduler}mixin(SeriesModel,LineStyleMixin),mixin(SeriesModel,PaletteMixin),mountExtend(SeriesModel,ComponentModel);var ComponentView=function(){function ComponentView(){this.group=new Group,this.uid=getUID("viewComponent")}return ComponentView.prototype.init=function(ecModel,api){},ComponentView.prototype.render=function(model,ecModel,api,payload){},ComponentView.prototype.dispose=function(ecModel,api){},ComponentView.prototype.updateView=function(model,ecModel,api,payload){},ComponentView.prototype.updateLayout=function(model,ecModel,api,payload){},ComponentView.prototype.updateVisual=function(model,ecModel,api,payload){},ComponentView.prototype.blurSeries=function(seriesModels,ecModel){},ComponentView.prototype.eachRendered=function(cb){var group=this.group;group&&group.traverse(cb)},ComponentView}();function createRenderPlanner(){var inner=makeInner();return function(seriesModel){var fields=inner(seriesModel),seriesModel=seriesModel.pipelineContext,originalLarge=!!fields.large,originalProgressive=!!fields.progressiveRender,large=fields.large=!(!seriesModel||!seriesModel.large),fields=fields.progressiveRender=!(!seriesModel||!seriesModel.progressiveRender);return!(originalLarge==large&&originalProgressive==fields)&&"reset"}}enableClassExtend(ComponentView),enableClassManagement(ComponentView);var inner$2=makeInner(),renderPlanner=createRenderPlanner(),ChartView=function(){function ChartView(){this.group=new Group,this.uid=getUID("viewChart"),this.renderTask=createTask({plan:renderTaskPlan,reset:renderTaskReset}),this.renderTask.context={view:this}}return ChartView.prototype.init=function(ecModel,api){},ChartView.prototype.render=function(seriesModel,ecModel,api,payload){throw new Error("render method must been implemented")},ChartView.prototype.highlight=function(seriesModel,ecModel,api,payload){seriesModel=seriesModel.getData(payload&&payload.dataType);seriesModel?toggleHighlight(seriesModel,payload,"emphasis"):error("Unknown dataType "+payload.dataType)},ChartView.prototype.downplay=function(seriesModel,ecModel,api,payload){seriesModel=seriesModel.getData(payload&&payload.dataType);seriesModel?toggleHighlight(seriesModel,payload,"normal"):error("Unknown dataType "+payload.dataType)},ChartView.prototype.remove=function(ecModel,api){this.group.removeAll()},ChartView.prototype.dispose=function(ecModel,api){},ChartView.prototype.updateView=function(seriesModel,ecModel,api,payload){this.render(seriesModel,ecModel,api,payload)},ChartView.prototype.updateLayout=function(seriesModel,ecModel,api,payload){this.render(seriesModel,ecModel,api,payload)},ChartView.prototype.updateVisual=function(seriesModel,ecModel,api,payload){this.render(seriesModel,ecModel,api,payload)},ChartView.prototype.eachRendered=function(cb){traverseElements(this.group,cb)},ChartView.markUpdateMethod=function(payload,methodName){inner$2(payload).updateMethod=methodName},ChartView.protoInitialize=void(ChartView.prototype.type="chart"),ChartView}();function elSetState(el,state,highlightDigit){el&&isHighDownDispatcher(el)&&("emphasis"===state?enterEmphasis:leaveEmphasis)(el,highlightDigit)}function toggleHighlight(data,payload,state){var dataIndex=queryDataIndex(data,payload),highlightDigit=payload&&null!=payload.highlightKey?function(highlightKey){var highlightDigit=_highlightKeyMap[highlightKey];return highlightDigit=null==highlightDigit&&_highlightNextDigit<=32?_highlightKeyMap[highlightKey]=_highlightNextDigit++:highlightDigit}(payload.highlightKey):null;null!=dataIndex?each(normalizeToArray(dataIndex),function(dataIdx){elSetState(data.getItemGraphicEl(dataIdx),state,highlightDigit)}):data.eachItemGraphicEl(function(el){elSetState(el,state,highlightDigit)})}function renderTaskPlan(context){return renderPlanner(context.model)}function renderTaskReset(context){var seriesModel=context.model,ecModel=context.ecModel,api=context.api,payload=context.payload,progressiveRender=seriesModel.pipelineContext.progressiveRender,context=context.view,updateMethod=payload&&inner$2(payload).updateMethod,progressiveRender=progressiveRender?"incrementalPrepareRender":updateMethod&&context[updateMethod]?updateMethod:"render";return"render"!==progressiveRender&&context[progressiveRender](seriesModel,ecModel,api,payload),progressMethodMap[progressiveRender]}enableClassExtend(ChartView,["dispose"]),enableClassManagement(ChartView);var progressMethodMap={incrementalPrepareRender:{progress:function(params,context){context.view.incrementalRender(params,context.model,context.ecModel,context.api,context.payload)}},render:{forceFirstProgress:!0,progress:function(params,context){context.view.render(context.model,context.ecModel,context.api,context.payload)}}},ORIGIN_METHOD="\0__throttleOriginMethod",RATE="\0__throttleRate";function throttle(fn,delay,debounce){var currCall,diff,scope,args,debounceNextCall,lastCall=0,lastExec=0,timer=null;function exec(){lastExec=(new Date).getTime(),timer=null,fn.apply(scope,args||[])}delay=delay||0;function cb(){for(var cbArgs=[],_i=0;_i<arguments.length;_i++)cbArgs[_i]=arguments[_i];currCall=(new Date).getTime(),scope=this,args=cbArgs;var thisDelay=debounceNextCall||delay,thisDebounce=debounceNextCall||debounce;debounceNextCall=null,diff=currCall-(thisDebounce?lastCall:lastExec)-thisDelay,clearTimeout(timer),thisDebounce?timer=setTimeout(exec,thisDelay):0<=diff?exec():timer=setTimeout(exec,-diff),lastCall=currCall}return cb.clear=function(){timer&&(clearTimeout(timer),timer=null)},cb.debounceNextCall=function(debounceDelay){debounceNextCall=debounceDelay},cb}function createOrUpdate(obj,fnAttr,rate,throttleType){var fn=obj[fnAttr];if(fn){var originFn=fn[ORIGIN_METHOD]||fn,lastThrottleType=fn["\0__throttleType"];if(fn[RATE]!==rate||lastThrottleType!==throttleType){if(null==rate||!throttleType)return obj[fnAttr]=originFn;(fn=obj[fnAttr]=throttle(originFn,rate,"debounce"===throttleType))[ORIGIN_METHOD]=originFn,fn["\0__throttleType"]=throttleType,fn[RATE]=rate}}}function clear(obj,fnAttr){var fn=obj[fnAttr];fn&&fn[ORIGIN_METHOD]&&(fn.clear&&fn.clear(),obj[fnAttr]=fn[ORIGIN_METHOD])}var inner$3=makeInner(),defaultStyleMappers={itemStyle:makeStyleMapper(ITEM_STYLE_KEY_MAP,!0),lineStyle:makeStyleMapper(LINE_STYLE_KEY_MAP,!0)},defaultColorKey={lineStyle:"stroke",itemStyle:"fill"};function getStyleMapper(seriesModel,stylePath){seriesModel=seriesModel.visualStyleMapper||defaultStyleMappers[stylePath];return seriesModel||(console.warn("Unkown style type '"+stylePath+"'."),defaultStyleMappers.itemStyle)}function getDefaultColorKey(seriesModel,stylePath){seriesModel=seriesModel.visualDrawType||defaultColorKey[stylePath];return seriesModel||(console.warn("Unkown style type '"+stylePath+"'."),"fill")}var ItemStyleMixin={createOnAllSeries:!0,performRawSeries:!0,reset:function(seriesModel,ecModel){var data=seriesModel.getData(),stylePath=seriesModel.visualStyleAccessPath||"itemStyle",styleModel=seriesModel.getModel(stylePath),globalStyle=getStyleMapper(seriesModel,stylePath)(styleModel),styleModel=styleModel.getShallow("decal"),colorKey=(styleModel&&(data.setVisual("decal",styleModel),styleModel.dirty=!0),getDefaultColorKey(seriesModel,stylePath)),styleModel=globalStyle[colorKey],colorCallback=isFunction(styleModel)?styleModel:null,stylePath="auto"===globalStyle.fill||"auto"===globalStyle.stroke;if(globalStyle[colorKey]&&!colorCallback&&!stylePath||(styleModel=seriesModel.getColorFromPalette(seriesModel.name,null,ecModel.getSeriesCount()),globalStyle[colorKey]||(globalStyle[colorKey]=styleModel,data.setVisual("colorFromPalette",!0)),globalStyle.fill="auto"===globalStyle.fill||isFunction(globalStyle.fill)?styleModel:globalStyle.fill,globalStyle.stroke="auto"===globalStyle.stroke||isFunction(globalStyle.stroke)?styleModel:globalStyle.stroke),data.setVisual("style",globalStyle),data.setVisual("drawType",colorKey),!ecModel.isSeriesFiltered(seriesModel)&&colorCallback)return data.setVisual("colorFromPalette",!1),{dataEach:function(data,idx){var dataParams=seriesModel.getDataParams(idx),itemStyle=extend({},globalStyle);itemStyle[colorKey]=colorCallback(dataParams),data.setItemVisual(idx,"style",itemStyle)}}}},sharedModel=new Model,AreaStyleMixin={createOnAllSeries:!0,performRawSeries:!0,reset:function(seriesModel,ecModel){var stylePath,getStyle,colorKey;if(!seriesModel.ignoreStyleOnData&&!ecModel.isSeriesFiltered(seriesModel))return ecModel=seriesModel.getData(),stylePath=seriesModel.visualStyleAccessPath||"itemStyle",getStyle=getStyleMapper(seriesModel,stylePath),colorKey=ecModel.getVisual("drawType"),{dataEach:ecModel.hasItemOption?function(data,idx){var rawItem=data.getRawDataItem(idx);rawItem&&rawItem[stylePath]&&(sharedModel.option=rawItem[stylePath],rawItem=getStyle(sharedModel),extend(data.ensureUniqueItemVisual(idx,"style"),rawItem),sharedModel.option.decal&&(data.setItemVisual(idx,"decal",sharedModel.option.decal),sharedModel.option.decal.dirty=!0),colorKey in rawItem&&data.setItemVisual(idx,"colorFromPalette",!1))}:null}}},subPixelOptimize$1={performRawSeries:!0,overallReset:function(ecModel){var paletteScopeGroupByType=createHashMap();ecModel.eachSeries(function(seriesModel){var colorScope,colorBy=seriesModel.getColorBy();seriesModel.isColorBySeries()||(colorBy=seriesModel.type+"-"+colorBy,(colorScope=paletteScopeGroupByType.get(colorBy))||paletteScopeGroupByType.set(colorBy,colorScope={}),inner$3(seriesModel).scope=colorScope)}),ecModel.eachSeries(function(seriesModel){var dataAll,idxMap,data,colorScope,stylePath,colorKey;seriesModel.isColorBySeries()||ecModel.isSeriesFiltered(seriesModel)||(dataAll=seriesModel.getRawData(),idxMap={},data=seriesModel.getData(),colorScope=inner$3(seriesModel).scope,stylePath=seriesModel.visualStyleAccessPath||"itemStyle",colorKey=getDefaultColorKey(seriesModel,stylePath),data.each(function(idx){var rawIdx=data.getRawIndex(idx);idxMap[rawIdx]=idx}),dataAll.each(function(rawIdx){var dataCount,idx=idxMap[rawIdx];data.getItemVisual(idx,"colorFromPalette")&&(idx=data.ensureUniqueItemVisual(idx,"style"),rawIdx=dataAll.getName(rawIdx)||rawIdx+"",dataCount=dataAll.count(),idx[colorKey]=seriesModel.getColorFromPalette(rawIdx,colorScope,dataCount))}))})}},PI$3=Math.PI;var Scheduler=function(){function Scheduler(ecInstance,api,dataProcessorHandlers,visualHandlers){this._stageTaskMap=createHashMap(),this.ecInstance=ecInstance,this.api=api,dataProcessorHandlers=this._dataProcessorHandlers=dataProcessorHandlers.slice(),visualHandlers=this._visualHandlers=visualHandlers.slice(),this._allHandlers=dataProcessorHandlers.concat(visualHandlers)}return Scheduler.prototype.restoreData=function(ecModel,payload){ecModel.restoreData(payload),this._stageTaskMap.each(function(taskRecord){taskRecord=taskRecord.overallTask;taskRecord&&taskRecord.dirty()})},Scheduler.prototype.getPerformArgs=function(task,isBlock){var pipeline,pCtx;if(task.__pipeline)return pipeline=this._pipelineMap.get(task.__pipeline.id),pCtx=pipeline.context,isBlock=!isBlock&&pipeline.progressiveEnabled&&(!pCtx||pCtx.progressiveRender)&&task.__idxInPipeline>pipeline.blockIndex?pipeline.step:null,task=pCtx&&pCtx.modDataCount,{step:isBlock,modBy:null!=task?Math.ceil(task/isBlock):null,modDataCount:task}},Scheduler.prototype.getPipeline=function(pipelineId){return this._pipelineMap.get(pipelineId)},Scheduler.prototype.updateStreamModes=function(seriesModel,view){var pipeline=this._pipelineMap.get(seriesModel.uid),dataLen=seriesModel.getData().count(),view=pipeline.progressiveEnabled&&view.incrementalPrepareRender&&dataLen>=pipeline.threshold,large=seriesModel.get("large")&&dataLen>=seriesModel.get("largeThreshold"),dataLen="mod"===seriesModel.get("progressiveChunkMode")?dataLen:null;seriesModel.pipelineContext=pipeline.context={progressiveRender:view,modDataCount:dataLen,large:large}},Scheduler.prototype.restorePipelines=function(ecModel){var scheduler=this,pipelineMap=scheduler._pipelineMap=createHashMap();ecModel.eachSeries(function(seriesModel){var progressive=seriesModel.getProgressive(),pipelineId=seriesModel.uid;pipelineMap.set(pipelineId,{id:pipelineId,head:null,tail:null,threshold:seriesModel.getProgressiveThreshold(),progressiveEnabled:progressive&&!(seriesModel.preventIncremental&&seriesModel.preventIncremental()),blockIndex:-1,step:Math.round(progressive||700),count:0}),scheduler._pipe(seriesModel,seriesModel.dataTask)})},Scheduler.prototype.prepareStageTasks=function(){var stageTaskMap=this._stageTaskMap,ecModel=this.api.getModel(),api=this.api;each(this._allHandlers,function(handler){var record=stageTaskMap.get(handler.uid)||stageTaskMap.set(handler.uid,{});assert(!(handler.reset&&handler.overallReset),'"reset" and "overallReset" must not be both specified.'),handler.reset&&this._createSeriesStageTask(handler,record,ecModel,api),handler.overallReset&&this._createOverallStageTask(handler,record,ecModel,api)},this)},Scheduler.prototype.prepareView=function(view,model,ecModel,api){var renderTask=view.renderTask,context=renderTask.context;context.model=model,context.ecModel=ecModel,context.api=api,renderTask.__block=!view.incrementalPrepareRender,this._pipe(model,renderTask)},Scheduler.prototype.performDataProcessorTasks=function(ecModel,payload){this._performStageTasks(this._dataProcessorHandlers,ecModel,payload,{block:!0})},Scheduler.prototype.performVisualTasks=function(ecModel,payload,opt){this._performStageTasks(this._visualHandlers,ecModel,payload,opt)},Scheduler.prototype._performStageTasks=function(stageHandlers,ecModel,payload,opt){opt=opt||{};var unfinished=!1,scheduler=this;function needSetDirty(opt,task){return opt.setDirty&&(!opt.dirtyMap||opt.dirtyMap.get(task.__pipeline.id))}each(stageHandlers,function(stageHandler,idx){var seriesTaskMap,stageHandlerRecord,overallNeedDirty_1,agentStubMap,performArgs_1;opt.visualType&&opt.visualType!==stageHandler.visualType||(seriesTaskMap=(stageHandlerRecord=scheduler._stageTaskMap.get(stageHandler.uid)).seriesTaskMap,(stageHandlerRecord=stageHandlerRecord.overallTask)?((agentStubMap=stageHandlerRecord.agentStubMap).each(function(stub){needSetDirty(opt,stub)&&(stub.dirty(),overallNeedDirty_1=!0)}),overallNeedDirty_1&&stageHandlerRecord.dirty(),scheduler.updatePayload(stageHandlerRecord,payload),performArgs_1=scheduler.getPerformArgs(stageHandlerRecord,opt.block),agentStubMap.each(function(stub){stub.perform(performArgs_1)}),stageHandlerRecord.perform(performArgs_1)&&(unfinished=!0)):seriesTaskMap&&seriesTaskMap.each(function(task,pipelineId){needSetDirty(opt,task)&&task.dirty();var performArgs=scheduler.getPerformArgs(task,opt.block);performArgs.skip=!stageHandler.performRawSeries&&ecModel.isSeriesFiltered(task.context.model),scheduler.updatePayload(task,payload),task.perform(performArgs)&&(unfinished=!0)}))}),this.unfinished=unfinished||this.unfinished},Scheduler.prototype.performSeriesTasks=function(ecModel){var unfinished;ecModel.eachSeries(function(seriesModel){unfinished=seriesModel.dataTask.perform()||unfinished}),this.unfinished=unfinished||this.unfinished},Scheduler.prototype.plan=function(){this._pipelineMap.each(function(pipeline){var task=pipeline.tail;do{if(task.__block){pipeline.blockIndex=task.__idxInPipeline;break}}while(task=task.getUpstream())})},Scheduler.prototype.updatePayload=function(task,payload){"remain"!==payload&&(task.context.payload=payload)},Scheduler.prototype._createSeriesStageTask=function(stageHandler,stageHandlerRecord,ecModel,api){var scheduler=this,oldSeriesTaskMap=stageHandlerRecord.seriesTaskMap,newSeriesTaskMap=stageHandlerRecord.seriesTaskMap=createHashMap(),stageHandlerRecord=stageHandler.seriesType,getTargetSeries=stageHandler.getTargetSeries;function create(seriesModel){var pipelineId=seriesModel.uid,pipelineId=newSeriesTaskMap.set(pipelineId,oldSeriesTaskMap&&oldSeriesTaskMap.get(pipelineId)||createTask({plan:seriesTaskPlan,reset:seriesTaskReset,count:seriesTaskCount}));pipelineId.context={model:seriesModel,ecModel:ecModel,api:api,useClearVisual:stageHandler.isVisual&&!stageHandler.isLayout,plan:stageHandler.plan,reset:stageHandler.reset,scheduler:scheduler},scheduler._pipe(seriesModel,pipelineId)}stageHandler.createOnAllSeries?ecModel.eachRawSeries(create):stageHandlerRecord?ecModel.eachRawSeriesByType(stageHandlerRecord,create):getTargetSeries&&getTargetSeries(ecModel,api).each(create)},Scheduler.prototype._createOverallStageTask=function(stageHandler,stageHandlerRecord,ecModel,api){var scheduler=this,overallTask=stageHandlerRecord.overallTask=stageHandlerRecord.overallTask||createTask({reset:overallTaskReset}),oldAgentStubMap=(overallTask.context={ecModel:ecModel,api:api,overallReset:stageHandler.overallReset,scheduler:scheduler},overallTask.agentStubMap),newAgentStubMap=overallTask.agentStubMap=createHashMap(),stageHandlerRecord=stageHandler.seriesType,getTargetSeries=stageHandler.getTargetSeries,overallProgress=!0,shouldOverallTaskDirty=!1;function createStub(seriesModel){var pipelineId=seriesModel.uid,pipelineId=newAgentStubMap.set(pipelineId,oldAgentStubMap&&oldAgentStubMap.get(pipelineId)||(shouldOverallTaskDirty=!0,createTask({reset:stubReset,onDirty:stubOnDirty})));pipelineId.context={model:seriesModel,overallProgress:overallProgress},pipelineId.agent=overallTask,pipelineId.__block=overallProgress,scheduler._pipe(seriesModel,pipelineId)}assert(!stageHandler.createOnAllSeries,'"createOnAllSeries" do not supported for "overallReset", becuase it will block all streams.'),stageHandlerRecord?ecModel.eachRawSeriesByType(stageHandlerRecord,createStub):getTargetSeries?getTargetSeries(ecModel,api).each(createStub):(overallProgress=!1,each(ecModel.getSeries(),createStub)),shouldOverallTaskDirty&&overallTask.dirty()},Scheduler.prototype._pipe=function(seriesModel,task){seriesModel=seriesModel.uid,seriesModel=this._pipelineMap.get(seriesModel);seriesModel.head||(seriesModel.head=task),seriesModel.tail&&seriesModel.tail.pipe(task),(seriesModel.tail=task).__idxInPipeline=seriesModel.count++,task.__pipeline=seriesModel},Scheduler.wrapStageHandler=function(stageHandler,visualType){return(stageHandler=isFunction(stageHandler)?{overallReset:stageHandler,seriesType:function(legacyFunc){seriesType=null;try{legacyFunc(ecModelMock,apiMock)}catch(e){}return seriesType}(stageHandler)}:stageHandler).uid=getUID("stageHandler"),visualType&&(stageHandler.visualType=visualType),stageHandler},Scheduler}();function overallTaskReset(context){context.overallReset(context.ecModel,context.api,context.payload)}function stubReset(context){return context.overallProgress&&stubProgress}function stubProgress(){this.agent.dirty(),this.getDownstream().dirty()}function stubOnDirty(){this.agent&&this.agent.dirty()}function seriesTaskPlan(context){return context.plan?context.plan(context.model,context.ecModel,context.api,context.payload):null}function seriesTaskReset(context){context.useClearVisual&&context.data.clearAllVisual();context=context.resetDefines=normalizeToArray(context.reset(context.model,context.ecModel,context.api,context.payload));return 1<context.length?map(context,function(v,idx){return makeSeriesTaskProgress(idx)}):singleSeriesTaskProgress}var singleSeriesTaskProgress=makeSeriesTaskProgress(0);function makeSeriesTaskProgress(resetDefineIdx){return function(params,context){var data=context.data,resetDefine=context.resetDefines[resetDefineIdx];if(resetDefine&&resetDefine.dataEach)for(var i=params.start;i<params.end;i++)resetDefine.dataEach(data,i);else resetDefine&&resetDefine.progress&&resetDefine.progress(params,data)}}function seriesTaskCount(context){return context.data.count()}var seriesType,ecModelMock={},apiMock={};function mockMethods(target,Clz){for(var name_1 in Clz.prototype)target[name_1]=noop}mockMethods(ecModelMock,GlobalModel),mockMethods(apiMock,ExtensionAPI),ecModelMock.eachSeriesByType=ecModelMock.eachRawSeriesByType=function(type){seriesType=type},ecModelMock.eachComponent=function(cond){"series"===cond.mainType&&cond.subType&&(seriesType=cond.subType)};function axisCommon(){return{axisLine:{lineStyle:{color:"#B9B8CE"}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}}var target=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"],LineStyleMixin={color:target,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],target]},ITEM_STYLE_KEY_MAP=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],LINE_STYLE_KEY_MAP={darkMode:!0,color:ITEM_STYLE_KEY_MAP,backgroundColor:"#100C2A",axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:"#B9B8CE"}},textStyle:{color:"#B9B8CE"},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:"#B9B8CE"}},dataZoom:{borderColor:"#71708A",textStyle:{color:"#B9B8CE"},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:"#B9B8CE"}},timeline:{lineStyle:{color:"#B9B8CE"},label:{color:"#B9B8CE"},controlStyle:{color:"#B9B8CE",borderColor:"#B9B8CE"}},calendar:{itemStyle:{color:"#100C2A"},dayLabel:{color:"#B9B8CE"},monthLabel:{color:"#B9B8CE"},yearLabel:{color:"#B9B8CE"}},timeAxis:axisCommon(),logAxis:axisCommon(),valueAxis:axisCommon(),categoryAxis:axisCommon(),line:{symbol:"circle"},graph:{color:ITEM_STYLE_KEY_MAP},gauge:{title:{color:"#B9B8CE"},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:"#B9B8CE"},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}},ECEventProcessor=(LINE_STYLE_KEY_MAP.categoryAxis.splitLine.show=!1,function(){function ECEventProcessor(){}return ECEventProcessor.prototype.normalizeQuery=function(query){var condCptType,suffixes_1,dataKeys_1,cptQuery={},dataQuery={},otherQuery={};return isString(query)?(condCptType=parseClassType(query),cptQuery.mainType=condCptType.main||null,cptQuery.subType=condCptType.sub||null):(suffixes_1=["Index","Name","Id"],dataKeys_1={name:1,dataIndex:1,dataType:1},each(query,function(val,key){for(var reserved=!1,i=0;i<suffixes_1.length;i++){var propSuffix=suffixes_1[i],suffixPos=key.lastIndexOf(propSuffix);0<suffixPos&&suffixPos===key.length-propSuffix.length&&("data"!==(suffixPos=key.slice(0,suffixPos))&&(cptQuery.mainType=suffixPos,cptQuery[propSuffix.toLowerCase()]=val,reserved=!0))}dataKeys_1.hasOwnProperty(key)&&(dataQuery[key]=val,reserved=!0),reserved||(otherQuery[key]=val)})),{cptQuery:cptQuery,dataQuery:dataQuery,otherQuery:otherQuery}},ECEventProcessor.prototype.filter=function(eventType,query){var eventInfo=this.eventInfo;if(!eventInfo)return!0;var targetEl=eventInfo.targetEl,packedEvent=eventInfo.packedEvent,model=eventInfo.model,eventInfo=eventInfo.view;if(!model||!eventInfo)return!0;var cptQuery=query.cptQuery,dataQuery=query.dataQuery;return check(cptQuery,model,"mainType")&&check(cptQuery,model,"subType")&&check(cptQuery,model,"index","componentIndex")&&check(cptQuery,model,"name")&&check(cptQuery,model,"id")&&check(dataQuery,packedEvent,"name")&&check(dataQuery,packedEvent,"dataIndex")&&check(dataQuery,packedEvent,"dataType")&&(!eventInfo.filterForExposedEvent||eventInfo.filterForExposedEvent(eventType,query.otherQuery,targetEl,packedEvent));function check(query,host,prop,propOnHost){return null==query[prop]||host[propOnHost||prop]===query[prop]}},ECEventProcessor.prototype.afterTrigger=function(){this.eventInfo=null},ECEventProcessor}()),SYMBOL_PROPS_WITH_CB=["symbol","symbolSize","symbolRotate","symbolOffset"],SYMBOL_PROPS=SYMBOL_PROPS_WITH_CB.concat(["symbolKeepAspect"]),target={createOnAllSeries:!0,performRawSeries:!0,reset:function(seriesModel,ecModel){var data=seriesModel.getData();if(seriesModel.legendIcon&&data.setVisual("legendIcon",seriesModel.legendIcon),seriesModel.hasSymbolVisual){for(var symbolPropsCb,symbolOptions={},symbolOptionsCb={},hasCallback=!1,i=0;i<SYMBOL_PROPS_WITH_CB.length;i++){var symbolPropName=SYMBOL_PROPS_WITH_CB[i],val=seriesModel.get(symbolPropName);isFunction(val)?(hasCallback=!0,symbolOptionsCb[symbolPropName]=val):symbolOptions[symbolPropName]=val}if(symbolOptions.symbol=symbolOptions.symbol||seriesModel.defaultSymbol,data.setVisual(extend({legendIcon:seriesModel.legendIcon||symbolOptions.symbol,symbolKeepAspect:seriesModel.get("symbolKeepAspect")},symbolOptions)),!ecModel.isSeriesFiltered(seriesModel))return symbolPropsCb=keys(symbolOptionsCb),{dataEach:hasCallback?function(data,idx){for(var rawValue=seriesModel.getRawValue(idx),params=seriesModel.getDataParams(idx),i=0;i<symbolPropsCb.length;i++){var symbolPropName=symbolPropsCb[i];data.setItemVisual(idx,symbolPropName,symbolOptionsCb[symbolPropName](rawValue,params))}}:null}}}},ITEM_STYLE_KEY_MAP={createOnAllSeries:!0,performRawSeries:!0,reset:function(seriesModel,ecModel){if(seriesModel.hasSymbolVisual&&!ecModel.isSeriesFiltered(seriesModel))return{dataEach:seriesModel.getData().hasItemOption?function(data,idx){for(var itemModel=data.getItemModel(idx),i=0;i<SYMBOL_PROPS.length;i++){var symbolPropName=SYMBOL_PROPS[i],val=itemModel.getShallow(symbolPropName,!0);null!=val&&data.setItemVisual(idx,symbolPropName,val)}}:null}}};function handleSeriesLegacySelectEvents(type,eventPostfix,ecIns,ecModel,payload){var legacyEventName=type+eventPostfix;ecIns.isSilent(legacyEventName)||(deprecateLog("event "+legacyEventName+" is deprecated."),ecModel.eachComponent({mainType:"series",subType:"pie"},function(seriesModel){for(var data,dataIndex,seriesIndex=seriesModel.seriesIndex,selectedMap=seriesModel.option.selectedMap,selected=payload.selected,i=0;i<selected.length;i++)selected[i].seriesIndex===seriesIndex&&(dataIndex=queryDataIndex(data=seriesModel.getData(),payload.fromActionPayload),ecIns.trigger(legacyEventName,{type:legacyEventName,seriesId:seriesModel.id,name:isArray(dataIndex)?data.getName(dataIndex[0]):data.getName(dataIndex),selected:isString(selectedMap)?selectedMap:extend({},selectedMap)}))}))}function findEventDispatcher(target,det,returnFirstMatch){for(var found;target&&(!det(target)||(found=target,!returnFirstMatch));)target=target.__hostTarget||target.parent;return found}var wmUniqueIndex=Math.round(9*Math.random()),supportDefineProperty="function"==typeof Object.defineProperty,WeakMap=function(){function WeakMap(){this._id="__ec_inner_"+wmUniqueIndex++}return WeakMap.prototype.get=function(key){return this._guard(key)[this._id]},WeakMap.prototype.set=function(key,value){key=this._guard(key);return supportDefineProperty?Object.defineProperty(key,this._id,{value:value,enumerable:!1,configurable:!0}):key[this._id]=value,this},WeakMap.prototype.delete=function(key){return!!this.has(key)&&(delete this._guard(key)[this._id],!0)},WeakMap.prototype.has=function(key){return!!this._guard(key)[this._id]},WeakMap.prototype._guard=function(key){if(key!==Object(key))throw TypeError("Value of WeakMap is not a non-null object.");return key},WeakMap}(),Triangle=Path.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(path,shape){var cx=shape.cx,cy=shape.cy,width=shape.width/2,shape=shape.height/2;path.moveTo(cx,cy-shape),path.lineTo(cx+width,cy+shape),path.lineTo(cx-width,cy+shape),path.closePath()}}),Diamond=Path.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(path,shape){var cx=shape.cx,cy=shape.cy,width=shape.width/2,shape=shape.height/2;path.moveTo(cx,cy-shape),path.lineTo(cx+width,cy),path.lineTo(cx,cy+shape),path.lineTo(cx-width,cy),path.closePath()}}),Pin=Path.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(path,shape){var x=shape.x,y=shape.y,w=shape.width/5*3,shape=Math.max(w,shape.height),w=w/2,dy=w*w/(shape-w),shape=y-shape+w+dy,angle=Math.asin(dy/w),dx=Math.cos(angle)*w,tanX=Math.sin(angle),tanY=Math.cos(angle),cpLen=.6*w,cpLen2=.7*w;path.moveTo(x-dx,shape+dy),path.arc(x,shape,w,Math.PI-angle,2*Math.PI+angle),path.bezierCurveTo(x+dx-tanX*cpLen,shape+dy+tanY*cpLen,x,y-cpLen2,x,y),path.bezierCurveTo(x,y-cpLen2,x-dx+tanX*cpLen,shape+dy+tanY*cpLen,x-dx,shape+dy),path.closePath()}}),Arrow=Path.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(ctx,shape){var height=shape.height,width=shape.width,x=shape.x,shape=shape.y,width=width/3*2;ctx.moveTo(x,shape),ctx.lineTo(x+width,shape+height),ctx.lineTo(x,shape+height/4*3),ctx.lineTo(x-width,shape+height),ctx.lineTo(x,shape),ctx.closePath()}}),symbolShapeMakers={line:function(x,y,w,h,shape){shape.x1=x,shape.y1=y+h/2,shape.x2=x+w,shape.y2=y+h/2},rect:function(x,y,w,h,shape){shape.x=x,shape.y=y,shape.width=w,shape.height=h},roundRect:function(x,y,w,h,shape){shape.x=x,shape.y=y,shape.width=w,shape.height=h,shape.r=Math.min(w,h)/4},square:function(x,y,w,h,shape){w=Math.min(w,h);shape.x=x,shape.y=y,shape.width=w,shape.height=w},circle:function(x,y,w,h,shape){shape.cx=x+w/2,shape.cy=y+h/2,shape.r=Math.min(w,h)/2},diamond:function(x,y,w,h,shape){shape.cx=x+w/2,shape.cy=y+h/2,shape.width=w,shape.height=h},pin:function(x,y,w,h,shape){shape.x=x+w/2,shape.y=y+h/2,shape.width=w,shape.height=h},arrow:function(x,y,w,h,shape){shape.x=x+w/2,shape.y=y+h/2,shape.width=w,shape.height=h},triangle:function(x,y,w,h,shape){shape.cx=x+w/2,shape.cy=y+h/2,shape.width=w,shape.height=h}},symbolBuildProxies={},SymbolClz=(each({line:Line,rect:Rect,roundRect:Rect,square:Rect,circle:Circle,diamond:Diamond,pin:Pin,arrow:Arrow,triangle:Triangle},function(Ctor,name){symbolBuildProxies[name]=new Ctor}),Path.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(out,config,rect){var out=calculateTextPosition(out,config,rect),shape=this.shape;return shape&&"pin"===shape.symbolType&&"inside"===config.position&&(out.y=rect.y+.4*rect.height),out},buildPath:function(ctx,shape,inBundle){var proxySymbol,symbolType=shape.symbolType;"none"!==symbolType&&(proxySymbol=(proxySymbol=symbolBuildProxies[symbolType])||symbolBuildProxies[symbolType="rect"],symbolShapeMakers[symbolType](shape.x,shape.y,shape.width,shape.height,proxySymbol.shape),proxySymbol.buildPath(ctx,proxySymbol.shape,inBundle))}}));function symbolPathSetColor(color,innerColor){var symbolStyle;"image"!==this.type&&(symbolStyle=this.style,this.__isEmptyBrush?(symbolStyle.stroke=color,symbolStyle.fill=innerColor||"#fff",symbolStyle.lineWidth=2):"line"===this.shape.symbolType?symbolStyle.stroke=color:symbolStyle.fill=color,this.markRedraw())}function createSymbol(symbolType,x,y,w,h,color,keepAspect){var isEmpty=0===symbolType.indexOf("empty");return(keepAspect=0===(symbolType=isEmpty?symbolType.substr(5,1).toLowerCase()+symbolType.substr(6):symbolType).indexOf("image://")?makeImage(symbolType.slice(8),new BoundingRect(x,y,w,h),keepAspect?"center":"cover"):0===symbolType.indexOf("path://")?makePath(symbolType.slice(7),{},new BoundingRect(x,y,w,h),keepAspect?"center":"cover"):new SymbolClz({shape:{symbolType:symbolType,x:x,y:y,width:w,height:h}})).__isEmptyBrush=isEmpty,keepAspect.setColor=symbolPathSetColor,color&&keepAspect.setColor(color),keepAspect}function normalizeSymbolOffset(symbolOffset,symbolSize){if(null!=symbolOffset)return[parsePercent$1((symbolOffset=isArray(symbolOffset)?symbolOffset:[symbolOffset,symbolOffset])[0],symbolSize[0])||0,parsePercent$1(retrieve2(symbolOffset[1],symbolOffset[0]),symbolSize[1])||0]}function getCanvasGradient(ctx,obj,rect){for(var canvasGradient=("radial"===obj.type?function(ctx,obj,rect){var width=rect.width,height=rect.height,min=Math.min(width,height),x=null==obj.x?.5:obj.x,y=null==obj.y?.5:obj.y,r=null==obj.r?.5:obj.r;return obj.global||(x=x*width+rect.x,y=y*height+rect.y,r*=min),ctx.createRadialGradient(x,y,0,x,y,r)}:function(ctx,obj,rect){var x=null==obj.x?0:obj.x,x2=null==obj.x2?1:obj.x2,y=null==obj.y?0:obj.y,y2=null==obj.y2?0:obj.y2;return obj.global||(x=x*rect.width+rect.x,x2=x2*rect.width+rect.x,y=y*rect.height+rect.y,y2=y2*rect.height+rect.y),x=isNaN(x)?0:x,x2=isNaN(x2)?1:x2,y=isNaN(y)?0:y,y2=isNaN(y2)?0:y2,ctx.createLinearGradient(x,y,x2,y2)})(ctx,obj,rect),colorStops=obj.colorStops,i=0;i<colorStops.length;i++)canvasGradient.addColorStop(colorStops[i].offset,colorStops[i].color);return canvasGradient}function parseInt10(val){return parseInt(val,10)}function getSize(root,whIdx,opts){var wh=["width","height"][whIdx],cwh=["clientWidth","clientHeight"][whIdx],plt=["paddingLeft","paddingTop"][whIdx],whIdx=["paddingRight","paddingBottom"][whIdx];if(null!=opts[wh]&&"auto"!==opts[wh])return parseFloat(opts[wh]);opts=document.defaultView.getComputedStyle(root);return(root[cwh]||parseInt10(opts[wh])||parseInt10(root.style[wh]))-(parseInt10(opts[plt])||0)-(parseInt10(opts[whIdx])||0)|0}function getLineDash(el){var lineScale_1,style=el.style,lineWidth=style.lineDash&&0<style.lineWidth&&(lineType=style.lineDash,lineWidth=style.lineWidth,lineType&&"solid"!==lineType&&0<lineWidth?"dashed"===lineType?[4*lineWidth,2*lineWidth]:"dotted"===lineType?[lineWidth]:isNumber(lineType)?[lineType]:isArray(lineType)?lineType:null:null),lineType=style.lineDashOffset;return lineWidth&&(lineScale_1=style.strokeNoScale&&el.getLineScale?el.getLineScale():1)&&1!==lineScale_1&&(lineWidth=map(lineWidth,function(rawVal){return rawVal/lineScale_1}),lineType/=lineScale_1),[lineWidth,lineType]}var pathProxyForDraw=new PathProxy(!0);function styleHasStroke(style){var stroke=style.stroke;return!(null==stroke||"none"===stroke||!(0<style.lineWidth))}function isValidStrokeFillStyle(strokeOrFill){return"string"==typeof strokeOrFill&&"none"!==strokeOrFill}function styleHasFill(style){style=style.fill;return null!=style&&"none"!==style}function doFillPath(ctx,style){var originalGlobalAlpha;null!=style.fillOpacity&&1!==style.fillOpacity?(originalGlobalAlpha=ctx.globalAlpha,ctx.globalAlpha=style.fillOpacity*style.opacity,ctx.fill(),ctx.globalAlpha=originalGlobalAlpha):ctx.fill()}function doStrokePath(ctx,style){var originalGlobalAlpha;null!=style.strokeOpacity&&1!==style.strokeOpacity?(originalGlobalAlpha=ctx.globalAlpha,ctx.globalAlpha=style.strokeOpacity*style.opacity,ctx.stroke(),ctx.globalAlpha=originalGlobalAlpha):ctx.stroke()}function createCanvasPattern(ctx,pattern,el){var el=createOrUpdateImage(pattern.image,pattern.__image,el);if(isImageReady(el))return ctx=ctx.createPattern(el,pattern.repeat||"repeat"),"function"==typeof DOMMatrix&&ctx&&ctx.setTransform&&((el=new DOMMatrix).translateSelf(pattern.x||0,pattern.y||0),el.rotateSelf(0,0,(pattern.rotation||0)*RADIAN_TO_DEGREE),el.scaleSelf(pattern.scaleX||1,pattern.scaleY||1),ctx.setTransform(el)),ctx}var SHADOW_NUMBER_PROPS=["shadowBlur","shadowOffsetX","shadowOffsetY"],STROKE_PROPS=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function bindCommonProps(ctx,style,prevStyle,forceSetAll,scope){var opacity,styleChanged=!1;if(!forceSetAll&&style===(prevStyle=prevStyle||{}))return!1;!forceSetAll&&style.opacity===prevStyle.opacity||(flushPathDrawn(ctx,scope),styleChanged=!0,opacity=Math.max(Math.min(style.opacity,1),0),ctx.globalAlpha=isNaN(opacity)?DEFAULT_COMMON_STYLE.opacity:opacity),!forceSetAll&&style.blend===prevStyle.blend||(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),ctx.globalCompositeOperation=style.blend||DEFAULT_COMMON_STYLE.blend);for(var i=0;i<SHADOW_NUMBER_PROPS.length;i++){var propName=SHADOW_NUMBER_PROPS[i];!forceSetAll&&style[propName]===prevStyle[propName]||(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),ctx[propName]=ctx.dpr*(style[propName]||0))}return!forceSetAll&&style.shadowColor===prevStyle.shadowColor||(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),ctx.shadowColor=style.shadowColor||DEFAULT_COMMON_STYLE.shadowColor),styleChanged}function bindPathAndTextCommonStyle(ctx,el,prevEl,forceSetAll,scope){var style=getStyle(el,scope.inHover),prevStyle=forceSetAll?null:prevEl&&getStyle(prevEl,scope.inHover)||{};if(style!==prevStyle){var styleChanged=bindCommonProps(ctx,style,prevStyle,forceSetAll,scope);!forceSetAll&&style.fill===prevStyle.fill||(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),isValidStrokeFillStyle(style.fill)&&(ctx.fillStyle=style.fill)),!forceSetAll&&style.stroke===prevStyle.stroke||(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),isValidStrokeFillStyle(style.stroke)&&(ctx.strokeStyle=style.stroke)),!forceSetAll&&style.opacity===prevStyle.opacity||(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),ctx.globalAlpha=null==style.opacity?1:style.opacity),el.hasStroke()&&(prevEl=style.lineWidth/(style.strokeNoScale&&el.getLineScale?el.getLineScale():1),ctx.lineWidth!==prevEl&&(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),ctx.lineWidth=prevEl));for(var i=0;i<STROKE_PROPS.length;i++){var prop=STROKE_PROPS[i],propName=prop[0];!forceSetAll&&style[propName]===prevStyle[propName]||(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),ctx[propName]=style[propName]||prop[1])}}}function setContextTransform(ctx,el){var el=el.transform,dpr=ctx.dpr||1;el?ctx.setTransform(dpr*el[0],dpr*el[1],dpr*el[2],dpr*el[3],dpr*el[4],dpr*el[5]):ctx.setTransform(dpr,0,0,dpr,0,0)}var DRAW_TYPE_PATH=1,DRAW_TYPE_IMAGE=2,DRAW_TYPE_TEXT=3,DRAW_TYPE_INCREMENTAL=4;function flushPathDrawn(ctx,scope){scope.batchFill&&ctx.fill(),scope.batchStroke&&ctx.stroke(),scope.batchFill="",scope.batchStroke=""}function getStyle(el,inHover){return inHover&&el.__hoverStyle||el.style}function brushSingle(ctx,el){brush(ctx,el,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function brush(ctx,el,scope,isLast){var m=el.transform;if(!el.shouldBePainted(scope.viewWidth,scope.viewHeight,!1,!1))return el.__dirty&=~REDRAW_BIT,void(el.__isRendered=!1);var clipPaths=el.__clipPaths,prevElClipPaths=scope.prevElClipPaths,forceSetTransform=!1,forceSetStyle=!1;prevElClipPaths&&!function(clipPaths,prevClipPaths){if(clipPaths!==prevClipPaths&&(clipPaths||prevClipPaths)){if(!clipPaths||!prevClipPaths||clipPaths.length!==prevClipPaths.length)return 1;for(var i=0;i<clipPaths.length;i++)if(clipPaths[i]!==prevClipPaths[i])return 1}}(clipPaths,prevElClipPaths)||(prevElClipPaths&&prevElClipPaths.length&&(flushPathDrawn(ctx,scope),ctx.restore(),forceSetStyle=forceSetTransform=!0,scope.prevElClipPaths=null,scope.allClipped=!1,scope.prevEl=null),clipPaths&&clipPaths.length&&(flushPathDrawn(ctx,scope),ctx.save(),function(clipPaths,ctx,scope){for(var allClipped=!1,i=0;i<clipPaths.length;i++){var clipPath=clipPaths[i],allClipped=allClipped||clipPath.isZeroArea();setContextTransform(ctx,clipPath),ctx.beginPath(),clipPath.buildPath(ctx,clipPath.shape),ctx.clip()}scope.allClipped=allClipped}(clipPaths,ctx,scope),forceSetTransform=!0),scope.prevElClipPaths=clipPaths),scope.allClipped?el.__isRendered=!1:(el.beforeBrush&&el.beforeBrush(),el.innerBeforeBrush(),(prevElClipPaths=scope.prevEl)||(forceSetStyle=forceSetTransform=!0),clipPaths=el instanceof Path&&el.autoBatch&&function(style){var hasFill=styleHasFill(style),hasStroke=styleHasStroke(style);return!(style.lineDash||!(+hasFill^+hasStroke)||hasFill&&"string"!=typeof style.fill||hasStroke&&"string"!=typeof style.stroke||style.strokePercent<1||style.strokeOpacity<1||style.fillOpacity<1)}(el.style),forceSetTransform||(forceSetTransform=m,m=prevElClipPaths.transform,forceSetTransform&&m?forceSetTransform[0]!==m[0]||forceSetTransform[1]!==m[1]||forceSetTransform[2]!==m[2]||forceSetTransform[3]!==m[3]||forceSetTransform[4]!==m[4]||forceSetTransform[5]!==m[5]:forceSetTransform||m)?(flushPathDrawn(ctx,scope),setContextTransform(ctx,el)):clipPaths||flushPathDrawn(ctx,scope),forceSetTransform=getStyle(el,scope.inHover),el instanceof Path?(scope.lastDrawType!==DRAW_TYPE_PATH&&(forceSetStyle=!0,scope.lastDrawType=DRAW_TYPE_PATH),bindPathAndTextCommonStyle(ctx,el,prevElClipPaths,forceSetStyle,scope),clipPaths&&(scope.batchFill||scope.batchStroke)||ctx.beginPath(),function(ctx,el,style,inBatch){var fill,hasFillGradient,hasStrokeGradient,hasFillPattern,hasStrokePattern,fillGradient,strokeGradient,fillPattern,strokePattern,lineDash,lineDashOffset,hasStroke=styleHasStroke(style),hasFill=styleHasFill(style),strokePercent=style.strokePercent,strokePart=strokePercent<1,firstDraw=!el.path,path=(el.silent&&!strokePart||!firstDraw||el.createPathProxy(),el.path||pathProxyForDraw),dirtyFlag=el.__dirty,rect=(inBatch||(fill=style.fill,stroke=style.stroke,hasFillGradient=hasFill&&!!fill.colorStops,hasStrokeGradient=hasStroke&&!!stroke.colorStops,hasFillPattern=hasFill&&!!fill.image,hasStrokePattern=hasStroke&&!!stroke.image,rect=strokePattern=fillPattern=strokeGradient=fillGradient=void 0,(hasFillGradient||hasStrokeGradient)&&(rect=el.getBoundingRect()),hasFillGradient&&(fillGradient=dirtyFlag?getCanvasGradient(ctx,fill,rect):el.__canvasFillGradient,el.__canvasFillGradient=fillGradient),hasStrokeGradient&&(strokeGradient=dirtyFlag?getCanvasGradient(ctx,stroke,rect):el.__canvasStrokeGradient,el.__canvasStrokeGradient=strokeGradient),hasFillPattern&&(fillPattern=dirtyFlag||!el.__canvasFillPattern?createCanvasPattern(ctx,fill,el):el.__canvasFillPattern,el.__canvasFillPattern=fillPattern),hasStrokePattern&&(strokePattern=dirtyFlag||!el.__canvasStrokePattern?createCanvasPattern(ctx,stroke,el):el.__canvasStrokePattern,el.__canvasStrokePattern=fillPattern),hasFillGradient?ctx.fillStyle=fillGradient:hasFillPattern&&(fillPattern?ctx.fillStyle=fillPattern:hasFill=!1),hasStrokeGradient?ctx.strokeStyle=strokeGradient:hasStrokePattern&&(strokePattern?ctx.strokeStyle=strokePattern:hasStroke=!1)),el.getGlobalScale()),stroke=(path.setScale(rect[0],rect[1],el.segmentIgnoreThreshold),ctx.setLineDash&&style.lineDash&&(lineDash=(fill=getLineDash(el))[0],lineDashOffset=fill[1]),!0);(firstDraw||dirtyFlag&SHAPE_CHANGED_BIT)&&(path.setDPR(ctx.dpr),strokePart?path.setContext(null):(path.setContext(ctx),stroke=!1),path.reset(),el.buildPath(path,el.shape,inBatch),path.toStatic(),el.pathUpdated()),stroke&&path.rebuildPath(ctx,strokePart?strokePercent:1),lineDash&&(ctx.setLineDash(lineDash),ctx.lineDashOffset=lineDashOffset),inBatch||(style.strokeFirst?(hasStroke&&doStrokePath(ctx,style),hasFill&&doFillPath(ctx,style)):(hasFill&&doFillPath(ctx,style),hasStroke&&doStrokePath(ctx,style))),lineDash&&ctx.setLineDash([])}(ctx,el,forceSetTransform,clipPaths),clipPaths&&(scope.batchFill=forceSetTransform.fill||"",scope.batchStroke=forceSetTransform.stroke||"")):el instanceof TSpan?(scope.lastDrawType!==DRAW_TYPE_TEXT&&(forceSetStyle=!0,scope.lastDrawType=DRAW_TYPE_TEXT),bindPathAndTextCommonStyle(ctx,el,prevElClipPaths,forceSetStyle,scope),function(ctx,el,style){var lineDash,lineDashOffset,text=style.text;null!=text&&(text+=""),text&&(ctx.font=style.font||DEFAULT_FONT,ctx.textAlign=style.textAlign,ctx.textBaseline=style.textBaseline,lineDashOffset=lineDash=void 0,ctx.setLineDash&&style.lineDash&&(lineDash=(el=getLineDash(el))[0],lineDashOffset=el[1]),lineDash&&(ctx.setLineDash(lineDash),ctx.lineDashOffset=lineDashOffset),style.strokeFirst?(styleHasStroke(style)&&ctx.strokeText(text,style.x,style.y),styleHasFill(style)&&ctx.fillText(text,style.x,style.y)):(styleHasFill(style)&&ctx.fillText(text,style.x,style.y),styleHasStroke(style)&&ctx.strokeText(text,style.x,style.y)),lineDash&&ctx.setLineDash([]))}(ctx,el,forceSetTransform)):el instanceof ZRImage?(scope.lastDrawType!==DRAW_TYPE_IMAGE&&(forceSetStyle=!0,scope.lastDrawType=DRAW_TYPE_IMAGE),function(ctx,el,prevEl,forceSetAll,scope){bindCommonProps(ctx,getStyle(el,scope.inHover),prevEl&&getStyle(prevEl,scope.inHover),forceSetAll,scope)}(ctx,el,prevElClipPaths,forceSetStyle,scope),function(ctx,el,style){var x,y,width,aspect,sx,sy,image=el.__image=createOrUpdateImage(style.image,el.__image,el,el.onload);image&&isImageReady(image)&&(x=style.x||0,y=style.y||0,width=el.getWidth(),el=el.getHeight(),aspect=image.width/image.height,null==width&&null!=el?width=el*aspect:null==el&&null!=width?el=width/aspect:null==width&&null==el&&(width=image.width,el=image.height),style.sWidth&&style.sHeight?(sx=style.sx||0,sy=style.sy||0,ctx.drawImage(image,sx,sy,style.sWidth,style.sHeight,x,y,width,el)):style.sx&&style.sy?(sx=style.sx,sy=style.sy,ctx.drawImage(image,sx,sy,width-sx,el-sy,x,y,width,el)):ctx.drawImage(image,x,y,width,el))}(ctx,el,forceSetTransform)):el.getTemporalDisplayables&&(scope.lastDrawType!==DRAW_TYPE_INCREMENTAL&&(forceSetStyle=!0,scope.lastDrawType=DRAW_TYPE_INCREMENTAL),function(ctx,el,scope){var i,len,displayables=el.getDisplayables(),temporalDisplayables=el.getTemporalDisplayables(),innerScope=(ctx.save(),{prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:scope.viewWidth,viewHeight:scope.viewHeight,inHover:scope.inHover});for(i=el.getCursor(),len=displayables.length;i<len;i++)(displayable=displayables[i]).beforeBrush&&displayable.beforeBrush(),displayable.innerBeforeBrush(),brush(ctx,displayable,innerScope,i===len-1),displayable.innerAfterBrush(),displayable.afterBrush&&displayable.afterBrush(),innerScope.prevEl=displayable;for(var i_1=0,len_1=temporalDisplayables.length;i_1<len_1;i_1++){var displayable;(displayable=temporalDisplayables[i_1]).beforeBrush&&displayable.beforeBrush(),displayable.innerBeforeBrush(),brush(ctx,displayable,innerScope,i_1===len_1-1),displayable.innerAfterBrush(),displayable.afterBrush&&displayable.afterBrush(),innerScope.prevEl=displayable}el.clearTemporalDisplayables(),el.notClear=!0,ctx.restore()}(ctx,el,scope)),clipPaths&&isLast&&flushPathDrawn(ctx,scope),el.innerAfterBrush(),el.afterBrush&&el.afterBrush(),(scope.prevEl=el).__dirty=0,el.__isRendered=!0)}var decalMap=new WeakMap,decalCache=new LRU(100),decalKeys=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function createOrUpdatePatternFromDecal(decalObject,api){if("none"===decalObject)return null;var dpr=api.getDevicePixelRatio(),zr=api.getZr(),isSVG="svg"===zr.painter.type,api=(decalObject.dirty&&decalMap.delete(decalObject),decalMap.get(decalObject));if(api)return api;var decalOpt=defaults(decalObject,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512}),api=("none"===decalOpt.backgroundColor&&(decalOpt.backgroundColor=null),{repeat:"repeat"});return function(pattern){for(var cacheKey,keys$$1=[dpr],isValidKey=!0,i=0;i<decalKeys.length;++i){var value=decalOpt[decalKeys[i]];if(null!=value&&!isArray(value)&&!isString(value)&&!isNumber(value)&&"boolean"!=typeof value){isValidKey=!1;break}keys$$1.push(value)}{var cache;isValidKey&&(cacheKey=keys$$1.join(",")+(isSVG?"-svg":""),(cache=decalCache.get(cacheKey))&&(isSVG?pattern.svgElement=cache:pattern.image=cache))}var ctx,dashArrayX=function normalizeDashArrayX(dash){if(!dash||0===dash.length)return[[0,0]];if(isNumber(dash))return[[dashValue=Math.ceil(dash),dashValue]];var isAllNumber=!0;for(var i=0;i<dash.length;++i)if(!isNumber(dash[i])){isAllNumber=!1;break}if(isAllNumber)return normalizeDashArrayX([dash]);var result=[];for(i=0;i<dash.length;++i){var dashValue;isNumber(dash[i])?(dashValue=Math.ceil(dash[i]),result.push([dashValue,dashValue])):(dashValue=map(dash[i],function(n){return Math.ceil(n)})).length%2==1?result.push(dashValue.concat(dashValue)):result.push(dashValue)}return result}(decalOpt.dashArrayX),dashArrayY=function(dash){if(!dash||"object"==typeof dash&&0===dash.length)return[0,0];if(isNumber(dash))return[dashValue_1=Math.ceil(dash),dashValue_1];var dashValue_1=map(dash,function(n){return Math.ceil(n)});return dash.length%2?dashValue_1.concat(dashValue_1):dashValue_1}(decalOpt.dashArrayY),symbolArray=function normalizeSymbolArray(symbol){if(!symbol||0===symbol.length)return[["rect"]];if(isString(symbol))return[[symbol]];var isAllString=!0;for(var i=0;i<symbol.length;++i)if(!isString(symbol[i])){isAllString=!1;break}if(isAllString)return normalizeSymbolArray([symbol]);var result=[];for(i=0;i<symbol.length;++i)isString(symbol[i])?result.push([symbol[i]]):result.push(symbol[i]);return result}(decalOpt.symbol),lineBlockLengthsX=function(dash){return map(dash,getLineBlockLengthY)}(dashArrayX),lineBlockLengthY=getLineBlockLengthY(dashArrayY),canvas=!isSVG&&platformApi.createCanvas(),svgRoot=isSVG&&{tag:"g",attrs:{},key:"dcl",children:[]},pSize=function(){for(var width=1,i=0,xlen=lineBlockLengthsX.length;i<xlen;++i)width=getLeastCommonMultiple(width,lineBlockLengthsX[i]);for(var symbolRepeats=1,i=0,xlen=symbolArray.length;i<xlen;++i)symbolRepeats=getLeastCommonMultiple(symbolRepeats,symbolArray[i].length);width*=symbolRepeats;function warn(attrName){console.warn("Calculated decal size is greater than "+attrName+" due to decal option settings so "+attrName+" is used for the decal size. Please consider changing the decal option to make a smaller decal or set "+attrName+" to be larger to avoid incontinuity.")}var height=lineBlockLengthY*lineBlockLengthsX.length*symbolArray.length;width>decalOpt.maxTileWidth&&warn("maxTileWidth");height>decalOpt.maxTileHeight&&warn("maxTileHeight");return{width:Math.max(1,Math.min(width,decalOpt.maxTileWidth)),height:Math.max(1,Math.min(height,decalOpt.maxTileHeight))}}();canvas&&(canvas.width=pSize.width*dpr,canvas.height=pSize.height*dpr,ctx=canvas.getContext("2d"));(function(){ctx&&(ctx.clearRect(0,0,canvas.width,canvas.height),decalOpt.backgroundColor&&(ctx.fillStyle=decalOpt.backgroundColor,ctx.fillRect(0,0,canvas.width,canvas.height)));for(var ySum=0,i=0;i<dashArrayY.length;++i)ySum+=dashArrayY[i];if(!(ySum<=0))for(var y=-lineBlockLengthY,yId=0,yIdTotal=0,xId0=0;y<pSize.height;){if(yId%2==0){for(var symbolYId=yIdTotal/2%symbolArray.length,x=0,xId1=0,xId1Total=0;x<2*pSize.width;){for(var left,size,width,height,symbolXId,xSum=0,i=0;i<dashArrayX[xId0].length;++i)xSum+=dashArrayX[xId0][i];if(xSum<=0)break;xId1%2==0&&(size=.5*(1-decalOpt.symbolSize),left=x+dashArrayX[xId0][xId1]*size,size=y+dashArrayY[yId]*size,width=dashArrayX[xId0][xId1]*decalOpt.symbolSize,height=dashArrayY[yId]*decalOpt.symbolSize,symbolXId=xId1Total/2%symbolArray[symbolYId].length,function(x,y,width,height,symbolType){var scale=isSVG?1:dpr,symbolType=createSymbol(symbolType,x*scale,y*scale,width*scale,height*scale,decalOpt.color,decalOpt.symbolKeepAspect);isSVG?(x=zr.painter.renderOneToVNode(symbolType))&&svgRoot.children.push(x):brushSingle(ctx,symbolType)}(left,size,width,height,symbolArray[symbolYId][symbolXId])),x+=dashArrayX[xId0][xId1],++xId1Total,++xId1===dashArrayX[xId0].length&&(xId1=0)}++xId0===dashArrayX.length&&(xId0=0)}y+=dashArrayY[yId],++yIdTotal,++yId===dashArrayY.length&&(yId=0)}})(),isValidKey&&decalCache.put(cacheKey,canvas||svgRoot);pattern.image=canvas,pattern.svgElement=svgRoot,pattern.svgWidth=pSize.width,pattern.svgHeight=pSize.height}(api),api.rotation=decalOpt.rotation,api.scaleX=api.scaleY=isSVG?1:1/dpr,decalMap.set(decalObject,api),decalObject.dirty=!1,api}function getLineBlockLengthY(dash){for(var blockLength=0,i=0;i<dash.length;++i)blockLength+=dash[i];return dash.length%2==1?2*blockLength:blockLength}var lifecycle=new Eventful,implsStore={};function getImpl(name){return implsStore[name]||error("Implementation of "+name+" doesn't exists."),implsStore[name]}var hasWindow="undefined"!=typeof window,Diamond={PROCESSOR:{FILTER:1e3,SERIES_FILTER:800,STATISTIC:5e3},VISUAL:{LAYOUT:1e3,PROGRESSIVE_LAYOUT:1100,GLOBAL:2e3,CHART:3e3,POST_CHART_LAYOUT:4600,COMPONENT:4e3,BRUSH:5e3,CHART_ITEM:4500,ARIA:6e3,DECAL:7e3}},ACTION_REG=/^[a-zA-Z0-9_]+$/;function createRegisterEventWithLowercaseECharts(method){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];if(!this.isDisposed())return toLowercaseNameAndCallEventful(this,method,args);disposedWarning(this.id)}}function createRegisterEventWithLowercaseMessageCenter(method){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return toLowercaseNameAndCallEventful(this,method,args)}}function toLowercaseNameAndCallEventful(host,method,args){return args[0]=args[0]&&args[0].toLowerCase(),Eventful.prototype[method].apply(host,args)}var prepare,prepareView,updateDirectly,updateMethods,doConvertPixel,updateStreamModes,doDispatchAction,flushPendingActions,triggerUpdatedEvent,bindRenderedEvent,bindMouseEvent,render,renderComponents,renderSeries,createExtensionAPI,enableConnect,markStatusToUpdate,applyChangedStates,MessageCenter=function(_super){function MessageCenter(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(MessageCenter,_super),MessageCenter}(Eventful),Pin=MessageCenter.prototype,ECharts=(Pin.on=createRegisterEventWithLowercaseMessageCenter("on"),Pin.off=createRegisterEventWithLowercaseMessageCenter("off"),function(_super){function ECharts(dom,theme$$1,opts){var _this=_super.call(this,new ECEventProcessor)||this,defaultRenderer=(_this._chartsViews=[],_this._chartsMap={},_this._componentsViews=[],_this._componentsMap={},_this._pendingActions=[],opts=opts||{},isString(theme$$1)&&(theme$$1=themeStorage[theme$$1]),_this._dom=dom,"canvas"),defaultUseDirtyRect=!1,root=hasWindow?window:global,defaultRenderer=root.__ECHARTS__DEFAULT__RENDERER__||defaultRenderer,root=root.__ECHARTS__DEFAULT__USE_DIRTY_RECT__,defaultUseDirtyRect=null==root?defaultUseDirtyRect:root,root=_this._zr=init$1(dom,{renderer:opts.renderer||defaultRenderer,devicePixelRatio:opts.devicePixelRatio,width:opts.width,height:opts.height,ssr:opts.ssr,useDirtyRect:null==opts.useDirtyRect?defaultUseDirtyRect:opts.useDirtyRect}),defaultUseDirtyRect=(_this._ssr=opts.ssr,_this._throttledZrFlush=throttle(bind(root.flush,root),17),(theme$$1=clone(theme$$1))&&globalBackwardCompat(theme$$1,!0),_this._theme=theme$$1,_this._locale=isString(dom=opts.locale||SYSTEM_LANG)?(defaultRenderer=localeStorage[dom.toUpperCase()]||{},dom===LOCALE_ZH||dom===LOCALE_EN?clone(defaultRenderer):merge(clone(defaultRenderer),clone(localeStorage[DEFAULT_LOCALE]),!1)):merge(clone(dom),clone(localeStorage[DEFAULT_LOCALE]),!1),_this._coordSysMgr=new CoordinateSystemManager,_this._api=createExtensionAPI(_this));function prioritySortFunc(a,b){return a.__prio-b.__prio}return sort(visualFuncs,prioritySortFunc),sort(dataProcessorFuncs,prioritySortFunc),_this._scheduler=new Scheduler(_this,defaultUseDirtyRect,dataProcessorFuncs,visualFuncs),_this._messageCenter=new MessageCenter,_this._initEvents(),_this.resize=bind(_this.resize,_this),root.animation.on("frame",_this._onframe,_this),bindRenderedEvent(root,_this),bindMouseEvent(root,_this),setAsPrimitive(_this),_this}function clearColorPalette(ecModel){ecModel.clearColorPalette(),ecModel.eachSeries(function(seriesModel){seriesModel.clearColorPalette()})}function applyElementStates(el){for(var newStates=[],oldStates=el.currentStates,i=0;i<oldStates.length;i++){var stateName=oldStates[i];"emphasis"!==stateName&&"blur"!==stateName&&"select"!==stateName&&newStates.push(stateName)}el.selected&&el.states.select&&newStates.push("select"),el.hoverState===HOVER_STATE_EMPHASIS&&el.states.emphasis?newStates.push("emphasis"):el.hoverState===HOVER_STATE_BLUR&&el.states.blur&&newStates.push("blur"),el.useStates(newStates)}function updateZ(model,view){var z,zlevel;model.preventAutoZ||(z=model.get("z")||0,zlevel=model.get("zlevel")||0,view.eachRendered(function(el){return function doUpdateZ(el,z,zlevel,maxZ2){var label=el.getTextContent();var labelLine=el.getTextGuideLine();var isGroup=el.isGroup;if(isGroup)for(var children=el.childrenRef(),i=0;i<children.length;i++)maxZ2=Math.max(doUpdateZ(children[i],z,zlevel,maxZ2),maxZ2);else el.z=z,el.zlevel=zlevel,maxZ2=Math.max(el.z2,maxZ2);label&&(label.z=z,label.zlevel=zlevel,isFinite(maxZ2)&&(label.z2=maxZ2+2));labelLine&&(isGroup=el.textGuideLineConfig,labelLine.z=z,labelLine.zlevel=zlevel,isFinite(maxZ2)&&(labelLine.z2=maxZ2+(isGroup&&isGroup.showAbove?1:-1)));return maxZ2}(el,z,zlevel,-1/0),!0}))}function clearStates$$1(model,view){view.eachRendered(function(el){var textContent,textGuide;isElementRemoved(el)||(textContent=el.getTextContent(),textGuide=el.getTextGuideLine(),el.stateTransition&&(el.stateTransition=null),textContent&&textContent.stateTransition&&(textContent.stateTransition=null),textGuide&&textGuide.stateTransition&&(textGuide.stateTransition=null),el.hasState()?(el.prevStates=el.currentStates,el.clearStates()):el.prevStates&&(el.prevStates=null))})}function updateStates(model,view){var stateAnimationModel=model.getModel("stateAnimation"),enableAnimation=model.isAnimationEnabled(),model=stateAnimationModel.get("duration"),stateTransition=0<model?{duration:model,delay:stateAnimationModel.get("delay"),easing:stateAnimationModel.get("easing")}:null;view.eachRendered(function(el){var prevStates,textGuide;el.states&&el.states.emphasis&&(isElementRemoved(el)||(el instanceof Path&&function(el){var store=getSavedStates(el),el=(store.normalFill=el.style.fill,store.normalStroke=el.style.stroke,el.states.select||{});store.selectFill=el.style&&el.style.fill||null,store.selectStroke=el.style&&el.style.stroke||null}(el),el.__dirty&&(prevStates=el.prevStates)&&el.useStates(prevStates),enableAnimation&&(el.stateTransition=stateTransition,prevStates=el.getTextContent(),textGuide=el.getTextGuideLine(),prevStates&&(prevStates.stateTransition=stateTransition),textGuide&&(textGuide.stateTransition=stateTransition)),el.__dirty&&applyElementStates(el)))})}return __extends(ECharts,_super),ECharts.prototype._onframe=function(){if(!this._disposed){applyChangedStates(this);var scheduler=this._scheduler;if(this.__pendingUpdate){var silent=this.__pendingUpdate.silent;this.__flagInMainProcess=!0;try{prepare(this),updateMethods.update.call(this,null,this.__pendingUpdate.updateParams)}catch(e){throw this.__flagInMainProcess=!1,this.__pendingUpdate=null,e}this._zr.flush(),this.__flagInMainProcess=!1,this.__pendingUpdate=null,flushPendingActions.call(this,silent),triggerUpdatedEvent.call(this,silent)}else if(scheduler.unfinished){var remainTime=1,ecModel=this._model,api=this._api;scheduler.unfinished=!1;do{var startTime=+new Date}while(scheduler.performSeriesTasks(ecModel),scheduler.performDataProcessorTasks(ecModel),updateStreamModes(this,ecModel),scheduler.performVisualTasks(ecModel),renderSeries(this,this._model,api,"remain",{}),0<(remainTime-=+new Date-startTime)&&scheduler.unfinished);scheduler.unfinished||this._zr.flush()}}},ECharts.prototype.getDom=function(){return this._dom},ECharts.prototype.getId=function(){return this.id},ECharts.prototype.getZr=function(){return this._zr},ECharts.prototype.isSSR=function(){return this._ssr},ECharts.prototype.setOption=function(option,notMerge,lazyUpdate){if(this.__flagInMainProcess)error("`setOption` should not be called during main process.");else if(this._disposed)disposedWarning(this.id);else{isObject(notMerge)&&(lazyUpdate=notMerge.lazyUpdate,silent=notMerge.silent,replaceMerge=notMerge.replaceMerge,transitionOpt=notMerge.transition,notMerge=notMerge.notMerge),this.__flagInMainProcess=!0,this._model&&!notMerge||(notMerge=new OptionManager(this._api),theme$$1=this._theme,(ecModel=this._model=new GlobalModel).scheduler=this._scheduler,ecModel.ssr=this._ssr,ecModel.init(null,null,null,theme$$1,this._locale,notMerge)),this._model.setOption(option,{replaceMerge:replaceMerge},optionPreprocessorFuncs);var silent,replaceMerge,transitionOpt,theme$$1,ecModel={seriesTransition:transitionOpt,optionChanged:!0};if(lazyUpdate)this.__pendingUpdate={silent:silent,updateParams:ecModel},this.__flagInMainProcess=!1,this.getZr().wakeUp();else{try{prepare(this),updateMethods.update.call(this,null,ecModel)}catch(e){throw this.__pendingUpdate=null,this.__flagInMainProcess=!1,e}this._ssr||this._zr.flush(),this.__pendingUpdate=null,this.__flagInMainProcess=!1,flushPendingActions.call(this,silent),triggerUpdatedEvent.call(this,silent)}}},ECharts.prototype.setTheme=function(){deprecateLog("ECharts#setTheme() is DEPRECATED in ECharts 3.0")},ECharts.prototype.getModel=function(){return this._model},ECharts.prototype.getOption=function(){return this._model&&this._model.getOption()},ECharts.prototype.getWidth=function(){return this._zr.getWidth()},ECharts.prototype.getHeight=function(){return this._zr.getHeight()},ECharts.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||hasWindow&&window.devicePixelRatio||1},ECharts.prototype.getRenderedCanvas=function(opts){return deprecateReplaceLog("getRenderedCanvas","renderToCanvas"),this.renderToCanvas(opts)},ECharts.prototype.renderToCanvas=function(opts){opts=opts||{};var painter=this._zr.painter;if("canvas"!==painter.type)throw new Error("renderToCanvas can only be used in the canvas renderer.");return painter.getRenderedCanvas({backgroundColor:opts.backgroundColor||this._model.get("backgroundColor"),pixelRatio:opts.pixelRatio||this.getDevicePixelRatio()})},ECharts.prototype.renderToSVGString=function(opts){opts=opts||{};var painter=this._zr.painter;if("svg"!==painter.type)throw new Error("renderToSVGString can only be used in the svg renderer.");return painter.renderToString({useViewBox:opts.useViewBox})},ECharts.prototype.getSvgDataURL=function(){var zr;if(env.svgSupported)return zr=this._zr,each(zr.storage.getDisplayList(),function(el){el.stopAnimation(null,!0)}),zr.painter.toDataURL()},ECharts.prototype.getDataURL=function(opts){var ecModel,excludesComponentViews,self,excludeComponents;{if(!this._disposed)return excludeComponents=(opts=opts||{}).excludeComponents,ecModel=this._model,excludesComponentViews=[],self=this,each(excludeComponents,function(componentType){ecModel.eachComponent({mainType:componentType},function(component){component=self._componentsMap[component.__viewId];component.group.ignore||(excludesComponentViews.push(component),component.group.ignore=!0)})}),excludeComponents="svg"===this._zr.painter.getType()?this.getSvgDataURL():this.renderToCanvas(opts).toDataURL("image/"+(opts&&opts.type||"png")),each(excludesComponentViews,function(view){view.group.ignore=!1}),excludeComponents;disposedWarning(this.id)}},ECharts.prototype.getConnectedDataURL=function(opts){var isSvg,groupId,mathMin,mathMax,left_1,top_1,right_1,bottom_1,canvasList_1,dpr_1,width,height,targetCanvas,zr_1,content_1;{if(!this._disposed)return isSvg="svg"===opts.type,groupId=this.group,mathMin=Math.min,mathMax=Math.max,connectedGroups[groupId]?(top_1=left_1=1/0,bottom_1=right_1=-1/0,canvasList_1=[],dpr_1=opts&&opts.pixelRatio||this.getDevicePixelRatio(),each(instances,function(chart,id){var canvas;chart.group===groupId&&(canvas=isSvg?chart.getZr().painter.getSvgDom().innerHTML:chart.renderToCanvas(clone(opts)),chart=chart.getDom().getBoundingClientRect(),left_1=mathMin(chart.left,left_1),top_1=mathMin(chart.top,top_1),right_1=mathMax(chart.right,right_1),bottom_1=mathMax(chart.bottom,bottom_1),canvasList_1.push({dom:canvas,left:chart.left,top:chart.top}))}),width=(right_1*=dpr_1)-(left_1*=dpr_1),height=(bottom_1*=dpr_1)-(top_1*=dpr_1),targetCanvas=platformApi.createCanvas(),(zr_1=init$1(targetCanvas,{renderer:isSvg?"svg":"canvas"})).resize({width:width,height:height}),isSvg?(content_1="",each(canvasList_1,function(item){var x=item.left-left_1,y=item.top-top_1;content_1+='<g transform="translate('+x+","+y+')">'+item.dom+"</g>"}),zr_1.painter.getSvgRoot().innerHTML=content_1,opts.connectedBackgroundColor&&zr_1.painter.setBackgroundColor(opts.connectedBackgroundColor),zr_1.refreshImmediately(),zr_1.painter.toDataURL()):(opts.connectedBackgroundColor&&zr_1.add(new Rect({shape:{x:0,y:0,width:width,height:height},style:{fill:opts.connectedBackgroundColor}})),each(canvasList_1,function(item){item=new ZRImage({style:{x:item.left*dpr_1-left_1,y:item.top*dpr_1-top_1,image:item.dom}});zr_1.add(item)}),zr_1.refreshImmediately(),targetCanvas.toDataURL("image/"+(opts&&opts.type||"png")))):this.getDataURL(opts);disposedWarning(this.id)}},ECharts.prototype.convertToPixel=function(finder,value){return doConvertPixel(this,"convertToPixel",finder,value)},ECharts.prototype.convertFromPixel=function(finder,value){return doConvertPixel(this,"convertFromPixel",finder,value)},ECharts.prototype.containPixel=function(finder,value){var result;{if(!this._disposed)return each(parseFinder(this._model,finder),function(models,key){0<=key.indexOf("Models")&&each(models,function(model){var coordSys=model.coordinateSystem;coordSys&&coordSys.containPoint?result=result||!!coordSys.containPoint(value):"seriesModels"===key?(coordSys=this._chartsMap[model.__viewId])&&coordSys.containPoint?result=result||coordSys.containPoint(value,model):console.warn(key+": "+(coordSys?"The found component do not support containPoint.":"No view mapping to the found component.")):console.warn(key+": containPoint is not supported")},this)},this),!!result;disposedWarning(this.id)}},ECharts.prototype.getVisual=function(finder,visualType){var finder=parseFinder(this._model,finder,{defaultMainType:"series"}),seriesModel=finder.seriesModel,seriesModel=(seriesModel||console.warn("There is no specified seires model"),seriesModel.getData()),finder=finder.hasOwnProperty("dataIndexInside")?finder.dataIndexInside:finder.hasOwnProperty("dataIndex")?seriesModel.indexOfRawIndex(finder.dataIndex):null;return null!=finder?function(data,dataIndex,key){switch(key){case"color":return data.getItemVisual(dataIndex,"style")[data.getVisual("drawType")];case"opacity":return data.getItemVisual(dataIndex,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return data.getItemVisual(dataIndex,key);default:console.warn("Unknown visual type "+key)}}(seriesModel,finder,visualType):function(data,key){switch(key){case"color":return data.getVisual("style")[data.getVisual("drawType")];case"opacity":return data.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return data.getVisual(key);default:console.warn("Unknown visual type "+key)}}(seriesModel,visualType)},ECharts.prototype.getViewOfComponentModel=function(componentModel){return this._componentsMap[componentModel.__viewId]},ECharts.prototype.getViewOfSeriesModel=function(seriesModel){return this._chartsMap[seriesModel.__viewId]},ECharts.prototype._initEvents=function(){var messageCenter,ecIns,api,_this=this;each(MOUSE_EVENT_NAMES,function(eveName){function handler(e){var params,componentType,componentIndex,ecModel=_this.getModel(),el=e.target,isGlobalOut="globalout"===eveName;isGlobalOut?params={}:el&&findEventDispatcher(el,function(parent){var dataModel,parent=getECData(parent);return parent&&null!=parent.dataIndex?(dataModel=parent.dataModel||ecModel.getSeriesByIndex(parent.seriesIndex),params=dataModel&&dataModel.getDataParams(parent.dataIndex,parent.dataType)||{},1):parent.eventData&&(params=extend({},parent.eventData),1)},!0),params&&(componentType=params.componentType,componentIndex=params.componentIndex,"markLine"!==componentType&&"markPoint"!==componentType&&"markArea"!==componentType||(componentType="series",componentIndex=params.seriesIndex),componentIndex=(componentType=componentType&&null!=componentIndex&&ecModel.getComponent(componentType,componentIndex))&&_this["series"===componentType.mainType?"_chartsMap":"_componentsMap"][componentType.__viewId],isGlobalOut||componentType&&componentIndex||console.warn("model or view can not be found by params"),params.event=e,params.type=eveName,_this._$eventProcessor.eventInfo={targetEl:el,packedEvent:params,model:componentType,view:componentIndex},_this.trigger(eveName,params))}handler.zrEventfulCallAtLast=!0,_this._zr.on(eveName,handler,_this)}),each(eventActionMap,function(actionType,eventType){_this._messageCenter.on(eventType,function(event){this.trigger(eventType,event)},_this)}),each(["selectchanged"],function(eventType){_this._messageCenter.on(eventType,function(event){this.trigger(eventType,event)},_this)}),messageCenter=this._messageCenter,api=(ecIns=this)._api,messageCenter.on("selectchanged",function(params){var ecModel=api.getModel();params.isFromClick?(handleSeriesLegacySelectEvents("map","selectchanged",ecIns,ecModel,params),handleSeriesLegacySelectEvents("pie","selectchanged",ecIns,ecModel,params)):"select"===params.fromAction?(handleSeriesLegacySelectEvents("map","selected",ecIns,ecModel,params),handleSeriesLegacySelectEvents("pie","selected",ecIns,ecModel,params)):"unselect"===params.fromAction&&(handleSeriesLegacySelectEvents("map","unselected",ecIns,ecModel,params),handleSeriesLegacySelectEvents("pie","unselected",ecIns,ecModel,params))})},ECharts.prototype.isDisposed=function(){return this._disposed},ECharts.prototype.clear=function(){this._disposed?disposedWarning(this.id):this.setOption({series:[]},!0)},ECharts.prototype.dispose=function(){var api,ecModel;this._disposed?disposedWarning(this.id):(this._disposed=!0,this.getDom()&&setAttribute(this.getDom(),DOM_ATTRIBUTE_KEY,""),api=this._api,ecModel=this._model,each(this._componentsViews,function(component){component.dispose(ecModel,api)}),each(this._chartsViews,function(chart){chart.dispose(ecModel,api)}),this._zr.dispose(),this._dom=this._model=this._chartsMap=this._componentsMap=this._chartsViews=this._componentsViews=this._scheduler=this._api=this._zr=this._throttledZrFlush=this._theme=this._coordSysMgr=this._messageCenter=null,delete instances[this.id])},ECharts.prototype.resize=function(opts){if(this.__flagInMainProcess)error("`resize` should not be called during main process.");else if(this._disposed)disposedWarning(this.id);else{this._zr.resize(opts);var ecModel=this._model;if(this._loadingFX&&this._loadingFX.resize(),ecModel){var ecModel=ecModel.resetOption("media"),silent=opts&&opts.silent;this.__pendingUpdate&&(null==silent&&(silent=this.__pendingUpdate.silent),ecModel=!0,this.__pendingUpdate=null),this.__flagInMainProcess=!0;try{ecModel&&prepare(this),updateMethods.update.call(this,{type:"resize",animation:extend({duration:0},opts&&opts.animation)})}catch(e){throw this.__flagInMainProcess=!1,e}this.__flagInMainProcess=!1,flushPendingActions.call(this,silent),triggerUpdatedEvent.call(this,silent)}}},ECharts.prototype.showLoading=function(name,cfg){var zr;this._disposed?disposedWarning(this.id):(isObject(name)&&(cfg=name,name=""),name=name||"default",this.hideLoading(),loadingEffects[name]?(cfg=loadingEffects[name](this._api,cfg),zr=this._zr,this._loadingFX=cfg,zr.add(cfg)):console.warn("Loading effects "+name+" not exists."))},ECharts.prototype.hideLoading=function(){this._disposed?disposedWarning(this.id):(this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null)},ECharts.prototype.makeActionFromEvent=function(eventObj){var payload=extend({},eventObj);return payload.type=eventActionMap[eventObj.type],payload},ECharts.prototype.dispatchAction=function(payload,opt){var silent;this._disposed?disposedWarning(this.id):(isObject(opt)||(opt={silent:!!opt}),actions[payload.type]&&this._model&&(this.__flagInMainProcess?this._pendingActions.push(payload):(silent=opt.silent,doDispatchAction.call(this,payload,silent),(payload=opt.flush)?this._zr.flush():!1!==payload&&env.browser.weChat&&this._throttledZrFlush(),flushPendingActions.call(this,silent),triggerUpdatedEvent.call(this,silent))))},ECharts.prototype.updateLabelLayout=function(){lifecycle.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},ECharts.prototype.appendData=function(params){var seriesIndex;this._disposed?disposedWarning(this.id):(seriesIndex=params.seriesIndex,seriesIndex=this.getModel().getSeriesByIndex(seriesIndex),assert(params.data&&seriesIndex),seriesIndex.appendData(params),this._scheduler.unfinished=!0,this.getZr().wakeUp())},ECharts.internalField=(prepare=function(ecIns){var scheduler=ecIns._scheduler;scheduler.restorePipelines(ecIns._model),scheduler.prepareStageTasks(),prepareView(ecIns,!0),prepareView(ecIns,!1),scheduler.plan()},prepareView=function(ecIns,isComponent){for(var ecModel=ecIns._model,scheduler=ecIns._scheduler,viewList=isComponent?ecIns._componentsViews:ecIns._chartsViews,viewMap=isComponent?ecIns._componentsMap:ecIns._chartsMap,zr=ecIns._zr,api=ecIns._api,i=0;i<viewList.length;i++)viewList[i].__alive=!1;function doPrepare(model){var classType,Clazz,requireNewView=model.__requireNewView,viewId=(model.__requireNewView=!1,"_ec_"+model.id+"_"+model.type),requireNewView=!requireNewView&&viewMap[viewId];requireNewView||(classType=parseClassType(model.type),assert(Clazz=isComponent?ComponentView.getClass(classType.main,classType.sub):ChartView.getClass(classType.sub),classType.sub+" does not exist."),(requireNewView=new Clazz).init(ecModel,api),viewMap[viewId]=requireNewView,viewList.push(requireNewView),zr.add(requireNewView.group)),model.__viewId=requireNewView.__id=viewId,requireNewView.__alive=!0,requireNewView.__model=model,requireNewView.group.__ecComponentInfo={mainType:model.mainType,index:model.componentIndex},isComponent||scheduler.prepareView(requireNewView,model,ecModel,api)}isComponent?ecModel.eachComponent(function(componentType,model){"series"!==componentType&&doPrepare(model)}):ecModel.eachSeries(doPrepare);for(i=0;i<viewList.length;){var view=viewList[i];view.__alive?i++:(isComponent||view.renderTask.dispose(),zr.remove(view.group),view.dispose(ecModel,api),viewList.splice(i,1),viewMap[view.__id]===view&&delete viewMap[view.__id],view.__id=view.group.__ecComponentInfo=null)}},updateDirectly=function(ecIns,method,payload,mainType,subType){var query,excludeSeriesIdMap,ecModel=ecIns._model;function callView(view){view&&view.__alive&&view[method]&&view[method](view.__model,ecModel,ecIns._api,payload)}ecModel.setUpdatePayload(payload),mainType?((query={})[mainType+"Id"]=payload[mainType+"Id"],query[mainType+"Index"]=payload[mainType+"Index"],query[mainType+"Name"]=payload[mainType+"Name"],query={mainType:mainType,query:query},subType&&(query.subType=subType),null!=(subType=payload.excludeSeriesId)&&(excludeSeriesIdMap=createHashMap(),each(normalizeToArray(subType),function(id){id=convertOptionIdName(id,null);null!=id&&excludeSeriesIdMap.set(id,!0)})),ecModel&&ecModel.eachComponent(query,function(model){var focusSelf,_a;excludeSeriesIdMap&&null!==excludeSeriesIdMap.get(model.id)||(isHighDownPayload(payload)?model instanceof SeriesModel?payload.type!==HIGHLIGHT_ACTION_TYPE||payload.notBlur||model.get(["emphasis","disabled"])||function(seriesModel,payload,api){var seriesIndex=seriesModel.seriesIndex,data=seriesModel.getData(payload.dataType);if(data){var dataIndex=(isArray(dataIndex=queryDataIndex(data,payload))?dataIndex[0]:dataIndex)||0,el=data.getItemGraphicEl(dataIndex);if(!el)for(var count=data.count(),current=0;!el&&current<count;)el=data.getItemGraphicEl(current++);el?blurSeries(seriesIndex,(dataIndex=getECData(el)).focus,dataIndex.blurScope,api):(dataIndex=seriesModel.get(["emphasis","focus"]),seriesModel=seriesModel.get(["emphasis","blurScope"]),null!=dataIndex&&blurSeries(seriesIndex,dataIndex,seriesModel,api))}else error("Unknown dataType "+payload.dataType)}(model,payload,ecIns._api):(focusSelf=(_a=findComponentHighDownDispatchers(model.mainType,model.componentIndex,payload.name,ecIns._api)).focusSelf,_a=_a.dispatchers,payload.type===HIGHLIGHT_ACTION_TYPE&&focusSelf&&!payload.notBlur&&blurComponent(model.mainType,model.componentIndex,ecIns._api),_a&&each(_a,function(dispatcher){(payload.type===HIGHLIGHT_ACTION_TYPE?enterEmphasis:leaveEmphasis)(dispatcher)})):isSelectChangePayload(payload)&&model instanceof SeriesModel&&(function(seriesModel,payload){var dataType,dataIndex;isSelectChangePayload(payload)&&(dataType=payload.dataType,isArray(dataIndex=queryDataIndex(seriesModel.getData(dataType),payload))||(dataIndex=[dataIndex]),seriesModel[payload.type===TOGGLE_SELECT_ACTION_TYPE?"toggleSelect":payload.type===SELECT_ACTION_TYPE?"select":"unselect"](dataIndex,dataType))}(model,payload,ecIns._api),updateSeriesElementSelection(model),markStatusToUpdate(ecIns)))},ecIns),ecModel&&ecModel.eachComponent(query,function(model){excludeSeriesIdMap&&null!==excludeSeriesIdMap.get(model.id)||callView(ecIns["series"===mainType?"_chartsMap":"_componentsMap"][model.__viewId])},ecIns)):each([].concat(ecIns._componentsViews).concat(ecIns._chartsViews),callView)},updateMethods={prepareAndUpdate:function(payload){prepare(this),updateMethods.update.call(this,payload,{optionChanged:null!=payload.newOption})},update:function(payload,updateParams){var ecModel=this._model,api=this._api,zr=this._zr,coordSysMgr=this._coordSysMgr,scheduler=this._scheduler;ecModel&&(ecModel.setUpdatePayload(payload),scheduler.restoreData(ecModel,payload),scheduler.performSeriesTasks(ecModel),coordSysMgr.create(ecModel,api),scheduler.performDataProcessorTasks(ecModel,payload),updateStreamModes(this,ecModel),coordSysMgr.update(ecModel,api),clearColorPalette(ecModel),scheduler.performVisualTasks(ecModel,payload),render(this,ecModel,api,payload,updateParams),coordSysMgr=ecModel.get("backgroundColor")||"transparent",scheduler=ecModel.get("darkMode"),zr.setBackgroundColor(coordSysMgr),null!=scheduler&&"auto"!==scheduler&&zr.setDarkMode(scheduler),lifecycle.trigger("afterupdate",ecModel,api))},updateTransform:function(payload){var componentDirtyList,seriesDirtyMap,_this=this,ecModel=this._model,api=this._api;ecModel&&(ecModel.setUpdatePayload(payload),componentDirtyList=[],ecModel.eachComponent(function(componentType,componentModel){"series"!==componentType&&(componentType=_this.getViewOfComponentModel(componentModel))&&componentType.__alive&&(!componentType.updateTransform||(componentModel=componentType.updateTransform(componentModel,ecModel,api,payload))&&componentModel.update)&&componentDirtyList.push(componentType)}),seriesDirtyMap=createHashMap(),ecModel.eachSeries(function(seriesModel){var chartView=_this._chartsMap[seriesModel.__viewId];(!chartView.updateTransform||(chartView=chartView.updateTransform(seriesModel,ecModel,api,payload))&&chartView.update)&&seriesDirtyMap.set(seriesModel.uid,1)}),clearColorPalette(ecModel),this._scheduler.performVisualTasks(ecModel,payload,{setDirty:!0,dirtyMap:seriesDirtyMap}),renderSeries(this,ecModel,api,payload,{},seriesDirtyMap),lifecycle.trigger("afterupdate",ecModel,api))},updateView:function(payload){var ecModel=this._model;ecModel&&(ecModel.setUpdatePayload(payload),ChartView.markUpdateMethod(payload,"updateView"),clearColorPalette(ecModel),this._scheduler.performVisualTasks(ecModel,payload,{setDirty:!0}),render(this,ecModel,this._api,payload,{}),lifecycle.trigger("afterupdate",ecModel,this._api))},updateVisual:function(payload){var _this=this,ecModel=this._model;ecModel&&(ecModel.setUpdatePayload(payload),ecModel.eachSeries(function(seriesModel){seriesModel.getData().clearAllVisual()}),ChartView.markUpdateMethod(payload,"updateVisual"),clearColorPalette(ecModel),this._scheduler.performVisualTasks(ecModel,payload,{visualType:"visual",setDirty:!0}),ecModel.eachComponent(function(componentType,componentModel){"series"!==componentType&&(componentType=_this.getViewOfComponentModel(componentModel))&&componentType.__alive&&componentType.updateVisual(componentModel,ecModel,_this._api,payload)}),ecModel.eachSeries(function(seriesModel){_this._chartsMap[seriesModel.__viewId].updateVisual(seriesModel,ecModel,_this._api,payload)}),lifecycle.trigger("afterupdate",ecModel,this._api))},updateLayout:function(payload){updateMethods.update.call(this,payload)}},doConvertPixel=function(ecIns,methodName,finder,value){if(ecIns._disposed)disposedWarning(ecIns.id);else{for(var ecModel=ecIns._model,coordSysList=ecIns._coordSysMgr.getCoordinateSystems(),parsedFinder=parseFinder(ecModel,finder),i=0;i<coordSysList.length;i++){var coordSys=coordSysList[i];if(coordSys[methodName]&&null!=(coordSys=coordSys[methodName](ecModel,parsedFinder,value)))return coordSys}console.warn("No coordinate system that supports "+methodName+" found by the given finder.")}},updateStreamModes=function(ecIns,ecModel){var chartsMap=ecIns._chartsMap,scheduler=ecIns._scheduler;ecModel.eachSeries(function(seriesModel){scheduler.updateStreamModes(seriesModel,chartsMap[seriesModel.__viewId])})},doDispatchAction=function(payload,silent){var eventObj,_this=this,ecModel=this.getModel(),payloadType=payload.type,escapeConnect=payload.escapeConnect,actionWrap=actions[payloadType],actionInfo=actionWrap.actionInfo,cptTypeTmp=(actionInfo.update||"update").split(":"),updateMethod=cptTypeTmp.pop(),cptType=null!=cptTypeTmp[0]&&parseClassType(cptTypeTmp[0]),cptTypeTmp=(this.__flagInMainProcess=!0,[payload]),batched=!1,eventObjBatch=(payload.batch&&(batched=!0,cptTypeTmp=map(payload.batch,function(item){return(item=defaults(extend({},item),payload)).batch=null,item})),[]),isSelectChange=isSelectChangePayload(payload),isHighDown=isHighDownPayload(payload);if(isHighDown&&allLeaveBlur(this._api),each(cptTypeTmp,function(batchItem){var queryOptionMap,_a;(eventObj=(eventObj=actionWrap.action(batchItem,_this._model,_this._api))||extend({},batchItem)).type=actionInfo.event||eventObj.type,eventObjBatch.push(eventObj),isHighDown?(queryOptionMap=(_a=preParseFinder(payload)).queryOptionMap,_a=_a.mainTypeSpecified?queryOptionMap.keys()[0]:"series",updateDirectly(_this,updateMethod,batchItem,_a),markStatusToUpdate(_this)):isSelectChange?(updateDirectly(_this,updateMethod,batchItem,"series"),markStatusToUpdate(_this)):cptType&&updateDirectly(_this,updateMethod,batchItem,cptType.main,cptType.sub)}),"none"!==updateMethod&&!isHighDown&&!isSelectChange&&!cptType)try{this.__pendingUpdate?(prepare(this),updateMethods.update.call(this,payload),this.__pendingUpdate=null):updateMethods[updateMethod].call(this,payload)}catch(e){throw this.__flagInMainProcess=!1,e}eventObj=batched?{type:actionInfo.event||payloadType,escapeConnect:escapeConnect,batch:eventObjBatch}:eventObjBatch[0],this.__flagInMainProcess=!1,silent||((cptTypeTmp=this._messageCenter).trigger(eventObj.type,eventObj),isSelectChange&&(batched={type:"selectchanged",escapeConnect:escapeConnect,selected:function(ecModel){var ret=[];return ecModel.eachSeries(function(seriesModel){each(seriesModel.getAllData(),function(_a){_a.data;var _a=_a.type,dataIndices=seriesModel.getSelectedDataIndices();0<dataIndices.length&&(dataIndices={dataIndex:dataIndices,seriesIndex:seriesModel.seriesIndex},null!=_a&&(dataIndices.dataType=_a),ret.push(dataIndices))})}),ret}(ecModel),isFromClick:payload.isFromClick||!1,fromAction:payload.type,fromActionPayload:payload},cptTypeTmp.trigger(batched.type,batched)))},flushPendingActions=function(silent){for(var pendingActions=this._pendingActions;pendingActions.length;){var payload=pendingActions.shift();doDispatchAction.call(this,payload,silent)}},triggerUpdatedEvent=function(silent){silent||this.trigger("updated")},bindRenderedEvent=function(zr,ecIns){zr.on("rendered",function(params){ecIns.trigger("rendered",params),!zr.animation.isFinished()||ecIns.__pendingUpdate||ecIns._scheduler.unfinished||ecIns._pendingActions.length||ecIns.trigger("finished")})},bindMouseEvent=function(zr,ecIns){zr.on("mouseover",function(e){var dispatcher=findEventDispatcher(e.target,isHighDownDispatcher);dispatcher&&(!function(dispatcher,e,api){isHighDownDispatcher(dispatcher)||error("param should be highDownDispatcher");var ecData=getECData(dispatcher),dispatchers=(_a=findComponentHighDownDispatchers(ecData.componentMainType,ecData.componentIndex,ecData.componentHighDownName,api)).dispatchers,_a=_a.focusSelf;dispatchers?(_a&&blurComponent(ecData.componentMainType,ecData.componentIndex,api),each(dispatchers,function(dispatcher){return enterEmphasisWhenMouseOver(dispatcher,e)})):(blurSeries(ecData.seriesIndex,ecData.focus,ecData.blurScope,api),"self"===ecData.focus&&blurComponent(ecData.componentMainType,ecData.componentIndex,api),enterEmphasisWhenMouseOver(dispatcher,e))}(dispatcher,e,ecIns._api),markStatusToUpdate(ecIns))}).on("mouseout",function(e){var dispatcher=findEventDispatcher(e.target,isHighDownDispatcher);dispatcher&&(!function(dispatcher,e,api){isHighDownDispatcher(dispatcher)||error("param should be highDownDispatcher"),allLeaveBlur(api);var ecData=getECData(dispatcher);(ecData=findComponentHighDownDispatchers(ecData.componentMainType,ecData.componentIndex,ecData.componentHighDownName,api).dispatchers)?each(ecData,function(dispatcher){return leaveEmphasisWhenMouseOut(dispatcher,e)}):leaveEmphasisWhenMouseOut(dispatcher,e)}(dispatcher,e,ecIns._api),markStatusToUpdate(ecIns))}).on("click",function(e){var actionType,e=findEventDispatcher(e.target,function(target){return null!=getECData(target).dataIndex},!0);e&&(actionType=e.selected?"unselect":"select",e=getECData(e),ecIns._api.dispatchAction({type:actionType,dataType:e.dataType,dataIndexInside:e.dataIndex,seriesIndex:e.seriesIndex,isFromClick:!0}))})},render=function(ecIns,ecModel,api,payload,updateParams){!function(ecModel){var zLevels,lastSeriesZLevel_1,lastSeriesKey_1,componentZLevels=[],seriesZLevels=[],hasSeperateZLevel=!1;ecModel.eachComponent(function(componentType,componentModel){var zlevel=componentModel.get("zlevel")||0,z=componentModel.get("z")||0,zlevelKey=componentModel.getZLevelKey();hasSeperateZLevel=hasSeperateZLevel||!!zlevelKey,("series"===componentType?seriesZLevels:componentZLevels).push({zlevel:zlevel,z:z,idx:componentModel.componentIndex,type:componentType,key:zlevelKey})}),hasSeperateZLevel&&(sort(zLevels=componentZLevels.concat(seriesZLevels),function(a,b){return a.zlevel===b.zlevel?a.z-b.z:a.zlevel-b.zlevel}),each(zLevels,function(item){var componentModel=ecModel.getComponent(item.type,item.idx),zlevel=item.zlevel,item=item.key;null!=lastSeriesZLevel_1&&(zlevel=Math.max(lastSeriesZLevel_1,zlevel)),item?(zlevel===lastSeriesZLevel_1&&item!==lastSeriesKey_1&&zlevel++,lastSeriesKey_1=item):lastSeriesKey_1&&(zlevel===lastSeriesZLevel_1&&zlevel++,lastSeriesKey_1=""),lastSeriesZLevel_1=zlevel,componentModel.setZLevel(zlevel)}))}(ecModel),renderComponents(ecIns,ecModel,api,payload,updateParams),each(ecIns._chartsViews,function(chart){chart.__alive=!1}),renderSeries(ecIns,ecModel,api,payload,updateParams),each(ecIns._chartsViews,function(chart){chart.__alive||chart.remove(ecModel,api)})},renderComponents=function(ecIns,ecModel,api,payload,updateParams,dirtyList){each(dirtyList||ecIns._componentsViews,function(componentView){var componentModel=componentView.__model;clearStates$$1(0,componentView),componentView.render(componentModel,ecModel,api,payload),updateZ(componentModel,componentView),updateStates(componentModel,componentView)})},renderSeries=function(ecIns,ecModel,api,payload,updateParams,dirtyMap){var scheduler=ecIns._scheduler,unfinished=(updateParams=extend(updateParams||{},{updatedSeries:ecModel.getSeries()}),lifecycle.trigger("series:beforeupdate",ecModel,api,updateParams),!1);ecModel.eachSeries(function(seriesModel){var chartView=ecIns._chartsMap[seriesModel.__viewId],renderTask=(chartView.__alive=!0,chartView.renderTask);scheduler.updatePayload(renderTask,payload),clearStates$$1(0,chartView),dirtyMap&&dirtyMap.get(seriesModel.uid)&&renderTask.dirty(),renderTask.perform(scheduler.getPerformArgs(renderTask))&&(unfinished=!0),chartView.group.silent=!!seriesModel.get("silent"),function(seriesModel,chartView){var blendMode=seriesModel.get("blendMode")||null;chartView.eachRendered(function(el){el.isGroup||(el.style.blend=blendMode)})}(seriesModel,chartView),updateSeriesElementSelection(seriesModel)}),scheduler.unfinished=unfinished||scheduler.unfinished,lifecycle.trigger("series:layoutlabels",ecModel,api,updateParams),lifecycle.trigger("series:transition",ecModel,api,updateParams),ecModel.eachSeries(function(seriesModel){var chartView=ecIns._chartsMap[seriesModel.__viewId];updateZ(seriesModel,chartView),updateStates(seriesModel,chartView)}),function(ecIns,ecModel){var storage=ecIns._zr.storage,elCount=0;storage.traverse(function(el){el.isGroup||elCount++}),elCount>ecModel.get("hoverLayerThreshold")&&!env.node&&!env.worker&&ecModel.eachSeries(function(seriesModel){seriesModel.preventUsingHoverLayer||(seriesModel=ecIns._chartsMap[seriesModel.__viewId]).__alive&&seriesModel.eachRendered(function(el){el.states.emphasis&&(el.states.emphasis.hoverLayer=!0)})})}(ecIns,ecModel),lifecycle.trigger("series:afterupdate",ecModel,api,updateParams)},markStatusToUpdate=function(ecIns){ecIns.__needsUpdateStatus=!0,ecIns.getZr().wakeUp()},applyChangedStates=function(ecIns){ecIns.__needsUpdateStatus&&(ecIns.getZr().storage.traverse(function(el){isElementRemoved(el)||applyElementStates(el)}),ecIns.__needsUpdateStatus=!1)},createExtensionAPI=function(ecIns){return __extends(class_1,_super=ExtensionAPI),class_1.prototype.getCoordinateSystems=function(){return ecIns._coordSysMgr.getCoordinateSystems()},class_1.prototype.getComponentByElement=function(el){for(;el;){var modelInfo=el.__ecComponentInfo;if(null!=modelInfo)return ecIns._model.getComponent(modelInfo.mainType,modelInfo.index);el=el.parent}},class_1.prototype.enterEmphasis=function(el,highlightDigit){enterEmphasis(el,highlightDigit),markStatusToUpdate(ecIns)},class_1.prototype.leaveEmphasis=function(el,highlightDigit){leaveEmphasis(el,highlightDigit),markStatusToUpdate(ecIns)},class_1.prototype.enterBlur=function(el){!function(el){traverseUpdateState(el,singleEnterBlur)}(el),markStatusToUpdate(ecIns)},class_1.prototype.leaveBlur=function(el){leaveBlur(el),markStatusToUpdate(ecIns)},class_1.prototype.enterSelect=function(el){enterSelect(el),markStatusToUpdate(ecIns)},class_1.prototype.leaveSelect=function(el){leaveSelect(el),markStatusToUpdate(ecIns)},class_1.prototype.getModel=function(){return ecIns.getModel()},class_1.prototype.getViewOfComponentModel=function(componentModel){return ecIns.getViewOfComponentModel(componentModel)},class_1.prototype.getViewOfSeriesModel=function(seriesModel){return ecIns.getViewOfSeriesModel(seriesModel)},new class_1(ecIns);function class_1(){return null!==_super&&_super.apply(this,arguments)||this}var _super},void(enableConnect=function(chart){function updateConnectedChartsStatus(charts,status){for(var i=0;i<charts.length;i++)charts[i].__connectUpdateStatus=status}each(eventActionMap,function(actionType,eventType){chart._messageCenter.on(eventType,function(event){var action_1,otherCharts_1;!connectedGroups[chart.group]||0===chart.__connectUpdateStatus||event&&event.escapeConnect||(action_1=chart.makeActionFromEvent(event),otherCharts_1=[],each(instances,function(otherChart){otherChart!==chart&&otherChart.group===chart.group&&otherCharts_1.push(otherChart)}),updateConnectedChartsStatus(otherCharts_1,0),each(otherCharts_1,function(otherChart){1!==otherChart.__connectUpdateStatus&&otherChart.dispatchAction(action_1)}),updateConnectedChartsStatus(otherCharts_1,2))})})})),ECharts}(Eventful)),Arrow=ECharts.prototype,MOUSE_EVENT_NAMES=(Arrow.on=createRegisterEventWithLowercaseECharts("on"),Arrow.off=createRegisterEventWithLowercaseECharts("off"),Arrow.one=function(eventName,cb,ctx){var self=this;deprecateLog("ECharts#one is deprecated."),this.on.call(this,eventName,function wrapped(){for(var args2=[],_i=0;_i<arguments.length;_i++)args2[_i]=arguments[_i];cb&&cb.apply&&cb.apply(this,args2),self.off(eventName,wrapped)},ctx)},["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"]);function disposedWarning(id){console.warn("Instance "+id+" has been disposed")}var actions={},eventActionMap={},dataProcessorFuncs=[],optionPreprocessorFuncs=[],visualFuncs=[],themeStorage={},loadingEffects={},instances={},connectedGroups={},idBase=+new Date,groupIdBase=+new Date,DOM_ATTRIBUTE_KEY="_echarts_instance_";function disConnect(groupId){connectedGroups[groupId]=!1}Triangle=disConnect;function getInstanceByDom(dom){return instances[function(dom,key){return dom.getAttribute?dom.getAttribute(key):dom[key]}(dom,DOM_ATTRIBUTE_KEY)]}function registerTheme(name,theme$$1){themeStorage[name]=theme$$1}function registerPreprocessor(preprocessorFunc){indexOf(optionPreprocessorFuncs,preprocessorFunc)<0&&optionPreprocessorFuncs.push(preprocessorFunc)}function registerProcessor(priority,processor){normalizeRegister(dataProcessorFuncs,priority,processor,2e3)}function registerPostInit(postInitFunc){registerUpdateLifecycle("afterinit",postInitFunc)}function registerPostUpdate(postUpdateFunc){registerUpdateLifecycle("afterupdate",postUpdateFunc)}function registerUpdateLifecycle(name,cb){lifecycle.on(name,cb)}function registerAction(actionInfo,eventName,action){isFunction(eventName)&&(action=eventName,eventName="");var actionType=isObject(actionInfo)?actionInfo.type:[actionInfo,actionInfo={event:eventName}][0];actionInfo.event=(actionInfo.event||actionType).toLowerCase(),eventName=actionInfo.event,eventActionMap[eventName]||(assert(ACTION_REG.test(actionType)&&ACTION_REG.test(eventName)),actions[actionType]||(actions[actionType]={action:action,actionInfo:actionInfo}),eventActionMap[eventName]=actionType)}function registerCoordinateSystem(type,coordSysCreator){CoordinateSystemManager.register(type,coordSysCreator)}function registerLayout(priority,layoutTask){normalizeRegister(visualFuncs,priority,layoutTask,1e3,"layout")}function registerVisual(priority,visualTask){normalizeRegister(visualFuncs,priority,visualTask,3e3,"visual")}var registeredTasks=[];function normalizeRegister(targetList,priority,fn,defaultPriority,visualType){if((isFunction(priority)||isObject(priority))&&(fn=priority,priority=defaultPriority),isNaN(priority)||null==priority)throw new Error("Illegal priority");each(targetList,function(wrap){assert(wrap.__raw!==fn)}),0<=indexOf(registeredTasks,fn)||(registeredTasks.push(fn),(defaultPriority=Scheduler.wrapStageHandler(fn,visualType)).__prio=priority,defaultPriority.__raw=fn,targetList.push(defaultPriority))}function registerLoading(name,loadingFx){loadingEffects[name]=loadingFx}function registerMap(mapName,geoJson,specialAreas){var registerMap=getImpl("registerMap");registerMap&&registerMap(mapName,geoJson,specialAreas)}function registerTransform(externalTransform){var type=(externalTransform=clone(externalTransform)).type,typeParsed=(type||throwError("Must have a `type` when `registerTransform`."),type.split(":")),isBuiltIn=(2!==typeParsed.length&&throwError('Name must include namespace like "ns:regression".'),!1);"echarts"===typeParsed[0]&&(type=typeParsed[1],isBuiltIn=!0),externalTransform.__isBuiltIn=isBuiltIn,externalTransformMap.set(type,externalTransform)}registerVisual(2e3,ItemStyleMixin),registerVisual(4500,AreaStyleMixin),registerVisual(4500,subPixelOptimize$1),registerVisual(2e3,target),registerVisual(4500,ITEM_STYLE_KEY_MAP),registerVisual(7e3,function(ecModel,api){ecModel.eachRawSeries(function(seriesModel){var data;ecModel.isSeriesFiltered(seriesModel)||((data=seriesModel.getData()).hasItemVisual()&&data.each(function(idx){var decal=data.getItemVisual(idx,"decal");decal&&(data.ensureUniqueItemVisual(idx,"style").decal=createOrUpdatePatternFromDecal(decal,api))}),(seriesModel=data.getVisual("decal"))&&(data.getVisual("style").decal=createOrUpdatePatternFromDecal(seriesModel,api)))})}),registerPreprocessor(globalBackwardCompat),registerProcessor(900,function(ecModel){var stackInfoMap=createHashMap();ecModel.eachSeries(function(seriesModel){var data,stack=seriesModel.get("stack");stack&&(stack=stackInfoMap.get(stack)||stackInfoMap.set(stack,[]),(seriesModel={stackResultDimension:(data=seriesModel.getData()).getCalculationInfo("stackResultDimension"),stackedOverDimension:data.getCalculationInfo("stackedOverDimension"),stackedDimension:data.getCalculationInfo("stackedDimension"),stackedByDimension:data.getCalculationInfo("stackedByDimension"),isStackedByIndex:data.getCalculationInfo("isStackedByIndex"),data:data,seriesModel:seriesModel}).stackedDimension&&(seriesModel.isStackedByIndex||seriesModel.stackedByDimension)&&(stack.length&&data.setCalculationInfo("stackedOnSeries",stack[stack.length-1].seriesModel),stack.push(seriesModel)))}),stackInfoMap.each(calculateStack)}),registerLoading("default",function(api,opts){defaults(opts=opts||{},{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var arc,group=new Group,mask=new Rect({style:{fill:opts.maskColor},zlevel:opts.zlevel,z:1e4}),textContent=(group.add(mask),new ZRText({style:{text:opts.text,fill:opts.textColor,fontSize:opts.fontSize,fontWeight:opts.fontWeight,fontStyle:opts.fontStyle,fontFamily:opts.fontFamily},zlevel:opts.zlevel,z:10001})),labelRect=new Rect({style:{fill:"none"},textContent:textContent,textConfig:{position:"right",distance:10},zlevel:opts.zlevel,z:10001});return group.add(labelRect),opts.showSpinner&&((arc=new Arc({shape:{startAngle:-PI$3/2,endAngle:-PI$3/2+.1,r:opts.spinnerRadius},style:{stroke:opts.color,lineCap:"round",lineWidth:opts.lineWidth},zlevel:opts.zlevel,z:10001})).animateShape(!0).when(1e3,{endAngle:3*PI$3/2}).start("circularInOut"),arc.animateShape(!0).when(1e3,{startAngle:3*PI$3/2}).delay(300).start("circularInOut"),group.add(arc)),group.resize=function(){var textWidth=textContent.getBoundingRect().width,r=opts.showSpinner?opts.spinnerRadius:0,textWidth=(api.getWidth()-2*r-(opts.showSpinner&&textWidth?10:0)-textWidth)/2-(opts.showSpinner&&textWidth?0:5+textWidth/2)+(opts.showSpinner?0:textWidth/2)+(textWidth?0:r),cy=api.getHeight()/2;opts.showSpinner&&arc.setShape({cx:textWidth,cy:cy}),labelRect.setShape({x:textWidth-r,y:cy-r,width:2*r,height:2*r}),mask.setShape({x:0,y:0,width:api.getWidth(),height:api.getHeight()})},group.resize(),group}),registerAction({type:HIGHLIGHT_ACTION_TYPE,event:HIGHLIGHT_ACTION_TYPE,update:HIGHLIGHT_ACTION_TYPE},noop),registerAction({type:DOWNPLAY_ACTION_TYPE,event:DOWNPLAY_ACTION_TYPE,update:DOWNPLAY_ACTION_TYPE},noop),registerAction({type:SELECT_ACTION_TYPE,event:SELECT_ACTION_TYPE,update:SELECT_ACTION_TYPE},noop),registerAction({type:UNSELECT_ACTION_TYPE,event:UNSELECT_ACTION_TYPE,update:UNSELECT_ACTION_TYPE},noop),registerAction({type:TOGGLE_SELECT_ACTION_TYPE,event:TOGGLE_SELECT_ACTION_TYPE,update:TOGGLE_SELECT_ACTION_TYPE},noop),registerTheme("light",LineStyleMixin),registerTheme("dark",LINE_STYLE_KEY_MAP);function dataIndexMapValueLength(valNumOrArrLengthMoreThan2){return null==valNumOrArrLengthMoreThan2?0:valNumOrArrLengthMoreThan2.length||1}function defaultKeyGetter(item){return item}var DataDiffer=function(){function DataDiffer(oldArr,newArr,oldKeyGetter,newKeyGetter,context,diffMode){this._old=oldArr,this._new=newArr,this._oldKeyGetter=oldKeyGetter||defaultKeyGetter,this._newKeyGetter=newKeyGetter||defaultKeyGetter,this.context=context,this._diffModeMultiple="multiple"===diffMode}return DataDiffer.prototype.add=function(func){return this._add=func,this},DataDiffer.prototype.update=function(func){return this._update=func,this},DataDiffer.prototype.updateManyToOne=function(func){return this._updateManyToOne=func,this},DataDiffer.prototype.updateOneToMany=function(func){return this._updateOneToMany=func,this},DataDiffer.prototype.updateManyToMany=function(func){return this._updateManyToMany=func,this},DataDiffer.prototype.remove=function(func){return this._remove=func,this},DataDiffer.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},DataDiffer.prototype._executeOneToOne=function(){var oldArr=this._old,newArr=this._new,newDataIndexMap={},oldDataKeyArr=new Array(oldArr.length),newDataKeyArr=new Array(newArr.length);this._initIndexMap(oldArr,null,oldDataKeyArr,"_oldKeyGetter"),this._initIndexMap(newArr,newDataIndexMap,newDataKeyArr,"_newKeyGetter");for(var i=0;i<oldArr.length;i++){var newIdx,oldKey=oldDataKeyArr[i],newIdxMapVal=newDataIndexMap[oldKey],newIdxMapValLen=dataIndexMapValueLength(newIdxMapVal);1<newIdxMapValLen?(newIdx=newIdxMapVal.shift(),1===newIdxMapVal.length&&(newDataIndexMap[oldKey]=newIdxMapVal[0]),this._update&&this._update(newIdx,i)):1===newIdxMapValLen?(newDataIndexMap[oldKey]=null,this._update&&this._update(newIdxMapVal,i)):this._remove&&this._remove(i)}this._performRestAdd(newDataKeyArr,newDataIndexMap)},DataDiffer.prototype._executeMultiple=function(){var oldArr=this._old,newArr=this._new,oldDataIndexMap={},newDataIndexMap={},oldDataKeyArr=[],newDataKeyArr=[];this._initIndexMap(oldArr,oldDataIndexMap,oldDataKeyArr,"_oldKeyGetter"),this._initIndexMap(newArr,newDataIndexMap,newDataKeyArr,"_newKeyGetter");for(var i=0;i<oldDataKeyArr.length;i++){var oldKey=oldDataKeyArr[i],oldIdxMapVal=oldDataIndexMap[oldKey],newIdxMapVal=newDataIndexMap[oldKey],oldIdxMapValLen=dataIndexMapValueLength(oldIdxMapVal),newIdxMapValLen=dataIndexMapValueLength(newIdxMapVal);if(1<oldIdxMapValLen&&1===newIdxMapValLen)this._updateManyToOne&&this._updateManyToOne(newIdxMapVal,oldIdxMapVal),newDataIndexMap[oldKey]=null;else if(1===oldIdxMapValLen&&1<newIdxMapValLen)this._updateOneToMany&&this._updateOneToMany(newIdxMapVal,oldIdxMapVal),newDataIndexMap[oldKey]=null;else if(1===oldIdxMapValLen&&1===newIdxMapValLen)this._update&&this._update(newIdxMapVal,oldIdxMapVal),newDataIndexMap[oldKey]=null;else if(1<oldIdxMapValLen&&1<newIdxMapValLen)this._updateManyToMany&&this._updateManyToMany(newIdxMapVal,oldIdxMapVal),newDataIndexMap[oldKey]=null;else if(1<oldIdxMapValLen)for(var i_1=0;i_1<oldIdxMapValLen;i_1++)this._remove&&this._remove(oldIdxMapVal[i_1]);else this._remove&&this._remove(oldIdxMapVal)}this._performRestAdd(newDataKeyArr,newDataIndexMap)},DataDiffer.prototype._performRestAdd=function(newDataKeyArr,newDataIndexMap){for(var i=0;i<newDataKeyArr.length;i++){var newKey=newDataKeyArr[i],newIdxMapVal=newDataIndexMap[newKey],idxMapValLen=dataIndexMapValueLength(newIdxMapVal);if(1<idxMapValLen)for(var j=0;j<idxMapValLen;j++)this._add&&this._add(newIdxMapVal[j]);else 1===idxMapValLen&&this._add&&this._add(newIdxMapVal);newDataIndexMap[newKey]=null}},DataDiffer.prototype._initIndexMap=function(arr,map,keyArr,keyGetterName){for(var cbModeMultiple=this._diffModeMultiple,i=0;i<arr.length;i++){var idxMapVal,idxMapValLen,key="_ec_"+this[keyGetterName](arr[i],i);cbModeMultiple||(keyArr[i]=key),map&&(0===(idxMapValLen=dataIndexMapValueLength(idxMapVal=map[key]))?(map[key]=i,cbModeMultiple&&keyArr.push(key)):1===idxMapValLen?map[key]=[idxMapVal,i]:idxMapVal.push(i))}},DataDiffer}(),DimensionUserOuput=function(){function DimensionUserOuput(encode,dimRequest){this._encode=encode,this._schema=dimRequest}return DimensionUserOuput.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},DimensionUserOuput.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},DimensionUserOuput}();function summarizeDimensions(data,schema){var summary={},encode=summary.encode={},notExtraCoordDimMap=createHashMap(),defaultedLabel=[],defaultedTooltip=[],userOutputEncode={},dataDimsOnCoord=(each(data.dimensions,function(dimName){var coordDimIndex,dimType,dimItem=data.getDimensionInfo(dimName),coordDim=dimItem.coordDim;coordDim&&(assert(null==VISUAL_DIMENSIONS.get(coordDim)),coordDimIndex=dimItem.coordDimIndex,getOrCreateEncodeArr(encode,coordDim)[coordDimIndex]=dimName,dimItem.isExtraCoord||(notExtraCoordDimMap.set(coordDim,1),"ordinal"!==(dimType=dimItem.type)&&"time"!==dimType&&(defaultedLabel[0]=dimName),getOrCreateEncodeArr(userOutputEncode,coordDim)[coordDimIndex]=data.getDimensionIndex(dimItem.name)),dimItem.defaultTooltip&&defaultedTooltip.push(dimName)),VISUAL_DIMENSIONS.each(function(v,otherDim){var encodeArr=getOrCreateEncodeArr(encode,otherDim),otherDim=dimItem.otherDims[otherDim];null!=otherDim&&!1!==otherDim&&(encodeArr[otherDim]=dimItem.name)})}),[]),encodeFirstDimNotExtra={},encodeLabel=(notExtraCoordDimMap.each(function(v,coordDim){var dimArr=encode[coordDim];encodeFirstDimNotExtra[coordDim]=dimArr[0],dataDimsOnCoord=dataDimsOnCoord.concat(dimArr)}),summary.dataDimsOnCoord=dataDimsOnCoord,summary.dataDimIndicesOnCoord=map(dataDimsOnCoord,function(dimName){return data.getDimensionInfo(dimName).storeDimIndex}),summary.encodeFirstDimNotExtra=encodeFirstDimNotExtra,encode.label),encodeLabel=(encodeLabel&&encodeLabel.length&&(defaultedLabel=encodeLabel.slice()),encode.tooltip);return encodeLabel&&encodeLabel.length?defaultedTooltip=encodeLabel.slice():defaultedTooltip.length||(defaultedTooltip=defaultedLabel.slice()),encode.defaultedLabel=defaultedLabel,encode.defaultedTooltip=defaultedTooltip,summary.userOutput=new DimensionUserOuput(userOutputEncode,schema),summary}function getOrCreateEncodeArr(encode,dim){return encode.hasOwnProperty(dim)||(encode[dim]=[]),encode[dim]}var SeriesDimensionDefine=function(opt){this.otherDims={},null!=opt&&extend(this,opt)},inner$4=makeInner(),dimTypeShort={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},SeriesDataSchema=function(){function SeriesDataSchema(opt){this.dimensions=opt.dimensions,this._dimOmitted=opt.dimensionOmitted,this.source=opt.source,this._fullDimCount=opt.fullDimensionCount,this._updateDimOmitted(opt.dimensionOmitted)}return SeriesDataSchema.prototype.isDimensionOmitted=function(){return this._dimOmitted},SeriesDataSchema.prototype._updateDimOmitted=function(dimensionOmitted){(this._dimOmitted=dimensionOmitted)&&!this._dimNameMap&&(this._dimNameMap=ensureSourceDimNameMap(this.source))},SeriesDataSchema.prototype.getSourceDimensionIndex=function(dimName){return retrieve2(this._dimNameMap.get(dimName),-1)},SeriesDataSchema.prototype.getSourceDimension=function(dimIndex){var dimensionsDefine=this.source.dimensionsDefine;if(dimensionsDefine)return dimensionsDefine[dimIndex]},SeriesDataSchema.prototype.makeStoreSchema=function(){for(var dimCount=this._fullDimCount,willRetrieveDataByName=shouldRetrieveDataByName(this.source),makeHashStrict=!(30<dimCount),dimHash="",dims=[],fullDimIdx=0,seriesDimIdx=0;fullDimIdx<dimCount;fullDimIdx++){var sourceDimDef,property=void 0,type=void 0,ordinalMeta=void 0,seriesDimDef=this.dimensions[seriesDimIdx];seriesDimDef&&seriesDimDef.storeDimIndex===fullDimIdx?(property=willRetrieveDataByName?seriesDimDef.name:null,type=seriesDimDef.type,ordinalMeta=seriesDimDef.ordinalMeta,seriesDimIdx++):(sourceDimDef=this.getSourceDimension(fullDimIdx))&&(property=willRetrieveDataByName?sourceDimDef.name:null,type=sourceDimDef.type),dims.push({property:property,type:type,ordinalMeta:ordinalMeta}),!willRetrieveDataByName||null==property||seriesDimDef&&seriesDimDef.isCalculationCoord||(dimHash+=makeHashStrict?property.replace(/\`/g,"`1").replace(/\$/g,"`2"):property),dimHash=dimHash+"$"+(dimTypeShort[type]||"f"),ordinalMeta&&(dimHash+=ordinalMeta.uid),dimHash+="$"}var source=this.source;return{dimensions:dims,hash:[source.seriesLayoutBy,source.startIndex,dimHash].join("$$")}},SeriesDataSchema.prototype.makeOutputDimensionNames=function(){for(var result=[],fullDimIdx=0,seriesDimIdx=0;fullDimIdx<this._fullDimCount;fullDimIdx++){var name_1=void 0,seriesDimDef=this.dimensions[seriesDimIdx];seriesDimDef&&seriesDimDef.storeDimIndex===fullDimIdx?(seriesDimDef.isCalculationCoord||(name_1=seriesDimDef.name),seriesDimIdx++):(seriesDimDef=this.getSourceDimension(fullDimIdx))&&(name_1=seriesDimDef.name),result.push(name_1)}return result},SeriesDataSchema.prototype.appendCalculationDimension=function(dimDef){this.dimensions.push(dimDef),dimDef.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},SeriesDataSchema}();function isSeriesDataSchema(schema){return schema instanceof SeriesDataSchema}function createDimNameMap(dimsDef){for(var dataDimNameMap=createHashMap(),i=0;i<(dimsDef||[]).length;i++){var dimDefItemRaw=dimsDef[i],dimDefItemRaw=isObject(dimDefItemRaw)?dimDefItemRaw.name:dimDefItemRaw;null!=dimDefItemRaw&&null==dataDimNameMap.get(dimDefItemRaw)&&dataDimNameMap.set(dimDefItemRaw,i)}return dataDimNameMap}function ensureSourceDimNameMap(source){var innerSource=inner$4(source);return innerSource.dimNameMap||(innerSource.dimNameMap=createDimNameMap(source.dimensionsDefine))}var prepareInvertedIndex,getId,getIdNameFromStore,normalizeDimensions,transferProperties,cloneListForMapAndSample,makeIdFromName,isObject$2=isObject,map$1=map,CtorInt32Array$1="undefined"==typeof Int32Array?Array:Int32Array,TRANSFERABLE_PROPERTIES=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],CLONE_PROPERTIES=["_approximateExtent"],SeriesData=function(){function SeriesData(dimensionsInput,hostModel){this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"];for(var dimensions,dimIdxToName_1,assignStoreDimIdx=!(this.DOWNSAMPLE_METHODS=["downSample","lttbDownSample"]),dimensionInfos=(isSeriesDataSchema(dimensionsInput)?(dimensions=dimensionsInput.dimensions,this._dimOmitted=dimensionsInput.isDimensionOmitted(),this._schema=dimensionsInput):(assignStoreDimIdx=!0,dimensions=dimensionsInput),dimensions=dimensions||["x","y"],{}),dimensionNames=[],invertedIndicesMap={},needsHasOwn=!1,emptyObj={},i=0;i<dimensions.length;i++){var dimInfoInput=dimensions[i],dimInfoInput=isString(dimInfoInput)?new SeriesDimensionDefine({name:dimInfoInput}):dimInfoInput instanceof SeriesDimensionDefine?dimInfoInput:new SeriesDimensionDefine(dimInfoInput),dimensionName=dimInfoInput.name,otherDims=(dimInfoInput.type=dimInfoInput.type||"float",dimInfoInput.coordDim||(dimInfoInput.coordDim=dimensionName,dimInfoInput.coordDimIndex=0),dimInfoInput.otherDims=dimInfoInput.otherDims||{});dimensionNames.push(dimensionName),dimensionInfos[dimensionName]=dimInfoInput,null!=emptyObj[dimensionName]&&(needsHasOwn=!0),dimInfoInput.createInvertedIndices&&(invertedIndicesMap[dimensionName]=[]),0===otherDims.itemName&&(this._nameDimIdx=i),0===otherDims.itemId&&(this._idDimIdx=i),assert(assignStoreDimIdx||0<=dimInfoInput.storeDimIndex),assignStoreDimIdx&&(dimInfoInput.storeDimIndex=i)}this.dimensions=dimensionNames,this._dimInfos=dimensionInfos,this._initGetDimensionInfo(needsHasOwn),this.hostModel=hostModel,this._invertedIndicesMap=invertedIndicesMap,this._dimOmitted&&(dimIdxToName_1=this._dimIdxToName=createHashMap(),each(dimensionNames,function(dimName){dimIdxToName_1.set(dimensionInfos[dimName].storeDimIndex,dimName)}))}return SeriesData.prototype.getDimension=function(dim){if(null==this._recognizeDimIndex(dim))return dim;if(dim=dim,!this._dimOmitted)return this.dimensions[dim];var dimName=this._dimIdxToName.get(dim);if(null!=dimName)return dimName;dimName=this._schema.getSourceDimension(dim);return dimName?dimName.name:void 0},SeriesData.prototype.getDimensionIndex=function(dim){var dimIdx=this._recognizeDimIndex(dim);if(null!=dimIdx)return dimIdx;if(null==dim)return-1;dimIdx=this._getDimInfo(dim);return dimIdx?dimIdx.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(dim):-1},SeriesData.prototype._recognizeDimIndex=function(dim){if(isNumber(dim)||null!=dim&&!isNaN(dim)&&!this._getDimInfo(dim)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(dim)<0))return+dim},SeriesData.prototype._getStoreDimIndex=function(dim){var dimIdx=this.getDimensionIndex(dim);if(null==dimIdx)throw new Error("Unkown dimension "+dim);return dimIdx},SeriesData.prototype.getDimensionInfo=function(dim){return this._getDimInfo(this.getDimension(dim))},SeriesData.prototype._initGetDimensionInfo=function(needsHasOwn){var dimensionInfos=this._dimInfos;this._getDimInfo=needsHasOwn?function(dimName){return dimensionInfos.hasOwnProperty(dimName)?dimensionInfos[dimName]:void 0}:function(dimName){return dimensionInfos[dimName]}},SeriesData.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},SeriesData.prototype.mapDimension=function(coordDim,idx){var dimensionsSummary=this._dimSummary;if(null==idx)return dimensionsSummary.encodeFirstDimNotExtra[coordDim];dimensionsSummary=dimensionsSummary.encode[coordDim];return dimensionsSummary?dimensionsSummary[idx]:null},SeriesData.prototype.mapDimensionsAll=function(coordDim){return(this._dimSummary.encode[coordDim]||[]).slice()},SeriesData.prototype.getStore=function(){return this._store},SeriesData.prototype.initData=function(data,nameList,dimValueGetter){var store,dimensions,_this=this;(store=data instanceof DataStore?data:store)||(dimensions=this.dimensions,data=isSourceInstance(data)||isArrayLike(data)?new DefaultDataProvider(data,dimensions.length):data,store=new DataStore,dimensions=map$1(dimensions,function(dimName){return{type:_this._dimInfos[dimName].type,property:dimName}}),store.initData(data,dimensions,dimValueGetter)),this._store=store,this._nameList=(nameList||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,store.count()),this._dimSummary=summarizeDimensions(this,this._schema),this.userOutput=this._dimSummary.userOutput},SeriesData.prototype.appendData=function(data){data=this._store.appendData(data);this._doInit(data[0],data[1])},SeriesData.prototype.appendValues=function(values,names){var values=this._store.appendValues(values,names.length),start=values.start,end=values.end,shouldMakeIdFromName=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),names)for(var idx=start;idx<end;idx++)this._nameList[idx]=names[idx-start],shouldMakeIdFromName&&makeIdFromName(this,idx)},SeriesData.prototype._updateOrdinalMeta=function(){for(var store=this._store,dimensions=this.dimensions,i=0;i<dimensions.length;i++){var dimInfo=this._dimInfos[dimensions[i]];dimInfo.ordinalMeta&&store.collectOrdinalMeta(dimInfo.storeDimIndex,dimInfo.ordinalMeta)}},SeriesData.prototype._shouldMakeIdFromName=function(){var provider=this._store.getProvider();return null==this._idDimIdx&&provider.getSource().sourceFormat!==SOURCE_FORMAT_TYPED_ARRAY&&!provider.fillStorage},SeriesData.prototype._doInit=function(start,end){if(!(end<=start)){var provider=this._store.getProvider(),nameList=(this._updateOrdinalMeta(),this._nameList),idList=this._idList;if(provider.getSource().sourceFormat===SOURCE_FORMAT_ORIGINAL&&!provider.pure)for(var sharedDataItem=[],idx=start;idx<end;idx++){var itemName,dataItem=provider.getItem(idx,sharedDataItem);!this.hasItemOption&&function(dataItem){return isObject(dataItem)&&!(dataItem instanceof Array)}(dataItem)&&(this.hasItemOption=!0),dataItem&&(itemName=dataItem.name,null==nameList[idx]&&null!=itemName&&(nameList[idx]=convertOptionIdName(itemName,null)),itemName=dataItem.id,null==idList[idx]&&null!=itemName&&(idList[idx]=convertOptionIdName(itemName,null)))}if(this._shouldMakeIdFromName())for(idx=start;idx<end;idx++)makeIdFromName(this,idx);prepareInvertedIndex(this)}},SeriesData.prototype.getApproximateExtent=function(dim){return this._approximateExtent[dim]||this._store.getDataExtent(this._getStoreDimIndex(dim))},SeriesData.prototype.setApproximateExtent=function(extent,dim){dim=this.getDimension(dim),this._approximateExtent[dim]=extent.slice()},SeriesData.prototype.getCalculationInfo=function(key){return this._calculationInfo[key]},SeriesData.prototype.setCalculationInfo=function(key,value){isObject$2(key)?extend(this._calculationInfo,key):this._calculationInfo[key]=value},SeriesData.prototype.getName=function(idx){var idx=this.getRawIndex(idx),name=this._nameList[idx];return name=null==(name=null==name&&null!=this._nameDimIdx?getIdNameFromStore(this,this._nameDimIdx,idx):name)?"":name},SeriesData.prototype._getCategory=function(dimIdx,idx){idx=this._store.get(dimIdx,idx),dimIdx=this._store.getOrdinalMeta(dimIdx);return dimIdx?dimIdx.categories[idx]:idx},SeriesData.prototype.getId=function(idx){return getId(this,this.getRawIndex(idx))},SeriesData.prototype.count=function(){return this._store.count()},SeriesData.prototype.get=function(dim,idx){var store=this._store,dim=this._dimInfos[dim];if(dim)return store.get(dim.storeDimIndex,idx)},SeriesData.prototype.getByRawIndex=function(dim,rawIdx){var store=this._store,dim=this._dimInfos[dim];if(dim)return store.getByRawIndex(dim.storeDimIndex,rawIdx)},SeriesData.prototype.getIndices=function(){return this._store.getIndices()},SeriesData.prototype.getDataExtent=function(dim){return this._store.getDataExtent(this._getStoreDimIndex(dim))},SeriesData.prototype.getSum=function(dim){return this._store.getSum(this._getStoreDimIndex(dim))},SeriesData.prototype.getMedian=function(dim){return this._store.getMedian(this._getStoreDimIndex(dim))},SeriesData.prototype.getValues=function(dimensions,idx){var _this=this,store=this._store;return isArray(dimensions)?store.getValues(map$1(dimensions,function(dim){return _this._getStoreDimIndex(dim)}),idx):store.getValues(dimensions)},SeriesData.prototype.hasValue=function(idx){for(var dataDimIndicesOnCoord=this._dimSummary.dataDimIndicesOnCoord,i=0,len=dataDimIndicesOnCoord.length;i<len;i++)if(isNaN(this._store.get(dataDimIndicesOnCoord[i],idx)))return!1;return!0},SeriesData.prototype.indexOfName=function(name){for(var i=0,len=this._store.count();i<len;i++)if(this.getName(i)===name)return i;return-1},SeriesData.prototype.getRawIndex=function(idx){return this._store.getRawIndex(idx)},SeriesData.prototype.indexOfRawIndex=function(rawIndex){return this._store.indexOfRawIndex(rawIndex)},SeriesData.prototype.rawIndexOf=function(dim,value){dim=dim&&this._invertedIndicesMap[dim];if(!dim)throw new Error("Do not supported yet");dim=dim[value];return null==dim||isNaN(dim)?-1:dim},SeriesData.prototype.indicesOfNearest=function(dim,value,maxDistance){return this._store.indicesOfNearest(this._getStoreDimIndex(dim),value,maxDistance)},SeriesData.prototype.each=function(dims,cb,ctx){isFunction(dims)&&(ctx=cb,cb=dims,dims=[]);ctx=ctx||this,dims=map$1(normalizeDimensions(dims),this._getStoreDimIndex,this);this._store.each(dims,ctx?bind(cb,ctx):cb)},SeriesData.prototype.filterSelf=function(dims,cb,ctx){isFunction(dims)&&(ctx=cb,cb=dims,dims=[]);ctx=ctx||this,dims=map$1(normalizeDimensions(dims),this._getStoreDimIndex,this);return this._store=this._store.filter(dims,ctx?bind(cb,ctx):cb),this},SeriesData.prototype.selectRange=function(range){var _this=this,innerRange={},dims=keys(range),dimIndices=[];return each(dims,function(dim){var dimIdx=_this._getStoreDimIndex(dim);innerRange[dimIdx]=range[dim],dimIndices.push(dimIdx)}),this._store=this._store.selectRange(innerRange),this},SeriesData.prototype.mapArray=function(dims,cb,ctx){isFunction(dims)&&(ctx=cb,cb=dims,dims=[]);var result=[];return this.each(dims,function(){result.push(cb&&cb.apply(this,arguments))},ctx=ctx||this),result},SeriesData.prototype.map=function(dims,cb,ctx,ctxCompat){ctx=ctx||ctxCompat||this,ctxCompat=map$1(normalizeDimensions(dims),this._getStoreDimIndex,this),dims=cloneListForMapAndSample(this);return dims._store=this._store.map(ctxCompat,ctx?bind(cb,ctx):cb),dims},SeriesData.prototype.modify=function(dims,cb,ctx,ctxCompat){var _this=this,ctx=ctx||ctxCompat||this,ctxCompat=(each(normalizeDimensions(dims),function(dim){_this.getDimensionInfo(dim).isCalculationCoord||console.error("Danger: only stack dimension can be modified")}),map$1(normalizeDimensions(dims),this._getStoreDimIndex,this));this._store.modify(ctxCompat,ctx?bind(cb,ctx):cb)},SeriesData.prototype.downSample=function(dimension,rate,sampleValue,sampleIndex){var list=cloneListForMapAndSample(this);return list._store=this._store.downSample(this._getStoreDimIndex(dimension),rate,sampleValue,sampleIndex),list},SeriesData.prototype.lttbDownSample=function(valueDimension,rate){var list=cloneListForMapAndSample(this);return list._store=this._store.lttbDownSample(this._getStoreDimIndex(valueDimension),rate),list},SeriesData.prototype.getRawDataItem=function(idx){return this._store.getRawDataItem(idx)},SeriesData.prototype.getItemModel=function(idx){var hostModel=this.hostModel,idx=this.getRawDataItem(idx);return new Model(idx,hostModel,hostModel&&hostModel.ecModel)},SeriesData.prototype.diff=function(otherList){var thisList=this;return new DataDiffer(otherList?otherList.getStore().getIndices():[],this.getStore().getIndices(),function(idx){return getId(otherList,idx)},function(idx){return getId(thisList,idx)})},SeriesData.prototype.getVisual=function(key){var visual=this._visual;return visual&&visual[key]},SeriesData.prototype.setVisual=function(kvObj,val){this._visual=this._visual||{},isObject$2(kvObj)?extend(this._visual,kvObj):this._visual[kvObj]=val},SeriesData.prototype.getItemVisual=function(idx,key){idx=this._itemVisuals[idx],idx=idx&&idx[key];return null==idx?this.getVisual(key):idx},SeriesData.prototype.hasItemVisual=function(){return 0<this._itemVisuals.length},SeriesData.prototype.ensureUniqueItemVisual=function(idx,key){var itemVisuals=this._itemVisuals,itemVisual=itemVisuals[idx],itemVisuals=(itemVisual=itemVisual||(itemVisuals[idx]={}))[key];return null==itemVisuals&&(isArray(itemVisuals=this.getVisual(key))?itemVisuals=itemVisuals.slice():isObject$2(itemVisuals)&&(itemVisuals=extend({},itemVisuals)),itemVisual[key]=itemVisuals),itemVisuals},SeriesData.prototype.setItemVisual=function(idx,key,value){var itemVisual=this._itemVisuals[idx]||{};this._itemVisuals[idx]=itemVisual,isObject$2(key)?extend(itemVisual,key):itemVisual[key]=value},SeriesData.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},SeriesData.prototype.setLayout=function(key,val){isObject$2(key)?extend(this._layout,key):this._layout[key]=val},SeriesData.prototype.getLayout=function(key){return this._layout[key]},SeriesData.prototype.getItemLayout=function(idx){return this._itemLayouts[idx]},SeriesData.prototype.setItemLayout=function(idx,layout,merge$$1){this._itemLayouts[idx]=merge$$1?extend(this._itemLayouts[idx]||{},layout):layout},SeriesData.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},SeriesData.prototype.setItemGraphicEl=function(idx,el){!function(seriesIndex,dataType,dataIdx,el){var ecData;el&&((ecData=getECData(el)).dataIndex=dataIdx,ecData.dataType=dataType,ecData.seriesIndex=seriesIndex,"group"===el.type&&el.traverse(function(child){child=getECData(child);child.seriesIndex=seriesIndex,child.dataIndex=dataIdx,child.dataType=dataType}))}(this.hostModel&&this.hostModel.seriesIndex,this.dataType,idx,el),this._graphicEls[idx]=el},SeriesData.prototype.getItemGraphicEl=function(idx){return this._graphicEls[idx]},SeriesData.prototype.eachItemGraphicEl=function(cb,context){each(this._graphicEls,function(el,idx){el&&cb&&cb.call(context,el,idx)})},SeriesData.prototype.cloneShallow=function(list){return list=list||new SeriesData(this._schema||map$1(this.dimensions,this._getDimInfo,this),this.hostModel),transferProperties(list,this),list._store=this._store,list},SeriesData.prototype.wrapMethod=function(methodName,injectFunction){var originalMethod=this[methodName];isFunction(originalMethod)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(methodName),this[methodName]=function(){var res=originalMethod.apply(this,arguments);return injectFunction.apply(this,[res].concat(slice(arguments)))})},SeriesData.internalField=(prepareInvertedIndex=function(data){var invertedIndicesMap=data._invertedIndicesMap;each(invertedIndicesMap,function(invertedIndices,dim){var dimInfo=data._dimInfos[dim],ordinalMeta=dimInfo.ordinalMeta,store=data._store;if(ordinalMeta){invertedIndices=invertedIndicesMap[dim]=new CtorInt32Array$1(ordinalMeta.categories.length);for(var i=0;i<invertedIndices.length;i++)invertedIndices[i]=-1;for(i=0;i<store.count();i++)invertedIndices[store.get(dimInfo.storeDimIndex,i)]=i}})},getIdNameFromStore=function(data,dimIdx,idx){return convertOptionIdName(data._getCategory(dimIdx,idx),null)},getId=function(data,rawIndex){var id=data._idList[rawIndex];return id=null==(id=null==id&&null!=data._idDimIdx?getIdNameFromStore(data,data._idDimIdx,rawIndex):id)?"e\0\0"+rawIndex:id},normalizeDimensions=function(dimensions){return dimensions=isArray(dimensions)?dimensions:null!=dimensions?[dimensions]:[]},cloneListForMapAndSample=function(original){var list=new SeriesData(original._schema||map$1(original.dimensions,original._getDimInfo,original),original.hostModel);return transferProperties(list,original),list},transferProperties=function(target,source){each(TRANSFERABLE_PROPERTIES.concat(source.__wrappedMethods||[]),function(propName){source.hasOwnProperty(propName)&&(target[propName]=source[propName])}),target.__wrappedMethods=source.__wrappedMethods,each(CLONE_PROPERTIES,function(propName){target[propName]=clone(source[propName])}),target._calculationInfo=extend({},source._calculationInfo)},void(makeIdFromName=function(data,idx){var nameList=data._nameList,idList=data._idList,nameDimIdx=data._nameDimIdx,idDimIdx=data._idDimIdx,name=nameList[idx],id=idList[idx];null==name&&null!=nameDimIdx&&(nameList[idx]=name=getIdNameFromStore(data,nameDimIdx,idx)),null==id&&null!=idDimIdx&&(idList[idx]=id=getIdNameFromStore(data,idDimIdx,idx)),null==id&&null!=name&&(id=name,1<(nameDimIdx=(nameList=data._nameRepeatCount)[name]=(nameList[name]||0)+1)&&(id+="__ec__"+nameDimIdx),idList[idx]=id)})),SeriesData}();function prepareSeriesDataSchema(source,opt){isSourceInstance(source)||(source=createSourceFromSeriesDataOption(source));for(var sysDims=(opt=opt||{}).coordDimensions||[],dimsDef=opt.dimensionsDefine||source.dimensionsDefine||[],coordDimNameMap=createHashMap(),resultList=[],dimCount=function(source,sysDims,dimsDef,optDimCount){var dimCount=Math.max(source.dimensionsDetectedCount||1,sysDims.length,dimsDef.length,optDimCount||0);return each(sysDims,function(sysDimItem){isObject(sysDimItem)&&(sysDimItem=sysDimItem.dimsDef)&&(dimCount=Math.max(dimCount,sysDimItem.length))}),dimCount}(source,sysDims,dimsDef,opt.dimensionsCount),omitUnusedDimensions=opt.canOmitUnusedDimensions&&30<dimCount,isUsingSourceDimensionsDef=dimsDef===source.dimensionsDefine,dataDimNameMap=isUsingSourceDimensionsDef?ensureSourceDimNameMap(source):createDimNameMap(dimsDef),encodeDef=opt.encodeDefine,encodeDefMap=createHashMap(encodeDef=!encodeDef&&opt.encodeDefaulter?opt.encodeDefaulter(source,dimCount):encodeDef),indicesMap=new CtorInt32Array(dimCount),i=0;i<indicesMap.length;i++)indicesMap[i]=-1;function getResultItem(dimIdx){var dimDefItemRaw,resultItem,userDimName,idx=indicesMap[dimIdx];return idx<0?(dimDefItemRaw=isObject(dimDefItemRaw=dimsDef[dimIdx])?dimDefItemRaw:{name:dimDefItemRaw},resultItem=new SeriesDimensionDefine,null!=(userDimName=dimDefItemRaw.name)&&null!=dataDimNameMap.get(userDimName)&&(resultItem.name=resultItem.displayName=userDimName),null!=dimDefItemRaw.type&&(resultItem.type=dimDefItemRaw.type),null!=dimDefItemRaw.displayName&&(resultItem.displayName=dimDefItemRaw.displayName),userDimName=resultList.length,indicesMap[dimIdx]=userDimName,resultItem.storeDimIndex=dimIdx,resultList.push(resultItem),resultItem):resultList[idx]}if(!omitUnusedDimensions)for(i=0;i<dimCount;i++)getResultItem(i);encodeDefMap.each(function(dataDimsRaw,coordDim){var validDataDims,dataDimsRaw=normalizeToArray(dataDimsRaw).slice();1===dataDimsRaw.length&&!isString(dataDimsRaw[0])&&dataDimsRaw[0]<0?encodeDefMap.set(coordDim,!1):(validDataDims=encodeDefMap.set(coordDim,[]),each(dataDimsRaw,function(resultDimIdxOrName,idx){resultDimIdxOrName=isString(resultDimIdxOrName)?dataDimNameMap.get(resultDimIdxOrName):resultDimIdxOrName;null!=resultDimIdxOrName&&resultDimIdxOrName<dimCount&&applyDim(getResultItem(validDataDims[idx]=resultDimIdxOrName),coordDim,idx)}))});var availDimIdx=0;function applyDim(resultItem,coordDim,coordDimIndex){null!=VISUAL_DIMENSIONS.get(coordDim)?resultItem.otherDims[coordDim]=coordDimIndex:(resultItem.coordDim=coordDim,resultItem.coordDimIndex=coordDimIndex,coordDimNameMap.set(coordDim,!0))}each(sysDims,function(sysDimItemRaw){isString(sysDimItemRaw)?(coordDim=sysDimItemRaw,sysDimItem={}):(coordDim=(sysDimItem=sysDimItemRaw).name,sysDimItemRaw=sysDimItem.ordinalMeta,sysDimItem.ordinalMeta=null,(sysDimItem=extend({},sysDimItem)).ordinalMeta=sysDimItemRaw,sysDimItemDimsDef=sysDimItem.dimsDef,sysDimItemOtherDims=sysDimItem.otherDims,sysDimItem.name=sysDimItem.coordDim=sysDimItem.coordDimIndex=sysDimItem.dimsDef=sysDimItem.otherDims=null);var sysDimItemDimsDef,sysDimItemOtherDims,sysDimItem,coordDim,dataDims=encodeDefMap.get(coordDim);if(!1!==dataDims){if(!(dataDims=normalizeToArray(dataDims)).length)for(var i=0;i<(sysDimItemDimsDef&&sysDimItemDimsDef.length||1);i++){for(;availDimIdx<dimCount&&null!=getResultItem(availDimIdx).coordDim;)availDimIdx++;availDimIdx<dimCount&&dataDims.push(availDimIdx++)}each(dataDims,function(resultDimIdx,coordDimIndex){resultDimIdx=getResultItem(resultDimIdx);isUsingSourceDimensionsDef&&null!=sysDimItem.type&&(resultDimIdx.type=sysDimItem.type),applyDim(defaults(resultDimIdx,sysDimItem),coordDim,coordDimIndex),null==resultDimIdx.name&&sysDimItemDimsDef&&(isObject(coordDimIndex=sysDimItemDimsDef[coordDimIndex])||(coordDimIndex={name:coordDimIndex}),resultDimIdx.name=resultDimIdx.displayName=coordDimIndex.name,resultDimIdx.defaultTooltip=coordDimIndex.defaultTooltip),sysDimItemOtherDims&&defaults(resultDimIdx.otherDims,sysDimItemOtherDims)})}});var generateCoord=opt.generateCoord,fromZero=null!=(generateCoordCount=opt.generateCoordCount),generateCoordCount=generateCoord?generateCoordCount||1:0,extra=generateCoord||"value";function ifNoNameFillWithCoordName(resultItem){null==resultItem.name&&(resultItem.name=resultItem.coordDim)}if(omitUnusedDimensions)each(resultList,function(resultItem){ifNoNameFillWithCoordName(resultItem)}),resultList.sort(function(item0,item1){return item0.storeDimIndex-item1.storeDimIndex});else for(var resultDimIdx=0;resultDimIdx<dimCount;resultDimIdx++){var resultItem=getResultItem(resultDimIdx);null==resultItem.coordDim&&(resultItem.coordDim=function(name,map$$1,fromZero){var mapData=map$$1.data;if(fromZero||mapData.hasOwnProperty(name)){for(var i=0;mapData.hasOwnProperty(name+i);)i++;name+=i}return map$$1.set(name,!0),name}(extra,coordDimNameMap,fromZero),resultItem.coordDimIndex=0,(!generateCoord||generateCoordCount<=0)&&(resultItem.isExtraCoord=!0),generateCoordCount--),ifNoNameFillWithCoordName(resultItem),null!=resultItem.type||guessOrdinal(source,resultDimIdx)!==BE_ORDINAL.Must&&(!resultItem.isExtraCoord||null==resultItem.otherDims.itemName&&null==resultItem.otherDims.seriesName)||(resultItem.type="ordinal")}return function(result){for(var duplicationMap=createHashMap(),i=0;i<result.length;i++){var dim=result[i],dimOriginalName=dim.name,count=duplicationMap.get(dimOriginalName)||0;0<count&&(dim.name=dimOriginalName+(count-1)),count++,duplicationMap.set(dimOriginalName,count)}}(resultList),new SeriesDataSchema({source:source,dimensions:resultList,fullDimensionCount:dimCount,dimensionOmitted:omitUnusedDimensions})}var CoordSysInfo=function(coordSysName){this.coordSysDims=[],this.axisMap=createHashMap(),this.categoryAxisMap=createHashMap(),this.coordSysName=coordSysName};var fetchers={cartesian2d:function(seriesModel,result,axisMap,categoryAxisMap){var xAxisModel=seriesModel.getReferringComponents("xAxis",SINGLE_REFERRING).models[0],yAxisModel=seriesModel.getReferringComponents("yAxis",SINGLE_REFERRING).models[0];if(!xAxisModel)throw new Error('xAxis "'+retrieve(seriesModel.get("xAxisIndex"),seriesModel.get("xAxisId"),0)+'" not found');if(!yAxisModel)throw new Error('yAxis "'+retrieve(seriesModel.get("xAxisIndex"),seriesModel.get("yAxisId"),0)+'" not found');result.coordSysDims=["x","y"],axisMap.set("x",xAxisModel),axisMap.set("y",yAxisModel),isCategory(xAxisModel)&&(categoryAxisMap.set("x",xAxisModel),result.firstCategoryDimIndex=0),isCategory(yAxisModel)&&(categoryAxisMap.set("y",yAxisModel),null==result.firstCategoryDimIndex&&(result.firstCategoryDimIndex=1))},singleAxis:function(seriesModel,result,axisMap,categoryAxisMap){seriesModel=seriesModel.getReferringComponents("singleAxis",SINGLE_REFERRING).models[0];if(!seriesModel)throw new Error("singleAxis should be specified.");result.coordSysDims=["single"],axisMap.set("single",seriesModel),isCategory(seriesModel)&&(categoryAxisMap.set("single",seriesModel),result.firstCategoryDimIndex=0)},polar:function(seriesModel,result,axisMap,categoryAxisMap){var seriesModel=seriesModel.getReferringComponents("polar",SINGLE_REFERRING).models[0],radiusAxisModel=seriesModel.findAxisModel("radiusAxis"),seriesModel=seriesModel.findAxisModel("angleAxis");if(!seriesModel)throw new Error("angleAxis option not found");if(!radiusAxisModel)throw new Error("radiusAxis option not found");result.coordSysDims=["radius","angle"],axisMap.set("radius",radiusAxisModel),axisMap.set("angle",seriesModel),isCategory(radiusAxisModel)&&(categoryAxisMap.set("radius",radiusAxisModel),result.firstCategoryDimIndex=0),isCategory(seriesModel)&&(categoryAxisMap.set("angle",seriesModel),null==result.firstCategoryDimIndex&&(result.firstCategoryDimIndex=1))},geo:function(seriesModel,result,axisMap,categoryAxisMap){result.coordSysDims=["lng","lat"]},parallel:function(seriesModel,result,axisMap,categoryAxisMap){var ecModel=seriesModel.ecModel,seriesModel=ecModel.getComponent("parallel",seriesModel.get("parallelIndex")),coordSysDims=result.coordSysDims=seriesModel.dimensions.slice();each(seriesModel.parallelAxisIndex,function(axisIndex,index){var axisIndex=ecModel.getComponent("parallelAxis",axisIndex),axisDim=coordSysDims[index];axisMap.set(axisDim,axisIndex),isCategory(axisIndex)&&(categoryAxisMap.set(axisDim,axisIndex),null==result.firstCategoryDimIndex&&(result.firstCategoryDimIndex=index))})}};function isCategory(axisModel){return"category"===axisModel.get("type")}function enableDataStack(seriesModel,dimensionsInput,opt){var dimensionDefineList,schema,store,stackedByDimInfo,stackedDimInfo,stackResultDimension,stackedOverDimension,stackedDimCoordDim_1,stackedDimCoordIndex_1,byIndex=(opt=opt||{}).byIndex,stackedCoordDimension=opt.stackedCoordDimension,mayStack=(!function(dimensionsInput){return!isSeriesDataSchema(dimensionsInput.schema)}(dimensionsInput)?(schema=dimensionsInput.schema,dimensionDefineList=schema.dimensions,store=dimensionsInput.store):dimensionDefineList=dimensionsInput,!(!seriesModel||!seriesModel.get("stack")));return each(dimensionDefineList,function(dimensionInfo,index){isString(dimensionInfo)&&(dimensionDefineList[index]=dimensionInfo={name:dimensionInfo}),mayStack&&!dimensionInfo.isExtraCoord&&(byIndex||stackedByDimInfo||!dimensionInfo.ordinalMeta||(stackedByDimInfo=dimensionInfo),stackedDimInfo||"ordinal"===dimensionInfo.type||"time"===dimensionInfo.type||stackedCoordDimension&&stackedCoordDimension!==dimensionInfo.coordDim||(stackedDimInfo=dimensionInfo))}),!stackedDimInfo||byIndex||stackedByDimInfo||(byIndex=!0),stackedDimInfo&&(stackResultDimension="__\0ecstackresult_"+seriesModel.id,stackedOverDimension="__\0ecstackedover_"+seriesModel.id,stackedByDimInfo&&(stackedByDimInfo.createInvertedIndices=!0),stackedDimCoordDim_1=stackedDimInfo.coordDim,opt=stackedDimInfo.type,stackedDimCoordIndex_1=0,each(dimensionDefineList,function(dimensionInfo){dimensionInfo.coordDim===stackedDimCoordDim_1&&stackedDimCoordIndex_1++}),dimensionsInput={name:stackResultDimension,coordDim:stackedDimCoordDim_1,coordDimIndex:stackedDimCoordIndex_1,type:opt,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:dimensionDefineList.length},seriesModel={name:stackedOverDimension,coordDim:stackedOverDimension,coordDimIndex:stackedDimCoordIndex_1+1,type:opt,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:dimensionDefineList.length+1},schema?(store&&(dimensionsInput.storeDimIndex=store.ensureCalculationDimension(stackedOverDimension,opt),seriesModel.storeDimIndex=store.ensureCalculationDimension(stackResultDimension,opt)),schema.appendCalculationDimension(dimensionsInput),schema.appendCalculationDimension(seriesModel)):(dimensionDefineList.push(dimensionsInput),dimensionDefineList.push(seriesModel))),{stackedDimension:stackedDimInfo&&stackedDimInfo.name,stackedByDimension:stackedByDimInfo&&stackedByDimInfo.name,isStackedByIndex:byIndex,stackedOverDimension:stackedOverDimension,stackResultDimension:stackResultDimension}}function isDimensionStacked(data,stackedDim){return!!stackedDim&&stackedDim===data.getCalculationInfo("stackedDimension")}function getStackedDimension(data,targetDim){return isDimensionStacked(data,targetDim)?data.getCalculationInfo("stackResultDimension"):targetDim}function getCoordSysDimDefs(seriesModel,coordSysInfo){var coordSysDimDefs,seriesModel=seriesModel.get("coordinateSystem"),seriesModel=CoordinateSystemManager.get(seriesModel);return coordSysDimDefs=(coordSysDimDefs=coordSysInfo&&coordSysInfo.coordSysDims?map(coordSysInfo.coordSysDims,function(dim){var dimInfo={name:dim},dim=coordSysInfo.axisMap.get(dim);return dim&&(dim=dim.get("type"),dimInfo.type=function(axisType){return"category"===axisType?"ordinal":"time"===axisType?"time":"float"}(dim)),dimInfo}):coordSysDimDefs)||(seriesModel&&(seriesModel.getDimensionsInfo?seriesModel.getDimensionsInfo():seriesModel.dimensions.slice())||["x","y"])}function createSeriesData(sourceRaw,seriesModel,opt){opt=opt||{};var source,sourceManager=seriesModel.getSourceManager(),isOriginalSource=!1,sourceRaw=(sourceRaw?(isOriginalSource=!0,source=createSourceFromSeriesDataOption(sourceRaw)):isOriginalSource=(source=sourceManager.getSource()).sourceFormat===SOURCE_FORMAT_ORIGINAL,function(seriesModel){var coordSysName=seriesModel.get("coordinateSystem"),result=new CoordSysInfo(coordSysName);if(coordSysName=fetchers[coordSysName])return coordSysName(seriesModel,result,result.axisMap,result.categoryAxisMap),result}(seriesModel)),coordSysDimDefs=getCoordSysDimDefs(seriesModel,sourceRaw),useEncodeDefaulter=opt.useEncodeDefaulter,useEncodeDefaulter=isFunction(useEncodeDefaulter)?useEncodeDefaulter:useEncodeDefaulter?curry(makeSeriesEncodeForAxisCoordSys,coordSysDimDefs,seriesModel):null,coordSysDimDefs=prepareSeriesDataSchema(source,{coordDimensions:coordSysDimDefs,generateCoord:opt.generateCoord,encodeDefine:seriesModel.getEncode(),encodeDefaulter:useEncodeDefaulter,canOmitUnusedDimensions:!isOriginalSource}),firstCategoryDimIndex=function(dimInfoList,createInvertedIndices,coordSysInfo){var firstCategoryDimIndex,hasNameEncode;return coordSysInfo&&each(dimInfoList,function(dimInfo,dimIndex){var coordDim=dimInfo.coordDim,coordDim=coordSysInfo.categoryAxisMap.get(coordDim);coordDim&&(null==firstCategoryDimIndex&&(firstCategoryDimIndex=dimIndex),dimInfo.ordinalMeta=coordDim.getOrdinalMeta(),createInvertedIndices&&(dimInfo.createInvertedIndices=!0)),null!=dimInfo.otherDims.itemName&&(hasNameEncode=!0)}),hasNameEncode||null==firstCategoryDimIndex||(dimInfoList[firstCategoryDimIndex].otherDims.itemName=0),firstCategoryDimIndex}(coordSysDimDefs.dimensions,opt.createInvertedIndices,sourceRaw),useEncodeDefaulter=isOriginalSource?null:sourceManager.getSharedDataStore(coordSysDimDefs),opt=enableDataStack(seriesModel,{schema:coordSysDimDefs,store:useEncodeDefaulter}),sourceRaw=new SeriesData(coordSysDimDefs,seriesModel),sourceManager=(sourceRaw.setCalculationInfo(opt),null!=firstCategoryDimIndex&&function(source){if(source.sourceFormat===SOURCE_FORMAT_ORIGINAL)return!isArray(getDataItemValue(function(arr){var i=0;for(;i<arr.length&&null==arr[i];)i++;return arr[i]}(source.data||[])))}(source)?function(itemOpt,dimName,dataIndex,dimIndex){return dimIndex===firstCategoryDimIndex?dataIndex:this.defaultDimValueGetter(itemOpt,dimName,dataIndex,dimIndex)}:null);return sourceRaw.hasItemOption=!1,sourceRaw.initData(isOriginalSource?source:useEncodeDefaulter,null,sourceManager),sourceRaw}var Scale=function(){function Scale(setting){this._setting=setting||{},this._extent=[1/0,-1/0]}return Scale.prototype.getSetting=function(name){return this._setting[name]},Scale.prototype.unionExtent=function(other){var extent=this._extent;other[0]<extent[0]&&(extent[0]=other[0]),other[1]>extent[1]&&(extent[1]=other[1])},Scale.prototype.unionExtentFromData=function(data,dim){this.unionExtent(data.getApproximateExtent(dim))},Scale.prototype.getExtent=function(){return this._extent.slice()},Scale.prototype.setExtent=function(start,end){var thisExtent=this._extent;isNaN(start)||(thisExtent[0]=start),isNaN(end)||(thisExtent[1]=end)},Scale.prototype.isInExtentRange=function(value){return this._extent[0]<=value&&this._extent[1]>=value},Scale.prototype.isBlank=function(){return this._isBlank},Scale.prototype.setBlank=function(isBlank){this._isBlank=isBlank},Scale}(),uidBase=(enableClassManagement(Scale),0),OrdinalMeta=function(){function OrdinalMeta(opt){this.categories=opt.categories||[],this._needCollect=opt.needCollect,this._deduplication=opt.deduplication,this.uid=++uidBase}return OrdinalMeta.createByAxisModel=function(axisModel){var axisModel=axisModel.option,data=axisModel.data,data=data&&map(data,getName);return new OrdinalMeta({categories:data,needCollect:!data,deduplication:!1!==axisModel.dedplication})},OrdinalMeta.prototype.getOrdinal=function(category){return this._getOrCreateMap().get(category)},OrdinalMeta.prototype.parseAndCollect=function(category){var needCollect=this._needCollect;if(!isString(category)&&!needCollect)return category;if(needCollect&&!this._deduplication)return index=this.categories.length,this.categories[index]=category,index;var index,map$$1=this._getOrCreateMap();return null==(index=map$$1.get(category))&&(needCollect?(index=this.categories.length,this.categories[index]=category,map$$1.set(category,index)):index=NaN),index},OrdinalMeta.prototype._getOrCreateMap=function(){return this._map||(this._map=createHashMap(this.categories))},OrdinalMeta}();function getName(obj){return isObject(obj)&&null!=obj.value?obj.value:obj+""}function isIntervalOrLogScale(scale){return"interval"===scale.type||"log"===scale.type}function intervalScaleNiceTicks(extent,splitNumber,minInterval,maxInterval){var result={},span=extent[1]-extent[0],span=result.interval=nice(span/splitNumber,!0),splitNumber=(null!=minInterval&&span<minInterval&&(span=result.interval=minInterval),null!=maxInterval&&maxInterval<span&&(span=result.interval=maxInterval),result.intervalPrecision=getIntervalPrecision(span));return function(niceTickExtent,extent){isFinite(niceTickExtent[0])||(niceTickExtent[0]=extent[0]),isFinite(niceTickExtent[1])||(niceTickExtent[1]=extent[1]),clamp(niceTickExtent,0,extent),clamp(niceTickExtent,1,extent),niceTickExtent[0]>niceTickExtent[1]&&(niceTickExtent[0]=niceTickExtent[1])}(result.niceTickExtent=[round(Math.ceil(extent[0]/span)*span,splitNumber),round(Math.floor(extent[1]/span)*span,splitNumber)],extent),result}function increaseInterval(interval){var exp10=Math.pow(10,quantityExponent(interval)),interval=interval/exp10;return interval?2===interval?interval=3:3===interval?interval=5:interval*=2:interval=1,round(interval*exp10)}function getIntervalPrecision(interval){return getPrecision(interval)+2}function clamp(niceTickExtent,idx,extent){niceTickExtent[idx]=Math.max(Math.min(niceTickExtent[idx],extent[1]),extent[0])}function contain$1(val,extent){return val>=extent[0]&&val<=extent[1]}function normalize$1(val,extent){return extent[1]===extent[0]?.5:(val-extent[0])/(extent[1]-extent[0])}function scale$2(val,extent){return val*(extent[1]-extent[0])+extent[0]}var OrdinalScale=function(_super){function OrdinalScale(setting){var setting=_super.call(this,setting)||this,ordinalMeta=(setting.type="ordinal",setting.getSetting("ordinalMeta"));return isArray(ordinalMeta=ordinalMeta||new OrdinalMeta({}))&&(ordinalMeta=new OrdinalMeta({categories:map(ordinalMeta,function(item){return isObject(item)?item.value:item})})),setting._ordinalMeta=ordinalMeta,setting._extent=setting.getSetting("extent")||[0,ordinalMeta.categories.length-1],setting}return __extends(OrdinalScale,_super),OrdinalScale.prototype.parse=function(val){return isString(val)?this._ordinalMeta.getOrdinal(val):Math.round(val)},OrdinalScale.prototype.contain=function(rank){return contain$1(rank=this.parse(rank),this._extent)&&null!=this._ordinalMeta.categories[rank]},OrdinalScale.prototype.normalize=function(val){return normalize$1(val=this._getTickNumber(this.parse(val)),this._extent)},OrdinalScale.prototype.scale=function(val){return val=Math.round(scale$2(val,this._extent)),this.getRawOrdinalNumber(val)},OrdinalScale.prototype.getTicks=function(){for(var ticks=[],extent=this._extent,rank=extent[0];rank<=extent[1];)ticks.push({value:rank}),rank++;return ticks},OrdinalScale.prototype.getMinorTicks=function(splitNumber){},OrdinalScale.prototype.setSortInfo=function(info){if(null==info)this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null;else{for(var infoOrdinalNumbers=info.ordinalNumbers,ordinalsByTick=this._ordinalNumbersByTick=[],ticksByOrdinal=this._ticksByOrdinalNumber=[],tickNum=0,allCategoryLen=this._ordinalMeta.categories.length,len=Math.min(allCategoryLen,infoOrdinalNumbers.length);tickNum<len;++tickNum){var ordinalNumber=infoOrdinalNumbers[tickNum];ticksByOrdinal[ordinalsByTick[tickNum]=ordinalNumber]=tickNum}for(var unusedOrdinal=0;tickNum<allCategoryLen;++tickNum){for(;null!=ticksByOrdinal[unusedOrdinal];)unusedOrdinal++;ordinalsByTick.push(unusedOrdinal),ticksByOrdinal[unusedOrdinal]=tickNum}}},OrdinalScale.prototype._getTickNumber=function(ordinal){var ticksByOrdinalNumber=this._ticksByOrdinalNumber;return ticksByOrdinalNumber&&0<=ordinal&&ordinal<ticksByOrdinalNumber.length?ticksByOrdinalNumber[ordinal]:ordinal},OrdinalScale.prototype.getRawOrdinalNumber=function(tickNumber){var ordinalNumbersByTick=this._ordinalNumbersByTick;return ordinalNumbersByTick&&0<=tickNumber&&tickNumber<ordinalNumbersByTick.length?ordinalNumbersByTick[tickNumber]:tickNumber},OrdinalScale.prototype.getLabel=function(tick){if(!this.isBlank())return tick=this.getRawOrdinalNumber(tick.value),null==(tick=this._ordinalMeta.categories[tick])?"":tick+""},OrdinalScale.prototype.count=function(){return this._extent[1]-this._extent[0]+1},OrdinalScale.prototype.unionExtentFromData=function(data,dim){this.unionExtent(data.getApproximateExtent(dim))},OrdinalScale.prototype.isInExtentRange=function(value){return value=this._getTickNumber(value),this._extent[0]<=value&&this._extent[1]>=value},OrdinalScale.prototype.getOrdinalMeta=function(){return this._ordinalMeta},OrdinalScale.prototype.calcNiceTicks=function(){},OrdinalScale.prototype.calcNiceExtent=function(){},OrdinalScale.type="ordinal",OrdinalScale}(Scale),roundNumber=(Scale.registerClass(OrdinalScale),round),IntervalScale=function(_super){function IntervalScale(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type="interval",_this._interval=0,_this._intervalPrecision=2,_this}return __extends(IntervalScale,_super),IntervalScale.prototype.parse=function(val){return val},IntervalScale.prototype.contain=function(val){return contain$1(val,this._extent)},IntervalScale.prototype.normalize=function(val){return normalize$1(val,this._extent)},IntervalScale.prototype.scale=function(val){return scale$2(val,this._extent)},IntervalScale.prototype.setExtent=function(start,end){var thisExtent=this._extent;isNaN(start)||(thisExtent[0]=parseFloat(start)),isNaN(end)||(thisExtent[1]=parseFloat(end))},IntervalScale.prototype.unionExtent=function(other){var extent=this._extent;other[0]<extent[0]&&(extent[0]=other[0]),other[1]>extent[1]&&(extent[1]=other[1]),this.setExtent(extent[0],extent[1])},IntervalScale.prototype.getInterval=function(){return this._interval},IntervalScale.prototype.setInterval=function(interval){this._interval=interval,this._niceExtent=this._extent.slice(),this._intervalPrecision=getIntervalPrecision(interval)},IntervalScale.prototype.getTicks=function(expandToNicedExtent){var interval=this._interval,extent=this._extent,niceTickExtent=this._niceExtent,intervalPrecision=this._intervalPrecision,ticks=[];if(!interval)return ticks;extent[0]<niceTickExtent[0]&&(expandToNicedExtent?ticks.push({value:roundNumber(niceTickExtent[0]-interval,intervalPrecision)}):ticks.push({value:extent[0]}));for(var tick=niceTickExtent[0];tick<=niceTickExtent[1]&&(ticks.push({value:tick}),(tick=roundNumber(tick+interval,intervalPrecision))!==ticks[ticks.length-1].value);)if(1e4<ticks.length)return[];var lastNiceTick=ticks.length?ticks[ticks.length-1].value:niceTickExtent[1];return extent[1]>lastNiceTick&&(expandToNicedExtent?ticks.push({value:roundNumber(lastNiceTick+interval,intervalPrecision)}):ticks.push({value:extent[1]})),ticks},IntervalScale.prototype.getMinorTicks=function(splitNumber){for(var ticks=this.getTicks(!0),minorTicks=[],extent=this.getExtent(),i=1;i<ticks.length;i++){for(var nextTick=ticks[i],prevTick=ticks[i-1],count=0,minorTicksGroup=[],minorInterval=(nextTick.value-prevTick.value)/splitNumber;count<splitNumber-1;){var minorTick=roundNumber(prevTick.value+(count+1)*minorInterval);minorTick>extent[0]&&minorTick<extent[1]&&minorTicksGroup.push(minorTick),count++}minorTicks.push(minorTicksGroup)}return minorTicks},IntervalScale.prototype.getLabel=function(data,opt){if(null==data)return"";opt=opt&&opt.precision;return null==opt?opt=getPrecision(data.value)||0:"auto"===opt&&(opt=this._intervalPrecision),addCommas(roundNumber(data.value,opt,!0))},IntervalScale.prototype.calcNiceTicks=function(splitNumber,minInterval,maxInterval){splitNumber=splitNumber||5;var extent=this._extent,span=extent[1]-extent[0];isFinite(span)&&(span<0&&extent.reverse(),span=intervalScaleNiceTicks(extent,splitNumber,minInterval,maxInterval),this._intervalPrecision=span.intervalPrecision,this._interval=span.interval,this._niceExtent=span.niceTickExtent)},IntervalScale.prototype.calcNiceExtent=function(opt){var extent=this._extent,expandSize=(extent[0]===extent[1]&&(0!==extent[0]?(expandSize=extent[0],opt.fixMax||(extent[1]+=expandSize/2),extent[0]-=expandSize/2):extent[1]=1),extent[1]-extent[0]),expandSize=(isFinite(expandSize)||(extent[0]=0,extent[1]=1),this.calcNiceTicks(opt.splitNumber,opt.minInterval,opt.maxInterval),this._interval);opt.fixMin||(extent[0]=roundNumber(Math.floor(extent[0]/expandSize)*expandSize)),opt.fixMax||(extent[1]=roundNumber(Math.ceil(extent[1]/expandSize)*expandSize))},IntervalScale.prototype.setNiceExtent=function(min,max){this._niceExtent=[min,max]},IntervalScale.type="interval",IntervalScale}(Scale),supportFloat32Array=(Scale.registerClass(IntervalScale),"undefined"!=typeof Float32Array),Float32ArrayCtor=supportFloat32Array?Float32Array:Array;function createFloat32Array(arg){return isArray(arg)?supportFloat32Array?new Float32Array(arg):arg:new Float32ArrayCtor(arg)}var STACK_PREFIX="__ec_stack_";function getSeriesStackId(seriesModel){return seriesModel.get("stack")||STACK_PREFIX+seriesModel.seriesIndex}function getAxisKey(axis){return axis.dim+axis.index}function prepareLayoutBarSeries(seriesType,ecModel){var seriesModels=[];return ecModel.eachSeriesByType(seriesType,function(seriesModel){isOnCartesian(seriesModel)&&seriesModels.push(seriesModel)}),seriesModels}function makeColumnLayout(barSeries){var axisMinGaps=function(barSeries){var key,axisValues={},axisMinGaps=(each(barSeries,function(seriesModel){var baseAxis=seriesModel.coordinateSystem.getBaseAxis();if("time"===baseAxis.type||"value"===baseAxis.type)for(var seriesModel=seriesModel.getData(),key=baseAxis.dim+"_"+baseAxis.index,dimIdx=seriesModel.getDimensionIndex(seriesModel.mapDimension(baseAxis.dim)),store=seriesModel.getStore(),i=0,cnt=store.count();i<cnt;++i){var value=store.get(dimIdx,i);axisValues[key]?axisValues[key].push(value):axisValues[key]=[value]}}),{});for(key in axisValues)if(axisValues.hasOwnProperty(key)){var valuesInAxis=axisValues[key];if(valuesInAxis){valuesInAxis.sort(function(a,b){return a-b});for(var min=null,j=1;j<valuesInAxis.length;++j){var delta=valuesInAxis[j]-valuesInAxis[j-1];0<delta&&(min=null===min?delta:Math.min(min,delta))}axisMinGaps[key]=min}}return axisMinGaps}(barSeries),seriesInfoList=[];return each(barSeries,function(seriesModel){var key,baseAxis=seriesModel.coordinateSystem.getBaseAxis(),axisExtent=baseAxis.getExtent(),extentSpan=(key="category"===baseAxis.type?baseAxis.getBandWidth():"value"===baseAxis.type||"time"===baseAxis.type?(key=baseAxis.dim+"_"+baseAxis.index,key=axisMinGaps[key],extentSpan=Math.abs(axisExtent[1]-axisExtent[0]),scale=baseAxis.scale.getExtent(),scale=Math.abs(scale[1]-scale[0]),key?extentSpan/scale*key:extentSpan):(scale=seriesModel.getData(),Math.abs(axisExtent[1]-axisExtent[0])/scale.count()),parsePercent$1(seriesModel.get("barWidth"),key)),axisExtent=parsePercent$1(seriesModel.get("barMaxWidth"),key),scale=parsePercent$1(seriesModel.get("barMinWidth")||(isInLargeMode(seriesModel)?.5:1),key),barGap=seriesModel.get("barGap"),barCategoryGap=seriesModel.get("barCategoryGap");seriesInfoList.push({bandWidth:key,barWidth:extentSpan,barMaxWidth:axisExtent,barMinWidth:scale,barGap:barGap,barCategoryGap:barCategoryGap,axisKey:getAxisKey(baseAxis),stackId:getSeriesStackId(seriesModel)})}),function(seriesInfoList){var columnsMap={},result=(each(seriesInfoList,function(seriesInfo,idx){var axisKey=seriesInfo.axisKey,bandWidth=seriesInfo.bandWidth,bandWidth=columnsMap[axisKey]||{bandWidth:bandWidth,remainedWidth:bandWidth,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},stacks=bandWidth.stacks,axisKey=(columnsMap[axisKey]=bandWidth,seriesInfo.stackId),barWidth=(stacks[axisKey]||bandWidth.autoWidthCount++,stacks[axisKey]=stacks[axisKey]||{width:0,maxWidth:0},seriesInfo.barWidth),barWidth=(barWidth&&!stacks[axisKey].width&&(stacks[axisKey].width=barWidth,barWidth=Math.min(bandWidth.remainedWidth,barWidth),bandWidth.remainedWidth-=barWidth),seriesInfo.barMaxWidth),barWidth=(barWidth&&(stacks[axisKey].maxWidth=barWidth),seriesInfo.barMinWidth),stacks=(barWidth&&(stacks[axisKey].minWidth=barWidth),seriesInfo.barGap),axisKey=(null!=stacks&&(bandWidth.gap=stacks),seriesInfo.barCategoryGap);null!=axisKey&&(bandWidth.categoryGap=axisKey)}),{});return each(columnsMap,function(columnsOnAxis,coordSysName){result[coordSysName]={};var lastColumn,stacks=columnsOnAxis.stacks,bandWidth=columnsOnAxis.bandWidth,categoryGapPercent=columnsOnAxis.categoryGap,columnCount=(null==categoryGapPercent&&(columnCount=keys(stacks).length,categoryGapPercent=Math.max(35-4*columnCount,15)+"%"),parsePercent$1(categoryGapPercent,bandWidth)),barGapPercent=parsePercent$1(columnsOnAxis.gap,1),remainedWidth=columnsOnAxis.remainedWidth,autoWidthCount=columnsOnAxis.autoWidthCount,autoWidth=(remainedWidth-columnCount)/(autoWidthCount+(autoWidthCount-1)*barGapPercent),autoWidth=Math.max(autoWidth,0),widthSum=(each(stacks,function(column){var finalWidth,maxWidth=column.maxWidth,minWidth=column.minWidth;column.width?(finalWidth=column.width,maxWidth&&(finalWidth=Math.min(finalWidth,maxWidth)),minWidth&&(finalWidth=Math.max(finalWidth,minWidth)),column.width=finalWidth,remainedWidth-=finalWidth+barGapPercent*finalWidth,autoWidthCount--):(finalWidth=autoWidth,maxWidth&&maxWidth<finalWidth&&(finalWidth=Math.min(maxWidth,remainedWidth)),(finalWidth=minWidth&&finalWidth<minWidth?minWidth:finalWidth)!==autoWidth&&(column.width=finalWidth,remainedWidth-=finalWidth+barGapPercent*finalWidth,autoWidthCount--))}),autoWidth=(remainedWidth-columnCount)/(autoWidthCount+(autoWidthCount-1)*barGapPercent),autoWidth=Math.max(autoWidth,0),0),offset=(each(stacks,function(column,idx){column.width||(column.width=autoWidth),widthSum+=(lastColumn=column).width*(1+barGapPercent)}),lastColumn&&(widthSum-=lastColumn.width*barGapPercent),-widthSum/2);each(stacks,function(column,stackId){result[coordSysName][stackId]=result[coordSysName][stackId]||{bandWidth:bandWidth,offset:offset,width:column.width},offset+=column.width*(1+barGapPercent)})}),result}(seriesInfoList)}function layout(seriesType,ecModel){var seriesType=prepareLayoutBarSeries(seriesType,ecModel),barWidthAndOffset=makeColumnLayout(seriesType);each(seriesType,function(seriesModel){var data=seriesModel.getData(),baseAxis=seriesModel.coordinateSystem.getBaseAxis(),seriesModel=getSeriesStackId(seriesModel),baseAxis=barWidthAndOffset[getAxisKey(baseAxis)][seriesModel],seriesModel=baseAxis.offset,columnWidth=baseAxis.width;data.setLayout({bandWidth:baseAxis.bandWidth,offset:seriesModel,size:columnWidth})})}function createProgressiveLayout(seriesType){return{seriesType:seriesType,plan:createRenderPlanner(),reset:function(seriesModel){var data,cartesian,valueAxis,valueDimIdx,baseDimIdx,drawBackground,baseAxis,stackResultDim,stacked,isValueAxisH,valueAxisStart,isLarge,barMinHeight,stackedDimIdx,columnWidth,columnOffset;if(isOnCartesian(seriesModel))return data=seriesModel.getData(),cartesian=seriesModel.coordinateSystem,baseAxis=cartesian.getBaseAxis(),valueAxis=cartesian.getOtherAxis(baseAxis),valueDimIdx=data.getDimensionIndex(data.mapDimension(valueAxis.dim)),baseDimIdx=data.getDimensionIndex(data.mapDimension(baseAxis.dim)),drawBackground=seriesModel.get("showBackground",!0),baseAxis=data.mapDimension(valueAxis.dim),stackResultDim=data.getCalculationInfo("stackResultDimension"),stacked=isDimensionStacked(data,baseAxis)&&!!data.getCalculationInfo("stackedOnSeries"),isValueAxisH=valueAxis.isHorizontal(),valueAxisStart=function(valueAxis){return valueAxis.toGlobalCoord(valueAxis.dataToCoord("log"===valueAxis.type?1:0))}(valueAxis),isLarge=isInLargeMode(seriesModel),barMinHeight=seriesModel.get("barMinHeight")||0,stackedDimIdx=stackResultDim&&data.getDimensionIndex(stackResultDim),columnWidth=data.getLayout("size"),columnOffset=data.getLayout("offset"),{progress:function(params,data){for(var dataIndex,count=params.count,largePoints=isLarge&&createFloat32Array(3*count),largeBackgroundPoints=isLarge&&drawBackground&&createFloat32Array(3*count),largeDataIndices=isLarge&&createFloat32Array(count),coordLayout=cartesian.master.getRect(),bgSize=isValueAxisH?coordLayout.width:coordLayout.height,store=data.getStore(),idxOffset=0;null!=(dataIndex=params.next());){var coord,value=store.get(stacked?stackedDimIdx:valueDimIdx,dataIndex),baseValue=store.get(baseDimIdx,dataIndex),baseCoord=valueAxisStart,startValue=void 0,x=(stacked&&(startValue=+value-store.get(valueDimIdx,dataIndex)),void 0),y=void 0,width=void 0,height=void 0;isValueAxisH?(coord=cartesian.dataToPoint([value,baseValue]),x=baseCoord=stacked?cartesian.dataToPoint([startValue,baseValue])[0]:baseCoord,y=coord[1]+columnOffset,width=coord[0]-baseCoord,height=columnWidth,Math.abs(width)<barMinHeight&&(width=(width<0?-1:1)*barMinHeight)):(coord=cartesian.dataToPoint([baseValue,value]),stacked&&(baseCoord=cartesian.dataToPoint([baseValue,startValue])[1]),x=coord[0]+columnOffset,y=baseCoord,width=columnWidth,height=coord[1]-baseCoord,Math.abs(height)<barMinHeight&&(height=(height<=0?-1:1)*barMinHeight)),isLarge?(largePoints[idxOffset]=x,largePoints[idxOffset+1]=y,largePoints[idxOffset+2]=isValueAxisH?width:height,largeBackgroundPoints&&(largeBackgroundPoints[idxOffset]=isValueAxisH?coordLayout.x:x,largeBackgroundPoints[idxOffset+1]=isValueAxisH?y:coordLayout.y,largeBackgroundPoints[idxOffset+2]=bgSize),largeDataIndices[dataIndex]=dataIndex):data.setItemLayout(dataIndex,{x:x,y:y,width:width,height:height}),idxOffset+=3}isLarge&&data.setLayout({largePoints:largePoints,largeDataIndices:largeDataIndices,largeBackgroundPoints:largeBackgroundPoints,valueAxisHorizontal:isValueAxisH})}}}}}function isOnCartesian(seriesModel){return seriesModel.coordinateSystem&&"cartesian2d"===seriesModel.coordinateSystem.type}function isInLargeMode(seriesModel){return seriesModel.pipelineContext&&seriesModel.pipelineContext.large}var TimeScale=function(_super){function TimeScale(settings){settings=_super.call(this,settings)||this;return settings.type="time",settings}return __extends(TimeScale,_super),TimeScale.prototype.getLabel=function(tick){var useUTC=this.getSetting("useUTC");return format(tick.value,fullLeveledFormatter[function(timeUnit){switch(timeUnit){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}(getPrimaryTimeUnit(this._minLevelUnit))]||fullLeveledFormatter.second,useUTC,this.getSetting("locale"))},TimeScale.prototype.getFormattedLabel=function(tick,idx,labelFormatter){var isUTC=this.getSetting("useUTC");return function(tick,idx,formatter,lang,isUTC){var template=null;if(isString(formatter))template=formatter;else if(isFunction(formatter))template=formatter(tick.value,idx,{level:tick.level});else{var defaults$$1=extend({},defaultLeveledFormatter);if(0<tick.level)for(var i=0;i<primaryTimeUnits.length;++i)defaults$$1[primaryTimeUnits[i]]="{primary|"+defaults$$1[primaryTimeUnits[i]]+"}";var mergedFormatter=formatter?!1===formatter.inherit?formatter:defaults(formatter,defaults$$1):defaults$$1,unit=getUnitFromValue(tick.value,isUTC);if(mergedFormatter[unit])template=mergedFormatter[unit];else if(mergedFormatter.inherit){for(i=timeUnits.indexOf(unit)-1;0<=i;--i)if(mergedFormatter[unit]){template=mergedFormatter[unit];break}template=template||defaults$$1.none}isArray(template)&&(idx=null==tick.level?0:0<=tick.level?tick.level:template.length+tick.level,template=template[idx=Math.min(idx,template.length-1)])}return format(new Date(tick.value),template,isUTC,lang)}(tick,idx,labelFormatter,this.getSetting("locale"),isUTC)},TimeScale.prototype.getTicks=function(){var interval=this._interval,extent=this._extent,ticks=[];if(!interval)return ticks;ticks.push({value:extent[0],level:0});interval=this.getSetting("useUTC"),interval=function(bottomUnitName,approxInterval,isUTC,extent){var unitNames=timeUnits,iter=0;function addLevelTicks(unitName,lastLevelTicks,levelTicks){var newAddedTicks=[],isFirstLevel=!lastLevelTicks.length;if(!function(unit,valueA,valueB,isUTC){function isSame(unit){return getUnitValue(dateA,unit,isUTC)===getUnitValue(dateB,unit,isUTC)}function isSameYear(){return isSame("year")}function isSameMonth(){return isSameYear()&&isSame("month")}function isSameDay(){return isSameMonth()&&isSame("day")}function isSameHour(){return isSameDay()&&isSame("hour")}function isSameMinute(){return isSameHour()&&isSame("minute")}function isSameSecond(){return isSameMinute()&&isSame("second")}var dateA=parseDate(valueA),dateB=parseDate(valueB);switch(unit){case"year":return isSameYear();case"month":return isSameMonth();case"day":return isSameDay();case"hour":return isSameHour();case"minute":return isSameMinute();case"second":return isSameSecond();case"millisecond":return isSameSecond()&&isSame("millisecond")}}(getPrimaryTimeUnit(unitName),extent[0],extent[1],isUTC)){isFirstLevel&&(lastLevelTicks=[{value:function(date,unitName,isUTC){var outDate=new Date(date);switch(getPrimaryTimeUnit(unitName)){case"year":case"month":outDate[monthSetterName(isUTC)](0);case"day":outDate[dateSetterName(isUTC)](1);case"hour":outDate[hoursSetterName(isUTC)](0);case"minute":outDate[minutesSetterName(isUTC)](0);case"second":outDate[secondsSetterName(isUTC)](0),outDate[millisecondsSetterName(isUTC)](0)}return outDate.getTime()}(new Date(extent[0]),unitName,isUTC)},{value:extent[1]}]);for(var i=0;i<lastLevelTicks.length-1;i++){var startTick=lastLevelTicks[i].value,endTick=lastLevelTicks[i+1].value;if(startTick!==endTick){var interval=void 0,getterName=void 0,setterName=void 0;switch(unitName){case"year":interval=Math.max(1,Math.round(approxInterval/ONE_DAY/365)),getterName=fullYearGetterName(isUTC),setterName=isUTC?"setUTCFullYear":"setFullYear";break;case"half-year":case"quarter":case"month":interval=function(approxInterval){return 6<(approxInterval/=30*ONE_DAY)?6:3<approxInterval?3:2<approxInterval?2:1}(approxInterval),getterName=monthGetterName(isUTC),setterName=monthSetterName(isUTC);break;case"week":case"half-week":case"day":interval=function(approxInterval){return 16<(approxInterval/=ONE_DAY)?16:7.5<approxInterval?7:3.5<approxInterval?4:1.5<approxInterval?2:1}(approxInterval),getterName=dateGetterName(isUTC),setterName=dateSetterName(isUTC),0;break;case"half-day":case"quarter-day":case"hour":interval=function(approxInterval){return 12<(approxInterval/=ONE_HOUR)?12:6<approxInterval?6:3.5<approxInterval?4:2<approxInterval?2:1}(approxInterval),getterName=hoursGetterName(isUTC),setterName=hoursSetterName(isUTC);break;case"minute":interval=getMinutesAndSecondsInterval(approxInterval,!0),getterName=minutesGetterName(isUTC),setterName=minutesSetterName(isUTC);break;case"second":interval=getMinutesAndSecondsInterval(approxInterval,!1),getterName=secondsGetterName(isUTC),setterName=secondsSetterName(isUTC);break;case"millisecond":interval=function(approxInterval){return nice(approxInterval,!0)}(approxInterval),getterName=millisecondsGetterName(isUTC),setterName=millisecondsSetterName(isUTC)}!function(interval,minTimestamp,maxTimestamp,getMethodName,setMethodName,out){for(var date=new Date(minTimestamp),dateTime=minTimestamp,d=date[getMethodName]();dateTime<maxTimestamp&&dateTime<=extent[1];)out.push({value:dateTime}),date[setMethodName](d+=interval),dateTime=date.getTime();out.push({value:dateTime,notAdd:!0})}(interval,startTick,endTick,getterName,setterName,newAddedTicks),"year"===unitName&&1<levelTicks.length&&0===i&&levelTicks.unshift({value:levelTicks[0].value-interval})}}for(i=0;i<newAddedTicks.length;i++)levelTicks.push(newAddedTicks[i])}}for(var levelsTicks=[],currentLevelTicks=[],tickCount=0,lastLevelTickCount=0,i=0;i<unitNames.length&&iter++<1e4;++i){var primaryTimeUnit=getPrimaryTimeUnit(unitNames[i]);if(function(timeUnit){return timeUnit===getPrimaryTimeUnit(timeUnit)}(unitNames[i])){addLevelTicks(unitNames[i],levelsTicks[levelsTicks.length-1]||[],currentLevelTicks);var nextPrimaryTimeUnit=unitNames[i+1]?getPrimaryTimeUnit(unitNames[i+1]):null;if(primaryTimeUnit!==nextPrimaryTimeUnit){if(currentLevelTicks.length){lastLevelTickCount=tickCount,currentLevelTicks.sort(function(a,b){return a.value-b.value});for(var levelTicksRemoveDuplicated=[],i_1=0;i_1<currentLevelTicks.length;++i_1){var tickValue=currentLevelTicks[i_1].value;0!==i_1&&currentLevelTicks[i_1-1].value===tickValue||(levelTicksRemoveDuplicated.push(currentLevelTicks[i_1]),tickValue>=extent[0]&&tickValue<=extent[1]&&tickCount++)}primaryTimeUnit=(extent[1]-extent[0])/approxInterval;if(1.5*primaryTimeUnit<tickCount&&primaryTimeUnit/1.5<lastLevelTickCount)break;if(levelsTicks.push(levelTicksRemoveDuplicated),primaryTimeUnit<tickCount||bottomUnitName===unitNames[i])break}currentLevelTicks=[]}}}1e4<=iter&&warn("Exceed safe limit.");for(var levelsTicksInExtent=filter(map(levelsTicks,function(levelTicks){return filter(levelTicks,function(tick){return tick.value>=extent[0]&&tick.value<=extent[1]&&!tick.notAdd})}),function(levelTicks){return 0<levelTicks.length}),ticks=[],maxLevel=levelsTicksInExtent.length-1,i=0;i<levelsTicksInExtent.length;++i)for(var levelTicks=levelsTicksInExtent[i],k=0;k<levelTicks.length;++k)ticks.push({value:levelTicks[k].value,level:maxLevel-i});ticks.sort(function(a,b){return a.value-b.value});for(var result=[],i=0;i<ticks.length;++i)0!==i&&ticks[i].value===ticks[i-1].value||result.push(ticks[i]);return result}(this._minLevelUnit,this._approxInterval,interval,extent);return(ticks=ticks.concat(interval)).push({value:extent[1],level:0}),ticks},TimeScale.prototype.calcNiceExtent=function(opt){var d,extent=this._extent;extent[0]===extent[1]&&(extent[0]-=ONE_DAY,extent[1]+=ONE_DAY),extent[1]===-1/0&&extent[0]===1/0&&(d=new Date,extent[1]=+new Date(d.getFullYear(),d.getMonth(),d.getDate()),extent[0]=extent[1]-ONE_DAY),this.calcNiceTicks(opt.splitNumber,opt.minInterval,opt.maxInterval)},TimeScale.prototype.calcNiceTicks=function(approxTickNum,minInterval,maxInterval){var extent=this._extent,extent=extent[1]-extent[0],extent=(this._approxInterval=extent/(approxTickNum=approxTickNum||10),null!=minInterval&&this._approxInterval<minInterval&&(this._approxInterval=minInterval),null!=maxInterval&&this._approxInterval>maxInterval&&(this._approxInterval=maxInterval),scaleIntervals.length),approxTickNum=Math.min(function(a,x,lo,hi){for(;lo<hi;){var mid=lo+hi>>>1;a[mid][1]<x?lo=1+mid:hi=mid}return lo}(scaleIntervals,this._approxInterval,0,extent),extent-1);this._interval=scaleIntervals[approxTickNum][1],this._minLevelUnit=scaleIntervals[Math.max(approxTickNum-1,0)][0]},TimeScale.prototype.parse=function(val){return isNumber(val)?val:+parseDate(val)},TimeScale.prototype.contain=function(val){return contain$1(this.parse(val),this._extent)},TimeScale.prototype.normalize=function(val){return normalize$1(this.parse(val),this._extent)},TimeScale.prototype.scale=function(val){return scale$2(val,this._extent)},TimeScale.type="time",TimeScale}(IntervalScale),scaleIntervals=[["second",ONE_SECOND],["minute",ONE_MINUTE],["hour",ONE_HOUR],["quarter-day",6*ONE_HOUR],["half-day",12*ONE_HOUR],["day",1.2*ONE_DAY],["half-week",3.5*ONE_DAY],["week",7*ONE_DAY],["month",31*ONE_DAY],["quarter",95*ONE_DAY],["half-year",classBase/2],["year",classBase]];function getMinutesAndSecondsInterval(approxInterval,isMinutes){return 30<(approxInterval/=isMinutes?ONE_MINUTE:ONE_SECOND)?30:20<approxInterval?20:15<approxInterval?15:10<approxInterval?10:5<approxInterval?5:2<approxInterval?2:1}Scale.registerClass(TimeScale);var scaleProto=Scale.prototype,intervalScaleProto=IntervalScale.prototype,roundingErrorFix=round,mathFloor=Math.floor,mathCeil=Math.ceil,mathPow$1=Math.pow,mathLog=Math.log,LogScale=function(_super){function LogScale(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type="log",_this.base=10,_this._originalScale=new IntervalScale,_this._interval=0,_this}return __extends(LogScale,_super),LogScale.prototype.getTicks=function(expandToNicedExtent){var originalScale=this._originalScale,extent=this._extent,originalExtent=originalScale.getExtent();return map(intervalScaleProto.getTicks.call(this,expandToNicedExtent),function(tick){var tick=tick.value,powVal=round(mathPow$1(this.base,tick)),powVal=tick===extent[0]&&this._fixMin?fixRoundingError(powVal,originalExtent[0]):powVal;return{value:powVal=tick===extent[1]&&this._fixMax?fixRoundingError(powVal,originalExtent[1]):powVal}},this)},LogScale.prototype.setExtent=function(start,end){var base=this.base;start=mathLog(start)/mathLog(base),end=mathLog(end)/mathLog(base),intervalScaleProto.setExtent.call(this,start,end)},LogScale.prototype.getExtent=function(){var base=this.base,extent=scaleProto.getExtent.call(this);extent[0]=mathPow$1(base,extent[0]),extent[1]=mathPow$1(base,extent[1]);base=this._originalScale.getExtent();return this._fixMin&&(extent[0]=fixRoundingError(extent[0],base[0])),this._fixMax&&(extent[1]=fixRoundingError(extent[1],base[1])),extent},LogScale.prototype.unionExtent=function(extent){this._originalScale.unionExtent(extent);var base=this.base;extent[0]=mathLog(extent[0])/mathLog(base),extent[1]=mathLog(extent[1])/mathLog(base),scaleProto.unionExtent.call(this,extent)},LogScale.prototype.unionExtentFromData=function(data,dim){this.unionExtent(data.getApproximateExtent(dim))},LogScale.prototype.calcNiceTicks=function(approxTickNum){approxTickNum=approxTickNum||10;var extent=this._extent,span=extent[1]-extent[0];if(!(span==1/0||span<=0)){var interval=quantity(span);for(approxTickNum/span*interval<=.5&&(interval*=10);!isNaN(interval)&&Math.abs(interval)<1&&0<Math.abs(interval);)interval*=10;approxTickNum=[round(mathCeil(extent[0]/interval)*interval),round(mathFloor(extent[1]/interval)*interval)];this._interval=interval,this._niceExtent=approxTickNum}},LogScale.prototype.calcNiceExtent=function(opt){intervalScaleProto.calcNiceExtent.call(this,opt),this._fixMin=opt.fixMin,this._fixMax=opt.fixMax},LogScale.prototype.parse=function(val){return val},LogScale.prototype.contain=function(val){return contain$1(val=mathLog(val)/mathLog(this.base),this._extent)},LogScale.prototype.normalize=function(val){return normalize$1(val=mathLog(val)/mathLog(this.base),this._extent)},LogScale.prototype.scale=function(val){return val=scale$2(val,this._extent),mathPow$1(this.base,val)},LogScale.type="log",LogScale}(Scale),WeakMap=LogScale.prototype;function fixRoundingError(val,originalVal){return roundingErrorFix(val,getPrecision(originalVal))}WeakMap.getMinorTicks=intervalScaleProto.getMinorTicks,WeakMap.getLabel=intervalScaleProto.getLabel,Scale.registerClass(LogScale);var ScaleRawExtentInfo=function(){function ScaleRawExtentInfo(scale,model,originalExtent){this._prepareParams(scale,model,originalExtent)}return ScaleRawExtentInfo.prototype._prepareParams=function(scale,model,dataExtent){dataExtent[1]<dataExtent[0]&&(dataExtent=[NaN,NaN]),this._dataMin=dataExtent[0],this._dataMax=dataExtent[1];var isOrdinal=this._isOrdinal="ordinal"===scale.type,modelMinRaw=(this._needCrossZero="interval"===scale.type&&model.getNeedCrossZero&&model.getNeedCrossZero(),this._modelMinRaw=model.get("min",!0)),modelMinRaw=(isFunction(modelMinRaw)?this._modelMinNum=parseAxisModelMinMax(scale,modelMinRaw({min:dataExtent[0],max:dataExtent[1]})):"dataMin"!==modelMinRaw&&(this._modelMinNum=parseAxisModelMinMax(scale,modelMinRaw)),this._modelMaxRaw=model.get("max",!0));isFunction(modelMinRaw)?this._modelMaxNum=parseAxisModelMinMax(scale,modelMinRaw({min:dataExtent[0],max:dataExtent[1]})):"dataMax"!==modelMinRaw&&(this._modelMaxNum=parseAxisModelMinMax(scale,modelMinRaw)),isOrdinal?this._axisDataLen=model.getCategories().length:"boolean"==typeof(scale=isArray(dataExtent=model.get("boundaryGap"))?dataExtent:[dataExtent||0,dataExtent||0])[0]||"boolean"==typeof scale[1]?(console.warn('Boolean type for boundaryGap is only allowed for ordinal axis. Please use string in percentage instead, e.g., "20%". Currently, boundaryGap is set to be 0.'),this._boundaryGapInner=[0,0]):this._boundaryGapInner=[parsePercent(scale[0],1),parsePercent(scale[1],1)]},ScaleRawExtentInfo.prototype.calculate=function(){var isOrdinal=this._isOrdinal,dataMin=this._dataMin,dataMax=this._dataMax,axisDataLen=this._axisDataLen,boundaryGapInner=this._boundaryGapInner,span=isOrdinal?null:dataMax-dataMin||Math.abs(dataMin),min="dataMin"===this._modelMinRaw?dataMin:this._modelMinNum,max="dataMax"===this._modelMaxRaw?dataMax:this._modelMaxNum,minFixed=null!=min,maxFixed=null!=max,dataMin=(null==min&&(min=isOrdinal?axisDataLen?0:NaN:dataMin-boundaryGapInner[0]*span),null==max&&(max=isOrdinal?axisDataLen?axisDataLen-1:NaN:dataMax+boundaryGapInner[1]*span),null!=min&&isFinite(min)||(min=NaN),null!=max&&isFinite(max)||(max=NaN),eqNaN(min)||eqNaN(max)||isOrdinal&&!axisDataLen),dataMax=(this._needCrossZero&&(min=0<min&&0<max&&!minFixed?0:min)<0&&max<0&&!maxFixed&&(max=0),this._determinedMin),boundaryGapInner=this._determinedMax;return null!=dataMax&&(min=dataMax,minFixed=!0),null!=boundaryGapInner&&(max=boundaryGapInner,maxFixed=!0),{min:min,max:max,minFixed:minFixed,maxFixed:maxFixed,isBlank:dataMin}},ScaleRawExtentInfo.prototype.modifyDataMinMax=function(minMaxName,val){assert(!this.frozen),this[DATA_MIN_MAX_ATTR[minMaxName]]=val},ScaleRawExtentInfo.prototype.setDeterminedMinMax=function(minMaxName,val){minMaxName=DETERMINED_MIN_MAX_ATTR[minMaxName];assert(!this.frozen&&null==this[minMaxName]),this[minMaxName]=val},ScaleRawExtentInfo.prototype.freeze=function(){this.frozen=!0},ScaleRawExtentInfo}(),DETERMINED_MIN_MAX_ATTR={min:"_determinedMin",max:"_determinedMax"},DATA_MIN_MAX_ATTR={min:"_dataMin",max:"_dataMax"};function ensureScaleRawExtentInfo(scale,model,originalExtent){var rawExtentInfo=scale.rawExtentInfo;return rawExtentInfo||(rawExtentInfo=new ScaleRawExtentInfo(scale,model,originalExtent),scale.rawExtentInfo=rawExtentInfo)}function parseAxisModelMinMax(scale,minMax){return null==minMax?null:eqNaN(minMax)?NaN:scale.parse(minMax)}function getScaleExtent(scale,model){var isBaseAxisAndHasBarSeries_1,scaleType=scale.type,rawExtentResult=ensureScaleRawExtentInfo(scale,model,scale.getExtent()).calculate(),scale=(scale.setBlank(rawExtentResult.isBlank),rawExtentResult.min),max=rawExtentResult.max,ecModel=model.ecModel;return ecModel&&"time"===scaleType&&(scaleType=prepareLayoutBarSeries("bar",ecModel),isBaseAxisAndHasBarSeries_1=!1,each(scaleType,function(seriesModel){isBaseAxisAndHasBarSeries_1=isBaseAxisAndHasBarSeries_1||seriesModel.getBaseAxis()===model.axis}),isBaseAxisAndHasBarSeries_1&&(ecModel=makeColumnLayout(scaleType),scale=(scaleType=function(min,max,model,barWidthAndOffset){var axisExtent=model.axis.getExtent(),axisExtent=axisExtent[1]-axisExtent[0],barWidthAndOffset=function(barWidthAndOffset,axis,seriesModel){if(barWidthAndOffset&&axis)return null!=(barWidthAndOffset=barWidthAndOffset[getAxisKey(axis)])&&null!=seriesModel?barWidthAndOffset[getSeriesStackId(seriesModel)]:barWidthAndOffset}(barWidthAndOffset,model.axis);if(void 0===barWidthAndOffset)return{min:min,max:max};var minOverflow=1/0,maxOverflow=(each(barWidthAndOffset,function(item){minOverflow=Math.min(item.offset,minOverflow)}),-1/0),model=(each(barWidthAndOffset,function(item){maxOverflow=Math.max(item.offset+item.width,maxOverflow)}),minOverflow=Math.abs(minOverflow),maxOverflow=Math.abs(maxOverflow),minOverflow+maxOverflow),barWidthAndOffset=max-min,axisExtent=barWidthAndOffset/(1-(minOverflow+maxOverflow)/axisExtent)-barWidthAndOffset;return{min:min-=minOverflow/model*axisExtent,max:max+=maxOverflow/model*axisExtent}}(scale,max,model,ecModel)).min,max=scaleType.max)),{extent:[scale,max],fixMin:rawExtentResult.minFixed,fixMax:rawExtentResult.maxFixed}}function niceScaleExtent(scale,inModel){var extentInfo=getScaleExtent(scale,inModel),extent=extentInfo.extent,splitNumber=inModel.get("splitNumber"),scaleType=(scale instanceof LogScale&&(scale.base=inModel.get("logBase")),scale.type),interval=inModel.get("interval"),scaleType="interval"===scaleType||"time"===scaleType;scale.setExtent(extent[0],extent[1]),scale.calcNiceExtent({splitNumber:splitNumber,fixMin:extentInfo.fixMin,fixMax:extentInfo.fixMax,minInterval:scaleType?inModel.get("minInterval"):null,maxInterval:scaleType?inModel.get("maxInterval"):null}),null!=interval&&scale.setInterval&&scale.setInterval(interval)}function createScaleByModel(model,axisType){if(axisType=axisType||model.get("type"))switch(axisType){case"category":return new OrdinalScale({ordinalMeta:model.getOrdinalMeta?model.getOrdinalMeta():model.getCategories(),extent:[1/0,-1/0]});case"time":return new TimeScale({locale:model.ecModel.getLocaleModel(),useUTC:model.ecModel.get("useUTC")});default:return new(Scale.getClass(axisType)||IntervalScale)}}function makeLabelFormatter(axis){var cb,tpl,labelFormatter=axis.getLabelModel().get("formatter"),categoryTickStart="category"===axis.type?axis.scale.getExtent()[0]:null;return"time"===axis.scale.type?(tpl=labelFormatter,function(tick,idx){return axis.scale.getFormattedLabel(tick,idx,tpl)}):isString(labelFormatter)?function(tpl){return function(tick){tick=axis.scale.getLabel(tick);return tpl.replace("{value}",null!=tick?tick:"")}}(labelFormatter):isFunction(labelFormatter)?(cb=labelFormatter,function(tick,idx){return null!=categoryTickStart&&(idx=tick.value-categoryTickStart),cb(getAxisRawValue(axis,tick),idx,null!=tick.level?{level:tick.level}:null)}):function(tick){return axis.scale.getLabel(tick)}}function getAxisRawValue(axis,tick){return"category"===axis.type?axis.scale.getLabel(tick):tick.value}function estimateLabelUnionRect(axis){var axisModel=axis.model,scale=axis.scale;if(axisModel.get(["axisLabel","show"])&&!scale.isBlank()){var realNumberScaleTicks,rect,categoryScaleExtent=scale.getExtent(),tickCount=scale instanceof OrdinalScale?scale.count():(realNumberScaleTicks=scale.getTicks()).length,axisLabelModel=axis.getLabelModel(),labelFormatter=makeLabelFormatter(axis),step=1;40<tickCount&&(step=Math.ceil(tickCount/40));for(var rotate,beforeWidth,afterWidth,i=0;i<tickCount;i+=step){var label=labelFormatter(realNumberScaleTicks?realNumberScaleTicks[i]:{value:categoryScaleExtent[0]+i},i),label=axisLabelModel.getTextRect(label),beforeHeight=(label=label,rotate=axisLabelModel.get("rotate")||0,beforeWidth=afterWidth=beforeHeight=beforeWidth=void 0,rotate=rotate*Math.PI/180,beforeWidth=label.width,beforeHeight=label.height,afterWidth=beforeWidth*Math.abs(Math.cos(rotate))+Math.abs(beforeHeight*Math.sin(rotate)),beforeWidth=beforeWidth*Math.abs(Math.sin(rotate))+Math.abs(beforeHeight*Math.cos(rotate)),new BoundingRect(label.x,label.y,afterWidth,beforeWidth));rect?rect.union(beforeHeight):rect=beforeHeight}return rect}}function getOptionCategoryInterval(model){model=model.get("interval");return null==model?"auto":model}function shouldShowAllLabels(axis){return"category"===axis.type&&0===getOptionCategoryInterval(axis.getLabelModel())}function getDataDimensionsOnAxis(data,axisDim){var dataDimMap={};return each(data.mapDimensionsAll(axisDim),function(dataDim){dataDimMap[getStackedDimension(data,dataDim)]=!0}),keys(dataDimMap)}var AxisModelCommonMixin=function(){function AxisModelCommonMixin(){}return AxisModelCommonMixin.prototype.getNeedCrossZero=function(){return!this.option.scale},AxisModelCommonMixin.prototype.getCoordSysModel=function(){},AxisModelCommonMixin}();var Pin=(Object.freeze||Object)({createList:function(seriesModel){return createSeriesData(null,seriesModel)},getLayoutRect:getLayoutRect,dataStack:{isDimensionStacked:isDimensionStacked,enableDataStack:enableDataStack,getStackedDimension:getStackedDimension},createScale:function(dataExtent,option){var axisModel=option;return(option=createScaleByModel(axisModel=option instanceof Model?option:new Model(option))).setExtent(dataExtent[0],dataExtent[1]),niceScaleExtent(option,axisModel),option},mixinAxisModelCommonMethods:function(Model$$1){mixin(Model$$1,AxisModelCommonMixin)},getECData:getECData,createTextStyle:function(textStyleModel,opts){return createTextStyle(textStyleModel,null,null,"normal"!==(opts=opts||{}).state)},createDimensions:function(source,opt){return prepareSeriesDataSchema(source,opt).dimensions},createSymbol:createSymbol,enableHoverEmphasis:enableHoverEmphasis}),extensions=[],extensionRegisters={registerPreprocessor:registerPreprocessor,registerProcessor:registerProcessor,registerPostInit:registerPostInit,registerPostUpdate:registerPostUpdate,registerUpdateLifecycle:registerUpdateLifecycle,registerAction:registerAction,registerCoordinateSystem:registerCoordinateSystem,registerLayout:registerLayout,registerVisual:registerVisual,registerTransform:registerTransform,registerLoading:registerLoading,registerMap:registerMap,registerImpl:function(name,impl){implsStore[name]&&error("Already has an implementation of "+name+"."),implsStore[name]=impl},PRIORITY:Diamond,ComponentModel:ComponentModel,ComponentView:ComponentView,SeriesModel:SeriesModel,ChartView:ChartView,registerComponentModel:function(ComponentModelClass){ComponentModel.registerClass(ComponentModelClass)},registerComponentView:function(ComponentViewClass){ComponentView.registerClass(ComponentViewClass)},registerSeriesModel:function(SeriesModelClass){SeriesModel.registerClass(SeriesModelClass)},registerChartView:function(ChartViewClass){ChartView.registerClass(ChartViewClass)},registerSubTypeDefaulter:function(componentType,defaulter){ComponentModel.registerSubTypeDefaulter(componentType,defaulter)},registerPainter:function(painterType,PainterCtor){registerPainter(painterType,PainterCtor)}};function use(ext){isArray(ext)?each(ext,function(singleExt){use(singleExt)}):0<=indexOf(extensions,ext)||(extensions.push(ext),(ext=isFunction(ext)?{install:ext}:ext).install(extensionRegisters))}var EPSILON$4=1e-8;function isAroundEqual$1(a,b){return Math.abs(a-b)<EPSILON$4}function contain$2(points,x,y){var w=0,p=points[0];if(p){for(var i=1;i<points.length;i++){var p2=points[i];w+=windingLine(p[0],p[1],p2[0],p2[1],x,y),p=p2}var p0=points[0];return isAroundEqual$1(p[0],p0[0])&&isAroundEqual$1(p[1],p0[1])||(w+=windingLine(p[0],p[1],p0[0],p0[1],x,y)),0!==w}}var TMP_TRANSFORM=[];function transformPoints(points,transform){for(var p=0;p<points.length;p++)applyTransform(points[p],points[p],transform)}function updateBBoxFromPoints(points,min$$1,max$$1,projection){for(var i=0;i<points.length;i++){var p=points[i];(p=projection?projection.project(p):p)&&isFinite(p[0])&&isFinite(p[1])&&(min(min$$1,min$$1,p),max(max$$1,max$$1,p))}}var Arrow=function(){function Region(name){this.name=name}return Region.prototype.setCenter=function(center){this._center=center},Region.prototype.getCenter=function(){return this._center||(this._center=this.calcCenter())},Region}(),GeoJSONPolygonGeometry=function(exterior,interiors){this.type="polygon",this.exterior=exterior,this.interiors=interiors},GeoJSONLineStringGeometry=function(points){this.type="linestring",this.points=points},GeoJSONRegion=function(_super){function GeoJSONRegion(name,geometries,cp){name=_super.call(this,name)||this;return name.type="geoJSON",name.geometries=geometries,name._center=cp&&[cp[0],cp[1]],name}return __extends(GeoJSONRegion,_super),GeoJSONRegion.prototype.calcCenter=function(){for(var largestGeo,geometries=this.geometries,largestGeoSize=0,i=0;i<geometries.length;i++){var geo=geometries[i],exterior=geo.exterior,exterior=exterior&&exterior.length;largestGeoSize<exterior&&(largestGeo=geo,largestGeoSize=exterior)}if(largestGeo)return function(points){for(var signedArea=0,cx=0,cy=0,len$$1=points.length,x0=points[len$$1-1][0],y0=points[len$$1-1][1],i=0;i<len$$1;i++){var x1=points[i][0],y1=points[i][1],a=x0*y1-x1*y0;signedArea+=a,cx+=(x0+x1)*a,cy+=(y0+y1)*a,x0=x1,y0=y1}return signedArea?[cx/signedArea/3,cy/signedArea/3,signedArea]:[points[0][0]||0,points[0][1]||0]}(largestGeo.exterior);var rect=this.getBoundingRect();return[rect.x+rect.width/2,rect.y+rect.height/2]},GeoJSONRegion.prototype.getBoundingRect=function(projection){var rect=this._rect;if(rect&&!projection)return rect;var min$$1=[1/0,1/0],max$$1=[-1/0,-1/0];return each(this.geometries,function(geo){"polygon"===geo.type?updateBBoxFromPoints(geo.exterior,min$$1,max$$1,projection):each(geo.points,function(points){updateBBoxFromPoints(points,min$$1,max$$1,projection)})}),isFinite(min$$1[0])&&isFinite(min$$1[1])&&isFinite(max$$1[0])&&isFinite(max$$1[1])||(min$$1[0]=min$$1[1]=max$$1[0]=max$$1[1]=0),rect=new BoundingRect(min$$1[0],min$$1[1],max$$1[0]-min$$1[0],max$$1[1]-min$$1[1]),projection||(this._rect=rect),rect},GeoJSONRegion.prototype.contain=function(coord){var rect=this.getBoundingRect(),geometries=this.geometries;if(!rect.contain(coord[0],coord[1]))return!1;loopGeo:for(var i=0,len$$1=geometries.length;i<len$$1;i++){var geo=geometries[i];if("polygon"===geo.type){var exterior=geo.exterior,interiors=geo.interiors;if(contain$2(exterior,coord[0],coord[1])){for(var k=0;k<(interiors?interiors.length:0);k++)if(contain$2(interiors[k],coord[0],coord[1]))continue loopGeo;return!0}}}return!1},GeoJSONRegion.prototype.transformTo=function(x,y,width,height){for(var rect=this.getBoundingRect(),aspect=rect.width/rect.height,aspect=(width?height=height||width/aspect:width=aspect*height,new BoundingRect(x,y,width,height)),transform=rect.calculateTransform(aspect),geometries=this.geometries,i=0;i<geometries.length;i++){var geo=geometries[i];"polygon"===geo.type?(transformPoints(geo.exterior,transform),each(geo.interiors,function(interior){transformPoints(interior,transform)})):each(geo.points,function(points){transformPoints(points,transform)})}(rect=this._rect).copy(aspect),this._center=[rect.x+rect.width/2,rect.y+rect.height/2]},GeoJSONRegion.prototype.cloneShallow=function(name){name=new GeoJSONRegion(name=null==name?this.name:name,this.geometries,this._center);return name._rect=this._rect,name.transformTo=null,name},GeoJSONRegion}(Arrow);!function(_super){function GeoSVGRegion(name,elOnlyForCalculate){name=_super.call(this,name)||this;return name.type="geoSVG",name._elOnlyForCalculate=elOnlyForCalculate,name}__extends(GeoSVGRegion,_super),GeoSVGRegion.prototype.calcCenter=function(){for(var el=this._elOnlyForCalculate,rect=el.getBoundingRect(),rect=[rect.x+rect.width/2,rect.y+rect.height/2],mat=identity(TMP_TRANSFORM),target=el;target&&!target.isGeoSVGGraphicRoot;)mul$1(mat,target.getLocalTransform(),mat),target=target.parent;return invert(mat,mat),applyTransform(rect,rect,mat),rect}}(Arrow);function decodeRings(rings,encodeOffsets,encodeScale){for(var c=0;c<rings.length;c++)rings[c]=decodeRing(rings[c],encodeOffsets[c],encodeScale)}function decodeRing(coordinate,encodeOffsets,encodeScale){for(var result=[],prevX=encodeOffsets[0],prevY=encodeOffsets[1],i=0;i<coordinate.length;i+=2){var x=(x=coordinate.charCodeAt(i)-64)>>1^-(1&x),y=(y=coordinate.charCodeAt(i+1)-64)>>1^-(1&y);x+=prevX,y+=prevY,result.push([(prevX=x)/encodeScale,(prevY=y)/encodeScale])}return result}function parseGeoJSON(geoJson,nameProperty){return map(filter((geoJson=function(json){if(!json.UTF8Encoding)return json;var encodeScale=json.UTF8Scale;return null==encodeScale&&(encodeScale=1024),each(json.features,function(feature){var geometry=feature.geometry,encodeOffsets=geometry.encodeOffsets,coordinates=geometry.coordinates;if(encodeOffsets)switch(geometry.type){case"LineString":geometry.coordinates=decodeRing(coordinates,encodeOffsets,encodeScale);break;case"Polygon":case"MultiLineString":decodeRings(coordinates,encodeOffsets,encodeScale);break;case"MultiPolygon":each(coordinates,function(rings,idx){return decodeRings(rings,encodeOffsets[idx],encodeScale)})}}),json.UTF8Encoding=!1,json}(geoJson)).features,function(featureObj){return featureObj.geometry&&featureObj.properties&&0<featureObj.geometry.coordinates.length}),function(featureObj){var properties=featureObj.properties,geo=featureObj.geometry,geometries=[];switch(geo.type){case"Polygon":var coordinates=geo.coordinates;geometries.push(new GeoJSONPolygonGeometry(coordinates[0],coordinates.slice(1)));break;case"MultiPolygon":each(geo.coordinates,function(item){item[0]&&geometries.push(new GeoJSONPolygonGeometry(item[0],item.slice(1)))});break;case"LineString":geometries.push(new GeoJSONLineStringGeometry([geo.coordinates]));break;case"MultiLineString":geometries.push(new GeoJSONLineStringGeometry(geo.coordinates))}featureObj=new GeoJSONRegion(properties[nameProperty||"name"],geometries,properties.cp);return featureObj.properties=properties,featureObj})}var ItemStyleMixin=(Object.freeze||Object)({linearMap:linearMap,round:round,asc:asc,getPrecision:getPrecision,getPrecisionSafe:getPrecisionSafe,getPixelPrecision:getPixelPrecision,getPercentWithPrecision:function(valueList,idx,precision){if(!valueList[idx])return 0;var sum=reduce(valueList,function(acc,val){return acc+(isNaN(val)?0:val)},0);if(0===sum)return 0;for(var digits=Math.pow(10,precision),precision=map(valueList,function(val){return(isNaN(val)?0:val)/sum*digits*100}),targetSeats=100*digits,seats=map(precision,function(votes){return Math.floor(votes)}),currentSum=reduce(seats,function(acc,val){return acc+val},0),remainder=map(precision,function(votes,idx){return votes-seats[idx]});currentSum<targetSeats;){for(var max=Number.NEGATIVE_INFINITY,maxId=null,i=0,len=remainder.length;i<len;++i)remainder[i]>max&&(max=remainder[i],maxId=i);++seats[maxId],remainder[maxId]=0,++currentSum}return seats[idx]/digits},MAX_SAFE_INTEGER:9007199254740991,remRadian:remRadian,isRadianAroundZero:isRadianAroundZero,parseDate:parseDate,quantity:quantity,quantityExponent:quantityExponent,nice:nice,quantile:function(ascArr,p){var p=(ascArr.length-1)*p+1,h=Math.floor(p),v=+ascArr[h-1];return(p=p-h)?v+p*(ascArr[h]-v):v},reformIntervals:function(list){list.sort(function(a,b){return function littleThan(a,b,lg){return a.interval[lg]<b.interval[lg]||a.interval[lg]===b.interval[lg]&&(a.close[lg]-b.close[lg]==(lg?-1:1)||!lg&&littleThan(a,b,1))}(a,b,0)?-1:1});for(var curr=-1/0,currClose=1,i=0;i<list.length;){for(var interval=list[i].interval,close_1=list[i].close,lg=0;lg<2;lg++)interval[lg]<=curr&&(interval[lg]=curr,close_1[lg]=lg?1:1-currClose),curr=interval[lg],currClose=close_1[lg];interval[0]===interval[1]&&close_1[0]*close_1[1]!=1?list.splice(i,1):i++}return list},isNumeric:isNumeric,numericToNumber:numericToNumber}),AreaStyleMixin=(Object.freeze||Object)({parse:parseDate,format:format}),subPixelOptimize$1=(Object.freeze||Object)({extendShape:extendShape,extendPath:extendPath,makePath:makePath,makeImage:makeImage,mergePath:mergePath,resizePath:resizePath,createIcon:createIcon,updateProps:updateProps,initProps:initProps,getTransform:getTransform,clipPointsByRect:clipPointsByRect,clipRectByRect:clipRectByRect,registerShape:registerShape,getShapeClass:getShapeClass,Group:Group,Image:ZRImage,Text:ZRText,Circle:Circle,Ellipse:Ellipse,Sector:Sector,Ring:Ring,Polygon:Polygon,Polyline:Polyline,Rect:Rect,Line:Line,BezierCurve:BezierCurve,Arc:Arc,IncrementalDisplayable:Element,CompoundPath:CompoundPath,LinearGradient:LinearGradient,RadialGradient:Gradient,BoundingRect:BoundingRect}),target=(Object.freeze||Object)({addCommas:addCommas,toCamelCase:toCamelCase,normalizeCssArray:normalizeCssArray$1,encodeHTML:encodeHTML,formatTpl:formatTpl,getTooltipMarker:getTooltipMarker,formatTime:function(tpl,value,isUTC){deprecateReplaceLog("echarts.format.formatTime","echarts.time.format"),"week"!==tpl&&"month"!==tpl&&"quarter"!==tpl&&"half-year"!==tpl&&"year"!==tpl||(tpl="MM-dd\nyyyy");var y=(value=parseDate(value))[(isUTC=isUTC?"getUTC":"get")+"FullYear"](),M=value[isUTC+"Month"]()+1,d=value[isUTC+"Date"](),h=value[isUTC+"Hours"](),m=value[isUTC+"Minutes"](),s=value[isUTC+"Seconds"](),value=value[isUTC+"Milliseconds"]();return tpl=tpl.replace("MM",pad(M,2)).replace("M",M).replace("yyyy",y).replace("yy",y%100+"").replace("dd",pad(d,2)).replace("d",d).replace("hh",pad(h,2)).replace("h",h).replace("mm",pad(m,2)).replace("m",m).replace("ss",pad(s,2)).replace("s",s).replace("SSS",pad(value,3))},capitalFirst:function(str){return str&&str.charAt(0).toUpperCase()+str.substr(1)},truncateText:truncateText,getTextRect:function(text,font,align,verticalAlign,padding,rich,truncate,lineHeight){return new ZRText({style:{text:text,font:font,align:align,verticalAlign:verticalAlign,padding:padding,rich:rich,overflow:truncate?"truncate":null,lineHeight:lineHeight}}).getBoundingRect()}}),ITEM_STYLE_KEY_MAP=(Object.freeze||Object)({map:map,each:each,indexOf:indexOf,inherits:inherits,reduce:reduce,filter:filter,bind:bind,curry:curry,isArray:isArray,isString:isString,isObject:isObject,isFunction:isFunction,extend:extend,defaults:defaults,clone:clone,merge:merge}),inner$5=makeInner();function createAxisLabels(axis){return("category"===axis.type?function(axis){var labelModel=axis.getLabelModel(),result=makeCategoryLabelsActually(axis,labelModel);return!labelModel.get("show")||axis.scale.isBlank()?{labels:[],labelCategoryInterval:result.labelCategoryInterval}:result}:function(axis){var ticks=axis.scale.getTicks(),labelFormatter=makeLabelFormatter(axis);return{labels:map(ticks,function(tick,idx){return{level:tick.level,formattedLabel:labelFormatter(tick,idx),rawLabel:axis.scale.getLabel(tick),tickValue:tick.value}})}})(axis)}function createAxisTicks(axis,tickModel){return"category"===axis.type?function(axis,tickModel){var ticks,tickCategoryInterval,ticksCache=getListCache(axis,"ticks"),optionTickInterval=getOptionCategoryInterval(tickModel),result=listCacheGet(ticksCache,optionTickInterval);if(result)return result;tickModel.get("show")&&!axis.scale.isBlank()||(ticks=[]);ticks=isFunction(optionTickInterval)?makeLabelsByCustomizedCategoryInterval(axis,optionTickInterval,!0):"auto"===optionTickInterval?(result=makeCategoryLabelsActually(axis,axis.getLabelModel()),tickCategoryInterval=result.labelCategoryInterval,map(result.labels,function(labelItem){return labelItem.tickValue})):makeLabelsByNumericCategoryInterval(axis,tickCategoryInterval=optionTickInterval,!0);return listCacheSet(ticksCache,optionTickInterval,{ticks:ticks,tickCategoryInterval:tickCategoryInterval})}(axis,tickModel):{ticks:map(axis.scale.getTicks(),function(tick){return tick.value})}}function makeCategoryLabelsActually(axis,labelModel){var numericLabelInterval,labelsCache=getListCache(axis,"labels"),labelModel=getOptionCategoryInterval(labelModel),result=listCacheGet(labelsCache,labelModel);return result||listCacheSet(labelsCache,labelModel,{labels:isFunction(labelModel)?makeLabelsByCustomizedCategoryInterval(axis,labelModel):(numericLabelInterval="auto"===labelModel?function(axis){var result=inner$5(axis).autoInterval;return null!=result?result:inner$5(axis).autoInterval=axis.calculateCategoryInterval()}(axis):labelModel,makeLabelsByNumericCategoryInterval(axis,numericLabelInterval)),labelCategoryInterval:numericLabelInterval})}function getListCache(axis,prop){return inner$5(axis)[prop]||(inner$5(axis)[prop]=[])}function listCacheGet(cache,key){for(var i=0;i<cache.length;i++)if(cache[i].key===key)return cache[i].value}function listCacheSet(cache,key,value){return cache.push({key:key,value:value}),value}function calculateCategoryInterval(axis){var params=function(axis){var labelModel=axis.getLabelModel();return{axisRotate:axis.getRotate?axis.getRotate():axis.isHorizontal&&!axis.isHorizontal()?90:0,labelRotate:labelModel.get("rotate")||0,font:labelModel.getFont()}}(axis),labelFormatter=makeLabelFormatter(axis),rotation=(params.axisRotate-params.labelRotate)/180*Math.PI,ordinalScale=axis.scale,ordinalExtent=ordinalScale.getExtent(),ordinalScale=ordinalScale.count();if(ordinalExtent[1]-ordinalExtent[0]<1)return 0;for(var step=1,tickValue=(40<ordinalScale&&(step=Math.max(1,Math.floor(ordinalScale/40))),ordinalExtent[0]),unitSpan=axis.dataToCoord(tickValue+1)-axis.dataToCoord(tickValue),unitW=Math.abs(unitSpan*Math.cos(rotation)),unitSpan=Math.abs(unitSpan*Math.sin(rotation)),maxW=0,maxH=0;tickValue<=ordinalExtent[1];tickValue+=step)var rect=getBoundingRect(labelFormatter({value:tickValue}),params.font,"center","top"),width=1.3*rect.width,rect=1.3*rect.height,maxW=Math.max(maxW,width,7),maxH=Math.max(maxH,rect,7);var rotation=maxW/unitW,unitW=maxH/unitSpan,unitSpan=(isNaN(rotation)&&(rotation=1/0),isNaN(unitW)&&(unitW=1/0),Math.max(0,Math.floor(Math.min(rotation,unitW)))),rotation=inner$5(axis.model),unitW=axis.getExtent(),axis=rotation.lastAutoInterval,lastTickCount=rotation.lastTickCount;return null!=axis&&null!=lastTickCount&&Math.abs(axis-unitSpan)<=1&&Math.abs(lastTickCount-ordinalScale)<=1&&unitSpan<axis&&rotation.axisExtent0===unitW[0]&&rotation.axisExtent1===unitW[1]?unitSpan=axis:(rotation.lastTickCount=ordinalScale,rotation.lastAutoInterval=unitSpan,rotation.axisExtent0=unitW[0],rotation.axisExtent1=unitW[1]),unitSpan}function makeLabelsByNumericCategoryInterval(axis,categoryInterval,onlyTick){for(var labelFormatter=makeLabelFormatter(axis),ordinalScale=axis.scale,ordinalExtent=ordinalScale.getExtent(),labelModel=axis.getLabelModel(),result=[],step=Math.max((categoryInterval||0)+1,1),categoryInterval=ordinalExtent[0],tickCount=ordinalScale.count(),tickCount=(0!==categoryInterval&&1<step&&2<tickCount/step&&(categoryInterval=Math.round(Math.ceil(categoryInterval/step)*step)),shouldShowAllLabels(axis)),axis=labelModel.get("showMinLabel")||tickCount,labelModel=labelModel.get("showMaxLabel")||tickCount,tickValue=(axis&&categoryInterval!==ordinalExtent[0]&&addItem(ordinalExtent[0]),categoryInterval);tickValue<=ordinalExtent[1];tickValue+=step)addItem(tickValue);function addItem(tickValue){var tickObj={value:tickValue};result.push(onlyTick?tickValue:{formattedLabel:labelFormatter(tickObj),rawLabel:ordinalScale.getLabel(tickObj),tickValue:tickValue})}return labelModel&&tickValue-step!==ordinalExtent[1]&&addItem(ordinalExtent[1]),result}function makeLabelsByCustomizedCategoryInterval(axis,categoryInterval,onlyTick){var ordinalScale=axis.scale,labelFormatter=makeLabelFormatter(axis),result=[];return each(ordinalScale.getTicks(),function(tick){var rawLabel=ordinalScale.getLabel(tick),tickValue=tick.value;categoryInterval(tick.value,rawLabel)&&result.push(onlyTick?tickValue:{formattedLabel:labelFormatter(tick),rawLabel:rawLabel,tickValue:tickValue})}),result}var NORMALIZED_EXTENT=[0,1],LineStyleMixin=function(){function Axis(dim,scale,extent){this.onBand=!1,this.inverse=!1,this.dim=dim,this.scale=scale,this._extent=extent||[0,0]}return Axis.prototype.contain=function(coord){var extent=this._extent,min=Math.min(extent[0],extent[1]),extent=Math.max(extent[0],extent[1]);return min<=coord&&coord<=extent},Axis.prototype.containData=function(data){return this.scale.contain(data)},Axis.prototype.getExtent=function(){return this._extent.slice()},Axis.prototype.getPixelPrecision=function(dataExtent){return getPixelPrecision(dataExtent||this.scale.getExtent(),this._extent)},Axis.prototype.setExtent=function(start,end){var extent=this._extent;extent[0]=start,extent[1]=end},Axis.prototype.dataToCoord=function(data,clamp){var extent=this._extent,scale=this.scale;return data=scale.normalize(data),this.onBand&&"ordinal"===scale.type&&fixExtentWithBands(extent=extent.slice(),scale.count()),linearMap(data,NORMALIZED_EXTENT,extent,clamp)},Axis.prototype.coordToData=function(coord,clamp){var extent=this._extent,scale=this.scale,scale=(this.onBand&&"ordinal"===scale.type&&fixExtentWithBands(extent=extent.slice(),scale.count()),linearMap(coord,extent,NORMALIZED_EXTENT,clamp));return this.scale.scale(scale)},Axis.prototype.pointToData=function(point,clamp){},Axis.prototype.getTicksCoords=function(opt){var tickModel=(opt=opt||{}).tickModel||this.getTickModel(),ticksCoords=map(createAxisTicks(this,tickModel).ticks,function(tickVal){return{coord:this.dataToCoord("ordinal"===this.scale.type?this.scale.getRawOrdinalNumber(tickVal):tickVal),tickValue:tickVal}},this);return function(axis,ticksCoords,alignWithLabel,clamp){var last,shift_1,crossLen,inverse,ticksLen=ticksCoords.length;function littleThan(a,b){return a=round(a),b=round(b),inverse?b<a:a<b}axis.onBand&&!alignWithLabel&&ticksLen&&(alignWithLabel=axis.getExtent(),1===ticksLen?(ticksCoords[0].coord=alignWithLabel[0],last=ticksCoords[1]={coord:alignWithLabel[0]}):(crossLen=ticksCoords[ticksLen-1].tickValue-ticksCoords[0].tickValue,shift_1=(ticksCoords[ticksLen-1].coord-ticksCoords[0].coord)/crossLen,each(ticksCoords,function(ticksItem){ticksItem.coord-=shift_1/2}),crossLen=axis.scale.getExtent(),axis=1+crossLen[1]-ticksCoords[ticksLen-1].tickValue,last={coord:ticksCoords[ticksLen-1].coord+shift_1*axis},ticksCoords.push(last)),inverse=alignWithLabel[0]>alignWithLabel[1],littleThan(ticksCoords[0].coord,alignWithLabel[0])&&(clamp?ticksCoords[0].coord=alignWithLabel[0]:ticksCoords.shift()),clamp&&littleThan(alignWithLabel[0],ticksCoords[0].coord)&&ticksCoords.unshift({coord:alignWithLabel[0]}),littleThan(alignWithLabel[1],last.coord)&&(clamp?last.coord=alignWithLabel[1]:ticksCoords.pop()),clamp&&littleThan(last.coord,alignWithLabel[1])&&ticksCoords.push({coord:alignWithLabel[1]}))}(this,ticksCoords,tickModel.get("alignWithLabel"),opt.clamp),ticksCoords},Axis.prototype.getMinorTicksCoords=function(){if("ordinal"===this.scale.type)return[];var splitNumber=this.model.getModel("minorTick").get("splitNumber");return map(this.scale.getMinorTicks(splitNumber=0<splitNumber&&splitNumber<100?splitNumber:5),function(minorTicksGroup){return map(minorTicksGroup,function(minorTick){return{coord:this.dataToCoord(minorTick),tickValue:minorTick}},this)},this)},Axis.prototype.getViewLabels=function(){return createAxisLabels(this).labels},Axis.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},Axis.prototype.getTickModel=function(){return this.model.getModel("axisTick")},Axis.prototype.getBandWidth=function(){var axisExtent=this._extent,dataExtent=this.scale.getExtent(),dataExtent=dataExtent[1]-dataExtent[0]+(this.onBand?1:0),axisExtent=(0===dataExtent&&(dataExtent=1),Math.abs(axisExtent[1]-axisExtent[0]));return Math.abs(axisExtent)/dataExtent},Axis.prototype.calculateCategoryInterval=function(){return calculateCategoryInterval(this)},Axis}();function fixExtentWithBands(extent,nTick){nTick=(extent[1]-extent[0])/nTick/2;extent[0]+=nTick,extent[1]-=nTick}var PI2$6=2*Math.PI,CMD$3=PathProxy.CMD,DEFAULT_SEARCH_SPACE=["top","right","bottom","left"];function projectPointToLine(x1,y1,x2,y2,x,y,out,limitToEnds){var dx=x-x1,dy=y-y1,x2=x2-x1,y2=y2-y1,lineLen=Math.sqrt(x2*x2+y2*y2),dx=(dx*(x2/=lineLen)+dy*(y2/=lineLen))/lineLen,dy=(limitToEnds&&(dx=Math.min(Math.max(dx,0),1)),out[0]=x1+(dx*=lineLen)*x2),limitToEnds=out[1]=y1+dx*y2;return Math.sqrt((dy-x)*(dy-x)+(limitToEnds-y)*(limitToEnds-y))}function projectPointToRect(x1,y1,width,height,x,y,out){width<0&&(x1+=width,width=-width),height<0&&(y1+=height,height=-height);width=x1+width,height=y1+height,x1=out[0]=Math.min(Math.max(x,x1),width),width=out[1]=Math.min(Math.max(y,y1),height);return Math.sqrt((x1-x)*(x1-x)+(width-y)*(width-y))}var tmpPt=[];function nearestPointOnPath(pt,path,out){for(var xi=0,yi=0,x0=0,y0=0,minDist=1/0,data=path.data,x=pt.x,y=pt.y,i=0;i<data.length;){var cmd=data[i++],d=(1===i&&(x0=xi=data[i],y0=yi=data[i+1]),minDist);switch(cmd){case CMD$3.M:xi=x0=data[i++],yi=y0=data[i++];break;case CMD$3.L:d=projectPointToLine(xi,yi,data[i],data[i+1],x,y,tmpPt,!0),xi=data[i++],yi=data[i++];break;case CMD$3.C:d=cubicProjectPoint(xi,yi,data[i++],data[i++],data[i++],data[i++],data[i],data[i+1],x,y,tmpPt),xi=data[i++],yi=data[i++];break;case CMD$3.Q:d=quadraticProjectPoint(xi,yi,data[i++],data[i++],data[i],data[i+1],x,y,tmpPt),xi=data[i++],yi=data[i++];break;case CMD$3.A:var cx=data[i++],cy=data[i++],rx=data[i++],ry=data[i++],theta=data[i++],dTheta=data[i++],anticlockwise=(i+=1,!!(1-data[i++])),x1=Math.cos(theta)*rx+cx,y1=Math.sin(theta)*ry+cy;i<=1&&(x0=x1,y0=y1);d=function(cx,cy,r,startAngle,endAngle,anticlockwise,x,y,out){x-=cx,y-=cy;var d=Math.sqrt(x*x+y*y),ox=(x/=d)*r+cx,oy=(y/=d)*r+cy;return Math.abs(startAngle-endAngle)%PI2$6<1e-4?(out[0]=ox,out[1]=oy,d-r):((endAngle=anticlockwise?(anticlockwise=startAngle,startAngle=normalizeRadian(endAngle),normalizeRadian(anticlockwise)):(startAngle=normalizeRadian(startAngle),normalizeRadian(endAngle)))<startAngle&&(endAngle+=PI2$6),(anticlockwise=Math.atan2(y,x))<0&&(anticlockwise+=PI2$6),startAngle<=anticlockwise&&anticlockwise<=endAngle||startAngle<=anticlockwise+PI2$6&&anticlockwise+PI2$6<=endAngle?(out[0]=ox,out[1]=oy,d-r):(anticlockwise=r*Math.cos(startAngle)+cx,ox=r*Math.sin(startAngle)+cy,oy=r*Math.cos(endAngle)+cx,d=r*Math.sin(endAngle)+cy,(startAngle=(anticlockwise-x)*(anticlockwise-x)+(ox-y)*(ox-y))<(cx=(oy-x)*(oy-x)+(d-y)*(d-y))?(out[0]=anticlockwise,out[1]=ox,Math.sqrt(startAngle)):(out[0]=oy,out[1]=d,Math.sqrt(cx))))}(cx,cy,ry,theta,theta+dTheta,anticlockwise,(x-cx)*ry/rx+cx,y,tmpPt),xi=Math.cos(theta+dTheta)*rx+cx,yi=Math.sin(theta+dTheta)*ry+cy;break;case CMD$3.R:d=projectPointToRect(x0=xi=data[i++],y0=yi=data[i++],data[i++],data[i++],x,y,tmpPt);break;case CMD$3.Z:d=projectPointToLine(xi,yi,x0,y0,x,y,tmpPt,!0),xi=x0,yi=y0}d<minDist&&(minDist=d,out.set(tmpPt[0],tmpPt[1]))}return minDist}var pt0=new Point,pt1=new Point,pt2=new Point,dir=new Point,dir2=new Point;function updateLabelLinePoints(target,labelLineModel){if(target){var labelLine=target.getTextGuideLine(),label=target.getTextContent();if(label&&labelLine){var labelGuideConfig=target.textGuideLineConfig||{},points=[[0,0],[0,0],[0,0]],searchSpace=labelGuideConfig.candidates||DEFAULT_SEARCH_SPACE,labelRect=label.getBoundingRect().clone(),minDist=(labelRect.applyTransform(label.getComputedTransform()),1/0),anchorPoint=labelGuideConfig.anchor,targetTransform=target.getComputedTransform(),targetInversedTransform=targetTransform&&invert([],targetTransform),len$$1=labelLineModel.get("length2")||0;anchorPoint&&pt2.copy(anchorPoint);for(var rect,out,len2,i=0;i<searchSpace.length;i++){!function(pos,distance$$1,rect,outPt,outDir){var width=rect.width,height=rect.height;switch(pos){case"top":outPt.set(rect.x+width/2,rect.y-distance$$1),outDir.set(0,-1);break;case"bottom":outPt.set(rect.x+width/2,rect.y+height+distance$$1),outDir.set(0,1);break;case"left":outPt.set(rect.x-distance$$1,rect.y+height/2),outDir.set(-1,0);break;case"right":outPt.set(rect.x+width+distance$$1,rect.y+height/2),outDir.set(1,0)}}(searchSpace[i],0,labelRect,pt0,dir),Point.scaleAndAdd(pt1,pt0,dir,len$$1),pt1.transform(targetInversedTransform);var boundingRect=target.getBoundingRect(),boundingRect=anchorPoint?anchorPoint.distance(pt1):target instanceof Path?nearestPointOnPath(pt1,target.path,pt2):(out=pt2,rect=projectPointToRect((rect=boundingRect).x,boundingRect.y,boundingRect.width,boundingRect.height,pt1.x,pt1.y,tmpPt),out.set(tmpPt[0],tmpPt[1]),rect);boundingRect<minDist&&(minDist=boundingRect,pt1.transform(targetTransform),pt2.transform(targetTransform),pt2.toArray(points[0]),pt1.toArray(points[1]),pt0.toArray(points[2]))}label=points,(labelGuideConfig=labelLineModel.get("minTurnAngle"))<=180&&0<labelGuideConfig&&(labelGuideConfig=labelGuideConfig/180*Math.PI,pt0.fromArray(label[0]),pt1.fromArray(label[1]),pt2.fromArray(label[2]),Point.sub(dir,pt0,pt1),Point.sub(dir2,pt2,pt1),labelLineModel=dir.len(),len2=dir2.len(),labelLineModel<.001||len2<.001||(dir.scale(1/labelLineModel),dir2.scale(1/len2),labelLineModel=dir.dot(dir2),Math.cos(labelGuideConfig)<labelLineModel&&(len2=projectPointToLine(pt1.x,pt1.y,pt2.x,pt2.y,pt0.x,pt0.y,tmpArr,!1),tmpProjPoint.fromArray(tmpArr),tmpProjPoint.scaleAndAdd(dir2,len2/Math.tan(Math.PI-labelGuideConfig)),labelLineModel=pt2.x!==pt1.x?(tmpProjPoint.x-pt1.x)/(pt2.x-pt1.x):(tmpProjPoint.y-pt1.y)/(pt2.y-pt1.y),isNaN(labelLineModel)||(labelLineModel<0?Point.copy(tmpProjPoint,pt1):1<labelLineModel&&Point.copy(tmpProjPoint,pt2),tmpProjPoint.toArray(label[1]))))),labelLine.setShape({points:points})}}}var tmpArr=[],tmpProjPoint=new Point;function setLabelLineState(labelLine,ignore,stateName,stateModel){var isNormal="normal"===stateName,stateName=isNormal?labelLine:labelLine.ensureState(stateName),ignore=(stateName.ignore=ignore,stateModel.get("smooth")),ignore=(ignore&&!0===ignore&&(ignore=.3),stateName.shape=stateName.shape||{},0<ignore&&(stateName.shape.smooth=ignore),stateModel.getModel("lineStyle").getLineStyle());isNormal?labelLine.useStyle(ignore):stateName.style=ignore}function buildLabelLinePath(path,shape){var smooth=shape.smooth,points=shape.points;if(points)if(path.moveTo(points[0][0],points[0][1]),0<smooth&&3<=points.length){var shape=dist(points[0],points[1]),len2=dist(points[1],points[2]);if(!shape||!len2)return path.lineTo(points[1][0],points[1][1]),void path.lineTo(points[2][0],points[2][1]);smooth=Math.min(shape,len2)*smooth,shape=lerp([],points[1],points[0],smooth/shape),smooth=lerp([],points[1],points[2],smooth/len2),len2=lerp([],shape,smooth,.5);path.bezierCurveTo(shape[0],shape[1],shape[0],shape[1],len2[0],len2[1]),path.bezierCurveTo(smooth[0],smooth[1],smooth[0],smooth[1],points[2][0],points[2][1])}else for(var i=1;i<points.length;i++)path.lineTo(points[i][0],points[i][1])}function prepareLayoutList(input){for(var list=[],i=0;i<input.length;i++){var label,transform,localRect,isAxisAligned,globalRect,minMargin,rawItem=input[i];rawItem.defaultAttr.ignore||(transform=(label=rawItem.label).getComputedTransform(),localRect=label.getBoundingRect(),isAxisAligned=!transform||transform[1]<1e-5&&transform[2]<1e-5,minMargin=label.style.margin||0,(globalRect=localRect.clone()).applyTransform(transform),globalRect.x-=minMargin/2,globalRect.y-=minMargin/2,globalRect.width+=minMargin,globalRect.height+=minMargin,minMargin=isAxisAligned?new OrientedBoundingRect(localRect,transform):null,list.push({label:label,labelLine:rawItem.labelLine,rect:globalRect,localRect:localRect,obb:minMargin,priority:rawItem.priority,defaultAttr:rawItem.defaultAttr,layoutOption:rawItem.computedLayoutOption,axisAligned:isAxisAligned,transform:transform}))}return list}function shiftLayout(list,xyDim,sizeDim,minBound,maxBound,balanceShift){var len=list.length;if(!(len<2)){list.sort(function(a,b){return a.rect[xyDim]-b.rect[xyDim]});for(var lastPos=0,adjusted=!1,shifts=[],totalShifts=0,i=0;i<len;i++){var delta,item=list[i],rect=item.rect,item=((delta=rect[xyDim]-lastPos)<0&&(rect[xyDim]-=delta,item.label[xyDim]-=delta,adjusted=!0),Math.max(-delta,0));shifts.push(item),totalShifts+=item,lastPos=rect[xyDim]+rect[sizeDim]}0<totalShifts&&balanceShift&&shiftList(-totalShifts/len,0,len);var minGap,maxGap,first=list[0],last=list[len-1];return updateMinMaxGap(),minGap<0&&squeezeGaps(-minGap,.8),maxGap<0&&squeezeGaps(maxGap,.8),updateMinMaxGap(),takeBoundsGap(minGap,maxGap,1),takeBoundsGap(maxGap,minGap,-1),updateMinMaxGap(),minGap<0&&squeezeWhenBailout(-minGap),maxGap<0&&squeezeWhenBailout(maxGap),adjusted}function updateMinMaxGap(){minGap=first.rect[xyDim]-minBound,maxGap=maxBound-last.rect[xyDim]-last.rect[sizeDim]}function takeBoundsGap(gapThisBound,gapOtherBound,moveDir){gapThisBound<0&&(0<(gapOtherBound=Math.min(gapOtherBound,-gapThisBound))?(shiftList(gapOtherBound*moveDir,0,len),(gapOtherBound=gapOtherBound+gapThisBound)<0&&squeezeGaps(-gapOtherBound*moveDir,1)):squeezeGaps(-gapThisBound*moveDir,1))}function shiftList(delta,start,end){0!==delta&&(adjusted=!0);for(var i=start;i<end;i++){var item=list[i];item.rect[xyDim]+=delta,item.label[xyDim]+=delta}}function squeezeGaps(delta,maxSqeezePercent){for(var gaps=[],totalGaps=0,i=1;i<len;i++){var prevItemRect=list[i-1].rect,prevItemRect=Math.max(list[i].rect[xyDim]-prevItemRect[xyDim]-prevItemRect[sizeDim],0);gaps.push(prevItemRect),totalGaps+=prevItemRect}if(totalGaps){var squeezePercent=Math.min(Math.abs(delta)/totalGaps,maxSqeezePercent);if(0<delta)for(i=0;i<len-1;i++)shiftList(gaps[i]*squeezePercent,0,i+1);else for(i=len-1;0<i;i--)shiftList(-(gaps[i-1]*squeezePercent),i,len)}}function squeezeWhenBailout(delta){for(var dir=delta<0?-1:1,moveForEachLabel=(delta=Math.abs(delta),Math.ceil(delta/(len-1))),i=0;i<len-1;i++)if(0<dir?shiftList(moveForEachLabel,0,i+1):shiftList(-moveForEachLabel,len-i-1,len),(delta-=moveForEachLabel)<=0)return}}function hideOverlap(labelList){var displayedLabels=[],globalRect=(labelList.sort(function(a,b){return b.priority-a.priority}),new BoundingRect(0,0,0,0));function hideEl(el){var emphasisState;el.ignore||null==(emphasisState=el.ensureState("emphasis")).ignore&&(emphasisState.ignore=!1),el.ignore=!0}for(var i=0;i<labelList.length;i++){for(var labelItem=labelList[i],isAxisAligned=labelItem.axisAligned,localRect=labelItem.localRect,transform=labelItem.transform,label=labelItem.label,labelLine=labelItem.labelLine,obb=(globalRect.copy(labelItem.rect),globalRect.width-=.1,globalRect.height-=.1,globalRect.x+=.05,globalRect.y+=.05,labelItem.obb),overlapped=!1,j=0;j<displayedLabels.length;j++){var existsTextCfg=displayedLabels[j];if(globalRect.intersect(existsTextCfg.rect)){if(isAxisAligned&&existsTextCfg.axisAligned){overlapped=!0;break}if(existsTextCfg.obb||(existsTextCfg.obb=new OrientedBoundingRect(existsTextCfg.localRect,existsTextCfg.transform)),(obb=obb||new OrientedBoundingRect(localRect,transform)).intersect(existsTextCfg.obb)){overlapped=!0;break}}}overlapped?(hideEl(label),labelLine&&hideEl(labelLine)):(label.attr("ignore",labelItem.defaultAttr.ignore),labelLine&&labelLine.attr("ignore",labelItem.defaultAttr.labelGuideIgnore),displayedLabels.push(labelItem))}}function prepareLayoutCallbackParams(labelItem,hostEl){var label=labelItem.label,hostEl=hostEl&&hostEl.getTextGuideLine();return{dataIndex:labelItem.dataIndex,dataType:labelItem.dataType,seriesIndex:labelItem.seriesModel.seriesIndex,text:labelItem.label.style.text,rect:labelItem.hostRect,labelRect:labelItem.rect,align:label.style.align,verticalAlign:label.style.verticalAlign,labelLinePoints:function(points){if(points){for(var newPoints=[],i=0;i<points.length;i++)newPoints.push(points[i].slice());return newPoints}}(hostEl&&hostEl.shape.points)}}var LABEL_OPTION_TO_STYLE_KEYS=["align","verticalAlign","width","height","fontSize"],dummyTransformable=new Transformable,labelLayoutInnerStore=makeInner(),labelLineAnimationStore=makeInner();function extendWithKeys(target,source,keys$$1){for(var i=0;i<keys$$1.length;i++){var key=keys$$1[i];null!=source[key]&&(target[key]=source[key])}}var LABEL_LAYOUT_PROPS=["x","y","rotation"],LabelManager=function(){function LabelManager(){this._labelList=[],this._chartViewList=[]}return LabelManager.prototype.clearLabels=function(){this._labelList=[],this._chartViewList=[]},LabelManager.prototype._addLabel=function(dataIndex,dataType,seriesModel,label,layoutOption){var hostRect,labelStyle=label.style,textConfig=label.__hostTarget.textConfig||{},labelTransform=label.getComputedTransform(),labelRect=label.getBoundingRect().plain(),labelTransform=(BoundingRect.applyTransform(labelRect,labelRect,labelTransform),labelTransform?dummyTransformable.setLocalTransform(labelTransform):(dummyTransformable.x=dummyTransformable.y=dummyTransformable.rotation=dummyTransformable.originX=dummyTransformable.originY=0,dummyTransformable.scaleX=dummyTransformable.scaleY=1),label.__hostTarget),transform=(labelTransform&&(hostRect=labelTransform.getBoundingRect().plain(),transform=labelTransform.getComputedTransform(),BoundingRect.applyTransform(hostRect,hostRect,transform)),hostRect&&labelTransform.getTextGuideLine());this._labelList.push({label:label,labelLine:transform,seriesModel:seriesModel,dataIndex:dataIndex,dataType:dataType,layoutOption:layoutOption,computedLayoutOption:null,rect:labelRect,hostRect:hostRect,priority:hostRect?hostRect.width*hostRect.height:0,defaultAttr:{ignore:label.ignore,labelGuideIgnore:transform&&transform.ignore,x:dummyTransformable.x,y:dummyTransformable.y,scaleX:dummyTransformable.scaleX,scaleY:dummyTransformable.scaleY,rotation:dummyTransformable.rotation,style:{x:labelStyle.x,y:labelStyle.y,align:labelStyle.align,verticalAlign:labelStyle.verticalAlign,width:labelStyle.width,height:labelStyle.height,fontSize:labelStyle.fontSize},cursor:label.cursor,attachedPos:textConfig.position,attachedRot:textConfig.rotation}})},LabelManager.prototype.addLabelsOfSeries=function(chartView){var _this=this,seriesModel=(this._chartViewList.push(chartView),chartView.__model),layoutOption=seriesModel.get("labelLayout");(isFunction(layoutOption)||keys(layoutOption).length)&&chartView.group.traverse(function(child){if(child.ignore)return!0;var textEl=child.getTextContent(),child=getECData(child);textEl&&!textEl.disableLabelLayout&&_this._addLabel(child.dataIndex,child.dataType,seriesModel,textEl,layoutOption)})},LabelManager.prototype.updateLayoutConfig=function(api){var width=api.getWidth(),height=api.getHeight();for(var i=0;i<this._labelList.length;i++){var labelItem=this._labelList[i],label=labelItem.label,hostEl=label.__hostTarget,defaultLabelAttr=labelItem.defaultAttr,layoutOption=void 0,layoutOption=isFunction(labelItem.layoutOption)?labelItem.layoutOption(prepareLayoutCallbackParams(labelItem,hostEl)):labelItem.layoutOption,degreeToRadian=(labelItem.computedLayoutOption=layoutOption=layoutOption||{},Math.PI/180),needsUpdateLabelLine=(hostEl&&hostEl.setTextConfig({local:!1,position:null!=layoutOption.x||null!=layoutOption.y?null:defaultLabelAttr.attachedPos,rotation:null!=layoutOption.rotate?layoutOption.rotate*degreeToRadian:defaultLabelAttr.attachedRot,offset:[layoutOption.dx||0,layoutOption.dy||0]}),!1);null!=layoutOption.x?(label.x=parsePercent$1(layoutOption.x,width),label.setStyle("x",0),needsUpdateLabelLine=!0):(label.x=defaultLabelAttr.x,label.setStyle("x",defaultLabelAttr.style.x)),null!=layoutOption.y?(label.y=parsePercent$1(layoutOption.y,height),label.setStyle("y",0),needsUpdateLabelLine=!0):(label.y=defaultLabelAttr.y,label.setStyle("y",defaultLabelAttr.style.y)),!layoutOption.labelLinePoints||(guideLine=hostEl.getTextGuideLine())&&(guideLine.setShape({points:layoutOption.labelLinePoints}),needsUpdateLabelLine=!1),labelLayoutInnerStore(label).needsUpdateLabelLine=needsUpdateLabelLine,label.rotation=null!=layoutOption.rotate?layoutOption.rotate*degreeToRadian:defaultLabelAttr.rotation,label.scaleX=defaultLabelAttr.scaleX,label.scaleY=defaultLabelAttr.scaleY;for(var guideLine,k=0;k<LABEL_OPTION_TO_STYLE_KEYS.length;k++){var key=LABEL_OPTION_TO_STYLE_KEYS[k];label.setStyle(key,(null!=layoutOption[key]?layoutOption:defaultLabelAttr.style)[key])}layoutOption.draggable?(label.draggable=!0,label.cursor="move",hostEl&&(guideLine=labelItem.seriesModel,null!=labelItem.dataIndex&&(guideLine=labelItem.seriesModel.getData(labelItem.dataType).getItemModel(labelItem.dataIndex)),label.on("drag",function(el,labelLineModel){return function(){updateLabelLinePoints(el,labelLineModel)}}(hostEl,guideLine.getModel("labelLine"))))):(label.off("drag"),label.cursor=defaultLabelAttr.cursor)}},LabelManager.prototype.layout=function(api){var balanceShift,width=api.getWidth(),api=api.getHeight(),labelList=prepareLayoutList(this._labelList),labelsNeedsAdjustOnX=filter(labelList,function(item){return"shiftX"===item.layoutOption.moveOverlap}),labelsNeedsAdjustOnY=filter(labelList,function(item){return"shiftY"===item.layoutOption.moveOverlap});shiftLayout(labelsNeedsAdjustOnX,"x","width",0,width,balanceShift),function(list,topBound,bottomBound,balanceShift){shiftLayout(list,"y","height",topBound,bottomBound,balanceShift)}(labelsNeedsAdjustOnY,0,api),hideOverlap(filter(labelList,function(item){return item.layoutOption.hideOverlap}))},LabelManager.prototype.processLabelsOverall=function(){var _this=this;each(this._chartViewList,function(chartView){var seriesModel=chartView.__model,ignoreLabelLineUpdate=chartView.ignoreLabelLineUpdate,animationEnabled=seriesModel.isAnimationEnabled();chartView.group.traverse(function(child){if(child.ignore&&!child.forceLabelAnimation)return!0;var needsUpdateLabelLine=!ignoreLabelLineUpdate,label=child.getTextContent();(needsUpdateLabelLine=!needsUpdateLabelLine&&label?labelLayoutInnerStore(label).needsUpdateLabelLine:needsUpdateLabelLine)&&_this._updateLabelLine(child,seriesModel),animationEnabled&&_this._animateLabels(child,seriesModel)})})},LabelManager.prototype._updateLabelLine=function(el,seriesModel){var textEl=el.getTextContent(),ecData=getECData(el),dataIndex=ecData.dataIndex;textEl&&null!=dataIndex&&(seriesModel=(textEl=seriesModel.getData(ecData.dataType)).getItemModel(dataIndex),ecData={},dataIndex=textEl.getItemVisual(dataIndex,"style"),textEl=textEl.getVisual("drawType"),ecData.stroke=dataIndex[textEl],dataIndex=seriesModel.getModel("labelLine"),function(targetEl,statesModels,defaultStyle){var labelLine=targetEl.getTextGuideLine(),label=targetEl.getTextContent();if(label){for(var normalModel=statesModels.normal,showNormal=normalModel.get("show"),labelIgnoreNormal=label.ignore,i=0;i<DISPLAY_STATES.length;i++){var stateShow,stateName=DISPLAY_STATES[i],stateModel=statesModels[stateName],isNormal="normal"===stateName;stateModel&&(stateShow=stateModel.get("show"),(isNormal?labelIgnoreNormal:retrieve2(label.states[stateName]&&label.states[stateName].ignore,labelIgnoreNormal))||!retrieve2(stateShow,showNormal)?(stateShow=isNormal?labelLine:labelLine&&labelLine.states.normal)&&(stateShow.ignore=!0):(labelLine||(labelLine=new Polyline,targetEl.setTextGuideLine(labelLine),isNormal||!labelIgnoreNormal&&showNormal||setLabelLineState(labelLine,!0,"normal",statesModels.normal),targetEl.stateProxy&&(labelLine.stateProxy=targetEl.stateProxy)),setLabelLineState(labelLine,!1,stateName,stateModel)))}labelLine&&(defaults(labelLine.style,defaultStyle),labelLine.style.fill=null,defaultStyle=normalModel.get("showAbove"),(targetEl.textGuideLineConfig=targetEl.textGuideLineConfig||{}).showAbove=defaultStyle||!1,labelLine.buildPath=buildLabelLinePath)}else labelLine&&targetEl.removeTextGuideLine()}(el,function(itemModel,labelLineName){for(var statesModels={normal:itemModel.getModel(labelLineName=labelLineName||"labelLine")},i=0;i<SPECIAL_STATES.length;i++){var stateName=SPECIAL_STATES[i];statesModels[stateName]=itemModel.getModel([stateName,labelLineName])}return statesModels}(seriesModel),ecData),updateLabelLinePoints(el,dataIndex))},LabelManager.prototype._animateLabels=function(el,seriesModel){var dataIndex,ecData,layoutStore,oldLayout,newProps,textEl=el.getTextContent(),guideLine=el.getTextGuideLine();!textEl||!el.forceLabelAnimation&&(textEl.ignore||textEl.invisible||el.disableLabelAnimation||isElementRemoved(el))||(oldLayout=(layoutStore=labelLayoutInnerStore(textEl)).oldLayout,dataIndex=(ecData=getECData(el)).dataIndex,newProps={x:textEl.x,y:textEl.y,rotation:textEl.rotation},ecData=seriesModel.getData(ecData.dataType),oldLayout?(textEl.attr(oldLayout),(el=el.prevStates)&&(0<=indexOf(el,"select")&&textEl.attr(layoutStore.oldLayoutSelect),0<=indexOf(el,"emphasis")&&textEl.attr(layoutStore.oldLayoutEmphasis)),updateProps(textEl,newProps,seriesModel,dataIndex)):(textEl.attr(newProps),labelInner(textEl).valueAnimation||(el=retrieve2(textEl.style.opacity,1),textEl.style.opacity=0,initProps(textEl,{style:{opacity:el}},seriesModel,dataIndex))),layoutStore.oldLayout=newProps,textEl.states.select&&(extendWithKeys(el=layoutStore.oldLayoutSelect={},newProps,LABEL_LAYOUT_PROPS),extendWithKeys(el,textEl.states.select,LABEL_LAYOUT_PROPS)),textEl.states.emphasis&&(extendWithKeys(el=layoutStore.oldLayoutEmphasis={},newProps,LABEL_LAYOUT_PROPS),extendWithKeys(el,textEl.states.emphasis,LABEL_LAYOUT_PROPS)),animateLabelValue(textEl,dataIndex,ecData,seriesModel,seriesModel)),!guideLine||guideLine.ignore||guideLine.invisible||(oldLayout=(layoutStore=labelLineAnimationStore(guideLine)).oldLayout,newProps={points:guideLine.shape.points},oldLayout?(guideLine.attr({shape:oldLayout}),updateProps(guideLine,{shape:newProps},seriesModel)):(guideLine.setShape(newProps),guideLine.style.strokePercent=0,initProps(guideLine,{style:{strokePercent:1}},seriesModel)),layoutStore.oldLayout=newProps)},LabelManager}(),getLabelManager=makeInner();function installLabelLayout(registers){registers.registerUpdateLifecycle("series:beforeupdate",function(ecModel,api,params){(getLabelManager(api).labelManager||(getLabelManager(api).labelManager=new LabelManager)).clearLabels()}),registers.registerUpdateLifecycle("series:layoutlabels",function(ecModel,api,params){var labelManager=getLabelManager(api).labelManager;params.updatedSeries.forEach(function(series){labelManager.addLabelsOfSeries(api.getViewOfSeriesModel(series))}),labelManager.updateLayoutConfig(api),labelManager.layout(api),labelManager.processLabelsOverall()})}function createDom(id,painter,dpr){var newDom=platformApi.createCanvas(),width=painter.getWidth(),painter=painter.getHeight(),newDomStyle=newDom.style;return newDomStyle&&(newDomStyle.position="absolute",newDomStyle.left="0",newDomStyle.top="0",newDomStyle.width=width+"px",newDomStyle.height=painter+"px",newDom.setAttribute("data-zr-dom-id",id)),newDom.width=width*dpr,newDom.height=painter*dpr,newDom}use(installLabelLayout);var Layer=function(_super){function Layer(id,painter,dpr){var dom,_this=_super.call(this)||this,id=(_this.motionBlur=!1,_this.lastFrameAlpha=.7,_this.dpr=1,_this.virtual=!1,_this.config={},_this.incremental=!1,_this.zlevel=0,_this.maxRepaintRectCount=5,_this.__dirty=!0,_this.__firstTimePaint=!0,_this.__used=!1,_this.__drawIndex=0,_this.__startIndex=0,_this.__endIndex=0,_this.__prevStartIndex=null,_this.__prevEndIndex=null,dpr=dpr||devicePixelRatio,"string"==typeof id?dom=createDom(id,painter,dpr):isObject(id)&&(id=(dom=id).id),_this.id=id,(_this.dom=dom).style);return id&&(disableUserSelect(dom),dom.onselectstart=function(){return!1},id.padding="0",id.margin="0",id.borderWidth="0"),_this.painter=painter,_this.dpr=dpr,_this}return __extends(Layer,_super),Layer.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},Layer.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},Layer.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},Layer.prototype.setUnpainted=function(){this.__firstTimePaint=!0},Layer.prototype.createBackBuffer=function(){var dpr=this.dpr;this.domBack=createDom("back-"+this.id,this.painter,dpr),this.ctxBack=this.domBack.getContext("2d"),1!==dpr&&this.ctxBack.scale(dpr,dpr)},Layer.prototype.createRepaintRects=function(displayList,prevList,viewWidth,viewHeight){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var mergedRepaintRects=[],maxRepaintRectCount=this.maxRepaintRectCount,full=!1,pendingRect=new BoundingRect(0,0,0,0);function addRectToMergePool(rect){if(rect.isFinite()&&!rect.isZero())if(0===mergedRepaintRects.length)(boundingRect=new BoundingRect(0,0,0,0)).copy(rect),mergedRepaintRects.push(boundingRect);else{for(var boundingRect,isMerged=!1,minDeltaArea=1/0,bestRectToMergeIdx=0,i=0;i<mergedRepaintRects.length;++i){var mergedRect=mergedRepaintRects[i];if(mergedRect.intersect(rect)){var pendingRect_1=new BoundingRect(0,0,0,0);pendingRect_1.copy(mergedRect),pendingRect_1.union(rect),mergedRepaintRects[i]=pendingRect_1,isMerged=!0;break}full&&(pendingRect.copy(rect),pendingRect.union(mergedRect),pendingRect_1=rect.width*rect.height,mergedRect=mergedRect.width*mergedRect.height,(mergedRect=pendingRect.width*pendingRect.height-pendingRect_1-mergedRect)<minDeltaArea&&(minDeltaArea=mergedRect,bestRectToMergeIdx=i))}full&&(mergedRepaintRects[bestRectToMergeIdx].union(rect),isMerged=!0),isMerged||((boundingRect=new BoundingRect(0,0,0,0)).copy(rect),mergedRepaintRects.push(boundingRect)),full=full||mergedRepaintRects.length>=maxRepaintRectCount}}for(var curRect,i=this.__startIndex;i<this.__endIndex;++i)(el=displayList[i])&&(shouldPaint=el.shouldBePainted(viewWidth,viewHeight,!0,!0),(prevRect=el.__isRendered&&(el.__dirty&REDRAW_BIT||!shouldPaint)?el.getPrevPaintRect():null)&&addRectToMergePool(prevRect),(curRect=shouldPaint&&(el.__dirty&REDRAW_BIT||!el.__isRendered)?el.getPaintRect():null)&&addRectToMergePool(curRect));for(i=this.__prevStartIndex;i<this.__prevEndIndex;++i){var el,prevRect,shouldPaint=(el=prevList[i]).shouldBePainted(viewWidth,viewHeight,!0,!0);!el||shouldPaint&&el.__zr||!el.__isRendered||(prevRect=el.getPrevPaintRect())&&addRectToMergePool(prevRect)}do{for(var hasIntersections=!1,i=0;i<mergedRepaintRects.length;)if(mergedRepaintRects[i].isZero())mergedRepaintRects.splice(i,1);else{for(var j=i+1;j<mergedRepaintRects.length;)mergedRepaintRects[i].intersect(mergedRepaintRects[j])?(hasIntersections=!0,mergedRepaintRects[i].union(mergedRepaintRects[j]),mergedRepaintRects.splice(j,1)):j++;i++}}while(hasIntersections);return this._paintRects=mergedRepaintRects},Layer.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},Layer.prototype.resize=function(width,height){var dpr=this.dpr,dom=this.dom,domStyle=dom.style,domBack=this.domBack;domStyle&&(domStyle.width=width+"px",domStyle.height=height+"px"),dom.width=width*dpr,dom.height=height*dpr,domBack&&(domBack.width=width*dpr,domBack.height=height*dpr,1!==dpr&&this.ctxBack.scale(dpr,dpr))},Layer.prototype.clear=function(clearAll,clearColor,repaintRects){var dom=this.dom,ctx=this.ctx,width=dom.width,height=dom.height,haveMotionBLur=(clearColor=clearColor||this.clearColor,this.motionBlur&&!clearAll),lastFrameAlpha=this.lastFrameAlpha,dpr=this.dpr,self=this,domBack=(haveMotionBLur&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(dom,0,0,width/dpr,height/dpr)),this.domBack);function doClear(x,y,width,height){var clearColorGradientOrPattern;ctx.clearRect(x,y,width,height),clearColor&&"transparent"!==clearColor&&(clearColorGradientOrPattern=void 0,null!=clearColor.colorStops?(clearColorGradientOrPattern=clearColor.__canvasGradient||getCanvasGradient(ctx,clearColor,{x:0,y:0,width:width,height:height}),clearColor.__canvasGradient=clearColorGradientOrPattern):null!=clearColor.image&&(clearColorGradientOrPattern=createCanvasPattern(ctx,clearColor,{dirty:function(){self.setUnpainted(),self.__painter.refresh()}})),ctx.save(),ctx.fillStyle=clearColorGradientOrPattern||clearColor,ctx.fillRect(x,y,width,height),ctx.restore()),haveMotionBLur&&(ctx.save(),ctx.globalAlpha=lastFrameAlpha,ctx.drawImage(domBack,x,y,width,height),ctx.restore())}!repaintRects||haveMotionBLur?doClear(0,0,width,height):repaintRects.length&&each(repaintRects,function(rect){doClear(rect.x*dpr,rect.y*dpr,rect.width*dpr,rect.height*dpr)})},Layer}(Eventful);var CanvasPainter=function(){function CanvasPainter(root,storage,opts,id){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var singleCanvas=!root.nodeName||"CANVAS"===root.nodeName.toUpperCase();this._opts=opts=extend({},opts||{}),this.dpr=opts.devicePixelRatio||devicePixelRatio,this._singleCanvas=singleCanvas;(this.root=root).style&&(disableUserSelect(root),root.innerHTML=""),this.storage=storage;var width,height,storage=this._zlevelList,layers=(this._prevDisplayList=[],this._layers);singleCanvas?(width=(singleCanvas=root).width,height=singleCanvas.height,null!=opts.width&&(width=opts.width),null!=opts.height&&(height=opts.height),this.dpr=opts.devicePixelRatio||1,singleCanvas.width=width*this.dpr,singleCanvas.height=height*this.dpr,this._width=width,this._height=height,(width=new Layer(singleCanvas,this,this.dpr)).__builtin__=!0,width.initContext(),(layers[314159]=width).zlevel=314159,storage.push(314159),this._domRoot=root):(this._width=getSize(root,0,opts),this._height=getSize(root,1,opts),height=this._domRoot=function(width,height){var domRoot=document.createElement("div");return domRoot.style.cssText=["position:relative","width:"+width+"px","height:"+height+"px","padding:0","margin:0","border-width:0"].join(";")+";",domRoot}(this._width,this._height),root.appendChild(height))}return CanvasPainter.prototype.getType=function(){return"canvas"},CanvasPainter.prototype.isSingleCanvas=function(){return this._singleCanvas},CanvasPainter.prototype.getViewportRoot=function(){return this._domRoot},CanvasPainter.prototype.getViewportRootOffset=function(){var viewportRoot=this.getViewportRoot();if(viewportRoot)return{offsetLeft:viewportRoot.offsetLeft||0,offsetTop:viewportRoot.offsetTop||0}},CanvasPainter.prototype.refresh=function(paintAll){var list=this.storage.getDisplayList(!0),prevList=this._prevDisplayList,zlevelList=this._zlevelList;this._redrawId=Math.random(),this._paintList(list,prevList,paintAll,this._redrawId);for(var i=0;i<zlevelList.length;i++){var clearColor,z=zlevelList[i],z=this._layers[z];!z.__builtin__&&z.refresh&&(clearColor=0===i?this._backgroundColor:null,z.refresh(clearColor))}return this._opts.useDirtyRect&&(this._prevDisplayList=list.slice()),this},CanvasPainter.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},CanvasPainter.prototype._paintHoverList=function(list){var len=list.length,hoverLayer=this._hoverlayer;if(hoverLayer&&hoverLayer.clear(),len){for(var ctx,scope={inHover:!0,viewWidth:this._width,viewHeight:this._height},i=0;i<len;i++){var el=list[i];el.__inHover&&(hoverLayer=hoverLayer||(this._hoverlayer=this.getLayer(1e5)),ctx||(ctx=hoverLayer.ctx).save(),brush(ctx,el,scope,i===len-1))}ctx&&ctx.restore()}},CanvasPainter.prototype.getHoverLayer=function(){return this.getLayer(1e5)},CanvasPainter.prototype.paintOne=function(ctx,el){brushSingle(ctx,el)},CanvasPainter.prototype._paintList=function(list,prevList,paintAll,redrawId){var finished,_a,self_1;this._redrawId===redrawId&&(paintAll=paintAll||!1,this._updateLayerStatus(list),finished=(_a=this._doPaintList(list,prevList,paintAll)).finished,_a=_a.needsRefreshHover,this._needsManuallyCompositing&&this._compositeManually(),_a&&this._paintHoverList(list),finished?this.eachLayer(function(layer){layer.afterBrush&&layer.afterBrush()}):(self_1=this,requestAnimationFrame$1(function(){self_1._paintList(list,prevList,paintAll,redrawId)})))},CanvasPainter.prototype._compositeManually=function(){var ctx=this.getLayer(314159).ctx,width=this._domRoot.width,height=this._domRoot.height;ctx.clearRect(0,0,width,height),this.eachBuiltinLayer(function(layer){layer.virtual&&ctx.drawImage(layer.dom,0,0,width,height)})},CanvasPainter.prototype._doPaintList=function(list,prevList,paintAll){for(var _this=this,layerList=[],useDirtyRect=this._opts.useDirtyRect,zi=0;zi<this._zlevelList.length;zi++){var zlevel=this._zlevelList[zi],zlevel=this._layers[zlevel];zlevel.__builtin__&&zlevel!==this._hoverlayer&&(zlevel.__dirty||paintAll)&&layerList.push(zlevel)}for(var finished=!0,needsRefreshHover=!1,_loop_1=function(k){function repaint(repaintRect){var scope={inHover:!1,allClipped:!1,prevEl:null,viewWidth:_this._width,viewHeight:_this._height};for(i=start;i<layer.__endIndex;i++){var el=list[i];if(el.__inHover&&(needsRefreshHover=!0),_this._doPaintEl(el,layer,useDirtyRect,repaintRect,scope,i===layer.__endIndex-1),useTimer)if(15<Date.now()-startTime)break}scope.prevElClipPaths&&ctx.restore()}var firstEl,i,layer=layerList[k],ctx=layer.ctx,repaintRects=useDirtyRect&&layer.createRepaintRects(list,prevList,this_1._width,this_1._height),start=paintAll?layer.__startIndex:layer.__drawIndex,useTimer=!paintAll&&layer.incremental&&Date.now,startTime=useTimer&&Date.now(),k=layer.zlevel===this_1._zlevelList[0]?this_1._backgroundColor:null;layer.__startIndex!==layer.__endIndex&&(start!==layer.__startIndex||(firstEl=list[start]).incremental&&firstEl.notClear&&!paintAll)||layer.clear(!1,k,repaintRects),-1===start&&(console.error("For some unknown reason. drawIndex is -1"),start=layer.__startIndex);if(repaintRects)if(0===repaintRects.length)i=layer.__endIndex;else for(var dpr=this_1.dpr,r=0;r<repaintRects.length;++r){var rect=repaintRects[r];ctx.save(),ctx.beginPath(),ctx.rect(rect.x*dpr,rect.y*dpr,rect.width*dpr,rect.height*dpr),ctx.clip(),repaint(rect),ctx.restore()}else ctx.save(),repaint(),ctx.restore();layer.__drawIndex=i,layer.__drawIndex<layer.__endIndex&&(finished=!1)},this_1=this,k=0;k<layerList.length;k++)_loop_1(k);return env.wxa&&each(this._layers,function(layer){layer&&layer.ctx&&layer.ctx.draw&&layer.ctx.draw()}),{finished:finished,needsRefreshHover:needsRefreshHover}},CanvasPainter.prototype._doPaintEl=function(el,currentLayer,useDirtyRect,repaintRect,scope,isLast){currentLayer=currentLayer.ctx;useDirtyRect?(useDirtyRect=el.getPaintRect(),(!repaintRect||useDirtyRect&&useDirtyRect.intersect(repaintRect))&&(brush(currentLayer,el,scope,isLast),el.setPrevPaintRect(useDirtyRect))):brush(currentLayer,el,scope,isLast)},CanvasPainter.prototype.getLayer=function(zlevel,virtual){this._singleCanvas&&!this._needsManuallyCompositing&&(zlevel=314159);var layer=this._layers[zlevel];return layer||((layer=new Layer("zr_"+zlevel,this,this.dpr)).zlevel=zlevel,layer.__builtin__=!0,this._layerConfig[zlevel]?merge(layer,this._layerConfig[zlevel],!0):this._layerConfig[zlevel-.01]&&merge(layer,this._layerConfig[zlevel-.01],!0),virtual&&(layer.virtual=virtual),this.insertLayer(zlevel,layer),layer.initContext()),layer},CanvasPainter.prototype.insertLayer=function(zlevel,layer){var layersMap=this._layers,zlevelList=this._zlevelList,len=zlevelList.length,domRoot=this._domRoot,prevLayer=null,i=-1;if(layersMap[zlevel])logError("ZLevel "+zlevel+" has been used already");else if(function(layer){return layer&&(layer.__builtin__||"function"==typeof layer.resize&&"function"==typeof layer.refresh)}(layer)){if(0<len&&zlevel>zlevelList[0]){for(i=0;i<len-1&&!(zlevelList[i]<zlevel&&zlevelList[i+1]>zlevel);i++);prevLayer=layersMap[zlevelList[i]]}zlevelList.splice(i+1,0,zlevel),(layersMap[zlevel]=layer).virtual||(prevLayer?(layersMap=prevLayer.dom).nextSibling?domRoot.insertBefore(layer.dom,layersMap.nextSibling):domRoot.appendChild(layer.dom):domRoot.firstChild?domRoot.insertBefore(layer.dom,domRoot.firstChild):domRoot.appendChild(layer.dom)),layer.__painter=this}else logError("Layer of zlevel "+zlevel+" is not valid")},CanvasPainter.prototype.eachLayer=function(cb,context){for(var zlevelList=this._zlevelList,i=0;i<zlevelList.length;i++){var z=zlevelList[i];cb.call(context,this._layers[z],z)}},CanvasPainter.prototype.eachBuiltinLayer=function(cb,context){for(var zlevelList=this._zlevelList,i=0;i<zlevelList.length;i++){var z=zlevelList[i],layer=this._layers[z];layer.__builtin__&&cb.call(context,layer,z)}},CanvasPainter.prototype.eachOtherLayer=function(cb,context){for(var zlevelList=this._zlevelList,i=0;i<zlevelList.length;i++){var z=zlevelList[i],layer=this._layers[z];layer.__builtin__||cb.call(context,layer,z)}},CanvasPainter.prototype.getLayers=function(){return this._layers},CanvasPainter.prototype._updateLayerStatus=function(list){function updatePrevLayer(idx){prevLayer&&(prevLayer.__endIndex!==idx&&(prevLayer.__dirty=!0),prevLayer.__endIndex=idx)}if(this.eachBuiltinLayer(function(layer,z){layer.__dirty=layer.__used=!1}),this._singleCanvas)for(var i_1=1;i_1<list.length;i_1++)if((el=list[i_1]).zlevel!==list[i_1-1].zlevel||el.incremental){this._needsManuallyCompositing=!0;break}for(var prevZlevel,prevLayer=null,incrementalLayerCount=0,i=0;i<list.length;i++){var el,zlevel=(el=list[i]).zlevel,layer=void 0;prevZlevel!==zlevel&&(prevZlevel=zlevel,incrementalLayerCount=0),el.incremental?((layer=this.getLayer(zlevel+.001,this._needsManuallyCompositing)).incremental=!0,incrementalLayerCount=1):layer=this.getLayer(zlevel+(0<incrementalLayerCount?.01:0),this._needsManuallyCompositing),layer.__builtin__||logError("ZLevel "+zlevel+" has been used by unkown layer "+layer.id),layer!==prevLayer&&(layer.__used=!0,layer.__startIndex!==i&&(layer.__dirty=!0),layer.__startIndex=i,layer.incremental?layer.__drawIndex=-1:layer.__drawIndex=i,updatePrevLayer(i),prevLayer=layer),el.__dirty&REDRAW_BIT&&!el.__inHover&&(layer.__dirty=!0,layer.incremental&&layer.__drawIndex<0&&(layer.__drawIndex=i))}updatePrevLayer(i),this.eachBuiltinLayer(function(layer,z){!layer.__used&&0<layer.getElementCount()&&(layer.__dirty=!0,layer.__startIndex=layer.__endIndex=layer.__drawIndex=0),layer.__dirty&&layer.__drawIndex<0&&(layer.__drawIndex=layer.__startIndex)})},CanvasPainter.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},CanvasPainter.prototype._clearLayer=function(layer){layer.clear()},CanvasPainter.prototype.setBackgroundColor=function(backgroundColor){this._backgroundColor=backgroundColor,each(this._layers,function(layer){layer.setUnpainted()})},CanvasPainter.prototype.configLayer=function(zlevel,config){if(config){var layerConfig=this._layerConfig;layerConfig[zlevel]?merge(layerConfig[zlevel],config,!0):layerConfig[zlevel]=config;for(var i=0;i<this._zlevelList.length;i++){var _zlevel=this._zlevelList[i];_zlevel!==zlevel&&_zlevel!==zlevel+.01||merge(this._layers[_zlevel],layerConfig[zlevel],!0)}}},CanvasPainter.prototype.delLayer=function(zlevel){var layers=this._layers,zlevelList=this._zlevelList,layer=layers[zlevel];layer&&(layer.dom.parentNode.removeChild(layer.dom),delete layers[zlevel],zlevelList.splice(indexOf(zlevelList,zlevel),1))},CanvasPainter.prototype.resize=function(width,height){if(this._domRoot.style){var domRoot=this._domRoot,opts=(domRoot.style.display="none",this._opts),root=this.root;if(null!=width&&(opts.width=width),null!=height&&(opts.height=height),width=getSize(root,0,opts),height=getSize(root,1,opts),domRoot.style.display="",this._width!==width||height!==this._height){for(var id in domRoot.style.width=width+"px",domRoot.style.height=height+"px",this._layers)this._layers.hasOwnProperty(id)&&this._layers[id].resize(width,height);this.refresh(!0)}this._width=width,this._height=height}else{if(null==width||null==height)return;this._width=width,this._height=height,this.getLayer(314159).resize(width,height)}return this},CanvasPainter.prototype.clearLayer=function(zlevel){zlevel=this._layers[zlevel];zlevel&&zlevel.clear()},CanvasPainter.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},CanvasPainter.prototype.getRenderedCanvas=function(opts){if(this._singleCanvas&&!this._compositeManually)return this._layers[314159].dom;var imageLayer=new Layer("image",this,(opts=opts||{}).pixelRatio||this.dpr),ctx=(imageLayer.initContext(),imageLayer.clear(!1,opts.backgroundColor||this._backgroundColor),imageLayer.ctx);if(opts.pixelRatio<=this.dpr){this.refresh();var width_1=imageLayer.dom.width,height_1=imageLayer.dom.height;this.eachLayer(function(layer){layer.__builtin__?ctx.drawImage(layer.dom,0,0,width_1,height_1):layer.renderToCanvas&&(ctx.save(),layer.renderToCanvas(ctx),ctx.restore())})}else for(var scope={inHover:!1,viewWidth:this._width,viewHeight:this._height},displayList=this.storage.getDisplayList(!0),i=0,len=displayList.length;i<len;i++){var el=displayList[i];brush(ctx,el,scope,i===len-1)}return imageLayer.dom},CanvasPainter.prototype.getWidth=function(){return this._width},CanvasPainter.prototype.getHeight=function(){return this._height},CanvasPainter}();var DatasetModel=function(_super){function DatasetModel(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type="dataset",_this}return __extends(DatasetModel,_super),DatasetModel.prototype.init=function(option,parentModel,ecModel){_super.prototype.init.call(this,option,parentModel,ecModel),this._sourceManager=new SourceManager(this),disableTransformOptionMerge(this)},DatasetModel.prototype.mergeOption=function(newOption,ecModel){_super.prototype.mergeOption.call(this,newOption,ecModel),disableTransformOptionMerge(this)},DatasetModel.prototype.optionUpdated=function(){this._sourceManager.dirty()},DatasetModel.prototype.getSourceManager=function(){return this._sourceManager},DatasetModel.type="dataset",DatasetModel.defaultOption={seriesLayoutBy:SERIES_LAYOUT_BY_COLUMN},DatasetModel}(ComponentModel),DatasetView=function(_super){function DatasetView(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type="dataset",_this}return __extends(DatasetView,_super),DatasetView.type="dataset",DatasetView}(ComponentView);use([function(registers){registers.registerPainter("canvas",CanvasPainter)},function(registers){registers.registerComponentModel(DatasetModel),registers.registerComponentView(DatasetView)}]),use(installLabelLayout);var samplers={average:function(frame){for(var sum=0,count=0,i=0;i<frame.length;i++)isNaN(frame[i])||(sum+=frame[i],count++);return 0===count?NaN:sum/count},sum:function(frame){for(var sum=0,i=0;i<frame.length;i++)sum+=frame[i]||0;return sum},max:function(frame){for(var max=-1/0,i=0;i<frame.length;i++)frame[i]>max&&(max=frame[i]);return isFinite(max)?max:NaN},min:function(frame){for(var min=1/0,i=0;i<frame.length;i++)frame[i]<min&&(min=frame[i]);return isFinite(min)?min:NaN},nearest:function(frame){return frame[0]}},indexSampler=function(frame){return Math.round(frame.length/2)};function dataSample(seriesType){return{seriesType:seriesType,reset:function(seriesModel,ecModel,api){var baseAxis,data=seriesModel.getData(),sampling=seriesModel.get("sampling"),coordSys=seriesModel.coordinateSystem,count=data.count();10<count&&"cartesian2d"===coordSys.type&&sampling&&(baseAxis=coordSys.getBaseAxis(),coordSys=coordSys.getOtherAxis(baseAxis),baseAxis=baseAxis.getExtent(),api=api.getDevicePixelRatio(),baseAxis=Math.abs(baseAxis[1]-baseAxis[0])*(api||1),api=Math.round(count/baseAxis),isFinite(api)&&1<api&&("lttb"===sampling&&seriesModel.setData(data.lttbDownSample(data.mapDimension(coordSys.dim),1/api)),count=void 0,isString(sampling)?count=samplers[sampling]:isFunction(sampling)&&(count=sampling),count&&seriesModel.setData(data.downSample(data.mapDimension(coordSys.dim),1/api,count,indexSampler))))}}}var BaseBarSeriesModel=function(_super){function BaseBarSeriesModel(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=BaseBarSeriesModel.type,_this}return __extends(BaseBarSeriesModel,_super),BaseBarSeriesModel.prototype.getInitialData=function(option,ecModel){return createSeriesData(null,this,{useEncodeDefaulter:!0})},BaseBarSeriesModel.prototype.getMarkerPosition=function(value){var offset,data,coordSys=this.coordinateSystem;return coordSys&&coordSys.clampData?(value=coordSys.dataToPoint(coordSys.clampData(value)),offset=(data=this.getData()).getLayout("offset"),data=data.getLayout("size"),value[coordSys.getBaseAxis().isHorizontal()?0:1]+=offset+data/2,value):[NaN,NaN]},BaseBarSeriesModel.type="series.__base_bar__",BaseBarSeriesModel.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},BaseBarSeriesModel}(SeriesModel),BarSeriesModel=(SeriesModel.registerClass(BaseBarSeriesModel),function(_super){function BarSeriesModel(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=BarSeriesModel.type,_this}return __extends(BarSeriesModel,_super),BarSeriesModel.prototype.getInitialData=function(){return createSeriesData(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},BarSeriesModel.prototype.getProgressive=function(){return!!this.get("large")&&this.get("progressive")},BarSeriesModel.prototype.getProgressiveThreshold=function(){var progressiveThreshold=this.get("progressiveThreshold"),largeThreshold=this.get("largeThreshold");return progressiveThreshold=progressiveThreshold<largeThreshold?largeThreshold:progressiveThreshold},BarSeriesModel.prototype.brushSelector=function(dataIndex,data,selectors){return selectors.rect(data.getItemLayout(dataIndex))},BarSeriesModel.type="series.bar",BarSeriesModel.dependencies=["grid","polar"],BarSeriesModel.defaultOption=inheritDefaultOption(BaseBarSeriesModel.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),BarSeriesModel}(BaseBarSeriesModel));function createGridClipPath(cartesian,hasAnimation,seriesModel,done,during){var rect=cartesian.getArea(),x=rect.x,y=rect.y,width=rect.width,rect=rect.height,lineWidth=seriesModel.get(["lineStyle","width"])||2,clipPath=(x-=lineWidth/2,y-=lineWidth/2,width+=lineWidth,rect+=lineWidth,x=Math.floor(x),width=Math.round(width),new Rect({shape:{x:x,y:y,width:width,height:rect}}));return hasAnimation&&(hasAnimation=(lineWidth=cartesian.getBaseAxis()).isHorizontal(),cartesian=lineWidth.inverse,hasAnimation?(cartesian&&(clipPath.shape.x+=width),clipPath.shape.width=0):(cartesian||(clipPath.shape.y+=rect),clipPath.shape.height=0),lineWidth=isFunction(during)?function(percent){during(percent,clipPath)}:null,initProps(clipPath,{shape:{width:width,height:rect,x:x,y:y}},seriesModel,null,done,lineWidth)),clipPath}function createPolarClipPath(polar,hasAnimation,seriesModel){var sectorArea=polar.getArea(),r0=round(sectorArea.r0,1),r=round(sectorArea.r,1),clipPath=new Sector({shape:{cx:round(polar.cx,1),cy:round(polar.cy,1),r0:r0,r:r,startAngle:sectorArea.startAngle,endAngle:sectorArea.endAngle,clockwise:sectorArea.clockwise}});return hasAnimation&&("angle"===polar.getBaseAxis().dim?clipPath.shape.endAngle=sectorArea.startAngle:clipPath.shape.r=r0,initProps(clipPath,{shape:{endAngle:sectorArea.endAngle,r:r}},seriesModel)),clipPath}var SausageShape=function(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0},SausagePath=function(_super){function SausagePath(opts){opts=_super.call(this,opts)||this;return opts.type="sausage",opts}return __extends(SausagePath,_super),SausagePath.prototype.getDefaultShape=function(){return new SausageShape},SausagePath.prototype.buildPath=function(ctx,shape){var cx=shape.cx,cy=shape.cy,r0=Math.max(shape.r0||0,0),r=Math.max(shape.r,0),dr=.5*(r-r0),rCenter=r0+dr,startAngle=shape.startAngle,endAngle=shape.endAngle,shape=shape.clockwise,PI2=2*Math.PI,lessThanCircle=shape?endAngle-startAngle<PI2:startAngle-endAngle<PI2,PI2=(lessThanCircle||(startAngle=endAngle-(shape?PI2:-PI2)),Math.cos(startAngle)),unitStartY=Math.sin(startAngle),unitEndX=Math.cos(endAngle),unitEndY=Math.sin(endAngle);lessThanCircle?(ctx.moveTo(PI2*r0+cx,unitStartY*r0+cy),ctx.arc(PI2*rCenter+cx,unitStartY*rCenter+cy,dr,-Math.PI+startAngle,startAngle,!shape)):ctx.moveTo(PI2*r+cx,unitStartY*r+cy),ctx.arc(cx,cy,r,startAngle,endAngle,!shape),ctx.arc(unitEndX*rCenter+cx,unitEndY*rCenter+cy,dr,endAngle-2*Math.PI,endAngle-Math.PI,!shape),0!==r0&&ctx.arc(cx,cy,r0,endAngle,startAngle,shape)},SausagePath}(Path);function isCoordinateSystemType(coordSys,type){return coordSys.type===type}function getDefaultLabel(data,dataIndex){var rawVal,labelDims=data.mapDimensionsAll("defaultedLabel"),len=labelDims.length;if(1===len)return null!=(rawVal=retrieveRawValue(data,dataIndex,labelDims[0]))?rawVal+"":null;if(len){for(var vals=[],i=0;i<labelDims.length;i++)vals.push(retrieveRawValue(data,dataIndex,labelDims[i]));return vals.join(" ")}}function getDefaultInterpolatedLabel(data,interpolatedValue){var labelDims=data.mapDimensionsAll("defaultedLabel");if(!isArray(interpolatedValue))return interpolatedValue+"";for(var vals=[],i=0;i<labelDims.length;i++){var dimIndex=data.getDimensionIndex(labelDims[i]);0<=dimIndex&&vals.push(interpolatedValue[dimIndex])}return vals.join(" ")}function adjustAngleDistanceX(angle,distance,isEnd){return distance*Math.sin(angle)*(isEnd?-1:1)}function adjustAngleDistanceY(angle,distance,isEnd){return distance*Math.cos(angle)*(isEnd?1:-1)}var mathMax$5=Math.max,mathMin$5=Math.min;var BarView=function(_super){function BarView(){var _this=_super.call(this)||this;return _this.type=BarView.type,_this._isFirstFrame=!0,_this}return __extends(BarView,_super),BarView.prototype.render=function(seriesModel,ecModel,api,payload){this._model=seriesModel,this._removeOnRenderedListener(api),this._updateDrawMode(seriesModel);var coordinateSystemType=seriesModel.get("coordinateSystem");"cartesian2d"===coordinateSystemType||"polar"===coordinateSystemType?(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(seriesModel,ecModel,api):this._renderNormal(seriesModel,ecModel,api,payload)):warn("Only cartesian2d and polar supported for bar.")},BarView.prototype.incrementalPrepareRender=function(seriesModel){this._clear(),this._updateDrawMode(seriesModel),this._updateLargeClip(seriesModel)},BarView.prototype.incrementalRender=function(params,seriesModel){this._progressiveEls=[],this._incrementalRenderLarge(params,seriesModel)},BarView.prototype.eachRendered=function(cb){traverseElements(this._progressiveEls||this.group,cb)},BarView.prototype._updateDrawMode=function(seriesModel){seriesModel=seriesModel.pipelineContext.large;null!=this._isLargeDraw&&seriesModel===this._isLargeDraw||(this._isLargeDraw=seriesModel,this._clear())},BarView.prototype._renderNormal=function(seriesModel,ecModel,api,payload){var isHorizontalOrRadial,group=this.group,data=seriesModel.getData(),oldData=this._data,coord=seriesModel.coordinateSystem,baseAxis=coord.getBaseAxis(),animationModel=("cartesian2d"===coord.type?isHorizontalOrRadial=baseAxis.isHorizontal():"polar"===coord.type&&(isHorizontalOrRadial="angle"===baseAxis.dim),seriesModel.isAnimationEnabled()?seriesModel:null),realtimeSortCfg=function(seriesModel,coordSys){var seriesModel=seriesModel.get("realtimeSort",!0),baseAxis=coordSys.getBaseAxis();seriesModel&&("category"!==baseAxis.type&&warn("`realtimeSort` will not work because this bar series is not based on a category axis."),"cartesian2d"!==coordSys.type&&warn("`realtimeSort` will not work because this bar series is not on cartesian2d."));if(seriesModel&&"category"===baseAxis.type&&"cartesian2d"===coordSys.type)return{baseAxis:baseAxis,otherAxis:coordSys.getOtherAxis(baseAxis)}}(seriesModel,coord),needsClip=(realtimeSortCfg&&this._enableRealtimeSort(realtimeSortCfg,data,api),seriesModel.get("clip",!0)||realtimeSortCfg),coordSysClipArea=function(coord,data){var coordSysClipArea=coord.getArea&&coord.getArea();return!isCoordinateSystemType(coord,"cartesian2d")||"category"===(coord=coord.getBaseAxis()).type&&coord.onBand||(data=data.getLayout("bandWidth"),coord.isHorizontal()?(coordSysClipArea.x-=data,coordSysClipArea.width+=2*data):(coordSysClipArea.y-=data,coordSysClipArea.height+=2*data)),coordSysClipArea}(coord,data),roundCap=(group.removeClipPath(),seriesModel.get("roundCap",!0)),drawBackground=seriesModel.get("showBackground",!0),backgroundModel=seriesModel.getModel("backgroundStyle"),barBorderRadius=backgroundModel.get("borderRadius")||0,bgEls=[],oldBgEls=this._backgroundEls,isInitSort=payload&&payload.isInitSort,isChangeOrder=payload&&"changeAxisOrder"===payload.type;function createBackground(dataIndex){var bgLayout=getLayout[coord.type](data,dataIndex),bgLayout=function(coord,isHorizontalOrRadial,layout){return new("polar"===coord.type?Sector:Rect)({shape:createBackgroundShape(isHorizontalOrRadial,layout,coord),silent:!0,z2:0})}(coord,isHorizontalOrRadial,bgLayout);return bgLayout.useStyle(backgroundModel.getItemStyle()),"cartesian2d"===coord.type&&bgLayout.setShape("r",barBorderRadius),bgEls[dataIndex]=bgLayout}data.diff(oldData).add(function(dataIndex){var isClipped,el,itemModel=data.getItemModel(dataIndex),layout=getLayout[coord.type](data,dataIndex,itemModel);drawBackground&&createBackground(dataIndex),data.hasValue(dataIndex)&&isValidLayout[coord.type](layout)&&(isClipped=!1,needsClip&&(isClipped=clip[coord.type](coordSysClipArea,layout)),el=elementCreator[coord.type](seriesModel,data,dataIndex,layout,isHorizontalOrRadial,animationModel,baseAxis.model,!1,roundCap),realtimeSortCfg&&(el.forceLabelAnimation=!0),updateStyle(el,data,dataIndex,itemModel,layout,seriesModel,isHorizontalOrRadial,"polar"===coord.type),isInitSort?el.attr({shape:layout}):realtimeSortCfg?updateRealtimeAnimation(realtimeSortCfg,animationModel,el,layout,dataIndex,isHorizontalOrRadial,!1,!1):initProps(el,{shape:layout},seriesModel,dataIndex),data.setItemGraphicEl(dataIndex,el),group.add(el),el.ignore=isClipped)}).update(function(newIndex,oldIndex){var bgLayout,itemModel=data.getItemModel(newIndex),layout=getLayout[coord.type](data,newIndex,itemModel),bgEl=(drawBackground&&(bgEl=void 0,0===oldBgEls.length?bgEl=createBackground(oldIndex):((bgEl=oldBgEls[oldIndex]).useStyle(backgroundModel.getItemStyle()),"cartesian2d"===coord.type&&bgEl.setShape("r",barBorderRadius),bgEls[newIndex]=bgEl),bgLayout=getLayout[coord.type](data,newIndex),updateProps(bgEl,{shape:createBackgroundShape(isHorizontalOrRadial,bgLayout,coord)},animationModel,newIndex)),oldData.getItemGraphicEl(oldIndex));data.hasValue(newIndex)&&isValidLayout[coord.type](layout)?(bgLayout=!1,needsClip&&(bgLayout=clip[coord.type](coordSysClipArea,layout))&&group.remove(bgEl),bgEl?saveOldStyle(bgEl):bgEl=elementCreator[coord.type](seriesModel,data,newIndex,layout,isHorizontalOrRadial,animationModel,baseAxis.model,!!bgEl,roundCap),realtimeSortCfg&&(bgEl.forceLabelAnimation=!0),isChangeOrder?(oldIndex=bgEl.getTextContent())&&null!=(oldIndex=labelInner(oldIndex)).prevValue&&(oldIndex.prevValue=oldIndex.value):updateStyle(bgEl,data,newIndex,itemModel,layout,seriesModel,isHorizontalOrRadial,"polar"===coord.type),isInitSort?bgEl.attr({shape:layout}):realtimeSortCfg?updateRealtimeAnimation(realtimeSortCfg,animationModel,bgEl,layout,newIndex,isHorizontalOrRadial,!0,isChangeOrder):updateProps(bgEl,{shape:layout},seriesModel,newIndex,null),data.setItemGraphicEl(newIndex,bgEl),bgEl.ignore=bgLayout,group.add(bgEl)):group.remove(bgEl)}).remove(function(dataIndex){var el=oldData.getItemGraphicEl(dataIndex);el&&removeElementWithFadeOut(el,seriesModel,dataIndex)}).execute();var bgGroup=this._backgroundGroup||(this._backgroundGroup=new Group);bgGroup.removeAll();for(var i=0;i<bgEls.length;++i)bgGroup.add(bgEls[i]);group.add(bgGroup),this._backgroundEls=bgEls,this._data=data},BarView.prototype._renderLarge=function(seriesModel,ecModel,api){this._clear(),createLarge(seriesModel,this.group),this._updateLargeClip(seriesModel)},BarView.prototype._incrementalRenderLarge=function(params,seriesModel){this._removeBackground(),createLarge(seriesModel,this.group,this._progressiveEls,!0)},BarView.prototype._updateLargeClip=function(seriesModel){var seriesModel=seriesModel.get("clip",!0)&&function(coordSys,hasAnimation,seriesModel,done,during){return coordSys?"polar"===coordSys.type?createPolarClipPath(coordSys,hasAnimation,seriesModel):"cartesian2d"===coordSys.type?createGridClipPath(coordSys,hasAnimation,seriesModel,done,during):null:null}(seriesModel.coordinateSystem,!1,seriesModel),group=this.group;seriesModel?group.setClipPath(seriesModel):group.removeClipPath()},BarView.prototype._enableRealtimeSort=function(realtimeSortCfg,data,api){var baseAxis,orderMapping_1,_this=this;data.count()&&(baseAxis=realtimeSortCfg.baseAxis,this._isFirstFrame?(this._dispatchInitSort(data,realtimeSortCfg,api),this._isFirstFrame=!1):(orderMapping_1=function(idx){idx=data.getItemGraphicEl(idx),idx=idx&&idx.shape;return idx&&Math.abs(baseAxis.isHorizontal()?idx.height:idx.width)||0},this._onRendered=function(){_this._updateSortWithinSameData(data,orderMapping_1,baseAxis,api)},api.getZr().on("rendered",this._onRendered)))},BarView.prototype._dataSort=function(data,baseAxis,orderMapping){var info=[];return data.each(data.mapDimension(baseAxis.dim),function(ordinalNumber,dataIdx){var mappedValue=null==(mappedValue=orderMapping(dataIdx))?NaN:mappedValue;info.push({dataIndex:dataIdx,mappedValue:mappedValue,ordinalNumber:ordinalNumber})}),info.sort(function(a,b){return b.mappedValue-a.mappedValue}),{ordinalNumbers:map(info,function(item){return item.ordinalNumber})}},BarView.prototype._isOrderChangedWithinSameData=function(data,orderMapping,baseAxis){for(var scale=baseAxis.scale,ordinalDataDim=data.mapDimension(baseAxis.dim),lastValue=Number.MAX_VALUE,tickNum=0,len=scale.getOrdinalMeta().categories.length;tickNum<len;++tickNum){var rawIdx=data.rawIndexOf(ordinalDataDim,scale.getRawOrdinalNumber(tickNum)),rawIdx=rawIdx<0?Number.MIN_VALUE:orderMapping(data.indexOfRawIndex(rawIdx));if(lastValue<rawIdx)return!0;lastValue=rawIdx}return!1},BarView.prototype._isOrderDifferentInView=function(orderInfo,baseAxis){for(var scale=baseAxis.scale,baseAxis=scale.getExtent(),tickNum=Math.max(0,baseAxis[0]),tickMax=Math.min(baseAxis[1],scale.getOrdinalMeta().categories.length-1);tickNum<=tickMax;++tickNum)if(orderInfo.ordinalNumbers[tickNum]!==scale.getRawOrdinalNumber(tickNum))return!0},BarView.prototype._updateSortWithinSameData=function(data,orderMapping,baseAxis,api){this._isOrderChangedWithinSameData(data,orderMapping,baseAxis)&&(data=this._dataSort(data,baseAxis,orderMapping),this._isOrderDifferentInView(data,baseAxis)&&(this._removeOnRenderedListener(api),api.dispatchAction({type:"changeAxisOrder",componentType:baseAxis.dim+"Axis",axisId:baseAxis.index,sortInfo:data})))},BarView.prototype._dispatchInitSort=function(data,realtimeSortCfg,api){var baseAxis=realtimeSortCfg.baseAxis,sortResult=this._dataSort(data,baseAxis,function(dataIdx){return data.get(data.mapDimension(realtimeSortCfg.otherAxis.dim),dataIdx)});api.dispatchAction({type:"changeAxisOrder",componentType:baseAxis.dim+"Axis",isInitSort:!0,axisId:baseAxis.index,sortInfo:sortResult})},BarView.prototype.remove=function(ecModel,api){this._clear(this._model),this._removeOnRenderedListener(api)},BarView.prototype.dispose=function(ecModel,api){this._removeOnRenderedListener(api)},BarView.prototype._removeOnRenderedListener=function(api){this._onRendered&&(api.getZr().off("rendered",this._onRendered),this._onRendered=null)},BarView.prototype._clear=function(model){var group=this.group,data=this._data;model&&model.isAnimationEnabled()&&data&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],data.eachItemGraphicEl(function(el){removeElementWithFadeOut(el,model,getECData(el).dataIndex)})):group.removeAll(),this._data=null,this._isFirstFrame=!0},BarView.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},BarView.type="bar",BarView}(ChartView),clip={cartesian2d:function(coordSysBoundingRect,layout){var signWidth=layout.width<0?-1:1,signHeight=layout.height<0?-1:1,coordSysX2=(signWidth<0&&(layout.x+=layout.width,layout.width=-layout.width),signHeight<0&&(layout.y+=layout.height,layout.height=-layout.height),coordSysBoundingRect.x+coordSysBoundingRect.width),coordSysY2=coordSysBoundingRect.y+coordSysBoundingRect.height,x=mathMax$5(layout.x,coordSysBoundingRect.x),x2=mathMin$5(layout.x+layout.width,coordSysX2),coordSysBoundingRect=mathMax$5(layout.y,coordSysBoundingRect.y),y2=mathMin$5(layout.y+layout.height,coordSysY2),xClipped=x2<x,yClipped=y2<coordSysBoundingRect;return layout.x=xClipped&&coordSysX2<x?x2:x,layout.y=yClipped&&coordSysY2<coordSysBoundingRect?y2:coordSysBoundingRect,layout.width=xClipped?0:x2-x,layout.height=yClipped?0:y2-coordSysBoundingRect,signWidth<0&&(layout.x+=layout.width,layout.width=-layout.width),signHeight<0&&(layout.y+=layout.height,layout.height=-layout.height),xClipped||yClipped},polar:function(coordSysClipArea,layout){var tmp,signR=layout.r0<=layout.r?1:-1,r=(signR<0&&(tmp=layout.r,layout.r=layout.r0,layout.r0=tmp),mathMin$5(layout.r,coordSysClipArea.r)),coordSysClipArea=mathMax$5(layout.r0,coordSysClipArea.r0),r=(layout.r=r)-(layout.r0=coordSysClipArea)<0;return signR<0&&(tmp=layout.r,layout.r=layout.r0,layout.r0=tmp),r}},elementCreator={cartesian2d:function(seriesModel,data,newIndex,layout,isHorizontal,animationModel,axisModel,isUpdate,roundCap){layout=new Rect({shape:extend({},layout),z2:1});return layout.__dataIndex=newIndex,layout.name="item",animationModel&&(layout.shape[isHorizontal?"height":"width"]=0),layout},polar:function(seriesModel,data,newIndex,layout,isRadial,animationModel,axisModel,isUpdate,roundCap){var positionMapping,isRoundCap,roundCap=!isRadial&&roundCap?SausagePath:Sector,sector=new roundCap({shape:layout,z2:1}),positionMap=(sector.name="item",createPolarPositionMapping(isRadial));return sector.calculateTextPosition=(positionMapping=positionMap,isRoundCap=({isRoundCap:roundCap===SausagePath}||{}).isRoundCap,function(out,opts,boundingRect){var textPosition=opts.position;if(!textPosition||textPosition instanceof Array)return calculateTextPosition(out,opts,boundingRect);var textPosition=positionMapping(textPosition),distance=null!=opts.distance?opts.distance:5,sector=this.shape,cx=sector.cx,cy=sector.cy,r=sector.r,r0=sector.r0,middleR=(r+r0)/2,startAngle=sector.startAngle,endAngle=sector.endAngle,middleAngle=(startAngle+endAngle)/2,extraDist=isRoundCap?Math.abs(r-r0)/2:0,mathCos=Math.cos,mathSin=Math.sin,x=cx+r*mathCos(startAngle),y=cy+r*mathSin(startAngle),textAlign="left",textVerticalAlign="top";switch(textPosition){case"startArc":x=cx+(r0-distance)*mathCos(middleAngle),y=cy+(r0-distance)*mathSin(middleAngle),textAlign="center",textVerticalAlign="top";break;case"insideStartArc":x=cx+(r0+distance)*mathCos(middleAngle),y=cy+(r0+distance)*mathSin(middleAngle),textAlign="center",textVerticalAlign="bottom";break;case"startAngle":x=cx+middleR*mathCos(startAngle)+adjustAngleDistanceX(startAngle,distance+extraDist,!1),y=cy+middleR*mathSin(startAngle)+adjustAngleDistanceY(startAngle,distance+extraDist,!1),textAlign="right",textVerticalAlign="middle";break;case"insideStartAngle":x=cx+middleR*mathCos(startAngle)+adjustAngleDistanceX(startAngle,extraDist-distance,!1),y=cy+middleR*mathSin(startAngle)+adjustAngleDistanceY(startAngle,extraDist-distance,!1),textAlign="left",textVerticalAlign="middle";break;case"middle":x=cx+middleR*mathCos(middleAngle),y=cy+middleR*mathSin(middleAngle),textAlign="center",textVerticalAlign="middle";break;case"endArc":x=cx+(r+distance)*mathCos(middleAngle),y=cy+(r+distance)*mathSin(middleAngle),textAlign="center",textVerticalAlign="bottom";break;case"insideEndArc":x=cx+(r-distance)*mathCos(middleAngle),y=cy+(r-distance)*mathSin(middleAngle),textAlign="center",textVerticalAlign="top";break;case"endAngle":x=cx+middleR*mathCos(endAngle)+adjustAngleDistanceX(endAngle,distance+extraDist,!0),y=cy+middleR*mathSin(endAngle)+adjustAngleDistanceY(endAngle,distance+extraDist,!0),textAlign="left",textVerticalAlign="middle";break;case"insideEndAngle":x=cx+middleR*mathCos(endAngle)+adjustAngleDistanceX(endAngle,extraDist-distance,!0),y=cy+middleR*mathSin(endAngle)+adjustAngleDistanceY(endAngle,extraDist-distance,!0),textAlign="right",textVerticalAlign="middle";break;default:return calculateTextPosition(out,opts,boundingRect)}return(out=out||{}).x=x,out.y=y,out.align=textAlign,out.verticalAlign=textVerticalAlign,out}),animationModel&&(positionMap={},sector.shape[roundCap=isRadial?"r":"endAngle"]=isRadial?0:layout.startAngle,positionMap[roundCap]=layout[roundCap],(isUpdate?updateProps:initProps)(sector,{shape:positionMap},animationModel)),sector}};function updateRealtimeAnimation(realtimeSortCfg,seriesAnimationModel,el,layout,newIndex,isHorizontal,isUpdate,isChangeOrder){var axisTarget,isHorizontal=isHorizontal?(axisTarget={x:layout.x,width:layout.width},{y:layout.y,height:layout.height}):(axisTarget={y:layout.y,height:layout.height},{x:layout.x,width:layout.width});isChangeOrder||(isUpdate?updateProps:initProps)(el,{shape:isHorizontal},seriesAnimationModel,newIndex,null),(isUpdate?updateProps:initProps)(el,{shape:axisTarget},seriesAnimationModel?realtimeSortCfg.baseAxis.model:null,newIndex)}function checkPropertiesNotValid(obj,props){for(var i=0;i<props.length;i++)if(!isFinite(obj[props[i]]))return 1}var rectPropties=["x","y","width","height"],polarPropties=["cx","cy","r","startAngle","endAngle"],isValidLayout={cartesian2d:function(layout){return!checkPropertiesNotValid(layout,rectPropties)},polar:function(layout){return!checkPropertiesNotValid(layout,polarPropties)}},getLayout={cartesian2d:function(data,dataIndex,itemModel){var data=data.getItemLayout(dataIndex),dataIndex=itemModel?function(itemModel,rawLayout){var borderColor=itemModel.get(["itemStyle","borderColor"]);if(!borderColor||"none"===borderColor)return 0;borderColor=itemModel.get(["itemStyle","borderWidth"])||0,itemModel=isNaN(rawLayout.width)?Number.MAX_VALUE:Math.abs(rawLayout.width),rawLayout=isNaN(rawLayout.height)?Number.MAX_VALUE:Math.abs(rawLayout.height);return Math.min(borderColor,itemModel,rawLayout)}(itemModel,data):0,itemModel=0<data.width?1:-1,signY=0<data.height?1:-1;return{x:data.x+itemModel*dataIndex/2,y:data.y+signY*dataIndex/2,width:data.width-itemModel*dataIndex,height:data.height-signY*dataIndex}},polar:function(data,dataIndex,itemModel){data=data.getItemLayout(dataIndex);return{cx:data.cx,cy:data.cy,r0:data.r0,r:data.r,startAngle:data.startAngle,endAngle:data.endAngle,clockwise:data.clockwise}}};function createPolarPositionMapping(isRadial){return function(isRadial){var arcOrAngle=isRadial?"Arc":"Angle";return function(position){switch(position){case"start":case"insideStart":case"end":case"insideEnd":return position+arcOrAngle;default:return position}}}(isRadial)}function updateStyle(el,data,dataIndex,itemModel,layout,seriesModel,isHorizontalOrRadial,isPolar){var style=data.getItemVisual(dataIndex,"style"),cursorStyle=(isPolar||el.setShape("r",itemModel.get(["itemStyle","borderRadius"])||0),el.useStyle(style),itemModel.getShallow("cursor")),cursorStyle=(cursorStyle&&el.attr("cursor",cursorStyle),isPolar?isHorizontalOrRadial?layout.r>=layout.r0?"endArc":"startArc":layout.endAngle>=layout.startAngle?"endAngle":"startAngle":isHorizontalOrRadial?0<=layout.height?"bottom":"top":0<=layout.width?"right":"left"),labelStatesModels=getLabelStatesModels(itemModel),style=(setLabelStyle(el,labelStatesModels,{labelFetcher:seriesModel,labelDataIndex:dataIndex,defaultText:getDefaultLabel(seriesModel.getData(),dataIndex),inheritColor:style.fill,defaultOpacity:style.opacity,defaultOutsidePosition:cursorStyle}),el.getTextContent()),cursorStyle=(isPolar&&style&&(isPolar=itemModel.get(["label","position"]),el.textConfig.inside="middle"===isPolar||null,function(sector,textPosition,positionMapping,rotateType){if(isNumber(rotateType))sector.setTextConfig({rotation:rotateType});else if(isArray(textPosition))sector.setTextConfig({rotation:0});else{var anchorAngle,rotateType=sector.shape,startAngle=rotateType.clockwise?rotateType.startAngle:rotateType.endAngle,endAngle=rotateType.clockwise?rotateType.endAngle:rotateType.startAngle,middleAngle=(startAngle+endAngle)/2,rotateType=positionMapping(textPosition);switch(rotateType){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":anchorAngle=middleAngle;break;case"startAngle":case"insideStartAngle":anchorAngle=startAngle;break;case"endAngle":case"insideEndAngle":anchorAngle=endAngle;break;default:return sector.setTextConfig({rotation:0})}positionMapping=1.5*Math.PI-anchorAngle;"middle"===rotateType&&positionMapping>Math.PI/2&&positionMapping<1.5*Math.PI&&(positionMapping-=Math.PI),sector.setTextConfig({rotation:positionMapping})}}(el,"outside"===isPolar?cursorStyle:isPolar,createPolarPositionMapping(isHorizontalOrRadial),itemModel.get(["label","rotate"]))),!function(label,labelStatesModels,value,getDefaultText){label&&((label=labelInner(label)).prevValue=label.value,label.value=value,value=labelStatesModels.normal,label.valueAnimation=value.get("valueAnimation"),label.valueAnimation&&(label.precision=value.get("precision"),label.defaultInterpolatedText=getDefaultText,label.statesModels=labelStatesModels))}(style,labelStatesModels,seriesModel.getRawValue(dataIndex),function(value){return getDefaultInterpolatedLabel(data,value)}),itemModel.getModel(["emphasis"]));toggleHoverEmphasis(el,cursorStyle.get("focus"),cursorStyle.get("blurScope"),cursorStyle.get("disabled")),setStatesStylesFromModel(el,itemModel),function(layout){return null!=layout.startAngle&&null!=layout.endAngle&&layout.startAngle===layout.endAngle}(layout)&&(el.style.fill="none",el.style.stroke="none",each(el.states,function(state){state.style&&(state.style.fill=state.style.stroke="none")}))}var LagePathShape=function(){},LargePath=function(_super){function LargePath(opts){opts=_super.call(this,opts)||this;return opts.type="largeBar",opts}return __extends(LargePath,_super),LargePath.prototype.getDefaultShape=function(){return new LagePathShape},LargePath.prototype.buildPath=function(ctx,shape){for(var points=shape.points,baseDimIdx=this.baseDimIdx,valueDimIdx=1-this.baseDimIdx,startPoint=[],size=[],barWidth=this.barWidth,i=0;i<points.length;i+=3)size[baseDimIdx]=barWidth,size[valueDimIdx]=points[i+2],startPoint[baseDimIdx]=points[i+baseDimIdx],startPoint[valueDimIdx]=points[i+valueDimIdx],ctx.rect(startPoint[0],startPoint[1],size[0],size[1])},LargePath}(Path);function createLarge(seriesModel,group,progressiveEls,incremental){var data=seriesModel.getData(),baseDimIdx=data.getLayout("valueAxisHorizontal")?1:0,largeDataIndices=data.getLayout("largeDataIndices"),barWidth=data.getLayout("size"),backgroundModel=seriesModel.getModel("backgroundStyle"),bgPoints=data.getLayout("largeBackgroundPoints"),backgroundModel=(bgPoints&&((bgPoints=new LargePath({shape:{points:bgPoints},incremental:!!incremental,silent:!0,z2:0})).baseDimIdx=baseDimIdx,bgPoints.largeDataIndices=largeDataIndices,bgPoints.barWidth=barWidth,bgPoints.useStyle(backgroundModel.getItemStyle()),group.add(bgPoints),progressiveEls&&progressiveEls.push(bgPoints)),new LargePath({shape:{points:data.getLayout("largePoints")},incremental:!!incremental,z2:1}));backgroundModel.baseDimIdx=baseDimIdx,backgroundModel.largeDataIndices=largeDataIndices,backgroundModel.barWidth=barWidth,group.add(backgroundModel),backgroundModel.useStyle(data.getVisual("style")),getECData(backgroundModel).seriesIndex=seriesModel.seriesIndex,seriesModel.get("silent")||(backgroundModel.on("mousedown",largePathUpdateDataIndex),backgroundModel.on("mousemove",largePathUpdateDataIndex)),progressiveEls&&progressiveEls.push(backgroundModel)}var largePathUpdateDataIndex=throttle(function(event){event=function(largePath,x,y){for(var baseDimIdx=largePath.baseDimIdx,valueDimIdx=1-baseDimIdx,points=largePath.shape.points,largeDataIndices=largePath.largeDataIndices,startPoint=[],size=[],barWidth=largePath.barWidth,i=0,len=points.length/3;i<len;i++){var ii=3*i;if(size[baseDimIdx]=barWidth,size[valueDimIdx]=points[2+ii],startPoint[baseDimIdx]=points[ii+baseDimIdx],startPoint[valueDimIdx]=points[ii+valueDimIdx],size[valueDimIdx]<0&&(startPoint[valueDimIdx]+=size[valueDimIdx],size[valueDimIdx]=-size[valueDimIdx]),x>=startPoint[0]&&x<=startPoint[0]+size[0]&&y>=startPoint[1]&&y<=startPoint[1]+size[1])return largeDataIndices[i]}return-1}(this,event.offsetX,event.offsetY);getECData(this).dataIndex=0<=event?event:null},30,!1);function createBackgroundShape(isHorizontalOrRadial,layout,coord){var rectShape,coordLayout;return isCoordinateSystemType(coord,"cartesian2d")?(rectShape=layout,coordLayout=coord.getArea(),{x:(isHorizontalOrRadial?rectShape:coordLayout).x,y:(isHorizontalOrRadial?coordLayout:rectShape).y,width:(isHorizontalOrRadial?rectShape:coordLayout).width,height:(isHorizontalOrRadial?coordLayout:rectShape).height}):{cx:(coordLayout=coord.getArea()).cx,cy:coordLayout.cy,r0:(isHorizontalOrRadial?coordLayout:layout).r0,r:(isHorizontalOrRadial?coordLayout:layout).r,startAngle:isHorizontalOrRadial?layout.startAngle:0,endAngle:isHorizontalOrRadial?layout.endAngle:2*Math.PI}}use(function(registers){registers.registerChartView(BarView),registers.registerSeriesModel(BarSeriesModel),registers.registerLayout(registers.PRIORITY.VISUAL.LAYOUT,curry(layout,"bar")),registers.registerLayout(registers.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,createProgressiveLayout("bar")),registers.registerProcessor(registers.PRIORITY.PROCESSOR.STATISTIC,dataSample("bar")),registers.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(payload,ecModel){var componentType=payload.componentType||"series";ecModel.eachComponent({mainType:componentType,query:payload},function(componentModel){payload.sortInfo&&componentModel.axis.setCategorySortInfo(payload.sortInfo)})})});var _super,LineSeriesModel=function(_super){function LineSeriesModel(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=LineSeriesModel.type,_this.hasSymbolVisual=!0,_this}return __extends(LineSeriesModel,_super),LineSeriesModel.prototype.getInitialData=function(option){option=option.coordinateSystem;if("polar"!==option&&"cartesian2d"!==option)throw new Error("Line not support coordinateSystem besides cartesian and polar");return createSeriesData(null,this,{useEncodeDefaulter:!0})},LineSeriesModel.prototype.getLegendIcon=function(opt){var group=new Group,line=createSymbol("line",0,opt.itemHeight/2,opt.itemWidth,0,opt.lineStyle.stroke,!1),line=(group.add(line),line.setStyle(opt.lineStyle),this.getData().getVisual("symbol")),visualRotate=this.getData().getVisual("symbolRotate"),line="none"===line?"circle":line,size=.8*opt.itemHeight,size=createSymbol(line,(opt.itemWidth-size)/2,(opt.itemHeight-size)/2,size,size,opt.itemStyle.fill),visualRotate=(group.add(size),size.setStyle(opt.itemStyle),"inherit"===opt.iconRotate?visualRotate:opt.iconRotate||0);return size.rotation=visualRotate*Math.PI/180,size.setOrigin([opt.itemWidth/2,opt.itemHeight/2]),-1<line.indexOf("empty")&&(size.style.stroke=size.style.fill,size.style.fill="#fff",size.style.lineWidth=2),group},LineSeriesModel.type="series.line",LineSeriesModel.dependencies=["grid","polar"],LineSeriesModel.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},LineSeriesModel}(SeriesModel),Symbol$1=(__extends(Symbol,_super=Group),Symbol.prototype._createSymbol=function(symbolType,data,idx,symbolSize,keepAspect){this.removeAll();keepAspect=createSymbol(symbolType,-1,-1,2,2,null,keepAspect);keepAspect.attr({z2:100,culling:!0,scaleX:symbolSize[0]/2,scaleY:symbolSize[1]/2}),keepAspect.drift=driftSymbol,this._symbolType=symbolType,this.add(keepAspect)},Symbol.prototype.stopSymbolAnimation=function(toLastFrame){this.childAt(0).stopAnimation(null,toLastFrame)},Symbol.prototype.getSymbolType=function(){return this._symbolType},Symbol.prototype.getSymbolPath=function(){return this.childAt(0)},Symbol.prototype.highlight=function(){enterEmphasis(this.childAt(0))},Symbol.prototype.downplay=function(){leaveEmphasis(this.childAt(0))},Symbol.prototype.setZ=function(zlevel,z){var symbolPath=this.childAt(0);symbolPath.zlevel=zlevel,symbolPath.z=z},Symbol.prototype.setDraggable=function(draggable){var symbolPath=this.childAt(0);symbolPath.draggable=draggable,symbolPath.cursor=draggable?"move":symbolPath.cursor},Symbol.prototype.updateData=function(data,idx,seriesScope,opts){this.silent=!1;var keepAspect,symbolPath,target,symbolType=data.getItemVisual(idx,"symbol")||"circle",seriesModel=data.hostModel,symbolSize=Symbol.getSymbolSize(data,idx),isInit=symbolType!==this._symbolType,disableAnimation=opts&&opts.disableAnimation;isInit?(keepAspect=data.getItemVisual(idx,"symbolKeepAspect"),this._createSymbol(symbolType,data,idx,symbolSize,keepAspect)):((symbolPath=this.childAt(0)).silent=!1,target={scaleX:symbolSize[0]/2,scaleY:symbolSize[1]/2},disableAnimation?symbolPath.attr(target):updateProps(symbolPath,target,seriesModel,idx),saveOldStyle(symbolPath)),this._updateCommon(data,idx,symbolSize,seriesScope,opts),isInit&&(symbolPath=this.childAt(0),disableAnimation||(target={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:symbolPath.style.opacity}},symbolPath.scaleX=symbolPath.scaleY=0,symbolPath.style.opacity=0,initProps(symbolPath,target,seriesModel,idx))),disableAnimation&&this.childAt(0).stopAnimation("leave")},Symbol.prototype._updateCommon=function(data,idx,symbolSize,seriesScope,opts){var emphasisItemStyle,selectItemStyle,blurItemStyle,focus,blurScope,emphasisDisabled,labelStatesModels,hoverScale,symbolPath=this.childAt(0),seriesModel=data.hostModel,emphasisModel=(seriesScope&&(emphasisItemStyle=seriesScope.emphasisItemStyle,blurItemStyle=seriesScope.blurItemStyle,selectItemStyle=seriesScope.selectItemStyle,focus=seriesScope.focus,blurScope=seriesScope.blurScope,labelStatesModels=seriesScope.labelStatesModels,hoverScale=seriesScope.hoverScale,cursorStyle=seriesScope.cursorStyle,emphasisDisabled=seriesScope.emphasisDisabled),seriesScope&&!data.hasItemOption||(emphasisItemStyle=(emphasisModel=(seriesScope=seriesScope&&seriesScope.itemModel?seriesScope.itemModel:data.getItemModel(idx)).getModel("emphasis")).getModel("itemStyle").getItemStyle(),selectItemStyle=seriesScope.getModel(["select","itemStyle"]).getItemStyle(),blurItemStyle=seriesScope.getModel(["blur","itemStyle"]).getItemStyle(),focus=emphasisModel.get("focus"),blurScope=emphasisModel.get("blurScope"),emphasisDisabled=emphasisModel.get("disabled"),labelStatesModels=getLabelStatesModels(seriesScope),hoverScale=emphasisModel.getShallow("scale"),cursorStyle=seriesScope.getShallow("cursor")),data.getItemVisual(idx,"symbolRotate")),seriesScope=(symbolPath.attr("rotation",(emphasisModel||0)*Math.PI/180||0),normalizeSymbolOffset(data.getItemVisual(idx,"symbolOffset"),symbolSize)),emphasisModel=(seriesScope&&(symbolPath.x=seriesScope[0],symbolPath.y=seriesScope[1]),cursorStyle&&symbolPath.attr("cursor",cursorStyle),data.getItemVisual(idx,"style")),seriesScope=emphasisModel.fill,cursorStyle=(symbolPath instanceof ZRImage?(cursorStyle=symbolPath.style,symbolPath.useStyle(extend({image:cursorStyle.image,x:cursorStyle.x,y:cursorStyle.y,width:cursorStyle.width,height:cursorStyle.height},emphasisModel))):(symbolPath.__isEmptyBrush?symbolPath.useStyle(extend({},emphasisModel)):symbolPath.useStyle(emphasisModel),symbolPath.style.decal=null,symbolPath.setColor(seriesScope,opts&&opts.symbolInnerColor),symbolPath.style.strokeNoScale=!0),data.getItemVisual(idx,"liftZ")),z2Origin=this._z2,useNameLabel=(null!=cursorStyle?null==z2Origin&&(this._z2=symbolPath.z2,symbolPath.z2+=cursorStyle):null!=z2Origin&&(symbolPath.z2=z2Origin,this._z2=null),opts&&opts.useNameLabel);setLabelStyle(symbolPath,labelStatesModels,{labelFetcher:seriesModel,labelDataIndex:idx,defaultText:function(idx){return useNameLabel?data.getName(idx):getDefaultLabel(data,idx)},inheritColor:seriesScope,defaultOpacity:emphasisModel.opacity}),this._sizeX=symbolSize[0]/2,this._sizeY=symbolSize[1]/2;cursorStyle=symbolPath.ensureState("emphasis");cursorStyle.style=emphasisItemStyle,symbolPath.ensureState("select").style=selectItemStyle,symbolPath.ensureState("blur").style=blurItemStyle,hoverScale&&(z2Origin=Math.max(1.1,3/this._sizeY),cursorStyle.scaleX=this._sizeX*z2Origin,cursorStyle.scaleY=this._sizeY*z2Origin),this.setSymbolScale(1),toggleHoverEmphasis(this,focus,blurScope,emphasisDisabled)},Symbol.prototype.setSymbolScale=function(scale){this.scaleX=this.scaleY=scale},Symbol.prototype.fadeOut=function(cb,seriesModel,opt){var symbolPath=this.childAt(0),dataIndex=getECData(this).dataIndex,animationOpt=opt&&opt.animation;this.silent=symbolPath.silent=!0,opt&&opt.fadeLabel?(opt=symbolPath.getTextContent())&&removeElement(opt,{style:{opacity:0}},seriesModel,{dataIndex:dataIndex,removeOpt:animationOpt,cb:function(){symbolPath.removeTextContent()}}):symbolPath.removeTextContent(),removeElement(symbolPath,{style:{opacity:0},scaleX:0,scaleY:0},seriesModel,{dataIndex:dataIndex,cb:cb,removeOpt:animationOpt})},Symbol.getSymbolSize=function(data,idx){return[(data=isArray(data=data.getItemVisual(idx,"symbolSize"))?data:[+data,+data])[0]||0,data[1]||0]},Symbol);function Symbol(data,idx,seriesScope,opts){var _this=_super.call(this)||this;return _this.updateData(data,idx,seriesScope,opts),_this}function driftSymbol(dx,dy){this.parent.drift(dx,dy)}function symbolNeedsDraw(data,point,idx,opt){return point&&!isNaN(point[0])&&!isNaN(point[1])&&(!opt.isIgnore||!opt.isIgnore(idx))&&(!opt.clipShape||opt.clipShape.contain(point[0],point[1]))&&"none"!==data.getItemVisual(idx,"symbol")}function normalizeUpdateOpt(opt){return(opt=null==opt||isObject(opt)?opt:{isIgnore:opt})||{}}function makeSeriesScope(data){var data=data.hostModel,emphasisModel=data.getModel("emphasis");return{emphasisItemStyle:emphasisModel.getModel("itemStyle").getItemStyle(),blurItemStyle:data.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:data.getModel(["select","itemStyle"]).getItemStyle(),focus:emphasisModel.get("focus"),blurScope:emphasisModel.get("blurScope"),emphasisDisabled:emphasisModel.get("disabled"),hoverScale:emphasisModel.get("scale"),labelStatesModels:getLabelStatesModels(data),cursorStyle:data.get("cursor")}}var SymbolDraw=function(){function SymbolDraw(SymbolCtor){this.group=new Group,this._SymbolCtor=SymbolCtor||Symbol$1}return SymbolDraw.prototype.updateData=function(data,opt){this._progressiveEls=null,opt=normalizeUpdateOpt(opt);var group=this.group,seriesModel=data.hostModel,oldData=this._data,SymbolCtor=this._SymbolCtor,disableAnimation=opt.disableAnimation,seriesScope=makeSeriesScope(data),symbolUpdateOpt={disableAnimation:disableAnimation},getSymbolPoint=opt.getSymbolPoint||function(idx){return data.getItemLayout(idx)};oldData||group.removeAll(),data.diff(oldData).add(function(newIdx){var symbolEl,point=getSymbolPoint(newIdx);symbolNeedsDraw(data,point,newIdx,opt)&&((symbolEl=new SymbolCtor(data,newIdx,seriesScope,symbolUpdateOpt)).setPosition(point),data.setItemGraphicEl(newIdx,symbolEl),group.add(symbolEl))}).update(function(newIdx,oldIdx){var newSymbolType,oldSymbolType,oldIdx=oldData.getItemGraphicEl(oldIdx),point=getSymbolPoint(newIdx);symbolNeedsDraw(data,point,newIdx,opt)?(newSymbolType=data.getItemVisual(newIdx,"symbol")||"circle",oldSymbolType=oldIdx&&oldIdx.getSymbolType&&oldIdx.getSymbolType(),!oldIdx||oldSymbolType&&oldSymbolType!==newSymbolType?(group.remove(oldIdx),(oldIdx=new SymbolCtor(data,newIdx,seriesScope,symbolUpdateOpt)).setPosition(point)):(oldIdx.updateData(data,newIdx,seriesScope,symbolUpdateOpt),oldSymbolType={x:point[0],y:point[1]},disableAnimation?oldIdx.attr(oldSymbolType):updateProps(oldIdx,oldSymbolType,seriesModel)),group.add(oldIdx),data.setItemGraphicEl(newIdx,oldIdx)):group.remove(oldIdx)}).remove(function(oldIdx){var el=oldData.getItemGraphicEl(oldIdx);el&&el.fadeOut(function(){group.remove(el)},seriesModel)}).execute(),this._getSymbolPoint=getSymbolPoint,this._data=data},SymbolDraw.prototype.updateLayout=function(){var _this=this,data=this._data;data&&data.eachItemGraphicEl(function(el,idx){idx=_this._getSymbolPoint(idx);el.setPosition(idx),el.markRedraw()})},SymbolDraw.prototype.incrementalPrepareUpdate=function(data){this._seriesScope=makeSeriesScope(data),this._data=null,this.group.removeAll()},SymbolDraw.prototype.incrementalUpdate=function(taskParams,data,opt){function updateIncrementalAndHover(el){el.isGroup||(el.incremental=!0,el.ensureState("emphasis").hoverLayer=!0)}this._progressiveEls=[],opt=normalizeUpdateOpt(opt);for(var idx=taskParams.start;idx<taskParams.end;idx++){var el,point=data.getItemLayout(idx);symbolNeedsDraw(data,point,idx,opt)&&((el=new this._SymbolCtor(data,idx,this._seriesScope)).traverse(updateIncrementalAndHover),el.setPosition(point),this.group.add(el),data.setItemGraphicEl(idx,el),this._progressiveEls.push(el))}},SymbolDraw.prototype.eachRendered=function(cb){traverseElements(this._progressiveEls||this.group,cb)},SymbolDraw.prototype.remove=function(enableAnimation){var group=this.group,data=this._data;data&&enableAnimation?data.eachItemGraphicEl(function(el){el.fadeOut(function(){group.remove(el)},data.hostModel)}):group.removeAll()},SymbolDraw}();function prepareDataCoordInfo(coordSys,data,valueOrigin){var baseAxis=coordSys.getBaseAxis(),valueAxis=coordSys.getOtherAxis(baseAxis),valueOrigin=function(valueAxis,valueOrigin){var valueStart=0,valueAxis=valueAxis.scale.getExtent();"start"===valueOrigin?valueStart=valueAxis[0]:"end"===valueOrigin?valueStart=valueAxis[1]:0<valueAxis[0]?valueStart=valueAxis[0]:valueAxis[1]<0&&(valueStart=valueAxis[1]);return valueStart}(valueAxis,valueOrigin),baseAxis=baseAxis.dim,valueAxis=valueAxis.dim,valueDim=data.mapDimension(valueAxis),baseDim=data.mapDimension(baseAxis),baseDataOffset="x"===valueAxis||"radius"===valueAxis?1:0,coordSys=map(coordSys.dimensions,function(coordDim){return data.mapDimension(coordDim)}),stacked=!1,stackResultDim=data.getCalculationInfo("stackResultDimension");return isDimensionStacked(data,coordSys[0])&&(stacked=!0,coordSys[0]=stackResultDim),isDimensionStacked(data,coordSys[1])&&(stacked=!0,coordSys[1]=stackResultDim),{dataDimsForPoint:coordSys,valueStart:valueOrigin,valueAxisDim:valueAxis,baseAxisDim:baseAxis,stacked:!!stacked,valueDim:valueDim,baseDim:baseDim,baseDataOffset:baseDataOffset,stackedOverDimension:data.getCalculationInfo("stackedOverDimension")}}function getStackedOnPoint(dataCoordInfo,coordSys,data,idx){var value=NaN,baseDataOffset=(dataCoordInfo.stacked&&(value=data.get(data.getCalculationInfo("stackedOverDimension"),idx)),isNaN(value)&&(value=dataCoordInfo.valueStart),dataCoordInfo.baseDataOffset),stackedData=[];return stackedData[baseDataOffset]=data.get(dataCoordInfo.baseDim,idx),stackedData[1-baseDataOffset]=value,coordSys.dataToPoint(stackedData)}function lineAnimationDiff(oldData,newData,oldStackedOnPoints,newStackedOnPoints,oldCoordSys,newCoordSys,oldValueOrigin){for(var diff=function(oldData,newData){var diffResult=[];return newData.diff(oldData).add(function(idx){diffResult.push({cmd:"+",idx:idx})}).update(function(newIdx,oldIdx){diffResult.push({cmd:"=",idx:oldIdx,idx1:newIdx})}).remove(function(idx){diffResult.push({cmd:"-",idx:idx})}).execute(),diffResult}(oldData,newData),currPoints=[],nextPoints=[],currStackedPoints=[],nextStackedPoints=[],status=[],sortedIndices=[],rawIndices=[],newDataOldCoordInfo=prepareDataCoordInfo(oldCoordSys,newData,oldValueOrigin),oldPoints=oldData.getLayout("points")||[],newPoints=newData.getLayout("points")||[],i=0;i<diff.length;i++){var diffItem=diff[i],pointAdded=!0,newIdx2=void 0;switch(diffItem.cmd){case"=":var oldIdx2=2*diffItem.idx,newIdx2=2*diffItem.idx1,currentX=oldPoints[oldIdx2],currentY=oldPoints[1+oldIdx2],nextX=newPoints[newIdx2],nextY=newPoints[newIdx2+1];(isNaN(currentX)||isNaN(currentY))&&(currentX=nextX,currentY=nextY),currPoints.push(currentX,currentY),nextPoints.push(nextX,nextY),currStackedPoints.push(oldStackedOnPoints[oldIdx2],oldStackedOnPoints[1+oldIdx2]),nextStackedPoints.push(newStackedOnPoints[newIdx2],newStackedOnPoints[newIdx2+1]),rawIndices.push(newData.getRawIndex(diffItem.idx1));break;case"+":currentX=diffItem.idx,currentY=newDataOldCoordInfo.dataDimsForPoint,nextX=oldCoordSys.dataToPoint([newData.get(currentY[0],currentX),newData.get(currentY[1],currentX)]),nextY=(newIdx2=2*currentX,currPoints.push(nextX[0],nextX[1]),nextPoints.push(newPoints[newIdx2],newPoints[newIdx2+1]),getStackedOnPoint(newDataOldCoordInfo,oldCoordSys,newData,currentX));currStackedPoints.push(nextY[0],nextY[1]),nextStackedPoints.push(newStackedOnPoints[newIdx2],newStackedOnPoints[newIdx2+1]),rawIndices.push(newData.getRawIndex(currentX));break;case"-":pointAdded=!1}pointAdded&&(status.push(diffItem),sortedIndices.push(sortedIndices.length))}sortedIndices.sort(function(a,b){return rawIndices[a]-rawIndices[b]});for(var oldValueOrigin=currPoints.length,sortedCurrPoints=createFloat32Array(oldValueOrigin),sortedNextPoints=createFloat32Array(oldValueOrigin),sortedCurrStackedPoints=createFloat32Array(oldValueOrigin),sortedNextStackedPoints=createFloat32Array(oldValueOrigin),sortedStatus=[],i=0;i<sortedIndices.length;i++){var idx=sortedIndices[i],i2=2*i,idx2=2*idx;sortedCurrPoints[i2]=currPoints[idx2],sortedCurrPoints[1+i2]=currPoints[1+idx2],sortedNextPoints[i2]=nextPoints[idx2],sortedNextPoints[1+i2]=nextPoints[1+idx2],sortedCurrStackedPoints[i2]=currStackedPoints[idx2],sortedCurrStackedPoints[1+i2]=currStackedPoints[1+idx2],sortedNextStackedPoints[i2]=nextStackedPoints[idx2],sortedNextStackedPoints[1+i2]=nextStackedPoints[1+idx2],sortedStatus[i]=status[idx]}return{current:sortedCurrPoints,next:sortedNextPoints,stackedOnCurrent:sortedCurrStackedPoints,stackedOnNext:sortedNextStackedPoints,status:sortedStatus}}var mathMin$6=Math.min,mathMax$6=Math.max;function isPointNull$1(x,y){return isNaN(x)||isNaN(y)}function drawSegment(ctx,points,start,segLen,allLen,dir,smooth,smoothMonotone,connectNulls){for(var prevX,prevY,cpx0,cpy0,idx=start,k=0;k<segLen;k++){var x=points[2*idx],y=points[2*idx+1];if(allLen<=idx||idx<0)break;if(isPointNull$1(x,y)){if(connectNulls){idx+=dir;continue}break}if(idx===start)ctx[0<dir?"moveTo":"lineTo"](x,y),cpx0=x,cpy0=y;else{var dx=x-prevX,dy=y-prevY;if(dx*dx+dy*dy<.5){idx+=dir;continue}if(0<smooth){for(var nextIdx=idx+dir,nextX=points[2*nextIdx],nextY=points[2*nextIdx+1];nextX===x&&nextY===y&&k<segLen;)k++,idx+=dir,nextX=points[2*(nextIdx+=dir)],nextY=points[2*nextIdx+1],x=points[2*idx],y=points[2*idx+1];var tmpK=k+1;if(connectNulls)for(;isPointNull$1(nextX,nextY)&&tmpK<segLen;)tmpK++,nextX=points[2*(nextIdx+=dir)],nextY=points[2*nextIdx+1];var dx0,dx1,dy0,dy1,lenPrevSeg,lenNextSeg,cpx1,cpy1,dir_1,dx=0,dy=0,nextCpx0=void 0,nextCpy0=void 0;segLen<=tmpK||isPointNull$1(nextX,nextY)?(cpx1=x,cpy1=y):(dx=nextX-prevX,dy=nextY-prevY,dx0=x-prevX,dx1=nextX-x,dy0=y-prevY,dy1=nextY-y,lenNextSeg=lenPrevSeg=void 0,nextCpy0="x"===smoothMonotone?(cpx1=x-(dir_1=0<dx?1:-1)*(lenPrevSeg=Math.abs(dx0))*smooth,cpy1=y,nextCpx0=x+dir_1*(lenNextSeg=Math.abs(dx1))*smooth,y):"y"===smoothMonotone?(cpy1=y-(dir_1=0<dy?1:-1)*(lenPrevSeg=Math.abs(dy0))*smooth,nextCpx0=cpx1=x,y+dir_1*(lenNextSeg=Math.abs(dy1))*smooth):(lenPrevSeg=Math.sqrt(dx0*dx0+dy0*dy0),cpx1=x-dx*smooth*(1-(dx0=(lenNextSeg=Math.sqrt(dx1*dx1+dy1*dy1))/(lenNextSeg+lenPrevSeg))),cpy1=y-dy*smooth*(1-dx0),nextCpy0=y+dy*smooth*dx0,nextCpx0=mathMin$6(nextCpx0=x+dx*smooth*dx0,mathMax$6(nextX,x)),nextCpy0=mathMin$6(nextCpy0,mathMax$6(nextY,y)),nextCpx0=mathMax$6(nextCpx0,mathMin$6(nextX,x)),cpy1=y-(dy=(nextCpy0=mathMax$6(nextCpy0,mathMin$6(nextY,y)))-y)*lenPrevSeg/lenNextSeg,cpx1=mathMin$6(cpx1=x-(dx=nextCpx0-x)*lenPrevSeg/lenNextSeg,mathMax$6(prevX,x)),cpy1=mathMin$6(cpy1,mathMax$6(prevY,y)),nextCpx0=x+(dx=x-(cpx1=mathMax$6(cpx1,mathMin$6(prevX,x))))*lenNextSeg/lenPrevSeg,y+(dy=y-(cpy1=mathMax$6(cpy1,mathMin$6(prevY,y))))*lenNextSeg/lenPrevSeg)),ctx.bezierCurveTo(cpx0,cpy0,cpx1,cpy1,x,y),cpx0=nextCpx0,cpy0=nextCpy0}else ctx.lineTo(x,y)}prevX=x,prevY=y,idx+=dir}return k}var ECPolylineShape=function(){this.smooth=0,this.smoothConstraint=!0},ECPolyline=function(_super){function ECPolyline(opts){opts=_super.call(this,opts)||this;return opts.type="ec-polyline",opts}return __extends(ECPolyline,_super),ECPolyline.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},ECPolyline.prototype.getDefaultShape=function(){return new ECPolylineShape},ECPolyline.prototype.buildPath=function(ctx,shape){var points=shape.points,i=0,len=points.length/2;if(shape.connectNulls){for(;0<len&&isPointNull$1(points[2*len-2],points[2*len-1]);len--);for(;i<len&&isPointNull$1(points[2*i],points[2*i+1]);i++);}for(;i<len;)i+=drawSegment(ctx,points,i,len,len,1,shape.smooth,shape.smoothMonotone,shape.connectNulls)+1},ECPolyline.prototype.getPointOn=function(xOrY,dim){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var x0,y0,data=this.path.data,CMD=PathProxy.CMD,isDimX="x"===dim,roots=[],i=0;i<data.length;){var x=void 0,y=void 0;switch(data[i++]){case CMD.M:x0=data[i++],y0=data[i++];break;case CMD.L:var t,x=data[i++],y=data[i++];if((t=isDimX?(xOrY-x0)/(x-x0):(xOrY-y0)/(y-y0))<=1&&0<=t)return val=isDimX?(y-y0)*t+y0:(x-x0)*t+x0,isDimX?[xOrY,val]:[val,xOrY];x0=x,y0=y;break;case CMD.C:x=data[i++],y=data[i++];var x2=data[i++],y2=data[i++],x3=data[i++],y3=data[i++],nRoot=isDimX?cubicRootAt(x0,x,x2,x3,xOrY,roots):cubicRootAt(y0,y,y2,y3,xOrY,roots);if(0<nRoot)for(var i_1=0;i_1<nRoot;i_1++){var val,t_1=roots[i_1];if(t_1<=1&&0<=t_1)return val=isDimX?cubicAt(y0,y,y2,y3,t_1):cubicAt(x0,x,x2,x3,t_1),isDimX?[xOrY,val]:[val,xOrY]}x0=x3,y0=y3}}},ECPolyline}(Path),ECPolygonShape=function(_super){function ECPolygonShape(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ECPolygonShape,_super),ECPolygonShape}(ECPolylineShape),ECPolygon=function(_super){function ECPolygon(opts){opts=_super.call(this,opts)||this;return opts.type="ec-polygon",opts}return __extends(ECPolygon,_super),ECPolygon.prototype.getDefaultShape=function(){return new ECPolygonShape},ECPolygon.prototype.buildPath=function(ctx,shape){var points=shape.points,stackedOnPoints=shape.stackedOnPoints,i=0,len=points.length/2,smoothMonotone=shape.smoothMonotone;if(shape.connectNulls){for(;0<len&&isPointNull$1(points[2*len-2],points[2*len-1]);len--);for(;i<len&&isPointNull$1(points[2*i],points[2*i+1]);i++);}for(;i<len;){var k=drawSegment(ctx,points,i,len,len,1,shape.smooth,smoothMonotone,shape.connectNulls);drawSegment(ctx,stackedOnPoints,i+k-1,k,len,-1,shape.stackedOnSmooth,smoothMonotone,shape.connectNulls),i+=k+1,ctx.closePath()}},ECPolygon}(Path);function isPointsSame(points1,points2){if(points1.length===points2.length){for(var i=0;i<points1.length;i++)if(points1[i]!==points2[i])return;return 1}}function bboxFromPoints(points){for(var minX=1/0,minY=1/0,maxX=-1/0,maxY=-1/0,i=0;i<points.length;){var x=points[i++],y=points[i++];isNaN(x)||(minX=Math.min(x,minX),maxX=Math.max(x,maxX)),isNaN(y)||(minY=Math.min(y,minY),maxY=Math.max(y,maxY))}return[[minX,minY],[maxX,maxY]]}function getBoundingDiff(points1,points2){var points1=bboxFromPoints(points1),min1=points1[0],points1=points1[1],points2=bboxFromPoints(points2),min2=points2[0],points2=points2[1];return Math.max(Math.abs(min1[0]-min2[0]),Math.abs(min1[1]-min2[1]),Math.abs(points1[0]-points2[0]),Math.abs(points1[1]-points2[1]))}function getSmooth(smooth){return isNumber(smooth)?smooth:smooth?.5:0}function turnPointsIntoStep(points,coordSys,stepTurnAt,connectNulls){var coordSys=coordSys.getBaseAxis(),baseIndex="x"===coordSys.dim||"radius"===coordSys.dim?0:1,stepPoints=[],i=0,stepPt=[],pt=[],nextPt=[],filteredPoints=[];if(connectNulls){for(i=0;i<points.length;i+=2)isNaN(points[i])||isNaN(points[i+1])||filteredPoints.push(points[i],points[i+1]);points=filteredPoints}for(i=0;i<points.length-2;i+=2)switch(nextPt[0]=points[i+2],nextPt[1]=points[i+3],pt[0]=points[i],pt[1]=points[i+1],stepPoints.push(pt[0],pt[1]),stepTurnAt){case"end":stepPt[baseIndex]=nextPt[baseIndex],stepPt[1-baseIndex]=pt[1-baseIndex],stepPoints.push(stepPt[0],stepPt[1]);break;case"middle":var middle=(pt[baseIndex]+nextPt[baseIndex])/2,stepPt2=[];stepPt[baseIndex]=stepPt2[baseIndex]=middle,stepPt[1-baseIndex]=pt[1-baseIndex],stepPt2[1-baseIndex]=nextPt[1-baseIndex],stepPoints.push(stepPt[0],stepPt[1]),stepPoints.push(stepPt2[0],stepPt2[1]);break;default:stepPt[baseIndex]=pt[baseIndex],stepPt[1-baseIndex]=nextPt[1-baseIndex],stepPoints.push(stepPt[0],stepPt[1])}return stepPoints.push(points[i++],points[i++]),stepPoints}function getVisualGradient(data,coordSys,api){var visualMetaList=data.getVisual("visualMeta");if(visualMetaList&&visualMetaList.length&&data.count())if("cartesian2d"!==coordSys.type)console.warn("Visual map on line style is only supported on cartesian2d.");else{for(var visualMeta,i=visualMetaList.length-1;0<=i;i--){var coordDim,dimInfo=data.getDimensionInfo(visualMetaList[i].dimension);if("x"===(coordDim=dimInfo&&dimInfo.coordDim)||"y"===coordDim){visualMeta=visualMetaList[i];break}}if(visualMeta){var axis=coordSys.getAxis(coordDim),coordSys=map(visualMeta.stops,function(stop){return{coord:axis.toGlobalCoord(axis.dataToCoord(stop.value)),color:stop.color}}),stopLen=coordSys.length,outerColors=visualMeta.outerColors.slice(),api=(stopLen&&coordSys[0].coord>coordSys[stopLen-1].coord&&(coordSys.reverse(),outerColors.reverse()),function(colorStops,maxSize){var prevOutOfRangeColorStop,prevInRangeColorStop,newColorStops=[],len=colorStops.length;function lerpStop(stop0,stop1,clippedCoord){var coord0=stop0.coord;return{coord:clippedCoord,color:lerp$1((clippedCoord-coord0)/(stop1.coord-coord0),[stop0.color,stop1.color])}}for(var i=0;i<len;i++){var stop_1=colorStops[i],coord=stop_1.coord;if(coord<0)prevOutOfRangeColorStop=stop_1;else{if(maxSize<coord){prevInRangeColorStop?newColorStops.push(lerpStop(prevInRangeColorStop,stop_1,maxSize)):prevOutOfRangeColorStop&&newColorStops.push(lerpStop(prevOutOfRangeColorStop,stop_1,0),lerpStop(prevOutOfRangeColorStop,stop_1,maxSize));break}prevOutOfRangeColorStop&&(newColorStops.push(lerpStop(prevOutOfRangeColorStop,stop_1,0)),prevOutOfRangeColorStop=null),newColorStops.push(stop_1),prevInRangeColorStop=stop_1}}return newColorStops}(coordSys,"x"===coordDim?api.getWidth():api.getHeight())),inRangeStopLen=api.length;if(!inRangeStopLen&&stopLen)return coordSys[0].coord<0?outerColors[1]||coordSys[stopLen-1].color:outerColors[0]||coordSys[0].color;var minCoord=api[0].coord-10,stopLen=api[inRangeStopLen-1].coord+10,coordSpan=stopLen-minCoord;if(coordSpan<.001)return"transparent";each(api,function(stop){stop.offset=(stop.coord-minCoord)/coordSpan}),api.push({offset:inRangeStopLen?api[inRangeStopLen-1].offset:.5,color:outerColors[1]||"transparent"}),api.unshift({offset:inRangeStopLen?api[0].offset:.5,color:outerColors[0]||"transparent"});coordSys=new LinearGradient(0,0,0,0,api,!0);return coordSys[coordDim]=minCoord,coordSys[coordDim+"2"]=stopLen,coordSys}console.warn("Visual map on line style only support x or y dimension.")}}function getIsIgnoreFunc(seriesModel,data,coordSys){var seriesModel=seriesModel.get("showAllSymbol"),isAuto="auto"===seriesModel;if(!seriesModel||isAuto){var categoryDataDim,labelMap,categoryAxis=coordSys.getAxesByScale("ordinal")[0];if(categoryAxis)if(!isAuto||!function(categoryAxis,data){for(var axisExtent=categoryAxis.getExtent(),availSize=Math.abs(axisExtent[1]-axisExtent[0])/categoryAxis.scale.count(),dataLen=(isNaN(availSize)&&(availSize=0),data.count()),step=Math.max(1,Math.round(dataLen/5)),dataIndex=0;dataIndex<dataLen;dataIndex+=step)if(1.5*Symbol$1.getSymbolSize(data,dataIndex)[categoryAxis.isHorizontal()?1:0]>availSize)return;return 1}(categoryAxis,data))return categoryDataDim=data.mapDimension(categoryAxis.dim),labelMap={},each(categoryAxis.getViewLabels(),function(labelItem){labelItem=categoryAxis.scale.getRawOrdinalNumber(labelItem.tickValue);labelMap[labelItem]=1}),function(dataIndex){return!labelMap.hasOwnProperty(data.get(categoryDataDim,dataIndex))}}}function getLastIndexNotNull(points){for(var x,y,len=points.length/2;0<len&&(x=points[2*len-2],y=points[2*len-1],isNaN(x)||isNaN(y));len--);return len-1}function getPointAtIndex(points,idx){return[points[2*idx],points[2*idx+1]]}function anyStateShowEndLabel(seriesModel){if(seriesModel.get(["endLabel","show"]))return 1;for(var i=0;i<SPECIAL_STATES.length;i++)if(seriesModel.get([SPECIAL_STATES[i],"endLabel","show"]))return 1}function createLineClipPath(lineView,coordSys,hasAnimation,seriesModel){var endLabelModel_1,valueAnimation_1,data_1,labelAnimationRecord_1,during,isHorizontal,clipPath,rectShape,expandSize;return isCoordinateSystemType(coordSys,"cartesian2d")?(endLabelModel_1=seriesModel.getModel("endLabel"),valueAnimation_1=endLabelModel_1.get("valueAnimation"),data_1=seriesModel.getData(),labelAnimationRecord_1={lastFrameIndex:0},during=anyStateShowEndLabel(seriesModel)?function(percent,clipRect){lineView._endLabelOnDuring(percent,clipRect,data_1,labelAnimationRecord_1,valueAnimation_1,endLabelModel_1,coordSys)}:null,isHorizontal=coordSys.getBaseAxis().isHorizontal(),clipPath=createGridClipPath(coordSys,hasAnimation,seriesModel,function(){var endLabel=lineView._endLabel;endLabel&&hasAnimation&&null!=labelAnimationRecord_1.originalX&&endLabel.attr({x:labelAnimationRecord_1.originalX,y:labelAnimationRecord_1.originalY})},during),seriesModel.get("clip",!0)||(rectShape=clipPath.shape,expandSize=Math.max(rectShape.width,rectShape.height),isHorizontal?(rectShape.y-=expandSize,rectShape.height+=2*expandSize):(rectShape.x-=expandSize,rectShape.width+=2*expandSize)),during&&during(1,clipPath),clipPath):(seriesModel.get(["endLabel","show"])&&console.warn("endLabel is not supported for lines in polar systems."),createPolarClipPath(coordSys,hasAnimation,seriesModel))}var LineView=function(_super){function LineView(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(LineView,_super),LineView.prototype.init=function(){var lineGroup=new Group,symbolDraw=new SymbolDraw;this.group.add(symbolDraw.group),this._symbolDraw=symbolDraw,this._lineGroup=lineGroup},LineView.prototype.render=function(seriesModel,ecModel,api){function changePolyState(toState){_this._changePolyState(toState)}var clipShapeForSymbol,_this=this,coordSys=seriesModel.coordinateSystem,group=this.group,data=seriesModel.getData(),lineStyleModel=seriesModel.getModel("lineStyle"),areaStyleModel=seriesModel.getModel("areaStyle"),points=data.getLayout("points")||[],isCoordSysPolar="polar"===coordSys.type,prevCoordSys=this._coordSys,symbolDraw=this._symbolDraw,polyline=this._polyline,polygon=this._polygon,lineGroup=this._lineGroup,hasAnimation=seriesModel.get("animation"),isAreaChart=!areaStyleModel.isEmpty(),valueOrigin=areaStyleModel.get("origin"),dataCoordInfo=prepareDataCoordInfo(coordSys,data,valueOrigin),dataCoordInfo=isAreaChart&&function(coordSys,data,dataCoordInfo){if(!dataCoordInfo.valueDim)return[];for(var len=data.count(),points=createFloat32Array(2*len),idx=0;idx<len;idx++){var pt=getStackedOnPoint(dataCoordInfo,coordSys,data,idx);points[2*idx]=pt[0],points[2*idx+1]=pt[1]}return points}(coordSys,data,dataCoordInfo),showSymbol=seriesModel.get("showSymbol"),connectNulls=seriesModel.get("connectNulls"),isIgnoreFunc=showSymbol&&!isCoordSysPolar&&getIsIgnoreFunc(seriesModel,data,coordSys),oldData=this._data,step=(oldData&&oldData.eachItemGraphicEl(function(el,idx){el.__temp&&(group.remove(el),oldData.setItemGraphicEl(idx,null))}),showSymbol||symbolDraw.remove(),group.add(lineGroup),!isCoordSysPolar&&seriesModel.get("step")),visualColor=(coordSys&&coordSys.getArea&&seriesModel.get("clip",!0)&&(null!=(clipShapeForSymbol=coordSys.getArea()).width?(clipShapeForSymbol.x-=.1,clipShapeForSymbol.y-=.1,clipShapeForSymbol.width+=.2,clipShapeForSymbol.height+=.2):clipShapeForSymbol.r0&&(clipShapeForSymbol.r0-=.5,clipShapeForSymbol.r+=.5)),this._clipShapeForSymbol=clipShapeForSymbol,getVisualGradient(data,coordSys,api)||data.getVisual("style")[data.getVisual("drawType")]),prevCoordSys=(polyline&&prevCoordSys.type===coordSys.type&&step===this._step?(isAreaChart&&!polygon?polygon=this._newPolygon(points,dataCoordInfo):polygon&&!isAreaChart&&(lineGroup.remove(polygon),polygon=this._polygon=null),isCoordSysPolar||this._initOrUpdateEndLabel(seriesModel,coordSys,convertToColorString(visualColor)),(prevCoordSys=lineGroup.getClipPath())?initProps(prevCoordSys,{shape:createLineClipPath(this,coordSys,!1,seriesModel).shape},seriesModel):lineGroup.setClipPath(createLineClipPath(this,coordSys,!0,seriesModel)),showSymbol&&symbolDraw.updateData(data,{isIgnore:isIgnoreFunc,clipShape:clipShapeForSymbol,disableAnimation:!0,getSymbolPoint:function(idx){return[points[2*idx],points[2*idx+1]]}}),isPointsSame(this._stackedOnPoints,dataCoordInfo)&&isPointsSame(this._points,points)||(hasAnimation?this._doUpdateAnimation(data,dataCoordInfo,coordSys,api,step,valueOrigin,connectNulls):(step&&(points=turnPointsIntoStep(points,coordSys,step,connectNulls),dataCoordInfo=dataCoordInfo&&turnPointsIntoStep(dataCoordInfo,coordSys,step,connectNulls)),polyline.setShape({points:points}),polygon&&polygon.setShape({points:points,stackedOnPoints:dataCoordInfo})))):(showSymbol&&symbolDraw.updateData(data,{isIgnore:isIgnoreFunc,clipShape:clipShapeForSymbol,disableAnimation:!0,getSymbolPoint:function(idx){return[points[2*idx],points[2*idx+1]]}}),hasAnimation&&this._initSymbolLabelAnimation(data,coordSys,clipShapeForSymbol),step&&(points=turnPointsIntoStep(points,coordSys,step,connectNulls),dataCoordInfo=dataCoordInfo&&turnPointsIntoStep(dataCoordInfo,coordSys,step,connectNulls)),polyline=this._newPolyline(points),isAreaChart&&(polygon=this._newPolygon(points,dataCoordInfo)),isCoordSysPolar||this._initOrUpdateEndLabel(seriesModel,coordSys,convertToColorString(visualColor)),lineGroup.setClipPath(createLineClipPath(this,coordSys,!0,seriesModel))),seriesModel.getModel("emphasis")),api=prevCoordSys.get("focus"),showSymbol=prevCoordSys.get("blurScope"),symbolDraw=prevCoordSys.get("disabled"),isIgnoreFunc=(polyline.useStyle(defaults(lineStyleModel.getLineStyle(),{fill:"none",stroke:visualColor,lineJoin:"bevel"})),setStatesStylesFromModel(polyline,seriesModel,"lineStyle"),0<polyline.style.lineWidth&&"bolder"===seriesModel.get(["emphasis","lineStyle","width"])&&(polyline.getState("emphasis").style.lineWidth=+polyline.style.lineWidth+1),getECData(polyline).seriesIndex=seriesModel.seriesIndex,toggleHoverEmphasis(polyline,api,showSymbol,symbolDraw),getSmooth(seriesModel.get("smooth"))),hasAnimation=seriesModel.get("smoothMonotone");polyline.setShape({smooth:isIgnoreFunc,smoothMonotone:hasAnimation,connectNulls:connectNulls}),polygon&&(clipShapeForSymbol=data.getCalculationInfo("stackedOnSeries"),isAreaChart=0,polygon.useStyle(defaults(areaStyleModel.getAreaStyle(),{fill:visualColor,opacity:.7,lineJoin:"bevel",decal:data.getVisual("style").decal})),clipShapeForSymbol&&(isAreaChart=getSmooth(clipShapeForSymbol.get("smooth"))),polygon.setShape({smooth:isIgnoreFunc,stackedOnSmooth:isAreaChart,smoothMonotone:hasAnimation,connectNulls:connectNulls}),setStatesStylesFromModel(polygon,seriesModel,"areaStyle"),getECData(polygon).seriesIndex=seriesModel.seriesIndex,toggleHoverEmphasis(polygon,api,showSymbol,symbolDraw));data.eachItemGraphicEl(function(el){el&&(el.onHoverStateChange=changePolyState)}),this._polyline.onHoverStateChange=changePolyState,this._data=data,this._coordSys=coordSys,this._stackedOnPoints=dataCoordInfo,this._points=points,this._step=step,this._valueOrigin=valueOrigin,seriesModel.get("triggerLineEvent")&&(this.packEventData(seriesModel,polyline),polygon&&this.packEventData(seriesModel,polygon))},LineView.prototype.packEventData=function(seriesModel,el){getECData(el).eventData={componentType:"series",componentSubType:"line",componentIndex:seriesModel.componentIndex,seriesIndex:seriesModel.seriesIndex,seriesName:seriesModel.name,seriesType:"line"}},LineView.prototype.highlight=function(seriesModel,ecModel,api,payload){var data=seriesModel.getData(),dataIndex=queryDataIndex(data,payload);if(this._changePolyState("emphasis"),!(dataIndex instanceof Array)&&null!=dataIndex&&0<=dataIndex){var points=data.getLayout("points");if(!(symbol=data.getItemGraphicEl(dataIndex))){var x=points[2*dataIndex],points=points[2*dataIndex+1];if(isNaN(x)||isNaN(points))return;if(this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(x,points))return;var symbol,zlevel=seriesModel.get("zlevel"),z=seriesModel.get("z"),x=((symbol=new Symbol$1(data,dataIndex)).x=x,symbol.y=points,symbol.setZ(zlevel,z),symbol.getSymbolPath().getTextContent());x&&(x.zlevel=zlevel,x.z=z,x.z2=this._polyline.z2+1),symbol.__temp=!0,data.setItemGraphicEl(dataIndex,symbol),symbol.stopSymbolAnimation(!0),this.group.add(symbol)}symbol.highlight()}else ChartView.prototype.highlight.call(this,seriesModel,ecModel,api,payload)},LineView.prototype.downplay=function(seriesModel,ecModel,api,payload){var symbol,data=seriesModel.getData(),dataIndex=queryDataIndex(data,payload);this._changePolyState("normal"),null!=dataIndex&&0<=dataIndex?(symbol=data.getItemGraphicEl(dataIndex))&&(symbol.__temp?(data.setItemGraphicEl(dataIndex,null),this.group.remove(symbol)):symbol.downplay()):ChartView.prototype.downplay.call(this,seriesModel,ecModel,api,payload)},LineView.prototype._changePolyState=function(toState){var polygon=this._polygon;setStatesFlag(this._polyline,toState),polygon&&setStatesFlag(polygon,toState)},LineView.prototype._newPolyline=function(points){var polyline=this._polyline;return polyline&&this._lineGroup.remove(polyline),polyline=new ECPolyline({shape:{points:points},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(polyline),this._polyline=polyline},LineView.prototype._newPolygon=function(points,stackedOnPoints){var polygon=this._polygon;return polygon&&this._lineGroup.remove(polygon),polygon=new ECPolygon({shape:{points:points,stackedOnPoints:stackedOnPoints},segmentIgnoreThreshold:2}),this._lineGroup.add(polygon),this._polygon=polygon},LineView.prototype._initSymbolLabelAnimation=function(data,coordSys,clipShape){var isHorizontalOrRadial,isCoordSysPolar,baseAxis=coordSys.getBaseAxis(),isAxisInverse=baseAxis.inverse,baseAxis=("cartesian2d"===coordSys.type?(isHorizontalOrRadial=baseAxis.isHorizontal(),isCoordSysPolar=!1):"polar"===coordSys.type&&(isHorizontalOrRadial="angle"===baseAxis.dim,isCoordSysPolar=!0),data.hostModel),seriesDuration=baseAxis.get("animationDuration"),seriesDalay=(isFunction(seriesDuration)&&(seriesDuration=seriesDuration(null)),baseAxis.get("animationDelay")||0),seriesDalayValue=isFunction(seriesDalay)?seriesDalay(null):seriesDalay;data.eachItemGraphicEl(function(symbol,idx){var start,end,polarClip,point,current,el=symbol;el&&(point=[symbol.x,symbol.y],current=end=start=void 0,clipShape&&(current=isCoordSysPolar?(polarClip=clipShape,point=coordSys.pointToCoord(point),isHorizontalOrRadial?(start=polarClip.startAngle,end=polarClip.endAngle,-point[1]/180*Math.PI):(start=polarClip.r0,end=polarClip.r,point[0])):isHorizontalOrRadial?(start=clipShape.x,end=clipShape.x+clipShape.width,symbol.x):(start=clipShape.y+clipShape.height,end=clipShape.y,symbol.y)),polarClip=end===start?0:(current-start)/(end-start),isAxisInverse&&(polarClip=1-polarClip),point=isFunction(seriesDalay)?seriesDalay(idx):seriesDuration*polarClip+seriesDalayValue,current=(symbol=el.getSymbolPath()).getTextContent(),el.attr({scaleX:0,scaleY:0}),el.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:point}),current&&current.animateFrom({style:{opacity:0}},{duration:300,delay:point}),symbol.disableLabelAnimation=!0)})},LineView.prototype._initOrUpdateEndLabel=function(seriesModel,coordSys,inheritColor){var endLabelModel=seriesModel.getModel("endLabel");if(anyStateShowEndLabel(seriesModel)){var data_2=seriesModel.getData(),polyline=this._polyline,points=data_2.getLayout("points");if(!points)return polyline.removeTextContent(),void(this._endLabel=null);var endLabel=this._endLabel,endLabel=(endLabel||((endLabel=this._endLabel=new ZRText({z2:200})).ignoreClip=!0,polyline.setTextContent(this._endLabel),polyline.disableLabelAnimation=!0),getLastIndexNotNull(points));0<=endLabel&&(setLabelStyle(polyline,getLabelStatesModels(seriesModel,"endLabel"),{inheritColor:inheritColor,labelFetcher:seriesModel,labelDataIndex:endLabel,defaultText:function(dataIndex,opt,interpolatedValue){return null!=interpolatedValue?getDefaultInterpolatedLabel(data_2,interpolatedValue):getDefaultLabel(data_2,dataIndex)},enableTextSetter:!0},function(endLabelModel,coordSys){var isHorizontal=(coordSys=coordSys.getBaseAxis()).isHorizontal(),coordSys=coordSys.inverse,align=isHorizontal?coordSys?"right":"left":"center",isHorizontal=isHorizontal?"middle":coordSys?"top":"bottom";return{normal:{align:endLabelModel.get("align")||align,verticalAlign:endLabelModel.get("verticalAlign")||isHorizontal}}}(endLabelModel,coordSys)),polyline.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},LineView.prototype._endLabelOnDuring=function(percent,clipRect,data,animationRecord,valueAnimation,endLabelModel,coordSys){var points,seriesModel,precision,distanceX,isHorizontal,indices,value,diff,connectNulls,pt,endLabel=this._endLabel,polyline=this._polyline;endLabel&&(percent<1&&null==animationRecord.originalX&&(animationRecord.originalX=endLabel.x,animationRecord.originalY=endLabel.y),points=data.getLayout("points"),connectNulls=(seriesModel=data.hostModel).get("connectNulls"),precision=endLabelModel.get("precision"),endLabelModel=endLabelModel.get("distance")||0,isHorizontal=(coordSys=coordSys.getBaseAxis()).isHorizontal(),coordSys=coordSys.inverse,clipRect=clipRect.shape,distanceX=(isHorizontal?endLabelModel:0)*(coordSys?-1:1),endLabelModel=(isHorizontal?0:-endLabelModel)*(coordSys?-1:1),value=void 0,1<=(diff=(indices=(isHorizontal=function(points,xOrY,dim){for(var a,b,len=points.length/2,dimIdx="x"===dim?0:1,prevIndex=0,nextIndex=-1,i=0;i<len;i++)if(b=points[2*i+dimIdx],!isNaN(b)&&!isNaN(points[2*i+1-dimIdx]))if(0===i)a=b;else{if(a<=xOrY&&xOrY<=b||xOrY<=a&&b<=xOrY){nextIndex=i;break}prevIndex=i,a=b}return{range:[prevIndex,nextIndex],t:(xOrY-a)/(b-a)}}(points,coordSys=coordSys?isHorizontal?clipRect.x:clipRect.y+clipRect.height:isHorizontal?clipRect.x+clipRect.width:clipRect.y,clipRect=isHorizontal?"x":"y")).range)[1]-indices[0])?(1<diff&&!connectNulls?(pt=getPointAtIndex(points,indices[0]),endLabel.attr({x:pt[0]+distanceX,y:pt[1]+endLabelModel}),valueAnimation&&(value=seriesModel.getRawValue(indices[0]))):((pt=polyline.getPointOn(coordSys,clipRect))&&endLabel.attr({x:pt[0]+distanceX,y:pt[1]+endLabelModel}),diff=seriesModel.getRawValue(indices[0]),connectNulls=seriesModel.getRawValue(indices[1]),valueAnimation&&(value=interpolateRawValues(data,precision,diff,connectNulls,isHorizontal.t))),animationRecord.lastFrameIndex=indices[0]):(pt=getPointAtIndex(points,polyline=1===percent||0<animationRecord.lastFrameIndex?indices[0]:0),valueAnimation&&(value=seriesModel.getRawValue(polyline)),endLabel.attr({x:pt[0]+distanceX,y:pt[1]+endLabelModel})),valueAnimation&&labelInner(endLabel).setLabelText(value))},LineView.prototype._doUpdateAnimation=function(data,stackedOnPoints,coordSys,api,step,valueOrigin,connectNulls){var polyline=this._polyline,polygon=this._polygon,seriesModel=data.hostModel,stackedOnPoints=lineAnimationDiff(this._data,data,this._stackedOnPoints,stackedOnPoints,this._coordSys,0,this._valueOrigin),current=stackedOnPoints.current,stackedOnCurrent=stackedOnPoints.stackedOnCurrent,next=stackedOnPoints.next,stackedOnNext=stackedOnPoints.stackedOnNext;if(step&&(current=turnPointsIntoStep(stackedOnPoints.current,coordSys,step,connectNulls),stackedOnCurrent=turnPointsIntoStep(stackedOnPoints.stackedOnCurrent,coordSys,step,connectNulls),next=turnPointsIntoStep(stackedOnPoints.next,coordSys,step,connectNulls),stackedOnNext=turnPointsIntoStep(stackedOnPoints.stackedOnNext,coordSys,step,connectNulls)),3e3<getBoundingDiff(current,next)||polygon&&3e3<getBoundingDiff(stackedOnCurrent,stackedOnNext))return polyline.stopAnimation(),polyline.setShape({points:next}),void(polygon&&(polygon.stopAnimation(),polygon.setShape({points:next,stackedOnPoints:stackedOnNext})));polyline.shape.__points=stackedOnPoints.current,polyline.shape.points=current;for(var el,coordSys={shape:{points:next}},updatedDataInfo=(stackedOnPoints.current!==current&&(coordSys.shape.__points=stackedOnPoints.next),polyline.stopAnimation(),updateProps(polyline,coordSys,seriesModel),polygon&&(polygon.setShape({points:current,stackedOnPoints:stackedOnCurrent}),polygon.stopAnimation(),updateProps(polygon,{shape:{stackedOnPoints:stackedOnNext}},seriesModel),polyline.shape.points!==polygon.shape.points&&(polygon.shape.points=polyline.shape.points)),[]),diffStatus=stackedOnPoints.status,i=0;i<diffStatus.length;i++)"="===diffStatus[i].cmd&&(el=data.getItemGraphicEl(diffStatus[i].idx1))&&updatedDataInfo.push({el:el,ptIdx:i});polyline.animators&&polyline.animators.length&&polyline.animators[0].during(function(){polygon&&polygon.dirtyShape();for(var points=polyline.shape.__points,i=0;i<updatedDataInfo.length;i++){var el=updatedDataInfo[i].el,offset=2*updatedDataInfo[i].ptIdx;el.x=points[offset],el.y=points[1+offset],el.markRedraw()}})},LineView.prototype.remove=function(ecModel){var group=this.group,oldData=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),oldData&&oldData.eachItemGraphicEl(function(el,idx){el.__temp&&(group.remove(el),oldData.setItemGraphicEl(idx,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},LineView.type="line",LineView}(ChartView);use(function(registers){var forceStoreInTypedArray;registers.registerChartView(LineView),registers.registerSeriesModel(LineSeriesModel),registers.registerLayout((forceStoreInTypedArray=!0,{seriesType:"line",plan:createRenderPlanner(),reset:function(seriesModel){var dimLen,stackResultDim,store,dimIdx0,dimIdx1,data=seriesModel.getData(),coordSys=seriesModel.coordinateSystem,seriesModel=seriesModel.pipelineContext,useTypedArray=forceStoreInTypedArray||seriesModel.large;if(coordSys)return seriesModel=map(coordSys.dimensions,function(dim){return data.mapDimension(dim)}).slice(0,2),dimLen=seriesModel.length,stackResultDim=data.getCalculationInfo("stackResultDimension"),isDimensionStacked(data,seriesModel[0])&&(seriesModel[0]=stackResultDim),isDimensionStacked(data,seriesModel[1])&&(seriesModel[1]=stackResultDim),store=data.getStore(),dimIdx0=data.getDimensionIndex(seriesModel[0]),dimIdx1=data.getDimensionIndex(seriesModel[1]),dimLen&&{progress:function(params,data){for(var segCount=params.end-params.start,points=useTypedArray&&createFloat32Array(segCount*dimLen),tmpIn=[],tmpOut=[],i=params.start,offset=0;i<params.end;i++){var x,point=void 0;point=1===dimLen?(x=store.get(dimIdx0,i),coordSys.dataToPoint(x,null,tmpOut)):(tmpIn[0]=store.get(dimIdx0,i),tmpIn[1]=store.get(dimIdx1,i),coordSys.dataToPoint(tmpIn,null,tmpOut)),useTypedArray?(points[offset++]=point[0],points[offset++]=point[1]):data.setItemLayout(i,point.slice())}useTypedArray&&data.setLayout("points",points)}}}})),registers.registerVisual({seriesType:"line",reset:function(seriesModel){var data=seriesModel.getData(),seriesModel=seriesModel.getModel("lineStyle").getLineStyle();seriesModel&&!seriesModel.stroke&&(seriesModel.stroke=data.getVisual("style").fill),data.setVisual("legendLineStyle",seriesModel)}}),registers.registerProcessor(registers.PRIORITY.PROCESSOR.STATISTIC,dataSample("line"))});var GridModel=function(_super){function GridModel(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(GridModel,_super),GridModel.type="grid",GridModel.dependencies=["xAxis","yAxis"],GridModel.layoutMode="box",GridModel.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},GridModel}(ComponentModel),CartesianAxisModel=function(_super){function CartesianAxisModel(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(CartesianAxisModel,_super),CartesianAxisModel.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",SINGLE_REFERRING).models[0]},CartesianAxisModel.type="cartesian2dAxis",CartesianAxisModel}(ComponentModel),LINE_STYLE_KEY_MAP=(mixin(CartesianAxisModel,AxisModelCommonMixin),{show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}}),classBase=merge({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},LINE_STYLE_KEY_MAP),WeakMap=merge({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},LINE_STYLE_KEY_MAP),axisDefault={category:classBase,value:WeakMap,time:merge({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},WeakMap),log:defaults({logBase:10},WeakMap)},AXIS_TYPES={value:1,category:1,time:1,log:1};function axisModelCreator(registers,axisName,BaseAxisModelClass,extraDefaultOption){each(AXIS_TYPES,function(v,axisType){var defaultOption=merge(merge({},axisDefault[axisType],!0),extraDefaultOption,!0),AxisModel=function(_super){function AxisModel(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=axisName+"Axis."+axisType,_this}return __extends(AxisModel,_super),AxisModel.prototype.mergeDefaultAndTheme=function(option,ecModel){var layoutMode=fetchLayoutMode(this),inputPositionParams=layoutMode?getLayoutParams(option):{};merge(option,ecModel.getTheme().get(axisType+"Axis")),merge(option,this.getDefaultOption()),option.type=getAxisType(option),layoutMode&&mergeLayoutParam(option,inputPositionParams,layoutMode)},AxisModel.prototype.optionUpdated=function(){"category"===this.option.type&&(this.__ordinalMeta=OrdinalMeta.createByAxisModel(this))},AxisModel.prototype.getCategories=function(rawData){var option=this.option;if("category"===option.type)return rawData?option.data:this.__ordinalMeta.categories},AxisModel.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},AxisModel.type=axisName+"Axis."+axisType,AxisModel.defaultOption=defaultOption,AxisModel}(BaseAxisModelClass);registers.registerComponentModel(AxisModel)}),registers.registerSubTypeDefaulter(axisName+"Axis",getAxisType)}function getAxisType(option){return option.type||(option.data?"category":"value")}var Arrow=function(){function Cartesian(name){this.type="cartesian",this._dimList=[],this._axes={},this.name=name||""}return Cartesian.prototype.getAxis=function(dim){return this._axes[dim]},Cartesian.prototype.getAxes=function(){return map(this._dimList,function(dim){return this._axes[dim]},this)},Cartesian.prototype.getAxesByScale=function(scaleType){return scaleType=scaleType.toLowerCase(),filter(this.getAxes(),function(axis){return axis.scale.type===scaleType})},Cartesian.prototype.addAxis=function(axis){var dim=axis.dim;this._axes[dim]=axis,this._dimList.push(dim)},Cartesian}(),cartesian2DDimensions=["x","y"];function canCalculateAffineTransform(scale$$1){return"interval"===scale$$1.type||"time"===scale$$1.type}var Cartesian2D=function(_super){function Cartesian2D(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type="cartesian2d",_this.dimensions=cartesian2DDimensions,_this}return __extends(Cartesian2D,_super),Cartesian2D.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var xScaleSpan,end,yScaleSpan,start,xAxisScale=this.getAxis("x").scale,yAxisScale=this.getAxis("y").scale;canCalculateAffineTransform(xAxisScale)&&canCalculateAffineTransform(yAxisScale)&&(xAxisScale=xAxisScale.getExtent(),yAxisScale=yAxisScale.getExtent(),start=this.dataToPoint([xAxisScale[0],yAxisScale[0]]),end=this.dataToPoint([xAxisScale[1],yAxisScale[1]]),xScaleSpan=xAxisScale[1]-xAxisScale[0],yScaleSpan=yAxisScale[1]-yAxisScale[0],xScaleSpan&&yScaleSpan&&(xScaleSpan=(end[0]-start[0])/xScaleSpan,end=(end[1]-start[1])/yScaleSpan,yScaleSpan=start[0]-xAxisScale[0]*xScaleSpan,xAxisScale=start[1]-yAxisScale[0]*end,start=this._transform=[xScaleSpan,0,0,end,yScaleSpan,xAxisScale],this._invTransform=invert([],start)))},Cartesian2D.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},Cartesian2D.prototype.containPoint=function(point){var axisX=this.getAxis("x"),axisY=this.getAxis("y");return axisX.contain(axisX.toLocalCoord(point[0]))&&axisY.contain(axisY.toLocalCoord(point[1]))},Cartesian2D.prototype.containData=function(data){return this.getAxis("x").containData(data[0])&&this.getAxis("y").containData(data[1])},Cartesian2D.prototype.dataToPoint=function(data,clamp,out){out=out||[];var xVal=data[0],yVal=data[1];if(this._transform&&null!=xVal&&isFinite(xVal)&&null!=yVal&&isFinite(yVal))return applyTransform(out,data,this._transform);var data=this.getAxis("x"),yAxis=this.getAxis("y");return out[0]=data.toGlobalCoord(data.dataToCoord(xVal,clamp)),out[1]=yAxis.toGlobalCoord(yAxis.dataToCoord(yVal,clamp)),out},Cartesian2D.prototype.clampData=function(data,out){var xScale=this.getAxis("x").scale,yScale=this.getAxis("y").scale,xAxisExtent=xScale.getExtent(),yAxisExtent=yScale.getExtent(),xScale=xScale.parse(data[0]),yScale=yScale.parse(data[1]);return(out=out||[])[0]=Math.min(Math.max(Math.min(xAxisExtent[0],xAxisExtent[1]),xScale),Math.max(xAxisExtent[0],xAxisExtent[1])),out[1]=Math.min(Math.max(Math.min(yAxisExtent[0],yAxisExtent[1]),yScale),Math.max(yAxisExtent[0],yAxisExtent[1])),out},Cartesian2D.prototype.pointToData=function(point,clamp){var out=[];if(this._invTransform)return applyTransform(out,point,this._invTransform);var xAxis=this.getAxis("x"),yAxis=this.getAxis("y");return out[0]=xAxis.coordToData(xAxis.toLocalCoord(point[0]),clamp),out[1]=yAxis.coordToData(yAxis.toLocalCoord(point[1]),clamp),out},Cartesian2D.prototype.getOtherAxis=function(axis){return this.getAxis("x"===axis.dim?"y":"x")},Cartesian2D.prototype.getArea=function(){var xExtent=this.getAxis("x").getGlobalExtent(),yExtent=this.getAxis("y").getGlobalExtent(),x=Math.min(xExtent[0],xExtent[1]),y=Math.min(yExtent[0],yExtent[1]),xExtent=Math.max(xExtent[0],xExtent[1])-x,yExtent=Math.max(yExtent[0],yExtent[1])-y;return new BoundingRect(x,y,xExtent,yExtent)},Cartesian2D}(Arrow),Axis2D=function(_super){function Axis2D(dim,scale,coordExtent,axisType,position){dim=_super.call(this,dim,scale,coordExtent)||this;return dim.index=0,dim.type=axisType||"value",dim.position=position||"bottom",dim}return __extends(Axis2D,_super),Axis2D.prototype.isHorizontal=function(){var position=this.position;return"top"===position||"bottom"===position},Axis2D.prototype.getGlobalExtent=function(asc){var ret=this.getExtent();return ret[0]=this.toGlobalCoord(ret[0]),ret[1]=this.toGlobalCoord(ret[1]),asc&&ret[0]>ret[1]&&ret.reverse(),ret},Axis2D.prototype.pointToData=function(point,clamp){return this.coordToData(this.toLocalCoord(point["x"===this.dim?0:1]),clamp)},Axis2D.prototype.setCategorySortInfo=function(info){if("category"!==this.type)return!1;this.model.option.categorySortInfo=info,this.scale.setSortInfo(info)},Axis2D}(LineStyleMixin);function layout$1(gridModel,axisModel,opt){opt=opt||{};var gridModel=gridModel.coordinateSystem,axis=axisModel.axis,layout={},otherAxisOnZeroOf=axis.getAxesOnZeroOf()[0],rawAxisPosition=axis.position,axisPosition=otherAxisOnZeroOf?"onZero":rawAxisPosition,axis=axis.dim,gridModel=gridModel.getRect(),gridModel=[gridModel.x,gridModel.x+gridModel.width,gridModel.y,gridModel.y+gridModel.height],idx={left:0,right:1,top:0,bottom:1,onZero:2},axisOffset=axisModel.get("offset")||0,axisOffset="x"===axis?[gridModel[2]-axisOffset,gridModel[3]+axisOffset]:[gridModel[0]-axisOffset,gridModel[1]+axisOffset],onZeroCoord=(otherAxisOnZeroOf&&(onZeroCoord=otherAxisOnZeroOf.toGlobalCoord(otherAxisOnZeroOf.dataToCoord(0)),axisOffset[idx.onZero]=Math.max(Math.min(onZeroCoord,axisOffset[1]),axisOffset[0])),layout.position=["y"===axis?axisOffset[idx[axisPosition]]:gridModel[0],"x"===axis?axisOffset[idx[axisPosition]]:gridModel[3]],layout.rotation=Math.PI/2*("x"===axis?0:1),layout.labelDirection=layout.tickDirection=layout.nameDirection={top:-1,bottom:1,left:-1,right:1}[rawAxisPosition],layout.labelOffset=otherAxisOnZeroOf?axisOffset[idx[rawAxisPosition]]-axisOffset[idx.onZero]:0,axisModel.get(["axisTick","inside"])&&(layout.tickDirection=-layout.tickDirection),retrieve(opt.labelInside,axisModel.get(["axisLabel","inside"]))&&(layout.labelDirection=-layout.labelDirection),axisModel.get(["axisLabel","rotate"]));return layout.labelRotate="top"===axisPosition?-onZeroCoord:onZeroCoord,layout.z2=1,layout}function isCartesian2DSeries(seriesModel){return"cartesian2d"===seriesModel.get("coordinateSystem")}function findAxisModels(seriesModel){var axisModelMap={xAxisModel:null,yAxisModel:null};return each(axisModelMap,function(v,key){var axisType=key.replace(/Model$/,""),axisModel=seriesModel.getReferringComponents(axisType,SINGLE_REFERRING).models[0];if(!axisModel)throw new Error(axisType+' "'+retrieve3(seriesModel.get(axisType+"Index"),seriesModel.get(axisType+"Id"),0)+'" not found');axisModelMap[key]=axisModel}),axisModelMap}var mathLog$1=Math.log;function alignScaleTicks(scale,axisModel,alignToScale){var intervalScaleProto=IntervalScale.prototype,alignToTicks=intervalScaleProto.getTicks.call(alignToScale),alignToNicedTicks=intervalScaleProto.getTicks.call(alignToScale,!0),alignToSplitNumber=alignToTicks.length-1,alignToScale=intervalScaleProto.getInterval.call(alignToScale),scaleExtent=getScaleExtent(scale,axisModel),rawExtent=scaleExtent.extent,isMinFixed=scaleExtent.fixMin,scaleExtent=scaleExtent.fixMax,logBase=("log"===scale.type&&(logBase=mathLog$1(scale.base),rawExtent=[mathLog$1(rawExtent[0])/logBase,mathLog$1(rawExtent[1])/logBase]),scale.setExtent(rawExtent[0],rawExtent[1]),scale.calcNiceExtent({splitNumber:alignToSplitNumber,fixMin:isMinFixed,fixMax:scaleExtent}),intervalScaleProto.getExtent.call(scale)),interval=(isMinFixed&&(rawExtent[0]=logBase[0]),scaleExtent&&(rawExtent[1]=logBase[1]),intervalScaleProto.getInterval.call(scale)),min=rawExtent[0],max=rawExtent[1];if(isMinFixed&&scaleExtent)interval=(max-min)/alignToSplitNumber;else if(isMinFixed)for(max=rawExtent[0]+interval*alignToSplitNumber;max<rawExtent[1]&&isFinite(max)&&isFinite(rawExtent[1]);)interval=increaseInterval(interval),max=rawExtent[0]+interval*alignToSplitNumber;else if(scaleExtent)for(min=rawExtent[1]-interval*alignToSplitNumber;min>rawExtent[0]&&isFinite(min)&&isFinite(rawExtent[0]);)interval=increaseInterval(interval),min=rawExtent[1]-interval*alignToSplitNumber;else{logBase=(interval=alignToSplitNumber<scale.getTicks().length-1?increaseInterval(interval):interval)*alignToSplitNumber;(min=round((max=Math.ceil(rawExtent[1]/interval)*interval)-logBase))<0&&0<=rawExtent[0]?(min=0,max=round(logBase)):0<max&&rawExtent[1]<=0&&(max=0,min=-round(logBase))}isMinFixed=(alignToTicks[0].value-alignToNicedTicks[0].value)/alignToScale,scaleExtent=(alignToTicks[alignToSplitNumber].value-alignToNicedTicks[alignToSplitNumber].value)/alignToScale,intervalScaleProto.setExtent.call(scale,min+interval*isMinFixed,max+interval*scaleExtent),intervalScaleProto.setInterval.call(scale,interval),(isMinFixed||scaleExtent)&&intervalScaleProto.setNiceExtent.call(scale,min+interval,max-interval),logBase=intervalScaleProto.getTicks.call(scale);logBase[1]&&(alignToTicks=interval,alignToNicedTicks=Math.pow(10,quantityExponent(Math.abs(alignToTicks))),0!==(alignToTicks=Math.abs(alignToTicks/alignToNicedTicks))&&1!==alignToTicks&&2!==alignToTicks&&3!==alignToTicks&&5!==alignToTicks||getPrecisionSafe(logBase[1].value)>getPrecisionSafe(interval))&&warn("The ticks may be not readable when set min: "+axisModel.get("min")+", max: "+axisModel.get("max")+" and alignTicks: true")}var Grid=function(){function Grid(gridModel,ecModel,api){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=cartesian2DDimensions,this._initCartesian(gridModel,ecModel,api),this.model=gridModel}return Grid.prototype.getRect=function(){return this._rect},Grid.prototype.update=function(ecModel,api){var axesMap=this._axesMap;function updateAxisTicks(axes){var alignTo,axesIndices=keys(axes),len=axesIndices.length;if(len){for(var axisNeedsAlign=[],i=len-1;0<=i;i--){var axis=axes[+axesIndices[i]],model=axis.model,scale=axis.scale;isIntervalOrLogScale(scale)&&model.get("alignTicks")&&null==model.get("interval")?axisNeedsAlign.push(axis):(niceScaleExtent(scale,model),isIntervalOrLogScale(scale)&&(alignTo=axis))}axisNeedsAlign.length&&(alignTo||niceScaleExtent((alignTo=axisNeedsAlign.pop()).scale,alignTo.model),each(axisNeedsAlign,function(axis){alignScaleTicks(axis.scale,axis.model,alignTo.scale)}))}}this._updateScale(ecModel,this.model),updateAxisTicks(axesMap.x),updateAxisTicks(axesMap.y);var onZeroRecords={};each(axesMap.x,function(xAxis){fixAxisOnZero(axesMap,"y",xAxis,onZeroRecords)}),each(axesMap.y,function(yAxis){fixAxisOnZero(axesMap,"x",yAxis,onZeroRecords)}),this.resize(this.model,api)},Grid.prototype.resize=function(gridModel,api,ignoreContainLabel){var boxLayoutParams=gridModel.getBoxLayoutParams(),ignoreContainLabel=!ignoreContainLabel&&gridModel.get("containLabel"),gridRect=getLayoutRect(boxLayoutParams,{width:api.getWidth(),height:api.getHeight()}),axesList=(this._rect=gridRect,this._axesList);function adjustAxes(){each(axesList,function(axis){var isHorizontal=axis.isHorizontal(),extent=isHorizontal?[0,gridRect.width]:[0,gridRect.height],idx=axis.inverse?1:0;axis.setExtent(extent[idx],extent[1-idx]),function(axis,coordBase){var axisExtent=axis.getExtent(),axisExtentSum=axisExtent[0]+axisExtent[1];axis.toGlobalCoord="x"===axis.dim?function(coord){return coord+coordBase}:function(coord){return axisExtentSum-coord+coordBase},axis.toLocalCoord="x"===axis.dim?function(coord){return coord-coordBase}:function(coord){return axisExtentSum-coord+coordBase}}(axis,isHorizontal?gridRect.x:gridRect.y)})}adjustAxes(),ignoreContainLabel&&(each(axesList,function(axis){var labelUnionRect,dim,margin;axis.model.get(["axisLabel","inside"])||(labelUnionRect=estimateLabelUnionRect(axis))&&(dim=axis.isHorizontal()?"height":"width",margin=axis.model.get(["axisLabel","margin"]),gridRect[dim]-=labelUnionRect[dim]+margin,"top"===axis.position?gridRect.y+=labelUnionRect.height+margin:"left"===axis.position&&(gridRect.x+=labelUnionRect.width+margin))}),adjustAxes()),each(this._coordsList,function(coord){coord.calcAffineTransform()})},Grid.prototype.getAxis=function(dim,axisIndex){dim=this._axesMap[dim];if(null!=dim)return dim[axisIndex||0]},Grid.prototype.getAxes=function(){return this._axesList.slice()},Grid.prototype.getCartesian=function(xAxisIndex,yAxisIndex){if(null!=xAxisIndex&&null!=yAxisIndex)return this._coordsMap["x"+xAxisIndex+"y"+yAxisIndex];isObject(xAxisIndex)&&(yAxisIndex=xAxisIndex.yAxisIndex,xAxisIndex=xAxisIndex.xAxisIndex);for(var i=0,coordList=this._coordsList;i<coordList.length;i++)if(coordList[i].getAxis("x").index===xAxisIndex||coordList[i].getAxis("y").index===yAxisIndex)return coordList[i]},Grid.prototype.getCartesians=function(){return this._coordsList.slice()},Grid.prototype.convertToPixel=function(ecModel,finder,value){finder=this._findConvertTarget(finder);return finder.cartesian?finder.cartesian.dataToPoint(value):finder.axis?finder.axis.toGlobalCoord(finder.axis.dataToCoord(value)):null},Grid.prototype.convertFromPixel=function(ecModel,finder,value){finder=this._findConvertTarget(finder);return finder.cartesian?finder.cartesian.pointToData(value):finder.axis?finder.axis.coordToData(finder.axis.toLocalCoord(value)):null},Grid.prototype._findConvertTarget=function(finder){var cartesian,axis,seriesModel=finder.seriesModel,xAxisModel=finder.xAxisModel||seriesModel&&seriesModel.getReferringComponents("xAxis",SINGLE_REFERRING).models[0],yAxisModel=finder.yAxisModel||seriesModel&&seriesModel.getReferringComponents("yAxis",SINGLE_REFERRING).models[0],finder=finder.gridModel,coordsList=this._coordsList;return seriesModel?indexOf(coordsList,cartesian=seriesModel.coordinateSystem)<0&&(cartesian=null):xAxisModel&&yAxisModel?cartesian=this.getCartesian(xAxisModel.componentIndex,yAxisModel.componentIndex):xAxisModel?axis=this.getAxis("x",xAxisModel.componentIndex):yAxisModel?axis=this.getAxis("y",yAxisModel.componentIndex):finder&&finder.coordinateSystem===this&&(cartesian=this._coordsList[0]),{cartesian:cartesian,axis:axis}},Grid.prototype.containPoint=function(point){var coord=this._coordsList[0];if(coord)return coord.containPoint(point)},Grid.prototype._initCartesian=function(gridModel,ecModel,api){var _this=this,grid=this,axisPositionUsed={left:!1,right:!1,top:!1,bottom:!1},axesMap={x:{},y:{}},axesCount={x:0,y:0};if(ecModel.eachComponent("xAxis",createAxisCreator("x"),this),ecModel.eachComponent("yAxis",createAxisCreator("y"),this),!axesCount.x||!axesCount.y)return this._axesMap={},void(this._axesList=[]);function createAxisCreator(dimName){return function(axisModel,idx){var axisPosition,isCategory;isAxisUsedInTheGrid(axisModel,gridModel)&&(axisPosition=axisModel.get("position"),"x"===dimName?"top"!==axisPosition&&"bottom"!==axisPosition&&(axisPosition=axisPositionUsed.bottom?"top":"bottom"):"left"!==axisPosition&&"right"!==axisPosition&&(axisPosition=axisPositionUsed.left?"right":"left"),axisPositionUsed[axisPosition]=!0,isCategory="category"===(axisPosition=new Axis2D(dimName,createScaleByModel(axisModel),[0,0],axisModel.get("type"),axisPosition)).type,axisPosition.onBand=isCategory&&axisModel.get("boundaryGap"),axisPosition.inverse=axisModel.get("inverse"),(axisModel.axis=axisPosition).model=axisModel,axisPosition.grid=grid,axisPosition.index=idx,grid._axesList.push(axisPosition),axesMap[dimName][idx]=axisPosition,axesCount[dimName]++)}}each((this._axesMap=axesMap).x,function(xAxis,xAxisIndex){each(axesMap.y,function(yAxis,yAxisIndex){var yAxisIndex="x"+xAxisIndex+"y"+yAxisIndex,cartesian=new Cartesian2D(yAxisIndex);cartesian.master=_this,cartesian.model=gridModel,_this._coordsMap[yAxisIndex]=cartesian,_this._coordsList.push(cartesian),cartesian.addAxis(xAxis),cartesian.addAxis(yAxis)})})},Grid.prototype._updateScale=function(ecModel,gridModel){function unionExtent(data,axis){each(getDataDimensionsOnAxis(data,axis.dim),function(dim){axis.scale.unionExtentFromData(data,dim)})}each(this._axesList,function(axis){var categorySortInfo;axis.scale.setExtent(1/0,-1/0),"category"===axis.type&&(categorySortInfo=axis.model.get("categorySortInfo"),axis.scale.setSortInfo(categorySortInfo))}),ecModel.eachSeries(function(seriesModel){var axesModelMap,xAxisModel;isCartesian2DSeries(seriesModel)&&(xAxisModel=(axesModelMap=findAxisModels(seriesModel)).xAxisModel,axesModelMap=axesModelMap.yAxisModel,isAxisUsedInTheGrid(xAxisModel,gridModel)&&isAxisUsedInTheGrid(axesModelMap,gridModel)&&(xAxisModel=this.getCartesian(xAxisModel.componentIndex,axesModelMap.componentIndex),axesModelMap=seriesModel.getData(),seriesModel=xAxisModel.getAxis("x"),xAxisModel=xAxisModel.getAxis("y"),unionExtent(axesModelMap,seriesModel),unionExtent(axesModelMap,xAxisModel)))},this)},Grid.prototype.getTooltipAxes=function(dim){var baseAxes=[],otherAxes=[];return each(this.getCartesians(),function(cartesian){var baseAxis=null!=dim&&"auto"!==dim?cartesian.getAxis(dim):cartesian.getBaseAxis(),cartesian=cartesian.getOtherAxis(baseAxis);indexOf(baseAxes,baseAxis)<0&&baseAxes.push(baseAxis),indexOf(otherAxes,cartesian)<0&&otherAxes.push(cartesian)}),{baseAxes:baseAxes,otherAxes:otherAxes}},Grid.create=function(ecModel,api){var grids=[];return ecModel.eachComponent("grid",function(gridModel,idx){var grid=new Grid(gridModel,ecModel,api);grid.name="grid_"+idx,grid.resize(gridModel,api,!0),gridModel.coordinateSystem=grid,grids.push(grid)}),ecModel.eachSeries(function(seriesModel){if(isCartesian2DSeries(seriesModel)){var axesModelMap=findAxisModels(seriesModel),xAxisModel=axesModelMap.xAxisModel,axesModelMap=axesModelMap.yAxisModel,gridModel=xAxisModel.getCoordSysModel();if(!gridModel)throw new Error('Grid "'+retrieve3(xAxisModel.get("gridIndex"),xAxisModel.get("gridId"),0)+'" not found');if(xAxisModel.getCoordSysModel()!==axesModelMap.getCoordSysModel())throw new Error("xAxis and yAxis must use the same grid");gridModel=gridModel.coordinateSystem;seriesModel.coordinateSystem=gridModel.getCartesian(xAxisModel.componentIndex,axesModelMap.componentIndex)}}),grids},Grid.dimensions=cartesian2DDimensions,Grid}();function isAxisUsedInTheGrid(axisModel,gridModel){return axisModel.getCoordSysModel()===gridModel}function fixAxisOnZero(axesMap,otherAxisDim,axis,onZeroRecords){axis.getAxesOnZeroOf=function(){return otherAxisOnZeroOf?[otherAxisOnZeroOf]:[]};var otherAxisOnZeroOf,otherAxes=axesMap[otherAxisDim],axesMap=axis.model,otherAxisDim=axesMap.get(["axisLine","onZero"]),axis=axesMap.get(["axisLine","onZeroAxisIndex"]);if(otherAxisDim){if(null!=axis)canOnZeroToAxis(otherAxes[axis])&&(otherAxisOnZeroOf=otherAxes[axis]);else for(var idx in otherAxes)if(otherAxes.hasOwnProperty(idx)&&canOnZeroToAxis(otherAxes[idx])&&!onZeroRecords[getOnZeroRecordKey(otherAxes[idx])]){otherAxisOnZeroOf=otherAxes[idx];break}otherAxisOnZeroOf&&(onZeroRecords[getOnZeroRecordKey(otherAxisOnZeroOf)]=!0)}function getOnZeroRecordKey(axis){return axis.dim+"_"+axis.index}}function canOnZeroToAxis(axis){return axis&&"category"!==axis.type&&"time"!==axis.type&&function(axis){var min=(axis=axis.scale.getExtent())[0],axis=axis[1];return!(0<min&&0<axis||min<0&&axis<0)}(axis)}var PI$4=Math.PI,AxisBuilder=function(){function AxisBuilder(axisModel,opt){this.group=new Group,this.opt=opt,this.axisModel=axisModel,defaults(opt,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});axisModel=new Group({x:opt.position[0],y:opt.position[1],rotation:opt.rotation});axisModel.updateTransform(),this._transformGroup=axisModel}return AxisBuilder.prototype.hasBuilder=function(name){return!!builders[name]},AxisBuilder.prototype.add=function(name){builders[name](this.opt,this.axisModel,this.group,this._transformGroup)},AxisBuilder.prototype.getGroup=function(){return this.group},AxisBuilder.innerTextLayout=function(axisRotation,textRotation,direction){var textVerticalAlign,textRotation=remRadian(textRotation-axisRotation),axisRotation=isRadianAroundZero(textRotation)?(textVerticalAlign=0<direction?"top":"bottom","center"):isRadianAroundZero(textRotation-PI$4)?(textVerticalAlign=0<direction?"bottom":"top","center"):(textVerticalAlign="middle",0<textRotation&&textRotation<PI$4?0<direction?"right":"left":0<direction?"left":"right");return{rotation:textRotation,textAlign:axisRotation,textVerticalAlign:textVerticalAlign}},AxisBuilder.makeAxisEventDataBase=function(axisModel){var eventData={componentType:axisModel.mainType,componentIndex:axisModel.componentIndex};return eventData[axisModel.mainType+"Index"]=axisModel.componentIndex,eventData},AxisBuilder.isLabelSilent=function(axisModel){var tooltipOpt=axisModel.get("tooltip");return axisModel.get("silent")||!(axisModel.get("triggerEvent")||tooltipOpt&&tooltipOpt.show)},AxisBuilder}(),builders={axisLine:function(opt,axisModel,group,transformGroup){var pt1,lineStyle,arrows,symbolWidth_1,symbolHeight_1,shown=axisModel.get(["axisLine","show"]);(shown="auto"===shown&&opt.handleAutoShown?opt.handleAutoShown("axisLine"):shown)&&(shown=axisModel.axis.getExtent(),transformGroup=transformGroup.transform,pt1=[shown[0],0],shown=[shown[1],0],transformGroup&&(applyTransform(pt1,pt1,transformGroup),applyTransform(shown,shown,transformGroup)),lineStyle=extend({lineCap:"round"},axisModel.getModel(["axisLine","lineStyle"]).getLineStyle()),(transformGroup=new Line({subPixelOptimize:!0,shape:{x1:pt1[0],y1:pt1[1],x2:shown[0],y2:shown[1]},style:lineStyle,strokeContainThreshold:opt.strokeContainThreshold||5,silent:!0,z2:1})).anid="line",group.add(transformGroup),null!=(arrows=axisModel.get(["axisLine","symbol"]))&&(transformGroup=axisModel.get(["axisLine","symbolSize"]),isString(arrows)&&(arrows=[arrows,arrows]),(isString(transformGroup)||isNumber(transformGroup))&&(transformGroup=[transformGroup,transformGroup]),axisModel=normalizeSymbolOffset(axisModel.get(["axisLine","symbolOffset"])||0,transformGroup),symbolWidth_1=transformGroup[0],symbolHeight_1=transformGroup[1],each([{rotate:opt.rotation+Math.PI/2,offset:axisModel[0],r:0},{rotate:opt.rotation-Math.PI/2,offset:axisModel[1],r:Math.sqrt((pt1[0]-shown[0])*(pt1[0]-shown[0])+(pt1[1]-shown[1])*(pt1[1]-shown[1]))}],function(point,index){var r;"none"!==arrows[index]&&null!=arrows[index]&&(index=createSymbol(arrows[index],-symbolWidth_1/2,-symbolHeight_1/2,symbolWidth_1,symbolHeight_1,lineStyle.stroke,!0),r=point.r+point.offset,index.attr({rotation:point.rotate,x:pt1[0]+r*Math.cos(opt.rotation),y:pt1[1]-r*Math.sin(opt.rotation),silent:!0,z2:11}),group.add(index))})))},axisTickLabel:function(opt,axisModel,group,transformGroup){var ticksEls=function(group,transformGroup,axisModel,opt){var axis=axisModel.axis,tickModel=axisModel.getModel("axisTick"),shown=tickModel.get("show");"auto"===shown&&opt.handleAutoShown&&(shown=opt.handleAutoShown("axisTick"));if(shown&&!axis.scale.isBlank()){for(var shown=tickModel.getModel("lineStyle"),opt=opt.tickDirection*tickModel.get("length"),ticksEls=createTicks(axis.getTicksCoords(),transformGroup.transform,opt,defaults(shown.getLineStyle(),{stroke:axisModel.get(["axisLine","lineStyle","color"])}),"ticks"),i=0;i<ticksEls.length;i++)group.add(ticksEls[i]);return ticksEls}}(group,transformGroup,axisModel,opt),labelEls=function(group,transformGroup,axisModel,opt){var labelModel,labelMargin,labels,labelRotation,labelLayout,rawCategoryData,labelEls,silent,triggerEvent,axis=axisModel.axis;if(retrieve(opt.axisLabelShow,axisModel.get(["axisLabel","show"]))&&!axis.scale.isBlank())return labelModel=axisModel.getModel("axisLabel"),labelMargin=labelModel.get("margin"),labels=axis.getViewLabels(),labelRotation=(retrieve(opt.labelRotate,labelModel.get("rotate"))||0)*PI$4/180,labelLayout=AxisBuilder.innerTextLayout(opt.rotation,labelRotation,opt.labelDirection),rawCategoryData=axisModel.getCategories&&axisModel.getCategories(!0),labelEls=[],silent=AxisBuilder.isLabelSilent(axisModel),triggerEvent=axisModel.get("triggerEvent"),each(labels,function(labelItem,index){var tickValue="ordinal"===axis.scale.type?axis.scale.getRawOrdinalNumber(labelItem.tickValue):labelItem.tickValue,formattedLabel=labelItem.formattedLabel,rawLabel=labelItem.rawLabel,itemLabelModel=labelModel,rawCategoryItem=(rawCategoryData&&rawCategoryData[tickValue]&&(isObject(rawCategoryItem=rawCategoryData[tickValue])&&rawCategoryItem.textStyle&&(itemLabelModel=new Model(rawCategoryItem.textStyle,labelModel,axisModel.ecModel))),itemLabelModel.getTextColor()||axisModel.get(["axisLine","lineStyle","color"])),tickCoord=axis.dataToCoord(tickValue),tickCoord=new ZRText({x:tickCoord,y:opt.labelOffset+opt.labelDirection*labelMargin,rotation:labelLayout.rotation,silent:silent,z2:10+(labelItem.level||0),style:createTextStyle(itemLabelModel,{text:formattedLabel,align:itemLabelModel.getShallow("align",!0)||labelLayout.textAlign,verticalAlign:itemLabelModel.getShallow("verticalAlign",!0)||itemLabelModel.getShallow("baseline",!0)||labelLayout.textVerticalAlign,fill:isFunction(rawCategoryItem)?rawCategoryItem("category"===axis.type?rawLabel:"value"===axis.type?tickValue+"":tickValue,index):rawCategoryItem})});tickCoord.anid="label_"+tickValue,triggerEvent&&((labelItem=AxisBuilder.makeAxisEventDataBase(axisModel)).targetType="axisLabel",labelItem.value=rawLabel,labelItem.tickIndex=index,"category"===axis.type&&(labelItem.dataIndex=tickValue),getECData(tickCoord).eventData=labelItem),transformGroup.add(tickCoord),tickCoord.updateTransform(),labelEls.push(tickCoord),group.add(tickCoord),tickCoord.decomposeTransform()}),labelEls}(group,transformGroup,axisModel,opt);!function(axisModel,labelEls,tickEls){var showMinLabel,firstLabel,nextLabel,lastLabel,firstTick,nextTick,lastTick;shouldShowAllLabels(axisModel.axis)||(showMinLabel=axisModel.get(["axisLabel","showMinLabel"]),axisModel=axisModel.get(["axisLabel","showMaxLabel"]),tickEls=tickEls||[],firstLabel=(labelEls=labelEls||[])[0],nextLabel=labelEls[1],lastLabel=labelEls[labelEls.length-1],labelEls=labelEls[labelEls.length-2],firstTick=tickEls[0],nextTick=tickEls[1],lastTick=tickEls[tickEls.length-1],tickEls=tickEls[tickEls.length-2],!1===showMinLabel?(ignoreEl(firstLabel),ignoreEl(firstTick)):isTwoLabelOverlapped(firstLabel,nextLabel)&&(showMinLabel?(ignoreEl(nextLabel),ignoreEl(nextTick)):(ignoreEl(firstLabel),ignoreEl(firstTick))),!1===axisModel?(ignoreEl(lastLabel),ignoreEl(lastTick)):isTwoLabelOverlapped(labelEls,lastLabel)&&(axisModel?(ignoreEl(labelEls),ignoreEl(tickEls)):(ignoreEl(lastLabel),ignoreEl(lastTick))))}(axisModel,labelEls,ticksEls),function(group,transformGroup,axisModel,tickDirection){var axis=axisModel.axis,minorTickModel=axisModel.getModel("minorTick");if(minorTickModel.get("show")&&!axis.scale.isBlank()){var minorTicksCoords=axis.getMinorTicksCoords();if(minorTicksCoords.length)for(var axis=minorTickModel.getModel("lineStyle"),tickEndCoord=tickDirection*minorTickModel.get("length"),minorTickLineStyle=defaults(axis.getLineStyle(),defaults(axisModel.getModel("axisTick").getLineStyle(),{stroke:axisModel.get(["axisLine","lineStyle","color"])})),i=0;i<minorTicksCoords.length;i++)for(var minorTicksEls=createTicks(minorTicksCoords[i],transformGroup.transform,tickEndCoord,minorTickLineStyle,"minorticks_"+i),k=0;k<minorTicksEls.length;k++)group.add(minorTicksEls[k])}}(group,transformGroup,axisModel,opt.tickDirection),axisModel.get(["axisLabel","hideOverlap"])&&hideOverlap(prepareLayoutList(map(labelEls,function(label){return{label:label,priority:label.z2,defaultAttr:{ignore:label.ignore}}})))},axisName:function(opt,axisModel,group,transformGroup){var textStyleModel,gapSignal,labelLayout,axisNameAvailableWidth,nameDirection,gap,extent,nameLocation,name=retrieve(opt.axisName,axisModel.get("name"));name&&(nameLocation=axisModel.get("nameLocation"),nameDirection=opt.nameDirection,textStyleModel=axisModel.getModel("nameTextStyle"),gap=axisModel.get("nameGap")||0,gapSignal=(extent=axisModel.axis.getExtent())[0]>extent[1]?-1:1,gapSignal=["start"===nameLocation?extent[0]-gapSignal*gap:"end"===nameLocation?extent[1]+gapSignal*gap:(extent[0]+extent[1])/2,isNameLocationCenter(nameLocation)?opt.labelOffset+nameDirection*gap:0],null!=(gap=axisModel.get("nameRotate"))&&(gap=gap*PI$4/180),isNameLocationCenter(nameLocation)?labelLayout=AxisBuilder.innerTextLayout(opt.rotation,null!=gap?gap:opt.rotation,nameDirection):(labelLayout=function(rotation,textPosition,textRotate,extent){var textVerticalAlign,textRotate=remRadian(textRotate-rotation),rotation=extent[0]>extent[1],extent="start"===textPosition&&!rotation||"start"!==textPosition&&rotation;textPosition=isRadianAroundZero(textRotate-PI$4/2)?(textVerticalAlign=extent?"bottom":"top","center"):isRadianAroundZero(textRotate-1.5*PI$4)?(textVerticalAlign=extent?"top":"bottom","center"):(textVerticalAlign="middle",textRotate<1.5*PI$4&&PI$4/2<textRotate?extent?"left":"right":extent?"right":"left");return{rotation:textRotate,textAlign:textPosition,textVerticalAlign:textVerticalAlign}}(opt.rotation,nameLocation,gap||0,extent),null!=(axisNameAvailableWidth=opt.axisNameAvailableWidth)&&(axisNameAvailableWidth=Math.abs(axisNameAvailableWidth/Math.sin(labelLayout.rotation)),isFinite(axisNameAvailableWidth)||(axisNameAvailableWidth=null))),nameDirection=textStyleModel.getFont(),gap=(nameLocation=axisModel.get("nameTruncate",!0)||{}).ellipsis,extent=retrieve(opt.nameTruncateMaxWidth,nameLocation.maxWidth,axisNameAvailableWidth),setTooltipConfig({el:opt=new ZRText({x:gapSignal[0],y:gapSignal[1],rotation:labelLayout.rotation,silent:AxisBuilder.isLabelSilent(axisModel),style:createTextStyle(textStyleModel,{text:name,font:nameDirection,overflow:"truncate",width:extent,ellipsis:gap,fill:textStyleModel.getTextColor()||axisModel.get(["axisLine","lineStyle","color"]),align:textStyleModel.get("align")||labelLayout.textAlign,verticalAlign:textStyleModel.get("verticalAlign")||labelLayout.textVerticalAlign}),z2:1}),componentModel:axisModel,itemName:name}),opt.__fullText=name,opt.anid="name",axisModel.get("triggerEvent")&&((nameLocation=AxisBuilder.makeAxisEventDataBase(axisModel)).targetType="axisName",nameLocation.name=name,getECData(opt).eventData=nameLocation),transformGroup.add(opt),opt.updateTransform(),group.add(opt),opt.decomposeTransform())}};function ignoreEl(el){el&&(el.ignore=!0)}function isTwoLabelOverlapped(current,next){var mRotationBack,firstRect=current&&current.getBoundingRect().clone(),nextRect=next&&next.getBoundingRect().clone();if(firstRect&&nextRect)return mRotationBack=identity([]),rotate(mRotationBack,mRotationBack,-current.rotation),firstRect.applyTransform(mul$1([],mRotationBack,current.getLocalTransform())),nextRect.applyTransform(mul$1([],mRotationBack,next.getLocalTransform())),firstRect.intersect(nextRect)}function isNameLocationCenter(nameLocation){return"middle"===nameLocation||"center"===nameLocation}function createTicks(ticksCoords,tickTransform,tickEndCoord,tickLineStyle,anidPrefix){for(var tickEls=[],pt1=[],pt2=[],i=0;i<ticksCoords.length;i++){var tickCoord=ticksCoords[i].coord,tickCoord=(pt1[0]=tickCoord,pt2[pt1[1]=0]=tickCoord,pt2[1]=tickEndCoord,tickTransform&&(applyTransform(pt1,pt1,tickTransform),applyTransform(pt2,pt2,tickTransform)),new Line({subPixelOptimize:!0,shape:{x1:pt1[0],y1:pt1[1],x2:pt2[0],y2:pt2[1]},style:tickLineStyle,z2:2,autoBatch:!0,silent:!0}));tickCoord.anid=anidPrefix+"_"+ticksCoords[i].tickValue,tickEls.push(tickCoord)}return tickEls}function collect(ecModel,api){var result={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return function(result,ecModel,api){var globalTooltipModel=ecModel.getComponent("tooltip"),globalAxisPointerModel=ecModel.getComponent("axisPointer"),linksOption=globalAxisPointerModel.get("link",!0)||[],linkGroups=[];each(api.getCoordinateSystems(),function(coordSys){var axesInfoInCoordSys,baseTooltipModel,coordSysKey,cross,tooltipAxes;function saveTooltipAxisInfo(fromTooltip,triggerTooltip,axis){var involveSeries,axisPointerModel=axis.model.getModel("axisPointer",globalAxisPointerModel),axisPointerShow=axisPointerModel.get("show");axisPointerShow&&("auto"!==axisPointerShow||fromTooltip||isHandleTrigger(axisPointerModel))&&(null==triggerTooltip&&(triggerTooltip=axisPointerModel.get("triggerTooltip")),axisPointerShow=(axisPointerModel=fromTooltip?function(axis,baseTooltipModel,globalAxisPointerModel,ecModel,fromTooltip,triggerTooltip){var tooltipAxisPointerModel=baseTooltipModel.getModel("axisPointer"),volatileOption={};each(["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],function(field){volatileOption[field]=clone(tooltipAxisPointerModel.get(field))}),volatileOption.snap="category"!==axis.type&&!!triggerTooltip,"cross"===tooltipAxisPointerModel.get("type")&&(volatileOption.type="line");baseTooltipModel=volatileOption.label||(volatileOption.label={});null==baseTooltipModel.show&&(baseTooltipModel.show=!1),"cross"===fromTooltip&&(fromTooltip=tooltipAxisPointerModel.get(["label","show"]),baseTooltipModel.show=null==fromTooltip||fromTooltip,triggerTooltip||(fromTooltip=volatileOption.lineStyle=tooltipAxisPointerModel.get("crossStyle"))&&defaults(baseTooltipModel,fromTooltip.textStyle));return axis.model.getModel("axisPointer",new Model(volatileOption,globalAxisPointerModel,ecModel))}(axis,baseTooltipModel,globalAxisPointerModel,ecModel,fromTooltip,triggerTooltip):axisPointerModel).get("snap"),fromTooltip=makeKey(axis.model),involveSeries=triggerTooltip||axisPointerShow||"category"===axis.type,triggerTooltip=result.axesInfo[fromTooltip]={key:fromTooltip,axis:axis,coordSys:coordSys,axisPointerModel:axisPointerModel,triggerTooltip:triggerTooltip,involveSeries:involveSeries,snap:axisPointerShow,useHandle:isHandleTrigger(axisPointerModel),seriesModels:[],linkGroup:null},axesInfoInCoordSys[fromTooltip]=triggerTooltip,result.seriesInvolved=result.seriesInvolved||involveSeries,null!=(axisPointerShow=function(linksOption,axis){for(var axisModel=axis.model,dim=axis.dim,i=0;i<linksOption.length;i++){var linkOption=linksOption[i]||{};if(checkPropInLink(linkOption[dim+"AxisId"],axisModel.id)||checkPropInLink(linkOption[dim+"AxisIndex"],axisModel.componentIndex)||checkPropInLink(linkOption[dim+"AxisName"],axisModel.name))return i}}(linksOption,axis))&&((axisPointerModel=linkGroups[axisPointerShow]||(linkGroups[axisPointerShow]={axesInfo:{}})).axesInfo[fromTooltip]=triggerTooltip,axisPointerModel.mapper=linksOption[axisPointerShow].mapper,triggerTooltip.linkGroup=axisPointerModel))}coordSys.axisPointerEnabled&&(coordSysKey=makeKey(coordSys.model),axesInfoInCoordSys=result.coordSysAxesInfo[coordSysKey]={},baseTooltipModel=(result.coordSysMap[coordSysKey]=coordSys).model.getModel("tooltip",globalTooltipModel),each(coordSys.getAxes(),curry(saveTooltipAxisInfo,!1,null)),coordSys.getTooltipAxes&&globalTooltipModel&&baseTooltipModel.get("show")&&(coordSysKey="axis"===baseTooltipModel.get("trigger"),cross="cross"===baseTooltipModel.get(["axisPointer","type"]),tooltipAxes=coordSys.getTooltipAxes(baseTooltipModel.get(["axisPointer","axis"])),(coordSysKey||cross)&&each(tooltipAxes.baseAxes,curry(saveTooltipAxisInfo,!cross||"cross",coordSysKey)),cross&&each(tooltipAxes.otherAxes,curry(saveTooltipAxisInfo,"cross",!1))))})}(result,ecModel,api),result.seriesInvolved&&function(result,ecModel){ecModel.eachSeries(function(seriesModel){var coordSys=seriesModel.coordinateSystem,seriesTooltipTrigger=seriesModel.get(["tooltip","trigger"],!0),seriesTooltipShow=seriesModel.get(["tooltip","show"],!0);coordSys&&"none"!==seriesTooltipTrigger&&!1!==seriesTooltipTrigger&&"item"!==seriesTooltipTrigger&&!1!==seriesTooltipShow&&!1!==seriesModel.get(["axisPointer","show"],!0)&&each(result.coordSysAxesInfo[makeKey(coordSys.model)],function(axisInfo){var axis=axisInfo.axis;coordSys.getAxis(axis.dim)===axis&&(axisInfo.seriesModels.push(seriesModel),null==axisInfo.seriesDataCount&&(axisInfo.seriesDataCount=0),axisInfo.seriesDataCount+=seriesModel.getData().count())})})}(result,ecModel),result}function checkPropInLink(linkPropValue,axisPropValue){return"all"===linkPropValue||isArray(linkPropValue)&&0<=indexOf(linkPropValue,axisPropValue)||linkPropValue===axisPropValue}function getAxisInfo(axisModel){var coordSysAxesInfo=(axisModel.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return coordSysAxesInfo&&coordSysAxesInfo.axesInfo[makeKey(axisModel)]}function isHandleTrigger(axisPointerModel){return!!axisPointerModel.get(["handle","show"])}function makeKey(model){return model.type+"||"+model.id}var axisPointerClazz={},AxisView=function(_super){function AxisView(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=AxisView.type,_this}return __extends(AxisView,_super),AxisView.prototype.render=function(axisModel,ecModel,api,payload){this.axisPointerClass&&function(axisModel){var scale,option,value,axisPointerModel,status;(axisModel=getAxisInfo(axisModel))&&(axisPointerModel=axisModel.axisPointerModel,scale=axisModel.axis.scale,option=axisPointerModel.option,status=axisPointerModel.get("status"),null!=(value=axisPointerModel.get("value"))&&(value=scale.parse(value)),axisPointerModel=isHandleTrigger(axisPointerModel),null==status&&(option.status=axisPointerModel?"show":"hide"),(status=scale.getExtent().slice())[0]>status[1]&&status.reverse(),(value=null==value||value>status[1]?status[1]:value)<status[0]&&(value=status[0]),option.value=value,axisPointerModel&&(option.status=axisModel.axis.scale.isBlank()?"hide":"show"))}(axisModel),_super.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(axisModel,api,!0)},AxisView.prototype.updateAxisPointer=function(axisModel,ecModel,api,payload){this._doUpdateAxisPointerClass(axisModel,api,!1)},AxisView.prototype.remove=function(ecModel,api){var axisPointer=this._axisPointer;axisPointer&&axisPointer.remove(api)},AxisView.prototype.dispose=function(ecModel,api){this._disposeAxisPointer(api),_super.prototype.dispose.apply(this,arguments)},AxisView.prototype._doUpdateAxisPointerClass=function(axisModel,api,forceRender){var axisPointerModel,Clazz=AxisView.getAxisPointerClass(this.axisPointerClass);Clazz&&((axisPointerModel=function(axisModel){return(axisModel=getAxisInfo(axisModel))&&axisModel.axisPointerModel}(axisModel))?(this._axisPointer||(this._axisPointer=new Clazz)).render(axisModel,axisPointerModel,api,forceRender):this._disposeAxisPointer(api))},AxisView.prototype._disposeAxisPointer=function(api){this._axisPointer&&this._axisPointer.dispose(api),this._axisPointer=null},AxisView.registerAxisPointerClass=function(type,clazz){if(axisPointerClazz[type])throw new Error("axisPointer "+type+" exists");axisPointerClazz[type]=clazz},AxisView.getAxisPointerClass=function(type){return type&&axisPointerClazz[type]},AxisView.type="axis",AxisView}(ComponentView),inner$6=makeInner();var axisBuilderAttrs=["axisLine","axisTickLabel","axisName"],selfBuilderAttrs=["splitArea","splitLine","minorSplitLine"],Circle=function(_super){function CartesianAxisView(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=CartesianAxisView.type,_this.axisPointerClass="CartesianAxisPointer",_this}return __extends(CartesianAxisView,_super),CartesianAxisView.prototype.render=function(axisModel,ecModel,api,payload){this.group.removeAll();var gridModel,layout,oldAxisGroup=this._axisGroup;this._axisGroup=new Group,this.group.add(this._axisGroup),axisModel.get("show")&&(layout=layout$1(gridModel=axisModel.getCoordSysModel(),axisModel),layout=new AxisBuilder(axisModel,extend({handleAutoShown:function(elementType){for(var cartesians=gridModel.coordinateSystem.getCartesians(),i=0;i<cartesians.length;i++)if(isIntervalOrLogScale(cartesians[i].getOtherAxis(axisModel.axis).scale))return!0;return!1}},layout)),each(axisBuilderAttrs,layout.add,layout),this._axisGroup.add(layout.getGroup()),each(selfBuilderAttrs,function(name){axisModel.get([name,"show"])&&axisElementBuilders[name](this,this._axisGroup,axisModel,gridModel)},this),payload&&"changeAxisOrder"===payload.type&&payload.isInitSort||groupTransition(oldAxisGroup,this._axisGroup,axisModel),_super.prototype.render.call(this,axisModel,ecModel,api,payload))},CartesianAxisView.prototype.remove=function(){inner$6(this).splitAreaColors=null},CartesianAxisView.type="cartesianAxis",CartesianAxisView}(AxisView),axisElementBuilders={splitLine:function(axisView,axisGroup,axisModel,gridModel){var axis=axisModel.axis;if(!axis.scale.isBlank())for(var axisModel=axisModel.getModel("splitLine"),lineStyleModel=axisModel.getModel("lineStyle"),lineColors=isArray(lineColors=lineStyleModel.get("color"))?lineColors:[lineColors],gridRect=gridModel.coordinateSystem.getRect(),isHorizontal=axis.isHorizontal(),lineCount=0,ticksCoords=axis.getTicksCoords({tickModel:axisModel}),p1=[],p2=[],lineStyle=lineStyleModel.getLineStyle(),i=0;i<ticksCoords.length;i++){var tickCoord=axis.toGlobalCoord(ticksCoords[i].coord),tickCoord=(isHorizontal?(p1[0]=tickCoord,p1[1]=gridRect.y,p2[0]=tickCoord,p2[1]=gridRect.y+gridRect.height):(p1[0]=gridRect.x,p1[1]=tickCoord,p2[0]=gridRect.x+gridRect.width,p2[1]=tickCoord),lineCount++%lineColors.length),tickValue=ticksCoords[i].tickValue;axisGroup.add(new Line({anid:null!=tickValue?"line_"+ticksCoords[i].tickValue:null,subPixelOptimize:!0,autoBatch:!0,shape:{x1:p1[0],y1:p1[1],x2:p2[0],y2:p2[1]},style:defaults({stroke:lineColors[tickCoord]},lineStyle),silent:!0}))}},minorSplitLine:function(axisView,axisGroup,axisModel,gridModel){var axis=axisModel.axis,axisModel=axisModel.getModel("minorSplitLine").getModel("lineStyle"),gridRect=gridModel.coordinateSystem.getRect(),isHorizontal=axis.isHorizontal(),minorTicksCoords=axis.getMinorTicksCoords();if(minorTicksCoords.length)for(var p1=[],p2=[],lineStyle=axisModel.getLineStyle(),i=0;i<minorTicksCoords.length;i++)for(var k=0;k<minorTicksCoords[i].length;k++){var tickCoord=axis.toGlobalCoord(minorTicksCoords[i][k].coord);isHorizontal?(p1[0]=tickCoord,p1[1]=gridRect.y,p2[0]=tickCoord,p2[1]=gridRect.y+gridRect.height):(p1[0]=gridRect.x,p1[1]=tickCoord,p2[0]=gridRect.x+gridRect.width,p2[1]=tickCoord),axisGroup.add(new Line({anid:"minor_line_"+minorTicksCoords[i][k].tickValue,subPixelOptimize:!0,autoBatch:!0,shape:{x1:p1[0],y1:p1[1],x2:p2[0],y2:p2[1]},style:lineStyle,silent:!0}))}},splitArea:function(axisView,axisGroup,axisModel,gridModel){!function(axisView,axisGroup,axisModel,gridModel){var axis=axisModel.axis;if(!axis.scale.isBlank()){var axisModel=axisModel.getModel("splitArea"),areaStyleModel=axisModel.getModel("areaStyle"),areaColors=areaStyleModel.get("color"),gridRect=gridModel.coordinateSystem.getRect(),ticksCoords=axis.getTicksCoords({tickModel:axisModel,clamp:!0});if(ticksCoords.length){var areaColorsLen=areaColors.length,lastSplitAreaColors=inner$6(axisView).splitAreaColors,newSplitAreaColors=createHashMap(),colorIndex=0;if(lastSplitAreaColors)for(var i=0;i<ticksCoords.length;i++){var cIndex=lastSplitAreaColors.get(ticksCoords[i].tickValue);if(null!=cIndex){colorIndex=(cIndex+(areaColorsLen-1)*i)%areaColorsLen;break}}for(var prev=axis.toGlobalCoord(ticksCoords[0].coord),areaStyle=areaStyleModel.getAreaStyle(),areaColors=isArray(areaColors)?areaColors:[areaColors],i=1;i<ticksCoords.length;i++){var tickCoord=axis.toGlobalCoord(ticksCoords[i].coord),x=void 0,y=void 0,width=void 0,height=void 0,prev=axis.isHorizontal()?(x=prev,y=gridRect.y,height=gridRect.height,x+(width=tickCoord-x)):(x=gridRect.x,y=prev,width=gridRect.width,y+(height=tickCoord-y)),tickCoord=ticksCoords[i-1].tickValue;null!=tickCoord&&newSplitAreaColors.set(tickCoord,colorIndex),axisGroup.add(new Rect({anid:null!=tickCoord?"area_"+tickCoord:null,shape:{x:x,y:y,width:width,height:height},style:defaults({fill:areaColors[colorIndex]},areaStyle),autoBatch:!0,silent:!0})),colorIndex=(colorIndex+1)%areaColorsLen}inner$6(axisView).splitAreaColors=newSplitAreaColors}}}(axisView,axisGroup,axisModel,gridModel)}},CartesianXAxisView=function(_super){function CartesianXAxisView(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=CartesianXAxisView.type,_this}return __extends(CartesianXAxisView,_super),CartesianXAxisView.type="xAxis",CartesianXAxisView}(Circle),CartesianYAxisView=function(_super){function CartesianYAxisView(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=CartesianXAxisView.type,_this}return __extends(CartesianYAxisView,_super),CartesianYAxisView.type="yAxis",CartesianYAxisView}(Circle),GridView=function(_super){function GridView(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type="grid",_this}return __extends(GridView,_super),GridView.prototype.render=function(gridModel,ecModel){this.group.removeAll(),gridModel.get("show")&&this.group.add(new Rect({shape:gridModel.coordinateSystem.getRect(),style:defaults({fill:gridModel.get("backgroundColor")},gridModel.getItemStyle()),silent:!0,z2:-1}))},GridView.type="grid",GridView}(ComponentView),extraOption={offset:0};use(function(registers){registers.registerComponentView(GridView),registers.registerComponentModel(GridModel),registers.registerCoordinateSystem("cartesian2d",Grid),axisModelCreator(registers,"x",CartesianAxisModel,extraOption),axisModelCreator(registers,"y",CartesianAxisModel,extraOption),registers.registerComponentView(CartesianXAxisView),registers.registerComponentView(CartesianYAxisView),registers.registerPreprocessor(function(option){option.xAxis&&option.yAxis&&!option.grid&&(option.grid={})})});var inner$7=makeInner(),clone$3=clone,bind$1=bind;function updateProps$1(animationModel,moveAnimation,el,props){!function propsEqual(lastProps,newProps){{var equals_1;return isObject(lastProps)&&isObject(newProps)?(equals_1=!0,each(newProps,function(item,key){equals_1=equals_1&&propsEqual(lastProps[key],item)}),!!equals_1):lastProps===newProps}}(inner$7(el).lastProp,props)&&(inner$7(el).lastProp=props,moveAnimation?updateProps(el,props,animationModel):(el.stopAnimation(),el.attr(props)))}function updateLabelShowHide(labelEl,axisPointerModel){labelEl[axisPointerModel.get(["label","show"])?"show":"hide"]()}function getHandleTransProps(trans){return{x:trans.x||0,y:trans.y||0,rotation:trans.rotation||0}}function updateMandatoryProps(group,axisPointerModel,silent){var z=axisPointerModel.get("z"),zlevel=axisPointerModel.get("zlevel");group&&group.traverse(function(el){"group"!==el.type&&(null!=z&&(el.z=z),null!=zlevel&&(el.zlevel=zlevel),el.silent=silent)})}function buildLabelElOption(elOption,axisModel,axisPointerModel,api,labelPos){var text=getValueLabel(axisPointerModel.get("value"),axisModel.axis,axisModel.ecModel,axisPointerModel.get("seriesDataIndices"),{precision:axisPointerModel.get(["label","precision"]),formatter:axisPointerModel.get(["label","formatter"])}),axisPointerModel=axisPointerModel.getModel("label"),paddings=normalizeCssArray$1(axisPointerModel.get("padding")||0),font=axisPointerModel.getFont(),textRect=getBoundingRect(text,font),position=labelPos.position,width=textRect.width+paddings[1]+paddings[3],textRect=textRect.height+paddings[0]+paddings[2],align=labelPos.align,align=("right"===align&&(position[0]-=width),"center"===align&&(position[0]-=width/2),labelPos.verticalAlign),labelPos=("bottom"===align&&(position[1]-=textRect),"middle"===align&&(position[1]-=textRect/2),!function(position,width,height,api){var viewWidth=api.getWidth(),api=api.getHeight();position[0]=Math.min(position[0]+width,viewWidth)-width,position[1]=Math.min(position[1]+height,api)-height,position[0]=Math.max(position[0],0),position[1]=Math.max(position[1],0)}(position,width,textRect,api),axisPointerModel.get("backgroundColor"));labelPos&&"auto"!==labelPos||(labelPos=axisModel.get(["axisLine","lineStyle","color"])),elOption.label={x:position[0],y:position[1],style:createTextStyle(axisPointerModel,{text:text,font:font,fill:axisPointerModel.getTextColor(),padding:paddings,backgroundColor:labelPos}),z2:10}}function getValueLabel(value,axis,ecModel,seriesDataIndices,opt){value=axis.scale.parse(value);var params_1,text=axis.scale.getLabel({value:value},{precision:opt.precision}),opt=opt.formatter;return opt&&(params_1={value:getAxisRawValue(axis,{value:value}),axisDimension:axis.dim,axisIndex:axis.index,seriesData:[]},each(seriesDataIndices,function(idxItem){var series=ecModel.getSeriesByIndex(idxItem.seriesIndex),idxItem=idxItem.dataIndexInside,series=series&&series.getDataParams(idxItem);series&&params_1.seriesData.push(series)}),isString(opt)?text=opt.replace("{value}",text):isFunction(opt)&&(text=opt(params_1))),text}function getTransformedPosition(axis,value,layoutInfo){var transform=create$1();return rotate(transform,transform,layoutInfo.rotation),translate(transform,transform,layoutInfo.position),applyTransform$1([axis.dataToCoord(value),(layoutInfo.labelOffset||0)+(layoutInfo.labelDirection||1)*(layoutInfo.labelMargin||0)],transform)}var CartesianAxisPointer=function(_super){function CartesianAxisPointer(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(CartesianAxisPointer,_super),CartesianAxisPointer.prototype.makeElOption=function(elOption,value,axisModel,axisPointerModel,api){var elStyle,axis=axisModel.axis,grid=axis.grid,axisPointerType=axisPointerModel.get("type"),otherExtent=getCartesian(grid,axis).getOtherAxis(axis).getGlobalExtent(),pixelValue=axis.toGlobalCoord(axis.dataToCoord(value,!0)),axis=(axisPointerType&&"none"!==axisPointerType&&(elStyle=function(axisPointerModel){var style,axisPointerType=axisPointerModel.get("type"),axisPointerModel=axisPointerModel.getModel(axisPointerType+"Style");return"line"===axisPointerType?(style=axisPointerModel.getLineStyle()).fill=null:"shadow"===axisPointerType&&((style=axisPointerModel.getAreaStyle()).stroke=null),style}(axisPointerModel),(axisPointerType=pointerShapeBuilder[axisPointerType](axis,pixelValue,otherExtent)).style=elStyle,elOption.graphicKey=axisPointerType.type,elOption.pointer=axisPointerType),layout$1(grid.model,axisModel));!function(value,elOption,layoutInfo,axisModel,axisPointerModel,api){var textLayout=AxisBuilder.innerTextLayout(layoutInfo.rotation,0,layoutInfo.labelDirection);layoutInfo.labelMargin=axisPointerModel.get(["label","margin"]),buildLabelElOption(elOption,axisModel,axisPointerModel,api,{position:getTransformedPosition(axisModel.axis,value,layoutInfo),align:textLayout.textAlign,verticalAlign:textLayout.textVerticalAlign})}(value,elOption,axis,axisModel,axisPointerModel,api)},CartesianAxisPointer.prototype.getHandleTransform=function(value,axisModel,axisPointerModel){var layoutInfo=layout$1(axisModel.axis.grid.model,axisModel,{labelInside:!1}),axisPointerModel=(layoutInfo.labelMargin=axisPointerModel.get(["handle","margin"]),getTransformedPosition(axisModel.axis,value,layoutInfo));return{x:axisPointerModel[0],y:axisPointerModel[1],rotation:layoutInfo.rotation+(layoutInfo.labelDirection<0?Math.PI:0)}},CartesianAxisPointer.prototype.updateHandleTransform=function(transform,delta,axisModel,axisPointerModel){var axisModel=axisModel.axis,grid=axisModel.grid,axisExtent=axisModel.getGlobalExtent(!0),grid=getCartesian(grid,axisModel).getOtherAxis(axisModel).getGlobalExtent(),axisModel="x"===axisModel.dim?0:1,currPosition=[transform.x,transform.y],delta=(currPosition[axisModel]+=delta[axisModel],currPosition[axisModel]=Math.min(axisExtent[1],currPosition[axisModel]),currPosition[axisModel]=Math.max(axisExtent[0],currPosition[axisModel]),(grid[1]+grid[0])/2),axisExtent=[delta,delta];axisExtent[axisModel]=currPosition[axisModel];return{x:currPosition[0],y:currPosition[1],rotation:transform.rotation,cursorPoint:axisExtent,tooltipOption:[{verticalAlign:"middle"},{align:"center"}][axisModel]}},CartesianAxisPointer}(function(){function BaseAxisPointer(){this._dragging=!1,this.animationThreshold=15}return BaseAxisPointer.prototype.render=function(axisModel,axisPointerModel,api,forceRender){var value=axisPointerModel.get("value"),status=axisPointerModel.get("status");if(this._axisModel=axisModel,this._axisPointerModel=axisPointerModel,this._api=api,forceRender||this._lastValue!==value||this._lastStatus!==status){this._lastValue=value,this._lastStatus=status;var forceRender=this._group,handle=this._handle;if(!status||"hide"===status)return forceRender&&forceRender.hide(),void(handle&&handle.hide());forceRender&&forceRender.show(),handle&&handle.show();var status={},handle=(this.makeElOption(status,value,axisModel,axisPointerModel,api),status.graphicKey),handle=(handle!==this._lastGraphicKey&&this.clear(api),this._lastGraphicKey=handle,this._moveAnimation=this.determineAnimation(axisModel,axisPointerModel));forceRender?(handle=curry(updateProps$1,axisPointerModel,handle),this.updatePointerEl(forceRender,status,handle),this.updateLabelEl(forceRender,status,handle,axisPointerModel)):(forceRender=this._group=new Group,this.createPointerEl(forceRender,status,axisModel,axisPointerModel),this.createLabelEl(forceRender,status,axisModel,axisPointerModel),api.getZr().add(forceRender)),updateMandatoryProps(forceRender,axisPointerModel,!0),this._renderHandle(value)}},BaseAxisPointer.prototype.remove=function(api){this.clear(api)},BaseAxisPointer.prototype.dispose=function(api){this.clear(api)},BaseAxisPointer.prototype.determineAnimation=function(axisModel,axisPointerModel){var animationThreshold,animation=axisPointerModel.get("animation"),axis=axisModel.axis,isCategoryAxis="category"===axis.type,axisPointerModel=axisPointerModel.get("snap");return!(!axisPointerModel&&!isCategoryAxis)&&("auto"===animation||null==animation?(animationThreshold=this.animationThreshold,isCategoryAxis&&axis.getBandWidth()>animationThreshold||!!axisPointerModel&&(isCategoryAxis=getAxisInfo(axisModel).seriesDataCount,axisPointerModel=axis.getExtent(),Math.abs(axisPointerModel[0]-axisPointerModel[1])/isCategoryAxis>animationThreshold)):!0===animation)},BaseAxisPointer.prototype.makeElOption=function(elOption,value,axisModel,axisPointerModel,api){},BaseAxisPointer.prototype.createPointerEl=function(group,elOption,axisModel,axisPointerModel){var pointerOption=elOption.pointer;pointerOption&&(pointerOption=inner$7(group).pointerEl=new graphic[pointerOption.type](clone$3(elOption.pointer)),group.add(pointerOption))},BaseAxisPointer.prototype.createLabelEl=function(group,elOption,axisModel,axisPointerModel){elOption.label&&(elOption=inner$7(group).labelEl=new ZRText(clone$3(elOption.label)),group.add(elOption),updateLabelShowHide(elOption,axisPointerModel))},BaseAxisPointer.prototype.updatePointerEl=function(group,elOption,updateProps$$1){group=inner$7(group).pointerEl;group&&elOption.pointer&&(group.setStyle(elOption.pointer.style),updateProps$$1(group,{shape:elOption.pointer.shape}))},BaseAxisPointer.prototype.updateLabelEl=function(group,elOption,updateProps$$1,axisPointerModel){group=inner$7(group).labelEl;group&&(group.setStyle(elOption.label.style),updateProps$$1(group,{x:elOption.label.x,y:elOption.label.y}),updateLabelShowHide(group,axisPointerModel))},BaseAxisPointer.prototype._renderHandle=function(value){if(!this._dragging&&this.updateHandleTransform){var isInit,axisPointerModel=this._axisPointerModel,zr=this._api.getZr(),handle=this._handle,handleModel=axisPointerModel.getModel("handle"),status=axisPointerModel.get("status");if(!handleModel.get("show")||!status||"hide"===status)return handle&&zr.remove(handle),void(this._handle=null);this._handle||(isInit=!0,handle=this._handle=createIcon(handleModel.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(e){stop(e.event)},onmousedown:bind$1(this._onHandleDragMove,this,0,0),drift:bind$1(this._onHandleDragMove,this),ondragend:bind$1(this._onHandleDragEnd,this)}),zr.add(handle)),updateMandatoryProps(handle,axisPointerModel,!1),handle.setStyle(handleModel.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));status=handleModel.get("size");isArray(status)||(status=[status,status]),handle.scaleX=status[0]/2,handle.scaleY=status[1]/2,createOrUpdate(this,"_doDispatchAxisPointer",handleModel.get("throttle")||0,"fixRate"),this._moveHandleToValue(value,isInit)}},BaseAxisPointer.prototype._moveHandleToValue=function(value,isInit){updateProps$1(this._axisPointerModel,!isInit&&this._moveAnimation,this._handle,getHandleTransProps(this.getHandleTransform(value,this._axisModel,this._axisPointerModel)))},BaseAxisPointer.prototype._onHandleDragMove=function(dx,dy){var handle=this._handle;handle&&(this._dragging=!0,dx=this.updateHandleTransform(getHandleTransProps(handle),[dx,dy],this._axisModel,this._axisPointerModel),this._payloadInfo=dx,handle.stopAnimation(),handle.attr(getHandleTransProps(dx)),inner$7(handle).lastProp=null,this._doDispatchAxisPointer())},BaseAxisPointer.prototype._doDispatchAxisPointer=function(){var payloadInfo,axisModel;this._handle&&(payloadInfo=this._payloadInfo,axisModel=this._axisModel,this._api.dispatchAction({type:"updateAxisPointer",x:payloadInfo.cursorPoint[0],y:payloadInfo.cursorPoint[1],tooltipOption:payloadInfo.tooltipOption,axesInfo:[{axisDim:axisModel.axis.dim,axisIndex:axisModel.componentIndex}]}))},BaseAxisPointer.prototype._onHandleDragEnd=function(){var value;this._dragging=!1,this._handle&&(value=this._axisPointerModel.get("value"),this._moveHandleToValue(value),this._api.dispatchAction({type:"hideTip"}))},BaseAxisPointer.prototype.clear=function(api){this._lastValue=null,this._lastStatus=null;var api=api.getZr(),group=this._group,handle=this._handle;api&&group&&(this._lastGraphicKey=null,group&&api.remove(group),handle&&api.remove(handle),this._group=null,this._handle=null,this._payloadInfo=null),clear(this,"_doDispatchAxisPointer")},BaseAxisPointer.prototype.doClear=function(){},BaseAxisPointer.prototype.buildLabel=function(xy,wh,xDimIndex){return{x:xy[xDimIndex=xDimIndex||0],y:xy[1-xDimIndex],width:wh[xDimIndex],height:wh[1-xDimIndex]}},BaseAxisPointer}());function getCartesian(grid,axis){var opt={};return opt[axis.dim+"AxisIndex"]=axis.index,grid.getCartesian(opt)}var pointerShapeBuilder={line:function(axis,pixelValue,otherExtent){var p1;return p1=[pixelValue,otherExtent[0]],pixelValue=[pixelValue,otherExtent[1]],otherExtent=getAxisDimIndex(axis),{type:"Line",subPixelOptimize:!0,shape:{x1:p1[otherExtent=otherExtent||0],y1:p1[1-otherExtent],x2:pixelValue[otherExtent],y2:pixelValue[1-otherExtent]}}},shadow:function(axis,pixelValue,otherExtent){var bandWidth=Math.max(1,axis.getBandWidth()),span=otherExtent[1]-otherExtent[0];return{type:"Rect",shape:(pixelValue=[pixelValue-bandWidth/2,otherExtent[0]],otherExtent=[bandWidth,span],bandWidth=getAxisDimIndex(axis),{x:pixelValue[bandWidth=bandWidth||0],y:pixelValue[1-bandWidth],width:otherExtent[bandWidth],height:otherExtent[1-bandWidth]})}}};function getAxisDimIndex(axis){return"x"===axis.dim?0:1}var AxisPointerModel=function(_super){function AxisPointerModel(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=AxisPointerModel.type,_this}return __extends(AxisPointerModel,_super),AxisPointerModel.type="axisPointer",AxisPointerModel.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},AxisPointerModel}(ComponentModel),inner$8=makeInner(),each$3=each;function register(key,api,handler){var zr;env.node||(zr=api.getZr(),inner$8(zr).records||(inner$8(zr).records={}),function(zr,api){function useHandler(eventType,cb){zr.on(eventType,function(e){var dis=function(api){function dispatchAction(payload){var pendingList=pendings[payload.type];pendingList?pendingList.push(payload):(payload.dispatchAction=dispatchAction,api.dispatchAction(payload))}var pendings={showTip:[],hideTip:[]};return{dispatchAction:dispatchAction,pendings:pendings}}(api);each$3(inner$8(zr).records,function(record){record&&cb(record,e,dis.dispatchAction)}),function(pendings,api){var actuallyPayload,showLen=pendings.showTip.length,hideLen=pendings.hideTip.length;showLen?actuallyPayload=pendings.showTip[showLen-1]:hideLen&&(actuallyPayload=pendings.hideTip[hideLen-1]);actuallyPayload&&(actuallyPayload.dispatchAction=null,api.dispatchAction(actuallyPayload))}(dis.pendings,api)})}inner$8(zr).initialized||(inner$8(zr).initialized=!0,useHandler("click",curry(doEnter,"click")),useHandler("mousemove",curry(doEnter,"mousemove")),useHandler("globalout",onLeave))}(zr,api),(inner$8(zr).records[key]||(inner$8(zr).records[key]={})).handler=handler)}function onLeave(record,e,dispatchAction){record.handler("leave",null,dispatchAction)}function doEnter(currTrigger,record,e,dispatchAction){record.handler(currTrigger,e,dispatchAction)}function unregister(key,api){env.node||(api=api.getZr(),(inner$8(api).records||{})[key]&&(inner$8(api).records[key]=null))}var AxisPointerView=function(_super){function AxisPointerView(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=AxisPointerView.type,_this}return __extends(AxisPointerView,_super),AxisPointerView.prototype.render=function(globalAxisPointerModel,ecModel,api){var ecModel=ecModel.getComponent("tooltip"),triggerOn=globalAxisPointerModel.get("triggerOn")||ecModel&&ecModel.get("triggerOn")||"mousemove|click";register("axisPointer",api,function(currTrigger,e,dispatchAction){"none"!==triggerOn&&("leave"===currTrigger||0<=triggerOn.indexOf(currTrigger))&&dispatchAction({type:"updateAxisPointer",currTrigger:currTrigger,x:e&&e.offsetX,y:e&&e.offsetY})})},AxisPointerView.prototype.remove=function(ecModel,api){unregister("axisPointer",api)},AxisPointerView.prototype.dispose=function(ecModel,api){unregister("axisPointer",api)},AxisPointerView.type="axisPointer",AxisPointerView}(ComponentView);function findPointFromSeries(finder,ecModel){var point=[],seriesIndex=finder.seriesIndex;if(null==seriesIndex||!(seriesModel=ecModel.getSeriesByIndex(seriesIndex)))return{point:[]};var data=seriesModel.getData(),ecModel=queryDataIndex(data,finder);if(null==ecModel||ecModel<0||isArray(ecModel))return{point:[]};var stackedData,seriesModel,seriesIndex=data.getItemGraphicEl(ecModel),coordSys=seriesModel.coordinateSystem;return seriesModel.getTooltipPosition?point=seriesModel.getTooltipPosition(ecModel)||[]:coordSys&&coordSys.dataToPoint?point=finder.isStacked?(seriesModel=coordSys.getBaseAxis(),finder=coordSys.getOtherAxis(seriesModel).dim,seriesModel=seriesModel.dim,finder="x"===finder||"radius"===finder?1:0,seriesModel=data.mapDimension(seriesModel),(stackedData=[])[finder]=data.get(seriesModel,ecModel),stackedData[1-finder]=data.get(data.getCalculationInfo("stackResultDimension"),ecModel),coordSys.dataToPoint(stackedData)||[]):coordSys.dataToPoint(data.getValues(map(coordSys.dimensions,function(dim){return data.mapDimension(dim)}),ecModel))||[]:seriesIndex&&((seriesModel=seriesIndex.getBoundingRect().clone()).applyTransform(seriesIndex.transform),point=[seriesModel.x+seriesModel.width/2,seriesModel.y+seriesModel.height/2]),{point:point,el:seriesIndex}}var inner$9=makeInner();function axisTrigger(payload,ecModel,api){var isIllegalPoint,inputAxesInfo,axesInfo,shouldHide,outputPayload,showValueMap,updaters,linkTriggers,currTrigger=payload.currTrigger,point=[payload.x,payload.y],finder=payload,dispatchAction=payload.dispatchAction||bind(api.dispatchAction,api),coordSysAxesInfo=ecModel.getComponent("axisPointer").coordSysAxesInfo;if(coordSysAxesInfo)return illegalPoint(point)&&(point=findPointFromSeries({seriesIndex:finder.seriesIndex,dataIndex:finder.dataIndex},ecModel).point),isIllegalPoint=illegalPoint(point),inputAxesInfo=finder.axesInfo,axesInfo=coordSysAxesInfo.axesInfo,shouldHide="leave"===currTrigger||illegalPoint(point),outputPayload={},showValueMap={},ecModel={list:[],map:{}},updaters={showPointer:curry(showPointer,showValueMap),showTooltip:curry(showTooltip,ecModel)},each(coordSysAxesInfo.coordSysMap,function(coordSys,coordSysKey){var coordSysContainsPoint=isIllegalPoint||coordSys.containPoint(point);each(coordSysAxesInfo.coordSysAxesInfo[coordSysKey],function(axisInfo,key){var axis=axisInfo.axis,inputAxisInfo=function(inputAxesInfo,axisInfo){for(var i=0;i<(inputAxesInfo||[]).length;i++){var inputAxisInfo=inputAxesInfo[i];if(axisInfo.axis.dim===inputAxisInfo.axisDim&&axisInfo.axis.model.componentIndex===inputAxisInfo.axisIndex)return inputAxisInfo}}(inputAxesInfo,axisInfo);shouldHide||!coordSysContainsPoint||inputAxesInfo&&!inputAxisInfo||null!=(inputAxisInfo=null!=(inputAxisInfo=inputAxisInfo&&inputAxisInfo.value)||isIllegalPoint?inputAxisInfo:axis.pointToData(point))&&processOnAxis(axisInfo,inputAxisInfo,updaters,!1,outputPayload)})}),linkTriggers={},each(axesInfo,function(tarAxisInfo,tarKey){var linkGroup=tarAxisInfo.linkGroup;linkGroup&&!showValueMap[tarKey]&&each(linkGroup.axesInfo,function(srcAxisInfo,srcKey){var srcKey=showValueMap[srcKey];srcAxisInfo!==tarAxisInfo&&srcKey&&(srcKey=srcKey.value,linkGroup.mapper&&(srcKey=tarAxisInfo.axis.scale.parse(linkGroup.mapper(srcKey,makeMapperParam(srcAxisInfo),makeMapperParam(tarAxisInfo)))),linkTriggers[tarAxisInfo.key]=srcKey)})}),each(linkTriggers,function(val,tarKey){processOnAxis(axesInfo[tarKey],val,updaters,!0,outputPayload)}),function(showValueMap,axesInfo,outputPayload){var outputAxesInfo=outputPayload.axesInfo=[];each(axesInfo,function(axisInfo,key){var option=axisInfo.axisPointerModel.option,key=showValueMap[key];key?(axisInfo.useHandle||(option.status="show"),option.value=key.value,option.seriesDataIndices=(key.payloadBatch||[]).slice()):axisInfo.useHandle||(option.status="hide"),"show"===option.status&&outputAxesInfo.push({axisDim:axisInfo.axis.dim,axisIndex:axisInfo.axis.model.componentIndex,value:option.value})})}(showValueMap,axesInfo,outputPayload),function(dataByCoordSys,point,payload,dispatchAction){var sampleItem;illegalPoint(point)||!dataByCoordSys.list.length?dispatchAction({type:"hideTip"}):(sampleItem=((dataByCoordSys.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{},dispatchAction({type:"showTip",escapeConnect:!0,x:point[0],y:point[1],tooltipOption:payload.tooltipOption,position:payload.position,dataIndexInside:sampleItem.dataIndexInside,dataIndex:sampleItem.dataIndex,seriesIndex:sampleItem.seriesIndex,dataByCoordSys:dataByCoordSys.list}))}(ecModel,point,payload,dispatchAction),function(axesInfo,api){var zr=api.getZr(),lastHighlights=inner$9(zr).axisPointerLastHighlights||{},newHighlights=inner$9(zr).axisPointerLastHighlights={},toHighlight=(each(axesInfo,function(axisInfo,key){axisInfo=axisInfo.axisPointerModel.option;"show"===axisInfo.status&&each(axisInfo.seriesDataIndices,function(batchItem){var key=batchItem.seriesIndex+" | "+batchItem.dataIndex;newHighlights[key]=batchItem})}),[]),toDownplay=[];each(lastHighlights,function(batchItem,key){newHighlights[key]||toDownplay.push(batchItem)}),each(newHighlights,function(batchItem,key){lastHighlights[key]||toHighlight.push(batchItem)}),toDownplay.length&&api.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:toDownplay}),toHighlight.length&&api.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:toHighlight})}(axesInfo,api),outputPayload}function processOnAxis(axisInfo,newValue,updaters,noSnap,outputFinder){var payloadInfo,payloadBatch,snapToValue,axis=axisInfo.axis;!axis.scale.isBlank()&&axis.containData(newValue)&&(axisInfo.involveSeries?(payloadBatch=(payloadInfo=function(value,axisInfo){var axis=axisInfo.axis,dim=axis.dim,snapToValue=value,payloadBatch=[],minDist=Number.MAX_VALUE,minDiff=-1;return each(axisInfo.seriesModels,function(series,idx){var dist,dataDim=series.getData().mapDimensionsAll(dim);if(series.getAxisTooltipData)var result=series.getAxisTooltipData(dataDim,value,axis),dataIndices=result.dataIndices,result=result.nestestValue;else{if(!(dataIndices=series.getData().indicesOfNearest(dataDim[0],value,"category"===axis.type?.5:null)).length)return;result=series.getData().get(dataDim[0],dataIndices[0])}null!=result&&isFinite(result)&&(dataDim=value-result,(dist=Math.abs(dataDim))<=minDist&&((dist<minDist||0<=dataDim&&minDiff<0)&&(minDist=dist,minDiff=dataDim,snapToValue=result,payloadBatch.length=0),each(dataIndices,function(dataIndex){payloadBatch.push({seriesIndex:series.seriesIndex,dataIndexInside:dataIndex,dataIndex:series.getData().getRawIndex(dataIndex)})})))}),{payloadBatch:payloadBatch,snapToValue:snapToValue}}(newValue,axisInfo)).payloadBatch,snapToValue=payloadInfo.snapToValue,payloadBatch[0]&&null==outputFinder.seriesIndex&&extend(outputFinder,payloadBatch[0]),!noSnap&&axisInfo.snap&&axis.containData(snapToValue)&&null!=snapToValue&&(newValue=snapToValue),updaters.showPointer(axisInfo,newValue,payloadBatch),updaters.showTooltip(axisInfo,payloadInfo,snapToValue)):updaters.showPointer(axisInfo,newValue))}function showPointer(showValueMap,axisInfo,value,payloadBatch){showValueMap[axisInfo.key]={value:value,payloadBatch:payloadBatch}}function showTooltip(dataByCoordSys,axisInfo,payloadInfo,value){var coordSysKey,coordSysItem,payloadInfo=payloadInfo.payloadBatch,axis=axisInfo.axis,axisModel=axis.model,axisPointerModel=axisInfo.axisPointerModel;axisInfo.triggerTooltip&&payloadInfo.length&&(coordSysKey=makeKey(axisInfo=axisInfo.coordSys.model),(coordSysItem=dataByCoordSys.map[coordSysKey])||(coordSysItem=dataByCoordSys.map[coordSysKey]={coordSysId:axisInfo.id,coordSysIndex:axisInfo.componentIndex,coordSysType:axisInfo.type,coordSysMainType:axisInfo.mainType,dataByAxis:[]},dataByCoordSys.list.push(coordSysItem)),coordSysItem.dataByAxis.push({axisDim:axis.dim,axisIndex:axisModel.componentIndex,axisType:axisModel.type,axisId:axisModel.id,value:value,valueLabelOpt:{precision:axisPointerModel.get(["label","precision"]),formatter:axisPointerModel.get(["label","formatter"])},seriesDataIndices:payloadInfo.slice()}))}function makeMapperParam(axisInfo){var axisModel=axisInfo.axis.model,item={},axisInfo=item.axisDim=axisInfo.axis.dim;return item.axisIndex=item[axisInfo+"AxisIndex"]=axisModel.componentIndex,item.axisName=item[axisInfo+"AxisName"]=axisModel.name,item.axisId=item[axisInfo+"AxisId"]=axisModel.id,item}function illegalPoint(point){return!point||null==point[0]||isNaN(point[0])||null==point[1]||isNaN(point[1])}function install$6(registers){AxisView.registerAxisPointerClass("CartesianAxisPointer",CartesianAxisPointer),registers.registerComponentModel(AxisPointerModel),registers.registerComponentView(AxisPointerView),registers.registerPreprocessor(function(option){var link;option&&(option.axisPointer&&0!==option.axisPointer.length||(option.axisPointer={}),(link=option.axisPointer.link)&&!isArray(link)&&(option.axisPointer.link=[link]))}),registers.registerProcessor(registers.PRIORITY.PROCESSOR.STATISTIC,function(ecModel,api){ecModel.getComponent("axisPointer").coordSysAxesInfo=collect(ecModel,api)}),registers.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},axisTrigger)}var TooltipModel=function(_super){function TooltipModel(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=TooltipModel.type,_this}return __extends(TooltipModel,_super),TooltipModel.type="tooltip",TooltipModel.dependencies=["axisPointer"],TooltipModel.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},TooltipModel}(ComponentModel);function shouldTooltipConfine(tooltipModel){var confineOption=tooltipModel.get("confine");return null!=confineOption?confineOption:"richText"===tooltipModel.get("renderMode")}function testStyle(styleProps){if(env.domSupported)for(var style=document.documentElement.style,i=0,len=styleProps.length;i<len;i++)if(styleProps[i]in style)return styleProps[i]}var TRANSFORM_VENDOR=testStyle(["transform","webkitTransform","OTransform","MozTransform","msTransform"]);function toCSSVendorPrefix(styleVendor,styleProp){if(!styleVendor)return styleProp;styleProp=toCamelCase(styleProp,!0);var idx=styleVendor.indexOf(styleProp);return(styleVendor=-1===idx?styleProp:"-"+styleVendor.slice(0,idx)+"-"+styleProp).toLowerCase()}var CSS_TRANSITION_VENDOR=toCSSVendorPrefix(testStyle(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),"transition"),CSS_TRANSFORM_VENDOR=toCSSVendorPrefix(TRANSFORM_VENDOR,"transform"),gCssText="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(env.transform3dSupported?"will-change:transform;":"");function assembleTransform(x,y,toString){x=x.toFixed(0)+"px",y=y.toFixed(0)+"px";if(!env.transformSupported)return toString?"top:"+y+";left:"+x+";":[["top",y],["left",x]];var is3d=env.transform3dSupported,x="translate"+(is3d?"3d":"")+"("+x+","+y+(is3d?",0":"")+")";return toString?"top:0;left:0;"+CSS_TRANSFORM_VENDOR+":"+x+";":[["top",0],["left",0],[TRANSFORM_VENDOR,x]]}function assembleCssText(tooltipModel,enableTransition,onlyFade){var cssText=[],transitionDuration=tooltipModel.get("transitionDuration"),backgroundColor=tooltipModel.get("backgroundColor"),shadowBlur=tooltipModel.get("shadowBlur"),shadowColor=tooltipModel.get("shadowColor"),shadowOffsetX=tooltipModel.get("shadowOffsetX"),shadowOffsetY=tooltipModel.get("shadowOffsetY"),textStyleModel=tooltipModel.getModel("textStyle"),padding=getPaddingFromTooltipModel(tooltipModel,"html");return cssText.push("box-shadow:"+(shadowOffsetX+"px "+shadowOffsetY+"px "+shadowBlur+"px "+shadowColor)),enableTransition&&transitionDuration&&cssText.push(function(duration,onlyFade){var transitionOption=" "+duration/2+"s cubic-bezier(0.23,1,0.32,1)",transitionText="opacity"+transitionOption+",visibility"+transitionOption;return onlyFade||(transitionOption=" "+duration+"s cubic-bezier(0.23,1,0.32,1)",transitionText+=env.transformSupported?","+CSS_TRANSFORM_VENDOR+transitionOption:",left"+transitionOption+",top"+transitionOption),CSS_TRANSITION_VENDOR+":"+transitionText}(transitionDuration,onlyFade)),backgroundColor&&cssText.push("background-color:"+backgroundColor),each(["width","color","radius"],function(name){var borderName="border-"+name,camelCase=toCamelCase(borderName),camelCase=tooltipModel.get(camelCase);null!=camelCase&&cssText.push(borderName+":"+camelCase+("color"===name?"":"px"))}),cssText.push(function(textStyleModel){var cssText=[],fontSize=textStyleModel.get("fontSize"),color=((color=textStyleModel.getTextColor())&&cssText.push("color:"+color),cssText.push("font:"+textStyleModel.getFont()),fontSize&&cssText.push("line-height:"+Math.round(3*fontSize/2)+"px"),textStyleModel.get("textShadowColor")),fontSize=textStyleModel.get("textShadowBlur")||0,shadowOffsetX=textStyleModel.get("textShadowOffsetX")||0,shadowOffsetY=textStyleModel.get("textShadowOffsetY")||0;return color&&fontSize&&cssText.push("text-shadow:"+shadowOffsetX+"px "+shadowOffsetY+"px "+fontSize+"px "+color),each(["decoration","align"],function(name){var val=textStyleModel.get(name);val&&cssText.push("text-"+name+":"+val)}),cssText.join(";")}(textStyleModel)),null!=padding&&cssText.push("padding:"+normalizeCssArray$1(padding).join("px ")+"px"),cssText.join(";")+";"}function makeStyleCoord(out,zr,appendToBody,zrX,zrY){var zrPainter=zr&&zr.painter;appendToBody?(appendToBody=zrPainter&&zrPainter.getViewportRoot())&&function(out,elFrom,elTarget,inX,inY){transformCoordWithViewport(_calcOut$1,elFrom,inX,inY,!0)&&transformCoordWithViewport(out,elTarget,_calcOut$1[0],_calcOut$1[1])}(out,appendToBody,document.body,zrX,zrY):(out[0]=zrX,out[1]=zrY,(appendToBody=zrPainter&&zrPainter.getViewportRootOffset())&&(out[0]+=appendToBody.offsetLeft,out[1]+=appendToBody.offsetTop)),out[2]=out[0]/zr.getWidth(),out[3]=out[1]/zr.getHeight()}var TooltipHTMLContent=function(){function TooltipHTMLContent(container,api,opt){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._firstShow=!0,this._longHide=!0,env.wxa)return null;var el=document.createElement("div"),zr=(el.domBelongToZr=!0,this.el=el,this._zr=api.getZr()),opt=this._appendToBody=opt&&opt.appendToBody,self=(makeStyleCoord(this._styleCoord,zr,opt,api.getWidth()/2,api.getHeight()/2),(opt?document.body:container).appendChild(el),this._container=container,this);el.onmouseenter=function(){self._enterable&&(clearTimeout(self._hideTimeout),self._show=!0),self._inContent=!0},el.onmousemove=function(e){var handler;e=e||window.event,self._enterable||(handler=zr.handler,normalizeEvent(zr.painter.getViewportRoot(),e,!0),handler.dispatch("mousemove",e))},el.onmouseleave=function(){self._inContent=!1,self._enterable&&self._show&&self.hideLater(self._hideDelay)}}return TooltipHTMLContent.prototype.update=function(tooltipModel){var container=this._container,style=(style="position",(el=(el=container).currentStyle||document.defaultView&&document.defaultView.getComputedStyle(el))?style?el[style]:el:null),el=container.style;"absolute"!==el.position&&"absolute"!==style&&(el.position="relative"),tooltipModel.get("alwaysShowContent")&&this._moveIfResized(),this.el.className=tooltipModel.get("className")||""},TooltipHTMLContent.prototype.show=function(tooltipModel,nearPointColor){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var el=this.el,style=el.style,styleCoord=this._styleCoord;el.innerHTML?style.cssText=gCssText+assembleCssText(tooltipModel,!this._firstShow,this._longHide)+assembleTransform(styleCoord[0],styleCoord[1],!0)+"border-color:"+convertToColorString(nearPointColor)+";"+(tooltipModel.get("extraCssText")||"")+";pointer-events:"+(this._enterable?"auto":"none"):style.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},TooltipHTMLContent.prototype.setContent=function(content,markers,tooltipModel,borderColor,arrowPosition){var el=this.el;if(null==content)el.innerHTML="";else{var arrow="";if(isString(arrowPosition)&&"item"===tooltipModel.get("trigger")&&!shouldTooltipConfine(tooltipModel)&&(arrow=function(tooltipModel,borderColor,arrowPosition){if(!isString(arrowPosition)||"inside"===arrowPosition)return"";var backgroundColor=tooltipModel.get("backgroundColor"),tooltipModel=tooltipModel.get("borderWidth"),arrowPosition=(borderColor=convertToColorString(borderColor),arrowPosition="left"===(arrowPosition=arrowPosition)?"right":"right"===arrowPosition?"left":"top"===arrowPosition?"bottom":"top"),arrowSize=Math.max(1.5*Math.round(tooltipModel),6),positionStyle="",transformStyle=CSS_TRANSFORM_VENDOR+":",rotateDeg=(-1<indexOf(["left","right"],arrowPosition)?(positionStyle+="top:50%",transformStyle+="translateY(-50%) rotate("+(rotateDeg="left"==arrowPosition?-225:-45)+"deg)"):(positionStyle+="left:50%",transformStyle+="translateX(-50%) rotate("+(rotateDeg="top"==arrowPosition?225:45)+"deg)"),rotateDeg*Math.PI/180),arrowWH=arrowSize+tooltipModel,rotateDeg=arrowWH*Math.abs(Math.cos(rotateDeg))+arrowWH*Math.abs(Math.sin(rotateDeg)),borderColor=borderColor+" solid "+tooltipModel+"px;";return'<div style="'+["position:absolute;width:"+arrowSize+"px;height:"+arrowSize+"px;",(positionStyle+=";"+arrowPosition+":-"+Math.round(100*((rotateDeg-Math.SQRT2*tooltipModel)/2+Math.SQRT2*tooltipModel-(rotateDeg-arrowWH)/2))/100+"px")+";"+transformStyle+";","border-bottom:"+borderColor,"border-right:"+borderColor,"background-color:"+backgroundColor+";"].join("")+'"></div>'}(tooltipModel,borderColor,arrowPosition)),isString(content))el.innerHTML=content+arrow;else if(content){el.innerHTML="",isArray(content)||(content=[content]);for(var i=0;i<content.length;i++)isDom(content[i])&&content[i].parentNode!==el&&el.appendChild(content[i]);arrow&&el.childNodes.length&&((tooltipModel=document.createElement("div")).innerHTML=arrow,el.appendChild(tooltipModel))}}},TooltipHTMLContent.prototype.setEnterable=function(enterable){this._enterable=enterable},TooltipHTMLContent.prototype.getSize=function(){var el=this.el;return[el.offsetWidth,el.offsetHeight]},TooltipHTMLContent.prototype.moveTo=function(zrX,zrY){var style_1,styleCoord=this._styleCoord;makeStyleCoord(styleCoord,this._zr,this._appendToBody,zrX,zrY),null!=styleCoord[0]&&null!=styleCoord[1]&&(style_1=this.el.style,each(assembleTransform(styleCoord[0],styleCoord[1]),function(transform){style_1[transform[0]]=transform[1]}))},TooltipHTMLContent.prototype._moveIfResized=function(){var ratioX=this._styleCoord[2],ratioY=this._styleCoord[3];this.moveTo(ratioX*this._zr.getWidth(),ratioY*this._zr.getHeight())},TooltipHTMLContent.prototype.hide=function(){var _this=this,style=this.el.style;style.visibility="hidden",style.opacity="0",env.transform3dSupported&&(style.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return _this._longHide=!0},500)},TooltipHTMLContent.prototype.hideLater=function(time){!this._show||this._inContent&&this._enterable||(time?(this._hideDelay=time,this._show=!1,this._hideTimeout=setTimeout(bind(this.hide,this),time)):this.hide())},TooltipHTMLContent.prototype.isShow=function(){return this._show},TooltipHTMLContent.prototype.dispose=function(){this.el.parentNode.removeChild(this.el)},TooltipHTMLContent}(),TooltipRichContent=function(){function TooltipRichContent(api){this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._zr=api.getZr(),makeStyleCoord$1(this._styleCoord,this._zr,api.getWidth()/2,api.getHeight()/2)}return TooltipRichContent.prototype.update=function(tooltipModel){tooltipModel.get("alwaysShowContent")&&this._moveIfResized()},TooltipRichContent.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},TooltipRichContent.prototype.setContent=function(content,markupStyleCreator,tooltipModel,borderColor,arrowPosition){var _this=this,textStyleModel=(isObject(content)&&throwError("Passing DOM nodes as content is not supported in richText tooltip!"),this.el&&this._zr.remove(this.el),tooltipModel.getModel("textStyle")),self=(this.el=new ZRText({style:{rich:markupStyleCreator.richTextStyles,text:content,lineHeight:22,borderWidth:1,borderColor:borderColor,textShadowColor:textStyleModel.get("textShadowColor"),fill:tooltipModel.get(["textStyle","color"]),padding:getPaddingFromTooltipModel(tooltipModel,"richText"),verticalAlign:"top",align:"left"},z:tooltipModel.get("z")}),each(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(propName){_this.el.style[propName]=tooltipModel.get(propName)}),each(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(propName){_this.el.style[propName]=textStyleModel.get(propName)||0}),this._zr.add(this.el),this);this.el.on("mouseover",function(){self._enterable&&(clearTimeout(self._hideTimeout),self._show=!0),self._inContent=!0}),this.el.on("mouseout",function(){self._enterable&&self._show&&self.hideLater(self._hideDelay),self._inContent=!1})},TooltipRichContent.prototype.setEnterable=function(enterable){this._enterable=enterable},TooltipRichContent.prototype.getSize=function(){var el=this.el,bounding=this.el.getBoundingRect(),el=calcShadowOuterSize(el.style);return[bounding.width+el.left+el.right,bounding.height+el.top+el.bottom]},TooltipRichContent.prototype.moveTo=function(x,y){var borderWidth,styleCoord,el=this.el;el&&(makeStyleCoord$1(styleCoord=this._styleCoord,this._zr,x,y),x=styleCoord[0],y=styleCoord[1],borderWidth=mathMaxWith0((styleCoord=el.style).borderWidth||0),styleCoord=calcShadowOuterSize(styleCoord),el.x=x+borderWidth+styleCoord.left,el.y=y+borderWidth+styleCoord.top,el.markRedraw())},TooltipRichContent.prototype._moveIfResized=function(){var ratioX=this._styleCoord[2],ratioY=this._styleCoord[3];this.moveTo(ratioX*this._zr.getWidth(),ratioY*this._zr.getHeight())},TooltipRichContent.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},TooltipRichContent.prototype.hideLater=function(time){!this._show||this._inContent&&this._enterable||(time?(this._hideDelay=time,this._show=!1,this._hideTimeout=setTimeout(bind(this.hide,this),time)):this.hide())},TooltipRichContent.prototype.isShow=function(){return this._show},TooltipRichContent.prototype.dispose=function(){this._zr.remove(this.el)},TooltipRichContent}();function mathMaxWith0(val){return Math.max(0,val)}function calcShadowOuterSize(style){var shadowBlur=mathMaxWith0(style.shadowBlur||0),shadowOffsetX=mathMaxWith0(style.shadowOffsetX||0),style=mathMaxWith0(style.shadowOffsetY||0);return{left:mathMaxWith0(shadowBlur-shadowOffsetX),right:mathMaxWith0(shadowBlur+shadowOffsetX),top:mathMaxWith0(shadowBlur-style),bottom:mathMaxWith0(shadowBlur+style)}}function makeStyleCoord$1(out,zr,zrX,zrY){out[0]=zrX,out[1]=zrY,out[2]=out[0]/zr.getWidth(),out[3]=out[1]/zr.getHeight()}var proxyRect=new Rect({shape:{x:-1,y:-1,width:2,height:2}}),TooltipView=function(_super){function TooltipView(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=TooltipView.type,_this}return __extends(TooltipView,_super),TooltipView.prototype.init=function(ecModel,api){var renderModeOption;!env.node&&api.getDom()&&(ecModel=ecModel.getComponent("tooltip"),renderModeOption=this._renderMode="auto"===(renderModeOption=ecModel.get("renderMode"))?env.domSupported?"html":"richText":renderModeOption||"html",this._tooltipContent="richText"===renderModeOption?new TooltipRichContent(api):new TooltipHTMLContent(api.getDom(),api,{appendToBody:ecModel.get("appendToBody",!0)}))},TooltipView.prototype.render=function(tooltipModel,ecModel,api){!env.node&&api.getDom()&&(this.group.removeAll(),this._tooltipModel=tooltipModel,this._ecModel=ecModel,this._api=api,this._alwaysShowContent=tooltipModel.get("alwaysShowContent"),(ecModel=this._tooltipContent).update(tooltipModel),ecModel.setEnterable(tooltipModel.get("enterable")),this._initGlobalListener(),this._keepShow(),"richText"!==this._renderMode&&tooltipModel.get("transitionDuration")?createOrUpdate(this,"_updatePosition",50,"fixRate"):clear(this,"_updatePosition"))},TooltipView.prototype._initGlobalListener=function(){var triggerOn=this._tooltipModel.get("triggerOn");register("itemTooltip",this._api,bind(function(currTrigger,e,dispatchAction){"none"!==triggerOn&&(0<=triggerOn.indexOf(currTrigger)?this._tryShow(e,dispatchAction):"leave"===currTrigger&&this._hide(dispatchAction))},this))},TooltipView.prototype._keepShow=function(){var self_1,tooltipModel=this._tooltipModel,ecModel=this._ecModel,api=this._api;null!=this._lastX&&null!=this._lastY&&"none"!==tooltipModel.get("triggerOn")&&(self_1=this,clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){api.isDisposed()||self_1.manuallyShowTip(tooltipModel,ecModel,api,{x:self_1._lastX,y:self_1._lastY,dataByCoordSys:self_1._lastDataByCoordSys})}))},TooltipView.prototype.manuallyShowTip=function(tooltipModel,ecModel,api,payload){var dispatchAction,cmptRef,rect,dataByCoordSys;payload.from!==this.uid&&!env.node&&api.getDom()&&(dispatchAction=makeDispatchAction$1(payload,api),this._ticket="",dataByCoordSys=payload.dataByCoordSys,(cmptRef=function(payload,ecModel,api){var queryOptionMap=preParseFinder(payload).queryOptionMap,componentMainType=queryOptionMap.keys()[0];if(componentMainType&&"series"!==componentMainType){var el,ecModel=queryReferringComponents(ecModel,componentMainType,queryOptionMap.get(componentMainType),{useDefault:!1,enableAll:!1,enableNone:!1}).models[0];if(ecModel)if(api.getViewOfComponentModel(ecModel).group.traverse(function(subEl){var tooltipConfig=getECData(subEl).tooltipConfig;if(tooltipConfig&&tooltipConfig.name===payload.name)return el=subEl,!0}),el)return{componentMainType:componentMainType,componentIndex:ecModel.componentIndex,el:el}}}(payload,ecModel,api))?((rect=cmptRef.el.getBoundingRect().clone()).applyTransform(cmptRef.el.transform),this._tryShow({offsetX:rect.x+rect.width/2,offsetY:rect.y+rect.height/2,target:cmptRef.el,position:payload.position,positionDefault:"bottom"},dispatchAction)):payload.tooltip&&null!=payload.x&&null!=payload.y?((rect=proxyRect).x=payload.x,rect.y=payload.y,rect.update(),getECData(rect).tooltipConfig={name:null,option:payload.tooltip},this._tryShow({offsetX:payload.x,offsetY:payload.y,target:rect},dispatchAction)):dataByCoordSys?this._tryShow({offsetX:payload.x,offsetY:payload.y,position:payload.position,dataByCoordSys:dataByCoordSys,tooltipOption:payload.tooltipOption},dispatchAction):null!=payload.seriesIndex?this._manuallyAxisShowTip(tooltipModel,ecModel,api,payload)||(rect=(cmptRef=findPointFromSeries(payload,ecModel)).point[0],dataByCoordSys=cmptRef.point[1],null!=rect&&null!=dataByCoordSys&&this._tryShow({offsetX:rect,offsetY:dataByCoordSys,target:cmptRef.el,position:payload.position,positionDefault:"bottom"},dispatchAction)):null!=payload.x&&null!=payload.y&&(api.dispatchAction({type:"updateAxisPointer",x:payload.x,y:payload.y}),this._tryShow({offsetX:payload.x,offsetY:payload.y,position:payload.position,target:api.getZr().findHover(payload.x,payload.y).target},dispatchAction)))},TooltipView.prototype.manuallyHideTip=function(tooltipModel,ecModel,api,payload){var tooltipContent=this._tooltipContent;!this._alwaysShowContent&&this._tooltipModel&&tooltipContent.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,payload.from!==this.uid&&this._hide(makeDispatchAction$1(payload,api))},TooltipView.prototype._manuallyAxisShowTip=function(tooltipModel,ecModel,api,payload){var seriesIndex=payload.seriesIndex,dataIndex=payload.dataIndex,coordSysAxesInfo=ecModel.getComponent("axisPointer").coordSysAxesInfo;if(null!=seriesIndex&&null!=dataIndex&&null!=coordSysAxesInfo){coordSysAxesInfo=ecModel.getSeriesByIndex(seriesIndex);if(coordSysAxesInfo){ecModel=buildTooltipModel([coordSysAxesInfo.getData().getItemModel(dataIndex),coordSysAxesInfo,(coordSysAxesInfo.coordinateSystem||{}).model],this._tooltipModel);if("axis"===ecModel.get("trigger"))return api.dispatchAction({type:"updateAxisPointer",seriesIndex:seriesIndex,dataIndex:dataIndex,position:payload.position}),!0}}},TooltipView.prototype._tryShow=function(e,dispatchAction){var dataByCoordSys,seriesDispatcher_1,cmptDispatcher_1,el=e.target;this._tooltipModel&&(this._lastX=e.offsetX,this._lastY=e.offsetY,(dataByCoordSys=e.dataByCoordSys)&&dataByCoordSys.length?this._showAxisTooltip(dataByCoordSys,e):el?(findEventDispatcher(el,function(target){return null!=getECData(target).dataIndex?(seriesDispatcher_1=target,1):null!=getECData(target).tooltipConfig&&(cmptDispatcher_1=target,1)},!(this._lastDataByCoordSys=null)),seriesDispatcher_1?this._showSeriesItemTooltip(e,seriesDispatcher_1,dispatchAction):cmptDispatcher_1?this._showComponentItemTooltip(e,cmptDispatcher_1,dispatchAction):this._hide(dispatchAction)):(this._lastDataByCoordSys=null,this._hide(dispatchAction)))},TooltipView.prototype._showOrMove=function(tooltipModel,cb){tooltipModel=tooltipModel.get("showDelay");cb=bind(cb,this),clearTimeout(this._showTimout),0<tooltipModel?this._showTimout=setTimeout(cb,tooltipModel):cb()},TooltipView.prototype._showAxisTooltip=function(dataByCoordSys,e){var ecModel=this._ecModel,globalTooltipModel=this._tooltipModel,point=[e.offsetX,e.offsetY],singleTooltipModel=buildTooltipModel([e.tooltipOption],globalTooltipModel),renderMode=this._renderMode,cbParamsList=[],articleMarkup=createTooltipMarkup("section",{blocks:[],noHeader:!0}),markupTextArrLegacy=[],markupStyleCreator=new TooltipMarkupStyleCreator,positionExpr=(each(dataByCoordSys,function(itemCoordSys){each(itemCoordSys.dataByAxis,function(axisItem){var axisValueLabel,axisSectionMarkup,axisModel=ecModel.getComponent(axisItem.axisDim+"Axis",axisItem.axisIndex),axisValue=axisItem.value;axisModel&&null!=axisValue&&(axisValueLabel=getValueLabel(axisValue,axisModel.axis,ecModel,axisItem.seriesDataIndices,axisItem.valueLabelOpt),axisSectionMarkup=createTooltipMarkup("section",{header:axisValueLabel,noHeader:!trim(axisValueLabel),sortBlocks:!0,blocks:[]}),articleMarkup.blocks.push(axisSectionMarkup),each(axisItem.seriesDataIndices,function(idxItem){var frag,series=ecModel.getSeriesByIndex(idxItem.seriesIndex),idxItem=idxItem.dataIndexInside,cbParams=series.getDataParams(idxItem);cbParams.dataIndex<0||(cbParams.axisDim=axisItem.axisDim,cbParams.axisIndex=axisItem.axisIndex,cbParams.axisType=axisItem.axisType,cbParams.axisId=axisItem.axisId,cbParams.axisValue=getAxisRawValue(axisModel.axis,{value:axisValue}),cbParams.axisValueLabel=axisValueLabel,cbParams.marker=markupStyleCreator.makeTooltipMarker("item",convertToColorString(cbParams.color),renderMode),(frag=(idxItem=normalizeTooltipFormatResult(series.formatTooltip(idxItem,!0,null))).frag)&&(series=buildTooltipModel([series],globalTooltipModel).get("valueFormatter"),axisSectionMarkup.blocks.push(series?extend({valueFormatter:series},frag):frag)),idxItem.text&&markupTextArrLegacy.push(idxItem.text),cbParamsList.push(cbParams))}))})}),articleMarkup.blocks.reverse(),markupTextArrLegacy.reverse(),e.position),e=singleTooltipModel.get("order"),e=buildTooltipMarkup(articleMarkup,markupStyleCreator,renderMode,e,ecModel.get("useUTC"),singleTooltipModel.get("textStyle")),e=(e&&markupTextArrLegacy.unshift(e),"richText"===renderMode?"\n\n":"<br/>"),allMarkupText=markupTextArrLegacy.join(e);this._showOrMove(singleTooltipModel,function(){this._updateContentNotChangedOnAxis(dataByCoordSys,cbParamsList)?this._updatePosition(singleTooltipModel,positionExpr,point[0],point[1],this._tooltipContent,cbParamsList):this._showTooltipContent(singleTooltipModel,allMarkupText,cbParamsList,Math.random()+"",point[0],point[1],positionExpr,null,markupStyleCreator)})},TooltipView.prototype._showSeriesItemTooltip=function(e,dispatcher,dispatchAction){var params,markupStyleCreator,frag,markupText,asyncTicket,ecModel=this._ecModel,dispatcher=getECData(dispatcher),seriesIndex=dispatcher.seriesIndex,seriesModel=ecModel.getSeriesByIndex(seriesIndex),dataModel=dispatcher.dataModel||seriesModel,dataIndex=dispatcher.dataIndex,dispatcher=dispatcher.dataType,data=dataModel.getData(dispatcher),renderMode=this._renderMode,positionDefault=e.positionDefault,tooltipModel=buildTooltipModel([data.getItemModel(dataIndex),dataModel,seriesModel&&(seriesModel.coordinateSystem||{}).model],this._tooltipModel,positionDefault?{position:positionDefault}:null),seriesModel=tooltipModel.get("trigger");null!=seriesModel&&"item"!==seriesModel||(params=dataModel.getDataParams(dataIndex,dispatcher),markupStyleCreator=new TooltipMarkupStyleCreator,params.marker=markupStyleCreator.makeTooltipMarker("item",convertToColorString(params.color),renderMode),positionDefault=normalizeTooltipFormatResult(dataModel.formatTooltip(dataIndex,!1,dispatcher)),seriesModel=tooltipModel.get("order"),dispatcher=tooltipModel.get("valueFormatter"),frag=positionDefault.frag,markupText=frag?buildTooltipMarkup(dispatcher?extend({valueFormatter:dispatcher},frag):frag,markupStyleCreator,renderMode,seriesModel,ecModel.get("useUTC"),tooltipModel.get("textStyle")):positionDefault.text,asyncTicket="item_"+dataModel.name+"_"+dataIndex,this._showOrMove(tooltipModel,function(){this._showTooltipContent(tooltipModel,markupText,params,asyncTicket,e.offsetX,e.offsetY,e.position,e.target,markupStyleCreator)}),dispatchAction({type:"showTip",dataIndexInside:dataIndex,dataIndex:data.getRawIndex(dataIndex),seriesIndex:seriesIndex,from:this.uid}))},TooltipView.prototype._showComponentItemTooltip=function(e,el,dispatchAction){var ecData=getECData(el),tooltipOpt=ecData.tooltipConfig.option||{},tooltipModelCascade=[tooltipOpt=isString(tooltipOpt)?{content:tooltipOpt,formatter:tooltipOpt}:tooltipOpt],ecData=this._ecModel.getComponent(ecData.componentMainType,ecData.componentIndex),ecData=(ecData&&tooltipModelCascade.push(ecData),tooltipModelCascade.push({formatter:tooltipOpt.content}),e.positionDefault),subTooltipModel=buildTooltipModel(tooltipModelCascade,this._tooltipModel,ecData?{position:ecData}:null),defaultHtml=subTooltipModel.get("content"),asyncTicket=Math.random()+"",markupStyleCreator=new TooltipMarkupStyleCreator;this._showOrMove(subTooltipModel,function(){var formatterParams=clone(subTooltipModel.get("formatterParams")||{});this._showTooltipContent(subTooltipModel,defaultHtml,formatterParams,asyncTicket,e.offsetX,e.offsetY,e.position,el,markupStyleCreator)}),dispatchAction({type:"showTip",from:this.uid})},TooltipView.prototype._showTooltipContent=function(tooltipModel,defaultHtml,params,asyncTicket,x,y,positionExpr,el,markupStyleCreator){var tooltipContent,formatter,nearPointColor,useUTC,params0;this._ticket="",tooltipModel.get("showContent")&&tooltipModel.get("show")&&((tooltipContent=this._tooltipContent).setEnterable(tooltipModel.get("enterable")),formatter=tooltipModel.get("formatter"),positionExpr=positionExpr||tooltipModel.get("position"),defaultHtml=defaultHtml,nearPointColor=this._getNearestPoint([x,y],params,tooltipModel.get("trigger"),tooltipModel.get("borderColor")).color,formatter&&(defaultHtml=isString(formatter)?(useUTC=tooltipModel.ecModel.get("useUTC"),defaultHtml=formatter,formatTpl(defaultHtml=(params0=isArray(params)?params[0]:params)&&params0.axisType&&0<=params0.axisType.indexOf("time")?format(params0.axisValue,defaultHtml,useUTC):defaultHtml,params,!0)):isFunction(formatter)?(params0=bind(function(cbTicket,html){cbTicket===this._ticket&&(tooltipContent.setContent(html,markupStyleCreator,tooltipModel,nearPointColor,positionExpr),this._updatePosition(tooltipModel,positionExpr,x,y,tooltipContent,params,el))},this),this._ticket=asyncTicket,formatter(params,asyncTicket,params0)):formatter),tooltipContent.setContent(defaultHtml,markupStyleCreator,tooltipModel,nearPointColor,positionExpr),tooltipContent.show(tooltipModel,nearPointColor),this._updatePosition(tooltipModel,positionExpr,x,y,tooltipContent,params,el))},TooltipView.prototype._getNearestPoint=function(point,tooltipDataParams,trigger,borderColor){return"axis"===trigger||isArray(tooltipDataParams)?{color:borderColor||("html"===this._renderMode?"#fff":"none")}:isArray(tooltipDataParams)?void 0:{color:borderColor||tooltipDataParams.color||tooltipDataParams.borderColor}},TooltipView.prototype._updatePosition=function(tooltipModel,positionExpr,x,y,content,params,el){var pos,viewWidth=this._api.getWidth(),viewHeight=this._api.getHeight(),contentSize=(positionExpr=positionExpr||tooltipModel.get("position"),content.getSize()),align=tooltipModel.get("align"),vAlign=tooltipModel.get("verticalAlign"),rect=el&&el.getBoundingRect().clone();el&&rect.applyTransform(el.transform),isArray(positionExpr=isFunction(positionExpr)?positionExpr([x,y],params,content.el,rect,{viewSize:[viewWidth,viewHeight],contentSize:contentSize.slice()}):positionExpr)?(x=parsePercent$1(positionExpr[0],viewWidth),y=parsePercent$1(positionExpr[1],viewHeight)):isObject(positionExpr)?((params=positionExpr).width=contentSize[0],params.height=contentSize[1],x=(params=getLayoutRect(params,{width:viewWidth,height:viewHeight})).x,y=params.y,vAlign=align=null):y=(x=(pos=isString(positionExpr)&&el?function(position,rect,contentSize,borderWidth){var domWidth=contentSize[0],domHeight=contentSize[1],offset=Math.ceil(Math.SQRT2*borderWidth)+8,x=0,y=0,rectWidth=rect.width,rectHeight=rect.height;switch(position){case"inside":x=rect.x+rectWidth/2-domWidth/2,y=rect.y+rectHeight/2-domHeight/2;break;case"top":x=rect.x+rectWidth/2-domWidth/2,y=rect.y-domHeight-offset;break;case"bottom":x=rect.x+rectWidth/2-domWidth/2,y=rect.y+rectHeight+offset;break;case"left":x=rect.x-domWidth-offset,y=rect.y+rectHeight/2-domHeight/2;break;case"right":x=rect.x+rectWidth+offset,y=rect.y+rectHeight/2-domHeight/2}return[x,y]}(positionExpr,rect,contentSize,tooltipModel.get("borderWidth")):function(x,y,content,viewWidth,viewHeight,gapH,gapV){var content=content.getSize(),width=content[0],content=content[1];null!=gapH&&(viewWidth<x+width+gapH+2?x-=width+gapH:x+=gapH);null!=gapV&&(viewHeight<y+content+gapV?y-=content+gapV:y+=gapV);return[x,y]}(x,y,content,viewWidth,viewHeight,align?null:20,vAlign?null:20))[0],pos[1]),align&&(x-=isCenterAlign(align)?contentSize[0]/2:"right"===align?contentSize[0]:0),vAlign&&(y-=isCenterAlign(vAlign)?contentSize[1]/2:"bottom"===vAlign?contentSize[1]:0),shouldTooltipConfine(tooltipModel)&&(x=(pos=function(x,y,content,viewWidth,viewHeight){var content=content.getSize(),width=content[0],content=content[1];return x=Math.min(x+width,viewWidth)-width,y=Math.min(y+content,viewHeight)-content,x=Math.max(x,0),y=Math.max(y,0),[x,y]}(x,y,content,viewWidth,viewHeight))[0],y=pos[1]),content.moveTo(x,y)},TooltipView.prototype._updateContentNotChangedOnAxis=function(dataByCoordSys,cbParamsList){var lastCoordSys=this._lastDataByCoordSys,lastCbParamsList=this._cbParamsList,contentNotChanged=!!lastCoordSys&&lastCoordSys.length===dataByCoordSys.length;return contentNotChanged&&each(lastCoordSys,function(lastItemCoordSys,indexCoordSys){var lastItemCoordSys=lastItemCoordSys.dataByAxis||[],thisDataByAxis=(dataByCoordSys[indexCoordSys]||{}).dataByAxis||[];(contentNotChanged=contentNotChanged&&lastItemCoordSys.length===thisDataByAxis.length)&&each(lastItemCoordSys,function(lastItem,indexAxis){var indexAxis=thisDataByAxis[indexAxis]||{},lastIndices=lastItem.seriesDataIndices||[],newIndices=indexAxis.seriesDataIndices||[];(contentNotChanged=contentNotChanged&&lastItem.value===indexAxis.value&&lastItem.axisType===indexAxis.axisType&&lastItem.axisId===indexAxis.axisId&&lastIndices.length===newIndices.length)&&each(lastIndices,function(lastIdxItem,j){j=newIndices[j];contentNotChanged=contentNotChanged&&lastIdxItem.seriesIndex===j.seriesIndex&&lastIdxItem.dataIndex===j.dataIndex}),lastCbParamsList&&each(lastItem.seriesDataIndices,function(idxItem){var idxItem=idxItem.seriesIndex,cbParams=cbParamsList[idxItem],idxItem=lastCbParamsList[idxItem];cbParams&&idxItem&&idxItem.data!==cbParams.data&&(contentNotChanged=!1)})})}),this._lastDataByCoordSys=dataByCoordSys,this._cbParamsList=cbParamsList,!!contentNotChanged},TooltipView.prototype._hide=function(dispatchAction){this._lastDataByCoordSys=null,dispatchAction({type:"hideTip",from:this.uid})},TooltipView.prototype.dispose=function(ecModel,api){!env.node&&api.getDom()&&(clear(this,"_updatePosition"),this._tooltipContent.dispose(),unregister("itemTooltip",api))},TooltipView.type="tooltip",TooltipView}(ComponentView);function buildTooltipModel(modelCascade,globalTooltipModel,defaultTooltipOption){for(var ecModel=globalTooltipModel.ecModel,resultModel=defaultTooltipOption?(resultModel=new Model(defaultTooltipOption,ecModel,ecModel),new Model(globalTooltipModel.option,resultModel,ecModel)):globalTooltipModel,i=modelCascade.length-1;0<=i;i--){var tooltipOpt=modelCascade[i];(tooltipOpt=tooltipOpt&&(isString(tooltipOpt=tooltipOpt instanceof Model?tooltipOpt.get("tooltip",!0):tooltipOpt)?{formatter:tooltipOpt}:tooltipOpt))&&(resultModel=new Model(tooltipOpt,resultModel,ecModel))}return resultModel}function makeDispatchAction$1(payload,api){return payload.dispatchAction||bind(api.dispatchAction,api)}function isCenterAlign(align){return"center"===align||"middle"===align}use(function(registers){use(install$6),registers.registerComponentModel(TooltipModel),registers.registerComponentView(TooltipView),registers.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},noop),registers.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},noop)});var DATA_ZOOM_AXIS_DIMENSIONS=["x","y","radius","angle","single"],SERIES_COORDS=["cartesian2d","polar","singleAxis"];function getAxisMainType(axisDim){return assert(axisDim),axisDim+"Axis"}function findEffectedDataZooms(ecModel,payload){var foundNewLink,axisRecords=createHashMap(),effectedModels=[],effectedModelMap=createHashMap();for(ecModel.eachComponent({mainType:"dataZoom",query:payload},function(dataZoomModel){effectedModelMap.get(dataZoomModel.uid)||addToEffected(dataZoomModel)});foundNewLink=!1,ecModel.eachComponent("dataZoom",processSingle),foundNewLink;);function processSingle(dataZoomModel){!effectedModelMap.get(dataZoomModel.uid)&&function(dataZoomModel){var isLink=!1;return dataZoomModel.eachTargetAxis(function(axisDim,axisIndex){axisDim=axisRecords.get(axisDim);axisDim&&axisDim[axisIndex]&&(isLink=!0)}),isLink}(dataZoomModel)&&(addToEffected(dataZoomModel),foundNewLink=!0)}function addToEffected(dataZoom){effectedModelMap.set(dataZoom.uid,!0),effectedModels.push(dataZoom),dataZoom.eachTargetAxis(function(axisDim,axisIndex){(axisRecords.get(axisDim)||axisRecords.set(axisDim,[]))[axisIndex]=!0})}return effectedModels}function collectReferCoordSysModelInfo(dataZoomModel){var ecModel=dataZoomModel.ecModel,coordSysInfoWrap={infoList:[],infoMap:createHashMap()};return dataZoomModel.eachTargetAxis(function(axisDim,axisIndex){var coordSysUid,coordSysInfo,axisDim=ecModel.getComponent(getAxisMainType(axisDim),axisIndex);!axisDim||(axisIndex=axisDim.getCoordSysModel())&&(coordSysUid=axisIndex.uid,(coordSysInfo=coordSysInfoWrap.infoMap.get(coordSysUid))||(coordSysInfoWrap.infoList.push(coordSysInfo={model:axisIndex,axisModels:[]}),coordSysInfoWrap.infoMap.set(coordSysUid,coordSysInfo)),coordSysInfo.axisModels.push(axisDim))}),coordSysInfoWrap}var DataZoomAxisInfo=function(){function DataZoomAxisInfo(){this.indexList=[],this.indexMap=[]}return DataZoomAxisInfo.prototype.add=function(axisCmptIdx){this.indexMap[axisCmptIdx]||(this.indexList.push(axisCmptIdx),this.indexMap[axisCmptIdx]=!0)},DataZoomAxisInfo}(),DataZoomModel=function(_super){function DataZoomModel(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=DataZoomModel.type,_this._autoThrottle=!0,_this._noTarget=!0,_this._rangePropMode=["percent","percent"],_this}return __extends(DataZoomModel,_super),DataZoomModel.prototype.init=function(option,parentModel,ecModel){var inputRawOption=retrieveRawOption(option);this.settledOption=inputRawOption,this.mergeDefaultAndTheme(option,ecModel),this._doInit(inputRawOption)},DataZoomModel.prototype.mergeOption=function(newOption){var inputRawOption=retrieveRawOption(newOption);merge(this.option,newOption,!0),merge(this.settledOption,inputRawOption,!0),this._doInit(inputRawOption)},DataZoomModel.prototype._doInit=function(inputRawOption){var thisOption=this.option,settledOption=(this._setDefaultThrottle(inputRawOption),this._updateRangeUse(inputRawOption),this.settledOption);each([["start","startValue"],["end","endValue"]],function(names,index){"value"===this._rangePropMode[index]&&(thisOption[names[0]]=settledOption[names[0]]=null)},this),this._resetTarget()},DataZoomModel.prototype._resetTarget=function(){var optionOrient=this.get("orient",!0),targetAxisIndexMap=this._targetAxisInfoMap=createHashMap();this._fillSpecifiedTargetAxis(targetAxisIndexMap)?this._orient=optionOrient||this._makeAutoOrientByTargetAxis():(this._orient=optionOrient||"horizontal",this._fillAutoTargetAxisByOrient(targetAxisIndexMap,this._orient)),this._noTarget=!0,targetAxisIndexMap.each(function(axisInfo){axisInfo.indexList.length&&(this._noTarget=!1)},this)},DataZoomModel.prototype._fillSpecifiedTargetAxis=function(targetAxisIndexMap){var hasAxisSpecified=!1;return each(DATA_ZOOM_AXIS_DIMENSIONS,function(axisDim){var axisInfo,refering=this.getReferringComponents(getAxisMainType(axisDim),MULTIPLE_REFERRING);refering.specified&&(hasAxisSpecified=!0,axisInfo=new DataZoomAxisInfo,each(refering.models,function(axisModel){axisInfo.add(axisModel.componentIndex)}),targetAxisIndexMap.set(axisDim,axisInfo))},this),hasAxisSpecified},DataZoomModel.prototype._fillAutoTargetAxisByOrient=function(targetAxisIndexMap,orient){var axisDim,ecModel=this.ecModel,needAuto=!0;function setParallelAxis(axisModels,axisDim){var axisInfo,gridModel_1,axisModel=axisModels[0];axisModel&&((axisInfo=new DataZoomAxisInfo).add(axisModel.componentIndex),targetAxisIndexMap.set(axisDim,axisInfo),needAuto=!1,"x"!==axisDim&&"y"!==axisDim||(gridModel_1=axisModel.getReferringComponents("grid",SINGLE_REFERRING).models[0])&&each(axisModels,function(axModel){axisModel.componentIndex!==axModel.componentIndex&&gridModel_1===axModel.getReferringComponents("grid",SINGLE_REFERRING).models[0]&&axisInfo.add(axModel.componentIndex)}))}needAuto&&setParallelAxis(ecModel.findComponents({mainType:(axisDim="vertical"===orient?"y":"x")+"Axis"}),axisDim),needAuto&&setParallelAxis(ecModel.findComponents({mainType:"singleAxis",filter:function(axisModel){return axisModel.get("orient",!0)===orient}}),"single"),needAuto&&each(DATA_ZOOM_AXIS_DIMENSIONS,function(axisDim){var axisModels,axisInfo;!needAuto||(axisModels=ecModel.findComponents({mainType:getAxisMainType(axisDim),filter:function(axisModel){return"category"===axisModel.get("type",!0)}}))[0]&&((axisInfo=new DataZoomAxisInfo).add(axisModels[0].componentIndex),targetAxisIndexMap.set(axisDim,axisInfo),needAuto=!1)},this)},DataZoomModel.prototype._makeAutoOrientByTargetAxis=function(){var dim;return this.eachTargetAxis(function(axisDim){dim=dim||axisDim},this),"y"===dim?"vertical":"horizontal"},DataZoomModel.prototype._setDefaultThrottle=function(inputRawOption){inputRawOption.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle&&(inputRawOption=this.ecModel.option,this.option.throttle=inputRawOption.animation&&0<inputRawOption.animationDurationUpdate?100:20)},DataZoomModel.prototype._updateRangeUse=function(inputRawOption){var rangePropMode=this._rangePropMode,rangeModeInOption=this.get("rangeMode");each([["start","startValue"],["end","endValue"]],function(names,index){var percentSpecified=null!=inputRawOption[names[0]],names=null!=inputRawOption[names[1]];percentSpecified&&!names?rangePropMode[index]="percent":!percentSpecified&&names?rangePropMode[index]="value":rangeModeInOption?rangePropMode[index]=rangeModeInOption[index]:percentSpecified&&(rangePropMode[index]="percent")})},DataZoomModel.prototype.noTarget=function(){return this._noTarget},DataZoomModel.prototype.getFirstTargetAxisModel=function(){var firstAxisModel;return this.eachTargetAxis(function(axisDim,axisIndex){null==firstAxisModel&&(firstAxisModel=this.ecModel.getComponent(getAxisMainType(axisDim),axisIndex))},this),firstAxisModel},DataZoomModel.prototype.eachTargetAxis=function(callback,context){this._targetAxisInfoMap.each(function(axisInfo,axisDim){each(axisInfo.indexList,function(axisIndex){callback.call(context,axisDim,axisIndex)})})},DataZoomModel.prototype.getAxisProxy=function(axisDim,axisIndex){axisDim=this.getAxisModel(axisDim,axisIndex);if(axisDim)return axisDim.__dzAxisProxy},DataZoomModel.prototype.getAxisModel=function(axisDim,axisIndex){assert(axisDim&&null!=axisIndex);var axisInfo=this._targetAxisInfoMap.get(axisDim);if(axisInfo&&axisInfo.indexMap[axisIndex])return this.ecModel.getComponent(getAxisMainType(axisDim),axisIndex)},DataZoomModel.prototype.setRawRange=function(opt){var thisOption=this.option,settledOption=this.settledOption;each([["start","startValue"],["end","endValue"]],function(names){null==opt[names[0]]&&null==opt[names[1]]||(thisOption[names[0]]=settledOption[names[0]]=opt[names[0]],thisOption[names[1]]=settledOption[names[1]]=opt[names[1]])},this),this._updateRangeUse(opt)},DataZoomModel.prototype.setCalculatedRange=function(opt){var option=this.option;each(["start","startValue","end","endValue"],function(name){option[name]=opt[name]})},DataZoomModel.prototype.getPercentRange=function(){var axisProxy=this.findRepresentativeAxisProxy();if(axisProxy)return axisProxy.getDataPercentWindow()},DataZoomModel.prototype.getValueRange=function(axisDim,axisIndex){if(null!=axisDim||null!=axisIndex)return this.getAxisProxy(axisDim,axisIndex).getDataValueWindow();axisDim=this.findRepresentativeAxisProxy();return axisDim?axisDim.getDataValueWindow():void 0},DataZoomModel.prototype.findRepresentativeAxisProxy=function(axisModel){if(axisModel)return axisModel.__dzAxisProxy;for(var firstProxy,axisDimList=this._targetAxisInfoMap.keys(),i=0;i<axisDimList.length;i++)for(var axisDim=axisDimList[i],axisInfo=this._targetAxisInfoMap.get(axisDim),j=0;j<axisInfo.indexList.length;j++){var proxy=this.getAxisProxy(axisDim,axisInfo.indexList[j]);if(proxy.hostedBy(this))return proxy;firstProxy=firstProxy||proxy}return firstProxy},DataZoomModel.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},DataZoomModel.prototype.getOrient=function(){return assert(this._orient),this._orient},DataZoomModel.type="dataZoom",DataZoomModel.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],DataZoomModel.defaultOption={z:4,filterMode:"filter",start:0,end:100},DataZoomModel}(ComponentModel);function retrieveRawOption(option){var ret={};return each(["start","end","startValue","endValue","throttle"],function(name){option.hasOwnProperty(name)&&(ret[name]=option[name])}),ret}var InsideZoomModel=function(_super){function InsideZoomModel(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=InsideZoomModel.type,_this}return __extends(InsideZoomModel,_super),InsideZoomModel.type="dataZoom.inside",InsideZoomModel.defaultOption=inheritDefaultOption(DataZoomModel.defaultOption,{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),InsideZoomModel}(DataZoomModel),Ellipse=function(_super){function DataZoomView(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=DataZoomView.type,_this}return __extends(DataZoomView,_super),DataZoomView.prototype.render=function(dataZoomModel,ecModel,api,payload){this.dataZoomModel=dataZoomModel,this.ecModel=ecModel,this.api=api},DataZoomView.type="dataZoom",DataZoomView}(ComponentView);function sliderMove(delta,handleEnds,extent,handleIndex,minSpan,maxSpan){delta=delta||0;var extentSpan=extent[1]-extent[0],extentSpan=(null!=minSpan&&(minSpan=restrict(minSpan,[0,extentSpan])),null!=maxSpan&&(maxSpan=Math.max(maxSpan,null!=minSpan?minSpan:0)),"all"===handleIndex&&(handleSpan=restrict(handleSpan=Math.abs(handleEnds[1]-handleEnds[0]),[0,extentSpan]),minSpan=maxSpan=restrict(handleSpan,[minSpan,maxSpan]),handleIndex=0),handleEnds[0]=restrict(handleEnds[0],extent),handleEnds[1]=restrict(handleEnds[1],extent),getSpanSign(handleEnds,handleIndex)),handleSpan=(handleEnds[handleIndex]+=delta,minSpan||0),delta=extent.slice();extentSpan.sign<0?delta[0]+=handleSpan:delta[1]-=handleSpan,handleEnds[handleIndex]=restrict(handleEnds[handleIndex],delta),extent=getSpanSign(handleEnds,handleIndex),null!=minSpan&&(extent.sign!==extentSpan.sign||extent.span<minSpan)&&(handleEnds[1-handleIndex]=handleEnds[handleIndex]+extentSpan.sign*minSpan),extent=getSpanSign(handleEnds,handleIndex),null!=maxSpan&&extent.span>maxSpan&&(handleEnds[1-handleIndex]=handleEnds[handleIndex]+extent.sign*maxSpan)}function getSpanSign(handleEnds,handleIndex){handleEnds=handleEnds[handleIndex]-handleEnds[1-handleIndex];return{span:Math.abs(handleEnds),sign:0<handleEnds||!(handleEnds<0)&&handleIndex?-1:1}}function restrict(value,extend){return Math.min(null!=extend[1]?extend[1]:1/0,Math.max(null!=extend[0]?extend[0]:-1/0,value))}var ATTR="\0_ec_interaction_mutex";function isTaken(zr,resourceKey){return function(zr){return zr[ATTR]||(zr[ATTR]={})}(zr)[resourceKey]}registerAction({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},noop);var RoamController=function(_super){function RoamController(zr){var _this=_super.call(this)||this,mousedownHandler=(_this._zr=zr,bind(_this._mousedownHandler,_this)),mousemoveHandler=bind(_this._mousemoveHandler,_this),mouseupHandler=bind(_this._mouseupHandler,_this),mousewheelHandler=bind(_this._mousewheelHandler,_this),pinchHandler=bind(_this._pinchHandler,_this);return _this.enable=function(controlType,opt){this.disable(),this._opt=defaults(clone(opt)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),!0!==(controlType=null==controlType?!0:controlType)&&"move"!==controlType&&"pan"!==controlType||(zr.on("mousedown",mousedownHandler),zr.on("mousemove",mousemoveHandler),zr.on("mouseup",mouseupHandler)),!0!==controlType&&"scale"!==controlType&&"zoom"!==controlType||(zr.on("mousewheel",mousewheelHandler),zr.on("pinch",pinchHandler))},_this.disable=function(){zr.off("mousedown",mousedownHandler),zr.off("mousemove",mousemoveHandler),zr.off("mouseup",mouseupHandler),zr.off("mousewheel",mousewheelHandler),zr.off("pinch",pinchHandler)},_this}return __extends(RoamController,_super),RoamController.prototype.isDragging=function(){return this._dragging},RoamController.prototype.isPinching=function(){return this._pinching},RoamController.prototype.setPointerChecker=function(pointerChecker){this.pointerChecker=pointerChecker},RoamController.prototype.dispose=function(){this.disable()},RoamController.prototype._mousedownHandler=function(e){var x,y;isMiddleOrRightButtonOnMouseUpDown(e)||e.target&&e.target.draggable||(x=e.offsetX,y=e.offsetY,this.pointerChecker&&this.pointerChecker(e,x,y)&&(this._x=x,this._y=y,this._dragging=!0))},RoamController.prototype._mousemoveHandler=function(e){var x,y,oldX,oldY,dx,dy;this._dragging&&isAvailableBehavior("moveOnMouseMove",e,this._opt)&&"pinch"!==e.gestureEvent&&!isTaken(this._zr,"globalPan")&&(x=e.offsetX,y=e.offsetY,dx=x-(oldX=this._x),dy=y-(oldY=this._y),this._x=x,this._y=y,this._opt.preventDefaultMouseMove&&stop(e.event),trigger(this,"pan","moveOnMouseMove",e,{dx:dx,dy:dy,oldX:oldX,oldY:oldY,newX:x,newY:y,isAvailableBehavior:null}))},RoamController.prototype._mouseupHandler=function(e){isMiddleOrRightButtonOnMouseUpDown(e)||(this._dragging=!1)},RoamController.prototype._mousewheelHandler=function(e){var shouldZoom=isAvailableBehavior("zoomOnMouseWheel",e,this._opt),shouldMove=isAvailableBehavior("moveOnMouseWheel",e,this._opt),wheelDelta=e.wheelDelta,absWheelDeltaDelta=Math.abs(wheelDelta),originX=e.offsetX,originY=e.offsetY;0!==wheelDelta&&(shouldZoom||shouldMove)&&(shouldZoom&&(shouldZoom=3<absWheelDeltaDelta?1.4:1<absWheelDeltaDelta?1.2:1.1,checkPointerAndTrigger(this,"zoom","zoomOnMouseWheel",e,{scale:0<wheelDelta?shouldZoom:1/shouldZoom,originX:originX,originY:originY,isAvailableBehavior:null})),shouldMove&&checkPointerAndTrigger(this,"scrollMove","moveOnMouseWheel",e,{scrollDelta:(0<wheelDelta?1:-1)*(3<(absWheelDeltaDelta=Math.abs(wheelDelta))?.4:1<absWheelDeltaDelta?.15:.05),originX:originX,originY:originY,isAvailableBehavior:null}))},RoamController.prototype._pinchHandler=function(e){isTaken(this._zr,"globalPan")||checkPointerAndTrigger(this,"zoom",null,e,{scale:1<e.pinchScale?1.1:1/1.1,originX:e.pinchX,originY:e.pinchY,isAvailableBehavior:null})},RoamController}(Eventful);function checkPointerAndTrigger(controller,eventName,behaviorToCheck,e,contollerEvent){controller.pointerChecker&&controller.pointerChecker(e,contollerEvent.originX,contollerEvent.originY)&&(stop(e.event),trigger(controller,eventName,behaviorToCheck,e,contollerEvent))}function trigger(controller,eventName,behaviorToCheck,e,contollerEvent){contollerEvent.isAvailableBehavior=bind(isAvailableBehavior,null,behaviorToCheck,e),controller.trigger(eventName,contollerEvent)}function isAvailableBehavior(behaviorToCheck,e,settings){settings=settings[behaviorToCheck];return!behaviorToCheck||settings&&(!isString(settings)||e.event[settings+"Key"])}var inner$10=makeInner();function disposeCoordSysRecord(coordSysRecordMap,coordSysRecord){coordSysRecord&&(coordSysRecordMap.removeKey(coordSysRecord.model.uid),(coordSysRecordMap=coordSysRecord.controller)&&coordSysRecordMap.dispose())}function dispatchAction(api,batch){api.isDisposed()||api.dispatchAction({type:"dataZoom",animation:{easing:"cubicOut",duration:100},batch:batch})}function containsPoint(coordSysModel,e,x,y){return coordSysModel.coordinateSystem.containPoint([x,y])}function installDataZoomRoamProcessor(registers){registers.registerProcessor(registers.PRIORITY.PROCESSOR.FILTER,function(ecModel,api){var apiInner=inner$10(api),coordSysRecordMap=apiInner.coordSysRecordMap||(apiInner.coordSysRecordMap=createHashMap());coordSysRecordMap.each(function(coordSysRecord){coordSysRecord.dataZoomInfoMap=null}),ecModel.eachComponent({mainType:"dataZoom",subType:"inside"},function(dataZoomModel){each(collectReferCoordSysModelInfo(dataZoomModel).infoList,function(dzCoordSysInfo){var coordSysUid=dzCoordSysInfo.model.uid,coordSysUid=coordSysRecordMap.get(coordSysUid)||coordSysRecordMap.set(coordSysUid,function(api,coordSysModel){var coordSysRecord={model:coordSysModel,containsPoint:curry(containsPoint,coordSysModel),dispatchAction:curry(dispatchAction,api),dataZoomInfoMap:null,controller:null},controller=coordSysRecord.controller=new RoamController(api.getZr());return each(["pan","zoom","scrollMove"],function(eventName){controller.on(eventName,function(event){var batch=[];coordSysRecord.dataZoomInfoMap.each(function(dzInfo){var method;event.isAvailableBehavior(dzInfo.model.option)&&(method=(method=(dzInfo.getRange||{})[eventName])&&method(dzInfo.dzReferCoordSysInfo,coordSysRecord.model.mainType,coordSysRecord.controller,event),!dzInfo.model.get("disabled",!0)&&method&&batch.push({dataZoomId:dzInfo.model.id,start:method[0],end:method[1]}))}),batch.length&&coordSysRecord.dispatchAction(batch)})}),coordSysRecord}(api,dzCoordSysInfo.model));(coordSysUid.dataZoomInfoMap||(coordSysUid.dataZoomInfoMap=createHashMap())).set(dataZoomModel.uid,{dzReferCoordSysInfo:dzCoordSysInfo,model:dataZoomModel,getRange:null})})}),coordSysRecordMap.each(function(coordSysRecord){var firstDzInfo,firstDzKey,controller=coordSysRecord.controller,dataZoomInfoMap=coordSysRecord.dataZoomInfoMap;dataZoomInfoMap&&null!=(firstDzKey=dataZoomInfoMap.keys()[0])&&(firstDzInfo=dataZoomInfoMap.get(firstDzKey)),firstDzInfo?(firstDzKey=function(dataZoomInfoMap){var controlType,typePriority={type_true:2,type_move:1,type_false:0,type_undefined:-1},preventDefaultMouseMove=!0;return dataZoomInfoMap.each(function(dataZoomInfo){var dataZoomInfo=dataZoomInfo.model,oneType=!dataZoomInfo.get("disabled",!0)&&(!dataZoomInfo.get("zoomLock",!0)||"move");typePriority["type_"+controlType]<typePriority["type_"+oneType]&&(controlType=oneType),preventDefaultMouseMove=preventDefaultMouseMove&&dataZoomInfo.get("preventDefaultMouseMove",!0)}),{controlType:controlType,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!preventDefaultMouseMove}}}(dataZoomInfoMap),controller.enable(firstDzKey.controlType,firstDzKey.opt),controller.setPointerChecker(coordSysRecord.containsPoint),createOrUpdate(coordSysRecord,"dispatchAction",firstDzInfo.model.get("throttle",!0),"fixRate")):disposeCoordSysRecord(coordSysRecordMap,coordSysRecord)})})}var InsideZoomView=function(_super){function InsideZoomView(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type="dataZoom.inside",_this}return __extends(InsideZoomView,_super),InsideZoomView.prototype.render=function(dataZoomModel,ecModel,api){_super.prototype.render.apply(this,arguments),dataZoomModel.noTarget()?this._clear():(this.range=dataZoomModel.getPercentRange(),function(api,dataZoomModel,getRange){inner$10(api).coordSysRecordMap.each(function(coordSysRecord){coordSysRecord=coordSysRecord.dataZoomInfoMap.get(dataZoomModel.uid);coordSysRecord&&(coordSysRecord.getRange=getRange)})}(api,dataZoomModel,{pan:bind(getRangeHandlers.pan,this),zoom:bind(getRangeHandlers.zoom,this),scrollMove:bind(getRangeHandlers.scrollMove,this)}))},InsideZoomView.prototype.dispose=function(){this._clear(),_super.prototype.dispose.apply(this,arguments)},InsideZoomView.prototype._clear=function(){for(var api=this.api,dataZoomModel=this.dataZoomModel,coordSysRecordMap=inner$10(api).coordSysRecordMap,coordSysKeyArr=coordSysRecordMap.keys(),i=0;i<coordSysKeyArr.length;i++){var dzUid,coordSysKey=coordSysKeyArr[i],coordSysKey=coordSysRecordMap.get(coordSysKey),dataZoomInfoMap=coordSysKey.dataZoomInfoMap;dataZoomInfoMap&&(dzUid=dataZoomModel.uid,dataZoomInfoMap.get(dzUid)&&(dataZoomInfoMap.removeKey(dzUid),dataZoomInfoMap.keys().length||disposeCoordSysRecord(coordSysRecordMap,coordSysKey)))}this.range=null},InsideZoomView.type="dataZoom.inside",InsideZoomView}(Ellipse),getRangeHandlers={zoom:function(coordSysInfo,coordSysMainType,controller,e){var lastRange=this.range,range=lastRange.slice(),axisModel=coordSysInfo.axisModels[0];if(axisModel)return coordSysMainType=getDirectionInfo[coordSysMainType](null,[e.originX,e.originY],axisModel,controller,coordSysInfo),axisModel=(0<coordSysMainType.signal?coordSysMainType.pixelStart+coordSysMainType.pixelLength-coordSysMainType.pixel:coordSysMainType.pixel-coordSysMainType.pixelStart)/coordSysMainType.pixelLength*(range[1]-range[0])+range[0],controller=Math.max(1/e.scale,0),range[0]=(range[0]-axisModel)*controller+axisModel,range[1]=(range[1]-axisModel)*controller+axisModel,coordSysInfo=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan(),sliderMove(0,range,[0,100],0,coordSysInfo.minSpan,coordSysInfo.maxSpan),this.range=range,lastRange[0]!==range[0]||lastRange[1]!==range[1]?range:void 0},pan:makeMover(function(range,axisModel,coordSysInfo,coordSysMainType,controller,e){coordSysMainType=getDirectionInfo[coordSysMainType]([e.oldX,e.oldY],[e.newX,e.newY],axisModel,controller,coordSysInfo);return coordSysMainType.signal*(range[1]-range[0])*coordSysMainType.pixel/coordSysMainType.pixelLength}),scrollMove:makeMover(function(range,axisModel,coordSysInfo,coordSysMainType,controller,e){return getDirectionInfo[coordSysMainType]([0,0],[e.scrollDelta,e.scrollDelta],axisModel,controller,coordSysInfo).signal*(range[1]-range[0])*e.scrollDelta})};function makeMover(getPercentDelta){return function(coordSysInfo,coordSysMainType,controller,e){var lastRange=this.range,range=lastRange.slice(),axisModel=coordSysInfo.axisModels[0];if(axisModel)return sliderMove(getPercentDelta(range,axisModel,coordSysInfo,coordSysMainType,controller,e),range,[0,100],"all"),this.range=range,lastRange[0]!==range[0]||lastRange[1]!==range[1]?range:void 0}}var getDirectionInfo={grid:function(oldPoint,newPoint,axisModel,controller,coordSysInfo){var axisModel=axisModel.axis,ret={},coordSysInfo=coordSysInfo.model.coordinateSystem.getRect();return oldPoint=oldPoint||[0,0],"x"===axisModel.dim?(ret.pixel=newPoint[0]-oldPoint[0],ret.pixelLength=coordSysInfo.width,ret.pixelStart=coordSysInfo.x,ret.signal=axisModel.inverse?1:-1):(ret.pixel=newPoint[1]-oldPoint[1],ret.pixelLength=coordSysInfo.height,ret.pixelStart=coordSysInfo.y,ret.signal=axisModel.inverse?-1:1),ret},polar:function(oldPoint,newPoint,axisModel,controller,coordSysInfo){var axis=axisModel.axis,ret={},coordSysInfo=coordSysInfo.model.coordinateSystem,radiusExtent=coordSysInfo.getRadiusAxis().getExtent(),angleExtent=coordSysInfo.getAngleAxis().getExtent();return oldPoint=oldPoint?coordSysInfo.pointToCoord(oldPoint):[0,0],newPoint=coordSysInfo.pointToCoord(newPoint),"radiusAxis"===axisModel.mainType?(ret.pixel=newPoint[0]-oldPoint[0],ret.pixelLength=radiusExtent[1]-radiusExtent[0],ret.pixelStart=radiusExtent[0],ret.signal=axis.inverse?1:-1):(ret.pixel=newPoint[1]-oldPoint[1],ret.pixelLength=angleExtent[1]-angleExtent[0],ret.pixelStart=angleExtent[0],ret.signal=axis.inverse?-1:1),ret},singleAxis:function(oldPoint,newPoint,axisModel,controller,coordSysInfo){var axisModel=axisModel.axis,coordSysInfo=coordSysInfo.model.coordinateSystem.getRect(),ret={};return oldPoint=oldPoint||[0,0],"horizontal"===axisModel.orient?(ret.pixel=newPoint[0]-oldPoint[0],ret.pixelLength=coordSysInfo.width,ret.pixelStart=coordSysInfo.x,ret.signal=axisModel.inverse?1:-1):(ret.pixel=newPoint[1]-oldPoint[1],ret.pixelLength=coordSysInfo.height,ret.pixelStart=coordSysInfo.y,ret.signal=axisModel.inverse?-1:1),ret}},each$4=each,asc$1=asc,AxisProxy=function(){function AxisProxy(dimName,axisIndex,dataZoomModel,ecModel){this._dimName=dimName,this._axisIndex=axisIndex,this.ecModel=ecModel,this._dataZoomModel=dataZoomModel}return AxisProxy.prototype.hostedBy=function(dataZoomModel){return this._dataZoomModel===dataZoomModel},AxisProxy.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},AxisProxy.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},AxisProxy.prototype.getTargetSeriesModels=function(){var seriesModels=[];return this.ecModel.eachSeries(function(seriesModel){var axisMainType;!function(seriesModel){return seriesModel=seriesModel.get("coordinateSystem"),0<=indexOf(SERIES_COORDS,seriesModel)}(seriesModel)||(axisMainType=getAxisMainType(this._dimName),(axisMainType=seriesModel.getReferringComponents(axisMainType,SINGLE_REFERRING).models[0])&&this._axisIndex===axisMainType.componentIndex&&seriesModels.push(seriesModel))},this),seriesModels},AxisProxy.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},AxisProxy.prototype.getMinMaxSpan=function(){return clone(this._minMaxSpan)},AxisProxy.prototype.calculateDataWindow=function(opt){var hasPropModeValue,dataExtent=this._dataExtent,scale=this.getAxisModel().axis.scale,rangePropMode=this._dataZoomModel.getRangePropMode(),percentExtent=[0,100],percentWindow=[],valueWindow=[],spans=(each$4(["start","end"],function(prop,idx){var boundPercent=opt[prop],prop=opt[prop+"Value"];"percent"===rangePropMode[idx]?prop=scale.parse(linearMap(boundPercent=null==boundPercent?percentExtent[idx]:boundPercent,percentExtent,dataExtent)):(hasPropModeValue=!0,boundPercent=linearMap(prop=null==prop?dataExtent[idx]:scale.parse(prop),dataExtent,percentExtent)),valueWindow[idx]=prop,percentWindow[idx]=boundPercent}),asc$1(valueWindow),asc$1(percentWindow),this._minMaxSpan);function restrictSet(fromWindow,toWindow,fromExtent,toExtent,toValue){var suffix=toValue?"Span":"ValueSpan";sliderMove(0,fromWindow,fromExtent,"all",spans["min"+suffix],spans["max"+suffix]);for(var i=0;i<2;i++)toWindow[i]=linearMap(fromWindow[i],fromExtent,toExtent,!0),toValue&&(toWindow[i]=scale.parse(toWindow[i]))}return hasPropModeValue?restrictSet(valueWindow,percentWindow,dataExtent,percentExtent,!1):restrictSet(percentWindow,valueWindow,percentExtent,dataExtent,!0),{valueWindow:valueWindow,percentWindow:percentWindow}},AxisProxy.prototype.reset=function(dataZoomModel){var axisProxy,axisDim,dataExtent,targetSeries;dataZoomModel===this._dataZoomModel&&(targetSeries=this.getTargetSeriesModels(),this._dataExtent=(axisDim=(axisProxy=this)._dimName,dataExtent=[1/0,-1/0],each$4(targetSeries=targetSeries,function(seriesModel){!function(dataExtent,data,axisDim){data&&each(getDataDimensionsOnAxis(data,axisDim),function(dim){dim=data.getApproximateExtent(dim);dim[0]<dataExtent[0]&&(dataExtent[0]=dim[0]),dim[1]>dataExtent[1]&&(dataExtent[1]=dim[1])})}(dataExtent,seriesModel.getData(),axisDim)}),[(axisProxy=ensureScaleRawExtentInfo((targetSeries=axisProxy.getAxisModel()).axis.scale,targetSeries,dataExtent).calculate()).min,axisProxy.max]),this._updateMinMaxSpan(),targetSeries=this.calculateDataWindow(dataZoomModel.settledOption),this._valueWindow=targetSeries.valueWindow,this._percentWindow=targetSeries.percentWindow,this._setAxisModel())},AxisProxy.prototype.filterData=function(dataZoomModel,api){var axisDim,seriesModels,filterMode,valueWindow;dataZoomModel===this._dataZoomModel&&(axisDim=this._dimName,seriesModels=this.getTargetSeriesModels(),filterMode=dataZoomModel.get("filterMode"),valueWindow=this._valueWindow,"none"!==filterMode&&each$4(seriesModels,function(seriesModel){var store_1,dataDimIndices_1,seriesData=seriesModel.getData(),dataDims=seriesData.mapDimensionsAll(axisDim);dataDims.length&&("weakFilter"===filterMode?(store_1=seriesData.getStore(),dataDimIndices_1=map(dataDims,function(dim){return seriesData.getDimensionIndex(dim)},seriesData),seriesData.filterSelf(function(dataIndex){for(var leftOut,rightOut,hasValue,i=0;i<dataDims.length;i++){var value=store_1.get(dataDimIndices_1[i],dataIndex),thisHasValue=!isNaN(value),thisLeftOut=value<valueWindow[0],value=value>valueWindow[1];if(thisHasValue&&!thisLeftOut&&!value)return!0;thisHasValue&&(hasValue=!0),thisLeftOut&&(leftOut=!0),value&&(rightOut=!0)}return hasValue&&leftOut&&rightOut})):each$4(dataDims,function(dim){var range;"empty"===filterMode?seriesModel.setData(seriesData=seriesData.map(dim,function(value){return function(value){return value>=valueWindow[0]&&value<=valueWindow[1]}(value)?value:NaN})):((range={})[dim]=valueWindow,seriesData.selectRange(range))}),each$4(dataDims,function(dim){seriesData.setApproximateExtent(valueWindow,dim)}))}))},AxisProxy.prototype._updateMinMaxSpan=function(){var minMaxSpan=this._minMaxSpan={},dataZoomModel=this._dataZoomModel,dataExtent=this._dataExtent;each$4(["min","max"],function(minMax){var percentSpan=dataZoomModel.get(minMax+"Span"),valueSpan=dataZoomModel.get(minMax+"ValueSpan");null!=(valueSpan=null!=valueSpan?this.getAxisModel().axis.scale.parse(valueSpan):valueSpan)?percentSpan=linearMap(dataExtent[0]+valueSpan,dataExtent,[0,100],!0):null!=percentSpan&&(valueSpan=linearMap(percentSpan,[0,100],dataExtent,!0)-dataExtent[0]),minMaxSpan[minMax+"Span"]=percentSpan,minMaxSpan[minMax+"ValueSpan"]=valueSpan},this)},AxisProxy.prototype._setAxisModel=function(){var precision,axisModel=this.getAxisModel(),percentWindow=this._percentWindow,valueWindow=this._valueWindow;percentWindow&&(precision=getPixelPrecision(valueWindow,[0,500]),precision=Math.min(precision,20),axisModel=axisModel.axis.scale.rawExtentInfo,0!==percentWindow[0]&&axisModel.setDeterminedMinMax("min",+valueWindow[0].toFixed(precision)),100!==percentWindow[1]&&axisModel.setDeterminedMinMax("max",+valueWindow[1].toFixed(precision)),axisModel.freeze())},AxisProxy}();var dataZoomProcessor={getTargetSeries:function(ecModel){function eachAxisModel(cb){ecModel.eachComponent("dataZoom",function(dataZoomModel){dataZoomModel.eachTargetAxis(function(axisDim,axisIndex){var axisModel=ecModel.getComponent(getAxisMainType(axisDim),axisIndex);cb(axisDim,axisIndex,axisModel,dataZoomModel)})})}eachAxisModel(function(axisDim,axisIndex,axisModel,dataZoomModel){axisModel.__dzAxisProxy=null});var proxyList=[],seriesModelMap=(eachAxisModel(function(axisDim,axisIndex,axisModel,dataZoomModel){axisModel.__dzAxisProxy||(axisModel.__dzAxisProxy=new AxisProxy(axisDim,axisIndex,dataZoomModel,ecModel),proxyList.push(axisModel.__dzAxisProxy))}),createHashMap());return each(proxyList,function(axisProxy){each(axisProxy.getTargetSeriesModels(),function(seriesModel){seriesModelMap.set(seriesModel.uid,seriesModel)})}),seriesModelMap},overallReset:function(ecModel,api){ecModel.eachComponent("dataZoom",function(dataZoomModel){dataZoomModel.eachTargetAxis(function(axisDim,axisIndex){dataZoomModel.getAxisProxy(axisDim,axisIndex).reset(dataZoomModel)}),dataZoomModel.eachTargetAxis(function(axisDim,axisIndex){dataZoomModel.getAxisProxy(axisDim,axisIndex).filterData(dataZoomModel,api)})}),ecModel.eachComponent("dataZoom",function(dataZoomModel){var percentRange,axisProxy=dataZoomModel.findRepresentativeAxisProxy();axisProxy&&(percentRange=axisProxy.getDataPercentWindow(),axisProxy=axisProxy.getDataValueWindow(),dataZoomModel.setCalculatedRange({start:percentRange[0],end:percentRange[1],startValue:axisProxy[0],endValue:axisProxy[1]}))})}};var installed=!1;function installCommon(registers){installed||(installed=!0,registers.registerProcessor(registers.PRIORITY.PROCESSOR.FILTER,dataZoomProcessor),function(registers){registers.registerAction("dataZoom",function(payload,ecModel){each(findEffectedDataZooms(ecModel,payload),function(dataZoomModel){dataZoomModel.setRawRange({start:payload.start,end:payload.end,startValue:payload.startValue,endValue:payload.endValue})})})}(registers),registers.registerSubTypeDefaulter("dataZoom",function(){return"slider"}))}function install$8(registers){installCommon(registers),registers.registerComponentModel(InsideZoomModel),registers.registerComponentView(InsideZoomView),installDataZoomRoamProcessor(registers)}var SliderZoomModel=function(_super){function SliderZoomModel(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=SliderZoomModel.type,_this}return __extends(SliderZoomModel,_super),SliderZoomModel.type="dataZoom.slider",SliderZoomModel.layoutMode="box",SliderZoomModel.defaultOption=inheritDefaultOption(DataZoomModel.defaultOption,{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,borderColor:"#d2dbee",borderRadius:3,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#d2dbee",width:.5},areaStyle:{color:"#d2dbee",opacity:.2}},selectedDataBackground:{lineStyle:{color:"#8fb0f7",width:.5},areaStyle:{color:"#8fb0f7",opacity:.2}},fillerColor:"rgba(135,175,274,0.2)",handleIcon:"path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z",handleSize:"100%",handleStyle:{color:"#fff",borderColor:"#ACB8D1"},moveHandleSize:7,moveHandleIcon:"path://M-320.9-50L-320.9-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-348-41-339-50-320.9-50z M-212.3-50L-212.3-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-239.4-41-230.4-50-212.3-50z M-103.7-50L-103.7-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-130.9-41-121.8-50-103.7-50z",moveHandleStyle:{color:"#D2DBEE",opacity:.7},showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#6E7079"},brushSelect:!0,brushStyle:{color:"rgba(135,175,274,0.15)"},emphasis:{handleStyle:{borderColor:"#8FB0F7"},moveHandleStyle:{color:"#8FB0F7"}}}),SliderZoomModel}(DataZoomModel),Rect$2=Rect,SHOW_DATA_SHADOW_SERIES_TYPE=["line","bar","candlestick","scatter"],REALTIME_ANIMATION_CONFIG={easing:"cubicOut",duration:100,delay:0},SliderZoomView=function(_super){function SliderZoomView(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=SliderZoomView.type,_this._displayables={},_this}return __extends(SliderZoomView,_super),SliderZoomView.prototype.init=function(ecModel,api){this.api=api,this._onBrush=bind(this._onBrush,this),this._onBrushEnd=bind(this._onBrushEnd,this)},SliderZoomView.prototype.render=function(dataZoomModel,ecModel,api,payload){if(_super.prototype.render.apply(this,arguments),createOrUpdate(this,"_dispatchZoomAction",dataZoomModel.get("throttle"),"fixRate"),this._orient=dataZoomModel.getOrient(),!1===dataZoomModel.get("show"))this.group.removeAll();else{if(dataZoomModel.noTarget())return this._clear(),void this.group.removeAll();payload&&"dataZoom"===payload.type&&payload.from===this.uid||this._buildView(),this._updateView()}},SliderZoomView.prototype.dispose=function(){this._clear(),_super.prototype.dispose.apply(this,arguments)},SliderZoomView.prototype._clear=function(){clear(this,"_dispatchZoomAction");var zr=this.api.getZr();zr.off("mousemove",this._onBrush),zr.off("mouseup",this._onBrushEnd)},SliderZoomView.prototype._buildView=function(){var thisGroup=this.group,barGroup=(thisGroup.removeAll(),this._brushing=!1,this._displayables.brushRect=null,this._resetLocation(),this._resetInterval(),this._displayables.sliderGroup=new Group);this._renderBackground(),this._renderHandle(),this._renderDataShadow(),thisGroup.add(barGroup),this._positionGroup()},SliderZoomView.prototype._resetLocation=function(){var dataZoomModel=this.dataZoomModel,api=this.api,moveHandleSize=dataZoomModel.get("brushSelect")?7:0,coordRect=this._findCoordRect(),api={width:api.getWidth(),height:api.getHeight()},positionInfo="horizontal"===this._orient?{right:api.width-coordRect.x-coordRect.width,top:api.height-30-7-moveHandleSize,width:coordRect.width,height:30}:{right:7,top:coordRect.y,width:30,height:coordRect.height},layoutParams=getLayoutParams(dataZoomModel.option),moveHandleSize=(each(["right","top","width","height"],function(name){"ph"===layoutParams[name]&&(layoutParams[name]=positionInfo[name])}),getLayoutRect(layoutParams,api));this._location={x:moveHandleSize.x,y:moveHandleSize.y},this._size=[moveHandleSize.width,moveHandleSize.height],"vertical"===this._orient&&this._size.reverse()},SliderZoomView.prototype._positionGroup=function(){var thisGroup=this.group,location=this._location,orient=this._orient,targetAxisModel=this.dataZoomModel.getFirstTargetAxisModel(),targetAxisModel=targetAxisModel&&targetAxisModel.get("inverse"),sliderGroup=this._displayables.sliderGroup,otherAxisInverse=(this._dataShadowInfo||{}).otherAxisInverse,orient=(sliderGroup.attr("horizontal"!==orient||targetAxisModel?"horizontal"===orient&&targetAxisModel?{scaleY:otherAxisInverse?1:-1,scaleX:-1}:"vertical"!==orient||targetAxisModel?{scaleY:otherAxisInverse?-1:1,scaleX:-1,rotation:Math.PI/2}:{scaleY:otherAxisInverse?-1:1,scaleX:1,rotation:Math.PI/2}:{scaleY:otherAxisInverse?1:-1,scaleX:1}),thisGroup.getBoundingRect([sliderGroup]));thisGroup.x=location.x-orient.x,thisGroup.y=location.y-orient.y,thisGroup.markRedraw()},SliderZoomView.prototype._getViewExtent=function(){return[0,this._size[0]]},SliderZoomView.prototype._renderBackground=function(){var dataZoomModel=this.dataZoomModel,size=this._size,barGroup=this._displayables.sliderGroup,brushSelect=dataZoomModel.get("brushSelect"),dataZoomModel=(barGroup.add(new Rect$2({silent:!0,shape:{x:0,y:0,width:size[0],height:size[1]},style:{fill:dataZoomModel.get("backgroundColor")},z2:-40})),new Rect$2({shape:{x:0,y:0,width:size[0],height:size[1]},style:{fill:"transparent"},z2:0,onclick:bind(this._onClickPanel,this)})),size=this.api.getZr();brushSelect?(dataZoomModel.on("mousedown",this._onBrushStart,this),dataZoomModel.cursor="crosshair",size.on("mousemove",this._onBrush),size.on("mouseup",this._onBrushEnd)):(size.off("mousemove",this._onBrush),size.off("mouseup",this._onBrushEnd)),barGroup.add(dataZoomModel)},SliderZoomView.prototype._renderDataShadow=function(){var info=this._dataShadowInfo=this._prepareDataShadowInfo();if(this._displayables.dataShadowSegs=[],info){var size=this._size,oldSize=this._shadowSize||[],seriesModel=info.series,data=seriesModel.getRawData(),seriesModel=seriesModel.getShadowDim?seriesModel.getShadowDim():info.otherDim;if(null!=seriesModel)for(var otherDataExtent_1,otherShadowExtent_1,areaPoints_1,linePoints_1,step_1,thisCoord_1,stride_1,lastIsEmpty_1,polygonPts=this._shadowPolygonPts,polylinePts=this._shadowPolylinePts,dataZoomModel=(data===this._shadowData&&seriesModel===this._shadowDim&&size[0]===oldSize[0]&&size[1]===oldSize[1]||(info=.3*((otherDataExtent_1=data.getDataExtent(seriesModel))[1]-otherDataExtent_1[0]),otherDataExtent_1=[otherDataExtent_1[0]-info,otherDataExtent_1[1]+info],otherShadowExtent_1=[0,size[1]],oldSize=[0,size[0]],areaPoints_1=[[size[0],0],[0,0]],linePoints_1=[],step_1=oldSize[1]/(data.count()-1),thisCoord_1=0,stride_1=Math.round(data.count()/size[0]),data.each([seriesModel],function(value,index){var isEmpty;0<stride_1&&index%stride_1?thisCoord_1+=step_1:(value=(isEmpty=null==value||isNaN(value)||""===value)?0:linearMap(value,otherDataExtent_1,otherShadowExtent_1,!0),isEmpty&&!lastIsEmpty_1&&index?(areaPoints_1.push([areaPoints_1[areaPoints_1.length-1][0],0]),linePoints_1.push([linePoints_1[linePoints_1.length-1][0],0])):!isEmpty&&lastIsEmpty_1&&(areaPoints_1.push([thisCoord_1,0]),linePoints_1.push([thisCoord_1,0])),areaPoints_1.push([thisCoord_1,value]),linePoints_1.push([thisCoord_1,value]),thisCoord_1+=step_1,lastIsEmpty_1=isEmpty)}),polygonPts=this._shadowPolygonPts=areaPoints_1,polylinePts=this._shadowPolylinePts=linePoints_1),this._shadowData=data,this._shadowDim=seriesModel,this._shadowSize=[size[0],size[1]],this.dataZoomModel),i=0;i<3;i++){var group=function(isSelectedArea){var isSelectedArea=dataZoomModel.getModel(isSelectedArea?"selectedDataBackground":"dataBackground"),group=new Group,polygon=new Polygon({shape:{points:polygonPts},segmentIgnoreThreshold:1,style:isSelectedArea.getModel("areaStyle").getAreaStyle(),silent:!0,z2:-20}),isSelectedArea=new Polyline({shape:{points:polylinePts},segmentIgnoreThreshold:1,style:isSelectedArea.getModel("lineStyle").getLineStyle(),silent:!0,z2:-19});return group.add(polygon),group.add(isSelectedArea),group}(1===i);this._displayables.sliderGroup.add(group),this._displayables.dataShadowSegs.push(group)}}},SliderZoomView.prototype._prepareDataShadowInfo=function(){var result,ecModel,dataZoomModel=this.dataZoomModel,showDataShadow=dataZoomModel.get("showDataShadow");if(!1!==showDataShadow)return ecModel=this.ecModel,dataZoomModel.eachTargetAxis(function(axisDim,axisIndex){each(dataZoomModel.getAxisProxy(axisDim,axisIndex).getTargetSeriesModels(),function(seriesModel){var thisAxis,otherDim,otherAxisInverse,coordSys;result||!0!==showDataShadow&&indexOf(SHOW_DATA_SHADOW_SERIES_TYPE,seriesModel.get("type"))<0||(thisAxis=ecModel.getComponent(getAxisMainType(axisDim),axisIndex).axis,coordSys=seriesModel.coordinateSystem,null!=(otherDim={x:"y",y:"x",radius:"angle",angle:"radius"}[axisDim])&&coordSys.getOtherAxis&&(otherAxisInverse=coordSys.getOtherAxis(thisAxis).inverse),otherDim=seriesModel.getData().mapDimension(otherDim),result={thisAxis:thisAxis,series:seriesModel,thisDim:axisDim,otherDim:otherDim,otherAxisInverse:otherAxisInverse})},this)},this),result},SliderZoomView.prototype._renderHandle=function(){var moveHandle_1,moveZoneExpandSize,thisGroup=this.group,displayables=this._displayables,handles=displayables.handles=[null,null],handleLabels=displayables.handleLabels=[null,null],sliderGroup=this._displayables.sliderGroup,size=this._size,dataZoomModel=this.dataZoomModel,api=this.api,borderRadius=dataZoomModel.get("borderRadius")||0,brushSelect=dataZoomModel.get("brushSelect"),filler=displayables.filler=new Rect$2({silent:brushSelect,style:{fill:dataZoomModel.get("fillerColor")},textConfig:{position:"inside"}}),borderRadius=(sliderGroup.add(filler),sliderGroup.add(new Rect$2({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:size[0],height:size[1],r:borderRadius},style:{stroke:dataZoomModel.get("dataBackgroundColor")||dataZoomModel.get("borderColor"),lineWidth:1,fill:"rgba(0,0,0,0)"}})),each([0,1],function(handleIndex){var iconStr=dataZoomModel.get("handleIcon"),iconStr=(!symbolBuildProxies[iconStr]&&iconStr.indexOf("path://")<0&&iconStr.indexOf("image://")<0&&(iconStr="path://"+iconStr,deprecateLog("handleIcon now needs 'path://' prefix when using a path string")),createSymbol(iconStr,-1,0,2,2,null,!0)),bRect=(iconStr.attr({cursor:getCursor(this._orient),draggable:!0,drift:bind(this._onDragMove,this,handleIndex),ondragend:bind(this._onDragEnd,this),onmouseover:bind(this._showDataInfo,this,!0),onmouseout:bind(this._showDataInfo,this,!1),z2:5}),iconStr.getBoundingRect()),handleSize=dataZoomModel.get("handleSize"),handleSize=(this._handleHeight=parsePercent$1(handleSize,this._size[1]),this._handleWidth=bRect.width/bRect.height*this._handleHeight,iconStr.setStyle(dataZoomModel.getModel("handleStyle").getItemStyle()),iconStr.style.strokeNoScale=!0,iconStr.rectHover=!0,iconStr.ensureState("emphasis").style=dataZoomModel.getModel(["emphasis","handleStyle"]).getItemStyle(),enableHoverEmphasis(iconStr),dataZoomModel.get("handleColor")),bRect=(null!=handleSize&&(iconStr.style.fill=handleSize),sliderGroup.add(handles[handleIndex]=iconStr),dataZoomModel.getModel("textStyle"));thisGroup.add(handleLabels[handleIndex]=new ZRText({silent:!0,invisible:!0,style:createTextStyle(bRect,{x:0,y:0,text:"",verticalAlign:"middle",align:"center",fill:bRect.getTextColor(),font:bRect.getFont()}),z2:10}))},this),filler);brushSelect&&(filler=parsePercent$1(dataZoomModel.get("moveHandleSize"),size[1]),moveHandle_1=displayables.moveHandle=new Rect({style:dataZoomModel.getModel("moveHandleStyle").getItemStyle(),silent:!0,shape:{r:[0,0,2,2],y:size[1]-.5,height:filler}}),brushSelect=.8*filler,(brushSelect=displayables.moveHandleIcon=createSymbol(dataZoomModel.get("moveHandleIcon"),-brushSelect/2,-brushSelect/2,brushSelect,brushSelect,"#fff",!0)).silent=!0,brushSelect.y=size[1]+filler/2-.5,moveHandle_1.ensureState("emphasis").style=dataZoomModel.getModel(["emphasis","moveHandleStyle"]).getItemStyle(),moveZoneExpandSize=Math.min(size[1]/2,Math.max(filler,10)),(borderRadius=displayables.moveZone=new Rect({invisible:!0,shape:{y:size[1]-moveZoneExpandSize,height:filler+moveZoneExpandSize}})).on("mouseover",function(){api.enterEmphasis(moveHandle_1)}).on("mouseout",function(){api.leaveEmphasis(moveHandle_1)}),sliderGroup.add(moveHandle_1),sliderGroup.add(brushSelect),sliderGroup.add(borderRadius)),borderRadius.attr({draggable:!0,cursor:getCursor(this._orient),drift:bind(this._onDragMove,this,"all"),ondragstart:bind(this._showDataInfo,this,!0),ondragend:bind(this._onDragEnd,this),onmouseover:bind(this._showDataInfo,this,!0),onmouseout:bind(this._showDataInfo,this,!1)})},SliderZoomView.prototype._resetInterval=function(){var range=this._range=this.dataZoomModel.getPercentRange(),viewExtent=this._getViewExtent();this._handleEnds=[linearMap(range[0],[0,100],viewExtent,!0),linearMap(range[1],[0,100],viewExtent,!0)]},SliderZoomView.prototype._updateInterval=function(handleIndex,delta){var dataZoomModel=this.dataZoomModel,handleEnds=this._handleEnds,viewExtend=this._getViewExtent(),minMaxSpan=dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan(),percentExtent=[0,100],delta=(sliderMove(delta,handleEnds,viewExtend,dataZoomModel.get("zoomLock")?"all":handleIndex,null!=minMaxSpan.minSpan?linearMap(minMaxSpan.minSpan,percentExtent,viewExtend,!0):null,null!=minMaxSpan.maxSpan?linearMap(minMaxSpan.maxSpan,percentExtent,viewExtend,!0):null),this._range),dataZoomModel=this._range=asc([linearMap(handleEnds[0],viewExtend,percentExtent,!0),linearMap(handleEnds[1],viewExtend,percentExtent,!0)]);return!delta||delta[0]!==dataZoomModel[0]||delta[1]!==dataZoomModel[1]},SliderZoomView.prototype._updateView=function(nonRealtime){for(var displaybles=this._displayables,handleEnds=this._handleEnds,handleInterval=asc(handleEnds.slice()),size=this._size,viewExtent=(each([0,1],function(handleIndex){var handle=displaybles.handles[handleIndex],handleHeight=this._handleHeight;handle.attr({scaleX:handleHeight/2,scaleY:handleHeight/2,x:handleEnds[handleIndex]+(handleIndex?-1:1),y:size[1]/2-handleHeight/2})},this),displaybles.filler.setShape({x:handleInterval[0],y:0,width:handleInterval[1]-handleInterval[0],height:size[1]}),{x:handleInterval[0],width:handleInterval[1]-handleInterval[0]}),dataShadowSegs=(displaybles.moveHandle&&(displaybles.moveHandle.setShape(viewExtent),displaybles.moveZone.setShape(viewExtent),displaybles.moveZone.getBoundingRect(),displaybles.moveHandleIcon&&displaybles.moveHandleIcon.attr("x",viewExtent.x+viewExtent.width/2)),displaybles.dataShadowSegs),segIntervals=[0,handleInterval[0],handleInterval[1],size[0]],i=0;i<dataShadowSegs.length;i++){var segGroup=dataShadowSegs[i],clipPath=segGroup.getClipPath();clipPath||(clipPath=new Rect,segGroup.setClipPath(clipPath)),clipPath.setShape({x:segIntervals[i],y:0,width:segIntervals[i+1]-segIntervals[i],height:size[1]})}this._updateDataInfo(nonRealtime)},SliderZoomView.prototype._updateDataInfo=function(nonRealtime){var axis,range,dataZoomModel=this.dataZoomModel,displaybles=this._displayables,handleLabels=displaybles.handleLabels,orient=this._orient,labelTexts=["",""],orderedHandleEnds=(!dataZoomModel.get("showDetail")||(dataZoomModel=dataZoomModel.findRepresentativeAxisProxy())&&(axis=dataZoomModel.getAxisModel().axis,range=this._range,nonRealtime=nonRealtime?dataZoomModel.calculateDataWindow({start:range[0],end:range[1]}).valueWindow:dataZoomModel.getDataValueWindow(),labelTexts=[this._formatLabel(nonRealtime[0],axis),this._formatLabel(nonRealtime[1],axis)]),asc(this._handleEnds.slice()));function setLabel(handleIndex){var barTransform=getTransform(displaybles.handles[handleIndex].parent,this.group),direction=transformDirection(0===handleIndex?"right":"left",barTransform),offset=this._handleWidth/2+5,offset=applyTransform$1([orderedHandleEnds[handleIndex]+(0===handleIndex?-offset:offset),this._size[1]/2],barTransform);handleLabels[handleIndex].setStyle({x:offset[0],y:offset[1],verticalAlign:"horizontal"===orient?"middle":direction,align:"horizontal"===orient?direction:"center",text:labelTexts[handleIndex]})}setLabel.call(this,0),setLabel.call(this,1)},SliderZoomView.prototype._formatLabel=function(value,axis){var dataZoomModel=this.dataZoomModel,labelFormatter=dataZoomModel.get("labelFormatter"),dataZoomModel=dataZoomModel.get("labelPrecision"),axis=(null!=dataZoomModel&&"auto"!==dataZoomModel||(dataZoomModel=axis.getPixelPrecision()),null==value||isNaN(value)?"":"category"===axis.type||"time"===axis.type?axis.scale.getLabel({value:Math.round(value)}):value.toFixed(Math.min(dataZoomModel,20)));return isFunction(labelFormatter)?labelFormatter(value,axis):isString(labelFormatter)?labelFormatter.replace("{value}",axis):axis},SliderZoomView.prototype._showDataInfo=function(showOrHide){showOrHide=this._dragging||showOrHide;var displayables=this._displayables,handleLabels=displayables.handleLabels;handleLabels[0].attr("invisible",!showOrHide),handleLabels[1].attr("invisible",!showOrHide),displayables.moveHandle&&this.api[showOrHide?"enterEmphasis":"leaveEmphasis"](displayables.moveHandle,1)},SliderZoomView.prototype._onDragMove=function(handleIndex,dx,dy,event){this._dragging=!0,stop(event.event);event=applyTransform$1([dx,dy],this._displayables.sliderGroup.getLocalTransform(),!0),dx=this._updateInterval(handleIndex,event[0]),dy=this.dataZoomModel.get("realtime");this._updateView(!dy),dx&&dy&&this._dispatchZoomAction(!0)},SliderZoomView.prototype._onDragEnd=function(){this._dragging=!1,this._showDataInfo(!1),this.dataZoomModel.get("realtime")||this._dispatchZoomAction(!1)},SliderZoomView.prototype._onClickPanel=function(e){var size=this._size,e=this._displayables.sliderGroup.transformCoordToLocal(e.offsetX,e.offsetY);e[0]<0||e[0]>size[0]||e[1]<0||e[1]>size[1]||(size=((size=this._handleEnds)[0]+size[1])/2,e=this._updateInterval("all",e[0]-size),this._updateView(),e&&this._dispatchZoomAction(!1))},SliderZoomView.prototype._onBrushStart=function(e){var x=e.offsetX,e=e.offsetY;this._brushStart=new Point(x,e),this._brushing=!0,this._brushStartTime=+new Date},SliderZoomView.prototype._onBrushEnd=function(e){var brushRect,viewExtend,percentExtent;this._brushing&&(brushRect=this._displayables.brushRect,this._brushing=!1,brushRect&&(brushRect.attr("ignore",!0),brushRect=brushRect.shape,+new Date-this._brushStartTime<200&&Math.abs(brushRect.width)<5||(viewExtend=this._getViewExtent(),this._range=asc([linearMap(brushRect.x,viewExtend,percentExtent=[0,100],!0),linearMap(brushRect.x+brushRect.width,viewExtend,percentExtent,!0)]),this._handleEnds=[brushRect.x,brushRect.x+brushRect.width],this._updateView(),this._dispatchZoomAction(!1))))},SliderZoomView.prototype._onBrush=function(e){this._brushing&&(stop(e.event),this._updateBrushRect(e.offsetX,e.offsetY))},SliderZoomView.prototype._updateBrushRect=function(mouseX,mouseY){var displayables=this._displayables,dataZoomModel=this.dataZoomModel,brushRect=displayables.brushRect,dataZoomModel=(brushRect||(brushRect=displayables.brushRect=new Rect$2({silent:!0,style:dataZoomModel.getModel("brushStyle").getItemStyle()}),displayables.sliderGroup.add(brushRect)),brushRect.attr("ignore",!1),this._brushStart),displayables=this._displayables.sliderGroup,mouseX=displayables.transformCoordToLocal(mouseX,mouseY),mouseY=displayables.transformCoordToLocal(dataZoomModel.x,dataZoomModel.y),displayables=this._size;mouseX[0]=Math.max(Math.min(displayables[0],mouseX[0]),0),brushRect.setShape({x:mouseY[0],y:0,width:mouseX[0]-mouseY[0],height:displayables[1]})},SliderZoomView.prototype._dispatchZoomAction=function(realtime){var range=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,animation:realtime?REALTIME_ANIMATION_CONFIG:null,start:range[0],end:range[1]})},SliderZoomView.prototype._findCoordRect=function(){var rect,height,coordSysInfoList=collectReferCoordSysModelInfo(this.dataZoomModel).infoList;return rect=(rect=!rect&&coordSysInfoList.length?(coordSysInfoList=coordSysInfoList[0].model.coordinateSystem).getRect&&coordSysInfoList.getRect():rect)?rect:{x:.2*(coordSysInfoList=this.api.getWidth()),y:.2*(height=this.api.getHeight()),width:.6*coordSysInfoList,height:.6*height}},SliderZoomView.type="dataZoom.slider",SliderZoomView}(Ellipse);function getCursor(orient){return"vertical"===orient?"ns-resize":"ew-resize"}function install$9(registers){registers.registerComponentModel(SliderZoomModel),registers.registerComponentView(SliderZoomView),installCommon(registers)}use(function(registers){use(install$8),use(install$9)}),exports.version="5.3.1",exports.dependencies={zrender:"5.3.1"},exports.PRIORITY=Diamond,exports.init=function(dom,theme$$1,opts){var isClient=!(opts&&opts.ssr);if(isClient){if(!dom)throw new Error("Initialize failed: invalid dom.");var existInstance=getInstanceByDom(dom);if(existInstance)return console.warn("There is a chart instance already initialized on the dom."),existInstance;!isDom(dom)||"CANVAS"===dom.nodeName.toUpperCase()||(dom.clientWidth||opts&&null!=opts.width)&&(dom.clientHeight||opts&&null!=opts.height)||console.warn("Can't get DOM width or height. Please check dom.clientWidth and dom.clientHeight. They should not be 0.For example, you may need to call this in the callback of window.onload.")}return(existInstance=new ECharts(dom,theme$$1,opts)).id="ec_"+idBase++,instances[existInstance.id]=existInstance,isClient&&setAttribute(dom,DOM_ATTRIBUTE_KEY,existInstance.id),enableConnect(existInstance),lifecycle.trigger("afterinit",existInstance),existInstance},exports.connect=function(groupId){var charts;return isArray(groupId)&&(charts=groupId,groupId=null,each(charts,function(chart){null!=chart.group&&(groupId=chart.group)}),groupId=groupId||"g_"+groupIdBase++,each(charts,function(chart){chart.group=groupId})),connectedGroups[groupId]=!0,groupId},exports.disConnect=disConnect,exports.disconnect=Triangle,exports.dispose=function(chart){isString(chart)?chart=instances[chart]:chart instanceof ECharts||(chart=getInstanceByDom(chart)),chart instanceof ECharts&&!chart.isDisposed()&&chart.dispose()},exports.getInstanceByDom=getInstanceByDom,exports.getInstanceById=function(key){return instances[key]},exports.registerTheme=registerTheme,exports.registerPreprocessor=registerPreprocessor,exports.registerProcessor=registerProcessor,exports.registerPostInit=registerPostInit,exports.registerPostUpdate=registerPostUpdate,exports.registerUpdateLifecycle=registerUpdateLifecycle,exports.registerAction=registerAction,exports.registerCoordinateSystem=registerCoordinateSystem,exports.getCoordinateSystemDimensions=function(type){if(type=CoordinateSystemManager.get(type))return type.getDimensionsInfo?type.getDimensionsInfo():type.dimensions.slice()},exports.registerLayout=registerLayout,exports.registerVisual=registerVisual,exports.registerLoading=registerLoading,exports.setCanvasCreator=function(creator){deprecateLog("setCanvasCreator is deprecated. Use setPlatformAPI({ createCanvas }) instead."),setPlatformAPI({createCanvas:creator})},exports.registerMap=registerMap,exports.getMap=function(mapName){var getMap=getImpl("getMap");return getMap&&getMap(mapName)},exports.registerTransform=registerTransform,exports.dataTool={},exports.registerLocale=registerLocale,exports.zrender=zrender,exports.matrix=mouseHandlerNames,exports.vector=createCanvas,exports.zrUtil=arrayProto,exports.color=color,exports.helper=Pin,exports.number=ItemStyleMixin,exports.time=AreaStyleMixin,exports.graphic=subPixelOptimize$1,exports.format=target,exports.util=ITEM_STYLE_KEY_MAP,exports.List=SeriesData,exports.ComponentModel=ComponentModel,exports.ComponentView=ComponentView,exports.SeriesModel=SeriesModel,exports.ChartView=ChartView,exports.extendComponentModel=function(proto){return proto=ComponentModel.extend(proto),ComponentModel.registerClass(proto),proto},exports.extendComponentView=function(proto){return proto=ComponentView.extend(proto),ComponentView.registerClass(proto),proto},exports.extendSeriesModel=function(proto){return proto=SeriesModel.extend(proto),SeriesModel.registerClass(proto),proto},exports.extendChartView=function(proto){return proto=ChartView.extend(proto),ChartView.registerClass(proto),proto},exports.throttle=throttle,exports.use=use,exports.setPlatformAPI=setPlatformAPI,exports.parseGeoJSON=parseGeoJSON,exports.parseGeoJson=parseGeoJSON,exports.env=env,exports.Model=Model,exports.Axis=LineStyleMixin,exports.innerDrawElementOnCanvas=brushSingle});